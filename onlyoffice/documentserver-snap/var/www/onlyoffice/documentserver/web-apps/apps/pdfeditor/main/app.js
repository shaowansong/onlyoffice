/*!
 * Copyright (c) Ascensio System SIA 2023. All rights reserved
 *
 * http://www.onlyoffice.com 
 *
 * Version: 7.5.1 (build:0)
 */
if(function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){"use strict";var i=[],n=Object.getPrototypeOf,o=i.slice,s=i.flat?function(t){return i.flat.call(t)}:function(t){return i.concat.apply([],t)},a=i.push,r=i.indexOf,l={},c=l.toString,d=l.hasOwnProperty,h=d.toString,m=h.call(Object),u={},p=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},f=function(t){return null!=t&&t===t.window},g=t.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function v(t,e,i){var n,o,s=(i=i||g).createElement("script");if(s.text=t,e)for(n in b)(o=e[n]||e.getAttribute&&e.getAttribute(n))&&s.setAttribute(n,o);i.head.appendChild(s).parentNode.removeChild(s)}function C(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[c.call(t)]||"object":typeof t}var y="3.5.1",w=function(t,e){return new w.fn.init(t,e)};function x(t){var e=!!t&&"length"in t&&t.length,i=C(t);return!p(t)&&!f(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}w.fn=w.prototype={jquery:y,constructor:w,length:0,toArray:function(){return o.call(this)},get:function(t){return null==t?o.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=w.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return w.each(this,t)},map:function(t){return this.pushStack(w.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(w.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:i.sort,splice:i.splice},w.extend=w.fn.extend=function(){var t,e,i,n,o,s,a=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[r]||{},r++),"object"==typeof a||p(a)||(a={}),r===l&&(a=this,r--);r<l;r++)if(null!=(t=arguments[r]))for(e in t)n=t[e],"__proto__"!==e&&a!==n&&(c&&n&&(w.isPlainObject(n)||(o=Array.isArray(n)))?(i=a[e],s=o&&!Array.isArray(i)?[]:o||w.isPlainObject(i)?i:{},o=!1,a[e]=w.extend(c,s,n)):void 0!==n&&(a[e]=n));return a},w.extend({expando:"jQuery"+(y+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==c.call(t))&&(!(e=n(t))||"function"==typeof(i=d.call(e,"constructor")&&e.constructor)&&h.call(i)===m)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,i){v(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,n=0;if(x(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},makeArray:function(t,e){var i=e||[];return null!=t&&(x(Object(t))?w.merge(i,"string"==typeof t?[t]:t):a.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:r.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,o=t.length;n<i;n++)t[o++]=e[n];return t.length=o,t},grep:function(t,e,i){for(var n=[],o=0,s=t.length,a=!i;o<s;o++)!e(t[o],o)!==a&&n.push(t[o]);return n},map:function(t,e,i){var n,o,a=0,r=[];if(x(t))for(n=t.length;a<n;a++)null!=(o=e(t[a],a,i))&&r.push(o);else for(a in t)null!=(o=e(t[a],a,i))&&r.push(o);return s(r)},guid:1,support:u}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=i[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){l["[object "+e+"]"]=e.toLowerCase()}));var _=function(t){var e,i,n,o,s,a,r,l,c,d,h,m,u,p,f,g,b,v,C,y="sizzle"+1*new Date,w=t.document,x=0,_=0,S=lt(),k=lt(),T=lt(),A=lt(),I=function(t,e){return t===e&&(h=!0),0},P={}.hasOwnProperty,E=[],D=E.pop,U=E.push,M=E.push,L=E.slice,F=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},V="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",O="(?:\\\\[\\da-fA-F]{1,6}"+B+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",R="\\["+B+"*("+O+")(?:"+B+"*([*^$|!~]?=)"+B+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+B+"*\\]",$=":("+O+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+R+")*)|.*)\\)|)",H=new RegExp(B+"+","g"),N=new RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),z=new RegExp("^"+B+"*,"+B+"*"),W=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),j=new RegExp(B+"|>"),K=new RegExp($),q=new RegExp("^"+O+"$"),G={ID:new RegExp("^#("+O+")"),CLASS:new RegExp("^\\.("+O+")"),TAG:new RegExp("^("+O+"|[*])"),ATTR:new RegExp("^"+R),PSEUDO:new RegExp("^"+$),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),bool:new RegExp("^(?:"+V+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+B+"*((?:-\\d)?\\d*)"+B+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,X=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}"+B+"?|\\\\([^\\r\\n\\f])","g"),it=function(t,e){var i="0x"+t.slice(1)-65536;return e||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},nt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ot=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},st=function(){m()},at=yt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{M.apply(E=L.call(w.childNodes),w.childNodes),E[w.childNodes.length].nodeType}catch(t){M={apply:E.length?function(t,e){U.apply(t,L.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function rt(t,e,n,o){var s,r,c,d,h,p,b,v=e&&e.ownerDocument,w=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return n;if(!o&&(m(e),e=e||u,f)){if(11!==w&&(h=Q.exec(t)))if(s=h[1]){if(9===w){if(!(c=e.getElementById(s)))return n;if(c.id===s)return n.push(c),n}else if(v&&(c=v.getElementById(s))&&C(e,c)&&c.id===s)return n.push(c),n}else{if(h[2])return M.apply(n,e.getElementsByTagName(t)),n;if((s=h[3])&&i.getElementsByClassName&&e.getElementsByClassName)return M.apply(n,e.getElementsByClassName(s)),n}if(i.qsa&&!A[t+" "]&&(!g||!g.test(t))&&(1!==w||"object"!==e.nodeName.toLowerCase())){if(b=t,v=e,1===w&&(j.test(t)||W.test(t))){for((v=tt.test(t)&&bt(e.parentNode)||e)===e&&i.scope||((d=e.getAttribute("id"))?d=d.replace(nt,ot):e.setAttribute("id",d=y)),r=(p=a(t)).length;r--;)p[r]=(d?"#"+d:":scope")+" "+Ct(p[r]);b=p.join(",")}try{return M.apply(n,v.querySelectorAll(b)),n}catch(e){A(t,!0)}finally{d===y&&e.removeAttribute("id")}}}return l(t.replace(N,"$1"),e,n,o)}function lt(){var t=[];return function e(i,o){return t.push(i+" ")>n.cacheLength&&delete e[t.shift()],e[i+" "]=o}}function ct(t){return t[y]=!0,t}function dt(t){var e=u.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var i=t.split("|"),o=i.length;o--;)n.attrHandle[i[o]]=e}function mt(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function ut(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function pt(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function ft(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&at(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function gt(t){return ct((function(e){return e=+e,ct((function(i,n){for(var o,s=t([],i.length,e),a=s.length;a--;)i[o=s[a]]&&(i[o]=!(n[o]=i[o]))}))}))}function bt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in i=rt.support={},s=rt.isXML=function(t){var e=t.namespaceURI,i=(t.ownerDocument||t).documentElement;return!Y.test(e||i&&i.nodeName||"HTML")},m=rt.setDocument=function(t){var e,o,a=t?t.ownerDocument||t:w;return a!=u&&9===a.nodeType&&a.documentElement?(p=(u=a).documentElement,f=!s(u),w!=u&&(o=u.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",st,!1):o.attachEvent&&o.attachEvent("onunload",st)),i.scope=dt((function(t){return p.appendChild(t).appendChild(u.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),i.attributes=dt((function(t){return t.className="i",!t.getAttribute("className")})),i.getElementsByTagName=dt((function(t){return t.appendChild(u.createComment("")),!t.getElementsByTagName("*").length})),i.getElementsByClassName=J.test(u.getElementsByClassName),i.getById=dt((function(t){return p.appendChild(t).id=y,!u.getElementsByName||!u.getElementsByName(y).length})),i.getById?(n.filter.ID=function(t){var e=t.replace(et,it);return function(t){return t.getAttribute("id")===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&f){var i=e.getElementById(t);return i?[i]:[]}}):(n.filter.ID=function(t){var e=t.replace(et,it);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&f){var i,n,o,s=e.getElementById(t);if(s){if((i=s.getAttributeNode("id"))&&i.value===t)return[s];for(o=e.getElementsByName(t),n=0;s=o[n++];)if((i=s.getAttributeNode("id"))&&i.value===t)return[s]}return[]}}),n.find.TAG=i.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):i.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],o=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[o++];)1===i.nodeType&&n.push(i);return n}return s},n.find.CLASS=i.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&f)return e.getElementsByClassName(t)},b=[],g=[],(i.qsa=J.test(u.querySelectorAll))&&(dt((function(t){var e;p.appendChild(t).innerHTML="<a id='"+y+"'></a><select id='"+y+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+B+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+B+"*(?:value|"+V+")"),t.querySelectorAll("[id~="+y+"-]").length||g.push("~="),(e=u.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||g.push("\\["+B+"*name"+B+"*="+B+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+y+"+*").length||g.push(".#.+[+~]"),t.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")})),dt((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=u.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+B+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(i.matchesSelector=J.test(v=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&dt((function(t){i.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),b.push("!=",$)})),g=g.length&&new RegExp(g.join("|")),b=b.length&&new RegExp(b.join("|")),e=J.test(p.compareDocumentPosition),C=e||J.test(p.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},I=e?function(t,e){if(t===e)return h=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!i.sortDetached&&e.compareDocumentPosition(t)===n?t==u||t.ownerDocument==w&&C(w,t)?-1:e==u||e.ownerDocument==w&&C(w,e)?1:d?F(d,t)-F(d,e):0:4&n?-1:1)}:function(t,e){if(t===e)return h=!0,0;var i,n=0,o=t.parentNode,s=e.parentNode,a=[t],r=[e];if(!o||!s)return t==u?-1:e==u?1:o?-1:s?1:d?F(d,t)-F(d,e):0;if(o===s)return mt(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)r.unshift(i);for(;a[n]===r[n];)n++;return n?mt(a[n],r[n]):a[n]==w?-1:r[n]==w?1:0},u):u},rt.matches=function(t,e){return rt(t,null,null,e)},rt.matchesSelector=function(t,e){if(m(t),i.matchesSelector&&f&&!A[e+" "]&&(!b||!b.test(e))&&(!g||!g.test(e)))try{var n=v.call(t,e);if(n||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){A(e,!0)}return rt(e,u,null,[t]).length>0},rt.contains=function(t,e){return(t.ownerDocument||t)!=u&&m(t),C(t,e)},rt.attr=function(t,e){(t.ownerDocument||t)!=u&&m(t);var o=n.attrHandle[e.toLowerCase()],s=o&&P.call(n.attrHandle,e.toLowerCase())?o(t,e,!f):void 0;return void 0!==s?s:i.attributes||!f?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},rt.escape=function(t){return(t+"").replace(nt,ot)},rt.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},rt.uniqueSort=function(t){var e,n=[],o=0,s=0;if(h=!i.detectDuplicates,d=!i.sortStable&&t.slice(0),t.sort(I),h){for(;e=t[s++];)e===t[s]&&(o=n.push(s));for(;o--;)t.splice(n[o],1)}return d=null,t},o=rt.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=o(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n++];)i+=o(e);return i},n=rt.selectors={cacheLength:50,createPseudo:ct,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,it),t[3]=(t[3]||t[4]||t[5]||"").replace(et,it),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||rt.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&rt.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return G.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&K.test(i)&&(e=a(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,it).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|"+B+")"+t+"("+B+"|$)"))&&S(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var o=rt.attr(n,t);return null==o?"!="===e:!e||(o+="","="===e?o===i:"!="===e?o!==i:"^="===e?i&&0===o.indexOf(i):"*="===e?i&&o.indexOf(i)>-1:"$="===e?i&&o.slice(-i.length)===i:"~="===e?(" "+o.replace(H," ")+" ").indexOf(i)>-1:"|="===e&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,o){var s="nth"!==t.slice(0,3),a="last"!==t.slice(-4),r="of-type"===e;return 1===n&&0===o?function(t){return!!t.parentNode}:function(e,i,l){var c,d,h,m,u,p,f=s!==a?"nextSibling":"previousSibling",g=e.parentNode,b=r&&e.nodeName.toLowerCase(),v=!l&&!r,C=!1;if(g){if(s){for(;f;){for(m=e;m=m[f];)if(r?m.nodeName.toLowerCase()===b:1===m.nodeType)return!1;p=f="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&v){for(C=(u=(c=(d=(h=(m=g)[y]||(m[y]={}))[m.uniqueID]||(h[m.uniqueID]={}))[t]||[])[0]===x&&c[1])&&c[2],m=u&&g.childNodes[u];m=++u&&m&&m[f]||(C=u=0)||p.pop();)if(1===m.nodeType&&++C&&m===e){d[t]=[x,u,C];break}}else if(v&&(C=u=(c=(d=(h=(m=e)[y]||(m[y]={}))[m.uniqueID]||(h[m.uniqueID]={}))[t]||[])[0]===x&&c[1]),!1===C)for(;(m=++u&&m&&m[f]||(C=u=0)||p.pop())&&((r?m.nodeName.toLowerCase()!==b:1!==m.nodeType)||!++C||(v&&((d=(h=m[y]||(m[y]={}))[m.uniqueID]||(h[m.uniqueID]={}))[t]=[x,C]),m!==e)););return(C-=o)===n||C%n==0&&C/n>=0}}},PSEUDO:function(t,e){var i,o=n.pseudos[t]||n.setFilters[t.toLowerCase()]||rt.error("unsupported pseudo: "+t);return o[y]?o(e):o.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,i){for(var n,s=o(t,e),a=s.length;a--;)t[n=F(t,s[a])]=!(i[n]=s[a])})):function(t){return o(t,0,i)}):o}},pseudos:{not:ct((function(t){var e=[],i=[],n=r(t.replace(N,"$1"));return n[y]?ct((function(t,e,i,o){for(var s,a=n(t,null,o,[]),r=t.length;r--;)(s=a[r])&&(t[r]=!(e[r]=s))})):function(t,o,s){return e[0]=t,n(e,null,s,i),e[0]=null,!i.pop()}})),has:ct((function(t){return function(e){return rt(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,it),function(e){return(e.textContent||o(e)).indexOf(t)>-1}})),lang:ct((function(t){return q.test(t||"")||rt.error("unsupported lang: "+t),t=t.replace(et,it).toLowerCase(),function(e){var i;do{if(i=f?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===u.activeElement&&(!u.hasFocus||u.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:ft(!1),disabled:ft(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!n.pseudos.empty(t)},header:function(t){return Z.test(t.nodeName)},input:function(t){return X.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:gt((function(){return[0]})),last:gt((function(t,e){return[e-1]})),eq:gt((function(t,e,i){return[i<0?i+e:i]})),even:gt((function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t})),odd:gt((function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t})),lt:gt((function(t,e,i){for(var n=i<0?i+e:i>e?e:i;--n>=0;)t.push(n);return t})),gt:gt((function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=ut(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=pt(e);function vt(){}function Ct(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function yt(t,e,i){var n=e.dir,o=e.next,s=o||n,a=i&&"parentNode"===s,r=_++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||a)return t(e,i,o);return!1}:function(e,i,l){var c,d,h,m=[x,r];if(l){for(;e=e[n];)if((1===e.nodeType||a)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||a)if(d=(h=e[y]||(e[y]={}))[e.uniqueID]||(h[e.uniqueID]={}),o&&o===e.nodeName.toLowerCase())e=e[n]||e;else{if((c=d[s])&&c[0]===x&&c[1]===r)return m[2]=c[2];if(d[s]=m,m[2]=t(e,i,l))return!0}return!1}}function wt(t){return t.length>1?function(e,i,n){for(var o=t.length;o--;)if(!t[o](e,i,n))return!1;return!0}:t[0]}function xt(t,e,i,n,o){for(var s,a=[],r=0,l=t.length,c=null!=e;r<l;r++)(s=t[r])&&(i&&!i(s,n,o)||(a.push(s),c&&e.push(r)));return a}function _t(t,e,i,n,o,s){return n&&!n[y]&&(n=_t(n)),o&&!o[y]&&(o=_t(o,s)),ct((function(s,a,r,l){var c,d,h,m=[],u=[],p=a.length,f=s||function(t,e,i){for(var n=0,o=e.length;n<o;n++)rt(t,e[n],i);return i}(e||"*",r.nodeType?[r]:r,[]),g=!t||!s&&e?f:xt(f,m,t,r,l),b=i?o||(s?t:p||n)?[]:a:g;if(i&&i(g,b,r,l),n)for(c=xt(b,u),n(c,[],r,l),d=c.length;d--;)(h=c[d])&&(b[u[d]]=!(g[u[d]]=h));if(s){if(o||t){if(o){for(c=[],d=b.length;d--;)(h=b[d])&&c.push(g[d]=h);o(null,b=[],c,l)}for(d=b.length;d--;)(h=b[d])&&(c=o?F(s,h):m[d])>-1&&(s[c]=!(a[c]=h))}}else b=xt(b===a?b.splice(p,b.length):b),o?o(null,a,b,l):M.apply(a,b)}))}function St(t){for(var e,i,o,s=t.length,a=n.relative[t[0].type],r=a||n.relative[" "],l=a?1:0,d=yt((function(t){return t===e}),r,!0),h=yt((function(t){return F(e,t)>-1}),r,!0),m=[function(t,i,n){var o=!a&&(n||i!==c)||((e=i).nodeType?d(t,i,n):h(t,i,n));return e=null,o}];l<s;l++)if(i=n.relative[t[l].type])m=[yt(wt(m),i)];else{if((i=n.filter[t[l].type].apply(null,t[l].matches))[y]){for(o=++l;o<s&&!n.relative[t[o].type];o++);return _t(l>1&&wt(m),l>1&&Ct(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(N,"$1"),i,l<o&&St(t.slice(l,o)),o<s&&St(t=t.slice(o)),o<s&&Ct(t))}m.push(i)}return wt(m)}return vt.prototype=n.filters=n.pseudos,n.setFilters=new vt,a=rt.tokenize=function(t,e){var i,o,s,a,r,l,c,d=k[t+" "];if(d)return e?0:d.slice(0);for(r=t,l=[],c=n.preFilter;r;){for(a in i&&!(o=z.exec(r))||(o&&(r=r.slice(o[0].length)||r),l.push(s=[])),i=!1,(o=W.exec(r))&&(i=o.shift(),s.push({value:i,type:o[0].replace(N," ")}),r=r.slice(i.length)),n.filter)!(o=G[a].exec(r))||c[a]&&!(o=c[a](o))||(i=o.shift(),s.push({value:i,type:a,matches:o}),r=r.slice(i.length));if(!i)break}return e?r.length:r?rt.error(t):k(t,l).slice(0)},r=rt.compile=function(t,e){var i,o=[],s=[],r=T[t+" "];if(!r){for(e||(e=a(t)),i=e.length;i--;)(r=St(e[i]))[y]?o.push(r):s.push(r);r=T(t,function(t,e){var i=e.length>0,o=t.length>0,s=function(s,a,r,l,d){var h,p,g,b=0,v="0",C=s&&[],y=[],w=c,_=s||o&&n.find.TAG("*",d),S=x+=null==w?1:Math.random()||.1,k=_.length;for(d&&(c=a==u||a||d);v!==k&&null!=(h=_[v]);v++){if(o&&h){for(p=0,a||h.ownerDocument==u||(m(h),r=!f);g=t[p++];)if(g(h,a||u,r)){l.push(h);break}d&&(x=S)}i&&((h=!g&&h)&&b--,s&&C.push(h))}if(b+=v,i&&v!==b){for(p=0;g=e[p++];)g(C,y,a,r);if(s){if(b>0)for(;v--;)C[v]||y[v]||(y[v]=D.call(l));y=xt(y)}M.apply(l,y),d&&!s&&y.length>0&&b+e.length>1&&rt.uniqueSort(l)}return d&&(x=S,c=w),C};return i?ct(s):s}(s,o)),r.selector=t}return r},l=rt.select=function(t,e,i,o){var s,l,c,d,h,m="function"==typeof t&&t,u=!o&&a(t=m.selector||t);if(i=i||[],1===u.length){if((l=u[0]=u[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===e.nodeType&&f&&n.relative[l[1].type]){if(!(e=(n.find.ID(c.matches[0].replace(et,it),e)||[])[0]))return i;m&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(s=G.needsContext.test(t)?0:l.length;s--&&(c=l[s],!n.relative[d=c.type]);)if((h=n.find[d])&&(o=h(c.matches[0].replace(et,it),tt.test(l[0].type)&&bt(e.parentNode)||e))){if(l.splice(s,1),!(t=o.length&&Ct(l)))return M.apply(i,o),i;break}}return(m||r(t,u))(o,e,!f,i,!e||tt.test(t)&&bt(e.parentNode)||e),i},i.sortStable=y.split("").sort(I).join("")===y,i.detectDuplicates=!!h,m(),i.sortDetached=dt((function(t){return 1&t.compareDocumentPosition(u.createElement("fieldset"))})),dt((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),i.attributes&&dt((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),dt((function(t){return null==t.getAttribute("disabled")}))||ht(V,(function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null})),rt}(t);w.find=_,w.expr=_.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=_.uniqueSort,w.text=_.getText,w.isXMLDoc=_.isXML,w.contains=_.contains,w.escapeSelector=_.escape;var S=function(t,e,i){for(var n=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&w(t).is(i))break;n.push(t)}return n},k=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},T=w.expr.match.needsContext;function A(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var I=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function P(t,e,i){return p(e)?w.grep(t,(function(t,n){return!!e.call(t,n,t)!==i})):e.nodeType?w.grep(t,(function(t){return t===e!==i})):"string"!=typeof e?w.grep(t,(function(t){return r.call(e,t)>-1!==i})):w.filter(e,t,i)}w.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?w.find.matchesSelector(n,t)?[n]:[]:w.find.matches(t,w.grep(e,(function(t){return 1===t.nodeType})))},w.fn.extend({find:function(t){var e,i,n=this.length,o=this;if("string"!=typeof t)return this.pushStack(w(t).filter((function(){for(e=0;e<n;e++)if(w.contains(o[e],this))return!0})));for(i=this.pushStack([]),e=0;e<n;e++)w.find(t,o[e],i);return n>1?w.uniqueSort(i):i},filter:function(t){return this.pushStack(P(this,t||[],!1))},not:function(t){return this.pushStack(P(this,t||[],!0))},is:function(t){return!!P(this,"string"==typeof t&&T.test(t)?w(t):t||[],!1).length}});var E,D=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(t,e,i){var n,o;if(!t)return this;if(i=i||E,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:D.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof w?e[0]:e,w.merge(this,w.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:g,!0)),I.test(n[1])&&w.isPlainObject(e))for(n in e)p(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(o=g.getElementById(n[2]))&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):p(t)?void 0!==i.ready?i.ready(t):t(w):w.makeArray(t,this)}).prototype=w.fn,E=w(g);var U=/^(?:parents|prev(?:Until|All))/,M={children:!0,contents:!0,next:!0,prev:!0};function L(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}w.fn.extend({has:function(t){var e=w(t,this),i=e.length;return this.filter((function(){for(var t=0;t<i;t++)if(w.contains(this,e[t]))return!0}))},closest:function(t,e){var i,n=0,o=this.length,s=[],a="string"!=typeof t&&w(t);if(!T.test(t))for(;n<o;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&w.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?w.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?r.call(w(t),this[0]):r.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),w.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return S(t,"parentNode")},parentsUntil:function(t,e,i){return S(t,"parentNode",i)},next:function(t){return L(t,"nextSibling")},prev:function(t){return L(t,"previousSibling")},nextAll:function(t){return S(t,"nextSibling")},prevAll:function(t){return S(t,"previousSibling")},nextUntil:function(t,e,i){return S(t,"nextSibling",i)},prevUntil:function(t,e,i){return S(t,"previousSibling",i)},siblings:function(t){return k((t.parentNode||{}).firstChild,t)},children:function(t){return k(t.firstChild)},contents:function(t){return null!=t.contentDocument&&n(t.contentDocument)?t.contentDocument:(A(t,"template")&&(t=t.content||t),w.merge([],t.childNodes))}},(function(t,e){w.fn[t]=function(i,n){var o=w.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=w.filter(n,o)),this.length>1&&(M[t]||w.uniqueSort(o),U.test(t)&&o.reverse()),this.pushStack(o)}}));var F=/[^\x20\t\r\n\f]+/g;function V(t){return t}function B(t){throw t}function O(t,e,i,n){var o;try{t&&p(o=t.promise)?o.call(t).done(e).fail(i):t&&p(o=t.then)?o.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}w.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return w.each(t.match(F)||[],(function(t,i){e[i]=!0})),e}(t):w.extend({},t);var e,i,n,o,s=[],a=[],r=-1,l=function(){for(o=o||t.once,n=e=!0;a.length;r=-1)for(i=a.shift();++r<s.length;)!1===s[r].apply(i[0],i[1])&&t.stopOnFalse&&(r=s.length,i=!1);t.memory||(i=!1),e=!1,o&&(s=i?[]:"")},c={add:function(){return s&&(i&&!e&&(r=s.length-1,a.push(i)),function e(i){w.each(i,(function(i,n){p(n)?t.unique&&c.has(n)||s.push(n):n&&n.length&&"string"!==C(n)&&e(n)}))}(arguments),i&&!e&&l()),this},remove:function(){return w.each(arguments,(function(t,e){for(var i;(i=w.inArray(e,s,i))>-1;)s.splice(i,1),i<=r&&r--})),this},has:function(t){return t?w.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return o=a=[],s=i="",this},disabled:function(){return!s},lock:function(){return o=a=[],i||e||(s=i=""),this},locked:function(){return!!o},fireWith:function(t,i){return o||(i=[t,(i=i||[]).slice?i.slice():i],a.push(i),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},w.extend({Deferred:function(e){var i=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return o.then(null,t)},pipe:function(){var t=arguments;return w.Deferred((function(e){w.each(i,(function(i,n){var o=p(t[n[4]])&&t[n[4]];s[n[1]]((function(){var t=o&&o.apply(this,arguments);t&&p(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[n[0]+"With"](this,o?[t]:arguments)}))})),t=null})).promise()},then:function(e,n,o){var s=0;function a(e,i,n,o){return function(){var r=this,l=arguments,c=function(){var t,c;if(!(e<s)){if((t=n.apply(r,l))===i.promise())throw new TypeError("Thenable self-resolution");c=t&&("object"==typeof t||"function"==typeof t)&&t.then,p(c)?o?c.call(t,a(s,i,V,o),a(s,i,B,o)):(s++,c.call(t,a(s,i,V,o),a(s,i,B,o),a(s,i,V,i.notifyWith))):(n!==V&&(r=void 0,l=[t]),(o||i.resolveWith)(r,l))}},d=o?c:function(){try{c()}catch(t){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(t,d.stackTrace),e+1>=s&&(n!==B&&(r=void 0,l=[t]),i.rejectWith(r,l))}};e?d():(w.Deferred.getStackHook&&(d.stackTrace=w.Deferred.getStackHook()),t.setTimeout(d))}}return w.Deferred((function(t){i[0][3].add(a(0,t,p(o)?o:V,t.notifyWith)),i[1][3].add(a(0,t,p(e)?e:V)),i[2][3].add(a(0,t,p(n)?n:B))})).promise()},promise:function(t){return null!=t?w.extend(t,o):o}},s={};return w.each(i,(function(t,e){var a=e[2],r=e[5];o[e[1]]=a.add,r&&a.add((function(){n=r}),i[3-t][2].disable,i[3-t][3].disable,i[0][2].lock,i[0][3].lock),a.add(e[3].fire),s[e[0]]=function(){return s[e[0]+"With"](this===s?void 0:this,arguments),this},s[e[0]+"With"]=a.fireWith})),o.promise(s),e&&e.call(s,s),s},when:function(t){var e=arguments.length,i=e,n=Array(i),s=o.call(arguments),a=w.Deferred(),r=function(t){return function(i){n[t]=this,s[t]=arguments.length>1?o.call(arguments):i,--e||a.resolveWith(n,s)}};if(e<=1&&(O(t,a.done(r(i)).resolve,a.reject,!e),"pending"===a.state()||p(s[i]&&s[i].then)))return a.then();for(;i--;)O(s[i],r(i),a.reject);return a.promise()}});var R=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(e,i){t.console&&t.console.warn&&e&&R.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,i)},w.readyException=function(e){t.setTimeout((function(){throw e}))};var $=w.Deferred();function H(){g.removeEventListener("DOMContentLoaded",H),t.removeEventListener("load",H),w.ready()}w.fn.ready=function(t){return $.then(t).catch((function(t){w.readyException(t)})),this},w.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==t&&--w.readyWait>0||$.resolveWith(g,[w]))}}),w.ready.then=$.then,"complete"===g.readyState||"loading"!==g.readyState&&!g.documentElement.doScroll?t.setTimeout(w.ready):(g.addEventListener("DOMContentLoaded",H),t.addEventListener("load",H));var N=function(t,e,i,n,o,s,a){var r=0,l=t.length,c=null==i;if("object"===C(i))for(r in o=!0,i)N(t,e,r,i[r],!0,s,a);else if(void 0!==n&&(o=!0,p(n)||(a=!0),c&&(a?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(w(t),i)})),e))for(;r<l;r++)e(t[r],i,a?n:n.call(t[r],r,e(t[r],i)));return o?t:c?e.call(t):l?e(t[0],i):s},z=/^-ms-/,W=/-([a-z])/g;function j(t,e){return e.toUpperCase()}function K(t){return t.replace(z,"ms-").replace(W,j)}var q=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function G(){this.expando=w.expando+G.uid++}G.uid=1,G.prototype={cache:function(t){var e=t[this.expando];return e||(e={},q(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,o=this.cache(t);if("string"==typeof e)o[K(e)]=i;else for(n in e)o[K(n)]=e[n];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][K(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(K):(e=K(e))in n?[e]:e.match(F)||[]).length;for(;i--;)delete n[e[i]]}(void 0===e||w.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!w.isEmptyObject(e)}};var Y=new G,X=new G,Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,J=/[A-Z]/g;function Q(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(J,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Z.test(t)?JSON.parse(t):t)}(i)}catch(t){}X.set(t,e,i)}else i=void 0;return i}w.extend({hasData:function(t){return X.hasData(t)||Y.hasData(t)},data:function(t,e,i){return X.access(t,e,i)},removeData:function(t,e){X.remove(t,e)},_data:function(t,e,i){return Y.access(t,e,i)},_removeData:function(t,e){Y.remove(t,e)}}),w.fn.extend({data:function(t,e){var i,n,o,s=this[0],a=s&&s.attributes;if(void 0===t){if(this.length&&(o=X.get(s),1===s.nodeType&&!Y.get(s,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&0===(n=a[i].name).indexOf("data-")&&(n=K(n.slice(5)),Q(s,n,o[n]));Y.set(s,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each((function(){X.set(this,t)})):N(this,(function(e){var i;if(s&&void 0===e)return void 0!==(i=X.get(s,t))||void 0!==(i=Q(s,t))?i:void 0;this.each((function(){X.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){X.remove(this,t)}))}}),w.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=Y.get(t,e),i&&(!n||Array.isArray(i)?n=Y.access(t,e,w.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=w.queue(t,e),n=i.length,o=i.shift(),s=w._queueHooks(t,e);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===e&&i.unshift("inprogress"),delete s.stop,o.call(t,(function(){w.dequeue(t,e)}),s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return Y.get(t,i)||Y.access(t,i,{empty:w.Callbacks("once memory").add((function(){Y.remove(t,[e+"queue",i])}))})}}),w.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?w.queue(this[0],t):void 0===e?this:this.each((function(){var i=w.queue(this,t,e);w._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&w.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){w.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,o=w.Deferred(),s=this,a=this.length,r=function(){--n||o.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(i=Y.get(s[a],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(r));return r(),o.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),it=["Top","Right","Bottom","Left"],nt=g.documentElement,ot=function(t){return w.contains(t.ownerDocument,t)},st={composed:!0};nt.getRootNode&&(ot=function(t){return w.contains(t.ownerDocument,t)||t.getRootNode(st)===t.ownerDocument});var at=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&ot(t)&&"none"===w.css(t,"display")};function rt(t,e,i,n){var o,s,a=20,r=n?function(){return n.cur()}:function(){return w.css(t,e,"")},l=r(),c=i&&i[3]||(w.cssNumber[e]?"":"px"),d=t.nodeType&&(w.cssNumber[e]||"px"!==c&&+l)&&et.exec(w.css(t,e));if(d&&d[3]!==c){for(l/=2,c=c||d[3],d=+l||1;a--;)w.style(t,e,d+c),(1-s)*(1-(s=r()/l||.5))<=0&&(a=0),d/=s;d*=2,w.style(t,e,d+c),i=i||[]}return i&&(d=+d||+l||0,o=i[1]?d+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=d,n.end=o)),o}var lt={};function ct(t){var e,i=t.ownerDocument,n=t.nodeName,o=lt[n];return o||(e=i.body.appendChild(i.createElement(n)),o=w.css(e,"display"),e.parentNode.removeChild(e),"none"===o&&(o="block"),lt[n]=o,o)}function dt(t,e){for(var i,n,o=[],s=0,a=t.length;s<a;s++)(n=t[s]).style&&(i=n.style.display,e?("none"===i&&(o[s]=Y.get(n,"display")||null,o[s]||(n.style.display="")),""===n.style.display&&at(n)&&(o[s]=ct(n))):"none"!==i&&(o[s]="none",Y.set(n,"display",i)));for(s=0;s<a;s++)null!=o[s]&&(t[s].style.display=o[s]);return t}w.fn.extend({show:function(){return dt(this,!0)},hide:function(){return dt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){at(this)?w(this).show():w(this).hide()}))}});var ht,mt,ut=/^(?:checkbox|radio)$/i,pt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ft=/^$|^module$|\/(?:java|ecma)script/i;ht=g.createDocumentFragment().appendChild(g.createElement("div")),(mt=g.createElement("input")).setAttribute("type","radio"),mt.setAttribute("checked","checked"),mt.setAttribute("name","t"),ht.appendChild(mt),u.checkClone=ht.cloneNode(!0).cloneNode(!0).lastChild.checked,ht.innerHTML="<textarea>x</textarea>",u.noCloneChecked=!!ht.cloneNode(!0).lastChild.defaultValue,ht.innerHTML="<option></option>",u.option=!!ht.lastChild;var gt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function bt(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&A(t,e)?w.merge([t],i):i}function vt(t,e){for(var i=0,n=t.length;i<n;i++)Y.set(t[i],"globalEval",!e||Y.get(e[i],"globalEval"))}gt.tbody=gt.tfoot=gt.colgroup=gt.caption=gt.thead,gt.th=gt.td,u.option||(gt.optgroup=gt.option=[1,"<select multiple='multiple'>","</select>"]);var Ct=/<|&#?\w+;/;function yt(t,e,i,n,o){for(var s,a,r,l,c,d,h=e.createDocumentFragment(),m=[],u=0,p=t.length;u<p;u++)if((s=t[u])||0===s)if("object"===C(s))w.merge(m,s.nodeType?[s]:s);else if(Ct.test(s)){for(a=a||h.appendChild(e.createElement("div")),r=(pt.exec(s)||["",""])[1].toLowerCase(),l=gt[r]||gt._default,a.innerHTML=l[1]+w.htmlPrefilter(s)+l[2],d=l[0];d--;)a=a.lastChild;w.merge(m,a.childNodes),(a=h.firstChild).textContent=""}else m.push(e.createTextNode(s));for(h.textContent="",u=0;s=m[u++];)if(n&&w.inArray(s,n)>-1)o&&o.push(s);else if(c=ot(s),a=bt(h.appendChild(s),"script"),c&&vt(a),i)for(d=0;s=a[d++];)ft.test(s.type||"")&&i.push(s);return h}var wt=/^key/,xt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_t=/^([^.]*)(?:\.(.+)|)/;function St(){return!0}function kt(){return!1}function Tt(t,e){return t===function(){try{return g.activeElement}catch(t){}}()==("focus"===e)}function At(t,e,i,n,o,s){var a,r;if("object"==typeof e){for(r in"string"!=typeof i&&(n=n||i,i=void 0),e)At(t,r,i,n,e[r],s);return t}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=kt;else if(!o)return t;return 1===s&&(a=o,o=function(t){return w().off(t),a.apply(this,arguments)},o.guid=a.guid||(a.guid=w.guid++)),t.each((function(){w.event.add(this,e,o,n,i)}))}function It(t,e,i){i?(Y.set(t,e,!1),w.event.add(t,e,{namespace:!1,handler:function(t){var n,s,a=Y.get(this,e);if(1&t.isTrigger&&this[e]){if(a.length)(w.event.special[e]||{}).delegateType&&t.stopPropagation();else if(a=o.call(arguments),Y.set(this,e,a),n=i(this,e),this[e](),a!==(s=Y.get(this,e))||n?Y.set(this,e,!1):s={},a!==s)return t.stopImmediatePropagation(),t.preventDefault(),s.value}else a.length&&(Y.set(this,e,{value:w.event.trigger(w.extend(a[0],w.Event.prototype),a.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Y.get(t,e)&&w.event.add(t,e,St)}w.event={global:{},add:function(t,e,i,n,o){var s,a,r,l,c,d,h,m,u,p,f,g=Y.get(t);if(q(t))for(i.handler&&(i=(s=i).handler,o=s.selector),o&&w.find.matchesSelector(nt,o),i.guid||(i.guid=w.guid++),(l=g.events)||(l=g.events=Object.create(null)),(a=g.handle)||(a=g.handle=function(e){return void 0!==w&&w.event.triggered!==e.type?w.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(F)||[""]).length;c--;)u=f=(r=_t.exec(e[c])||[])[1],p=(r[2]||"").split(".").sort(),u&&(h=w.event.special[u]||{},u=(o?h.delegateType:h.bindType)||u,h=w.event.special[u]||{},d=w.extend({type:u,origType:f,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&w.expr.match.needsContext.test(o),namespace:p.join(".")},s),(m=l[u])||((m=l[u]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,n,p,a)||t.addEventListener&&t.addEventListener(u,a)),h.add&&(h.add.call(t,d),d.handler.guid||(d.handler.guid=i.guid)),o?m.splice(m.delegateCount++,0,d):m.push(d),w.event.global[u]=!0)},remove:function(t,e,i,n,o){var s,a,r,l,c,d,h,m,u,p,f,g=Y.hasData(t)&&Y.get(t);if(g&&(l=g.events)){for(c=(e=(e||"").match(F)||[""]).length;c--;)if(u=f=(r=_t.exec(e[c])||[])[1],p=(r[2]||"").split(".").sort(),u){for(h=w.event.special[u]||{},m=l[u=(n?h.delegateType:h.bindType)||u]||[],r=r[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=m.length;s--;)d=m[s],!o&&f!==d.origType||i&&i.guid!==d.guid||r&&!r.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(m.splice(s,1),d.selector&&m.delegateCount--,h.remove&&h.remove.call(t,d));a&&!m.length&&(h.teardown&&!1!==h.teardown.call(t,p,g.handle)||w.removeEvent(t,u,g.handle),delete l[u])}else for(u in l)w.event.remove(t,u+e[c],i,n,!0);w.isEmptyObject(l)&&Y.remove(t,"handle events")}},dispatch:function(t){var e,i,n,o,s,a,r=new Array(arguments.length),l=w.event.fix(t),c=(Y.get(this,"events")||Object.create(null))[l.type]||[],d=w.event.special[l.type]||{};for(r[0]=l,e=1;e<arguments.length;e++)r[e]=arguments[e];if(l.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,l)){for(a=w.event.handlers.call(this,l,c),e=0;(o=a[e++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,i=0;(s=o.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==s.namespace&&!l.rnamespace.test(s.namespace)||(l.handleObj=s,l.data=s.data,void 0!==(n=((w.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,r))&&!1===(l.result=n)&&(l.preventDefault(),l.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,l),l.result}},handlers:function(t,e){var i,n,o,s,a,r=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(s=[],a={},i=0;i<l;i++)void 0===a[o=(n=e[i]).selector+" "]&&(a[o]=n.needsContext?w(o,this).index(c)>-1:w.find(o,this,null,[c]).length),a[o]&&s.push(n);s.length&&r.push({elem:c,handlers:s})}return c=this,l<e.length&&r.push({elem:c,handlers:e.slice(l)}),r},addProp:function(t,e){Object.defineProperty(w.Event.prototype,t,{enumerable:!0,configurable:!0,get:p(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[w.expando]?t:new w.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return ut.test(e.type)&&e.click&&A(e,"input")&&It(e,"click",St),!1},trigger:function(t){var e=this||t;return ut.test(e.type)&&e.click&&A(e,"input")&&It(e,"click"),!0},_default:function(t){var e=t.target;return ut.test(e.type)&&e.click&&A(e,"input")&&Y.get(e,"click")||A(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},w.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},w.Event=function(t,e){if(!(this instanceof w.Event))return new w.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?St:kt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&w.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:kt,isPropagationStopped:kt,isImmediatePropagationStopped:kt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=St,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=St,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=St,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&wt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&xt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},(function(t,e){w.event.special[t]={setup:function(){return It(this,t,Tt),!1},trigger:function(){return It(this,t),!0},delegateType:e}})),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){w.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,o=t.handleObj;return n&&(n===this||w.contains(this,n))||(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}})),w.fn.extend({on:function(t,e,i,n){return At(this,t,e,i,n)},one:function(t,e,i,n){return At(this,t,e,i,n,1)},off:function(t,e,i){var n,o;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,w(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=kt),this.each((function(){w.event.remove(this,t,i,e)}))}});var Pt=/<script|<style|<link/i,Et=/checked\s*(?:[^=]|=\s*.checked.)/i,Dt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ut(t,e){return A(t,"table")&&A(11!==e.nodeType?e:e.firstChild,"tr")&&w(t).children("tbody")[0]||t}function Mt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Lt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ft(t,e){var i,n,o,s,a,r;if(1===e.nodeType){if(Y.hasData(t)&&(r=Y.get(t).events))for(o in Y.remove(e,"handle events"),r)for(i=0,n=r[o].length;i<n;i++)w.event.add(e,o,r[o][i]);X.hasData(t)&&(s=X.access(t),a=w.extend({},s),X.set(e,a))}}function Vt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&ut.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function Bt(t,e,i,n){e=s(e);var o,a,r,l,c,d,h=0,m=t.length,f=m-1,g=e[0],b=p(g);if(b||m>1&&"string"==typeof g&&!u.checkClone&&Et.test(g))return t.each((function(o){var s=t.eq(o);b&&(e[0]=g.call(this,o,s.html())),Bt(s,e,i,n)}));if(m&&(a=(o=yt(e,t[0].ownerDocument,!1,t,n)).firstChild,1===o.childNodes.length&&(o=a),a||n)){for(l=(r=w.map(bt(o,"script"),Mt)).length;h<m;h++)c=o,h!==f&&(c=w.clone(c,!0,!0),l&&w.merge(r,bt(c,"script"))),i.call(t[h],c,h);if(l)for(d=r[r.length-1].ownerDocument,w.map(r,Lt),h=0;h<l;h++)c=r[h],ft.test(c.type||"")&&!Y.access(c,"globalEval")&&w.contains(d,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?w._evalUrl&&!c.noModule&&w._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},d):v(c.textContent.replace(Dt,""),c,d))}return t}function Ot(t,e,i){for(var n,o=e?w.filter(e,t):t,s=0;null!=(n=o[s]);s++)i||1!==n.nodeType||w.cleanData(bt(n)),n.parentNode&&(i&&ot(n)&&vt(bt(n,"script")),n.parentNode.removeChild(n));return t}w.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var n,o,s,a,r=t.cloneNode(!0),l=ot(t);if(!(u.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||w.isXMLDoc(t)))for(a=bt(r),n=0,o=(s=bt(t)).length;n<o;n++)Vt(s[n],a[n]);if(e)if(i)for(s=s||bt(t),a=a||bt(r),n=0,o=s.length;n<o;n++)Ft(s[n],a[n]);else Ft(t,r);return(a=bt(r,"script")).length>0&&vt(a,!l&&bt(t,"script")),r},cleanData:function(t){for(var e,i,n,o=w.event.special,s=0;void 0!==(i=t[s]);s++)if(q(i)){if(e=i[Y.expando]){if(e.events)for(n in e.events)o[n]?w.event.remove(i,n):w.removeEvent(i,n,e.handle);i[Y.expando]=void 0}i[X.expando]&&(i[X.expando]=void 0)}}}),w.fn.extend({detach:function(t){return Ot(this,t,!0)},remove:function(t){return Ot(this,t)},text:function(t){return N(this,(function(t){return void 0===t?w.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Bt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ut(this,t).appendChild(t)}))},prepend:function(){return Bt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Ut(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Bt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Bt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(w.cleanData(bt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return w.clone(this,t,e)}))},html:function(t){return N(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Pt.test(t)&&!gt[(pt.exec(t)||["",""])[1].toLowerCase()]){t=w.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(w.cleanData(bt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Bt(this,arguments,(function(e){var i=this.parentNode;w.inArray(this,t)<0&&(w.cleanData(bt(this)),i&&i.replaceChild(e,this))}),t)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){w.fn[t]=function(t){for(var i,n=[],o=w(t),s=o.length-1,r=0;r<=s;r++)i=r===s?this:this.clone(!0),w(o[r])[e](i),a.apply(n,i.get());return this.pushStack(n)}}));var Rt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),$t=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)},Ht=function(t,e,i){var n,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];for(o in n=i.call(t),e)t.style[o]=s[o];return n},Nt=new RegExp(it.join("|"),"i");function zt(t,e,i){var n,o,s,a,r=t.style;return(i=i||$t(t))&&(""!==(a=i.getPropertyValue(e)||i[e])||ot(t)||(a=w.style(t,e)),!u.pixelBoxStyles()&&Rt.test(a)&&Nt.test(e)&&(n=r.width,o=r.minWidth,s=r.maxWidth,r.minWidth=r.maxWidth=r.width=a,a=i.width,r.width=n,r.minWidth=o,r.maxWidth=s)),void 0!==a?a+"":a}function Wt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(d){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",d.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",nt.appendChild(c).appendChild(d);var e=t.getComputedStyle(d);n="1%"!==e.top,l=12===i(e.marginLeft),d.style.right="60%",a=36===i(e.right),o=36===i(e.width),d.style.position="absolute",s=12===i(d.offsetWidth/3),nt.removeChild(c),d=null}}function i(t){return Math.round(parseFloat(t))}var n,o,s,a,r,l,c=g.createElement("div"),d=g.createElement("div");d.style&&(d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",u.clearCloneStyle="content-box"===d.style.backgroundClip,w.extend(u,{boxSizingReliable:function(){return e(),o},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,i,n,o;return null==r&&(e=g.createElement("table"),i=g.createElement("tr"),n=g.createElement("div"),e.style.cssText="position:absolute;left:-11111px",i.style.height="1px",n.style.height="9px",nt.appendChild(e).appendChild(i).appendChild(n),o=t.getComputedStyle(i),r=parseInt(o.height)>3,nt.removeChild(e)),r}}))}();var jt=["Webkit","Moz","ms"],Kt=g.createElement("div").style,qt={};function Gt(t){var e=w.cssProps[t]||qt[t];return e||(t in Kt?t:qt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=jt.length;i--;)if((t=jt[i]+e)in Kt)return t}(t)||t)}var Yt=/^(none|table(?!-c[ea]).+)/,Xt=/^--/,Zt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"};function Qt(t,e,i){var n=et.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function te(t,e,i,n,o,s){var a="width"===e?1:0,r=0,l=0;if(i===(n?"border":"content"))return 0;for(;a<4;a+=2)"margin"===i&&(l+=w.css(t,i+it[a],!0,o)),n?("content"===i&&(l-=w.css(t,"padding"+it[a],!0,o)),"margin"!==i&&(l-=w.css(t,"border"+it[a]+"Width",!0,o))):(l+=w.css(t,"padding"+it[a],!0,o),"padding"!==i?l+=w.css(t,"border"+it[a]+"Width",!0,o):r+=w.css(t,"border"+it[a]+"Width",!0,o));return!n&&s>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-l-r-.5))||0),l}function ee(t,e,i){var n=$t(t),o=(!u.boxSizingReliable()||i)&&"border-box"===w.css(t,"boxSizing",!1,n),s=o,a=zt(t,e,n),r="offset"+e[0].toUpperCase()+e.slice(1);if(Rt.test(a)){if(!i)return a;a="auto"}return(!u.boxSizingReliable()&&o||!u.reliableTrDimensions()&&A(t,"tr")||"auto"===a||!parseFloat(a)&&"inline"===w.css(t,"display",!1,n))&&t.getClientRects().length&&(o="border-box"===w.css(t,"boxSizing",!1,n),(s=r in t)&&(a=t[r])),(a=parseFloat(a)||0)+te(t,e,i||(o?"border":"content"),s,n,a)+"px"}function ie(t,e,i,n,o){return new ie.prototype.init(t,e,i,n,o)}w.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=zt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,s,a,r=K(e),l=Xt.test(e),c=t.style;if(l||(e=Gt(r)),a=w.cssHooks[e]||w.cssHooks[r],void 0===i)return a&&"get"in a&&void 0!==(o=a.get(t,!1,n))?o:c[e];"string"===(s=typeof i)&&(o=et.exec(i))&&o[1]&&(i=rt(t,e,o),s="number"),null!=i&&i==i&&("number"!==s||l||(i+=o&&o[3]||(w.cssNumber[r]?"":"px")),u.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(l?c.setProperty(e,i):c[e]=i))}},css:function(t,e,i,n){var o,s,a,r=K(e);return Xt.test(e)||(e=Gt(r)),(a=w.cssHooks[e]||w.cssHooks[r])&&"get"in a&&(o=a.get(t,!0,i)),void 0===o&&(o=zt(t,e,n)),"normal"===o&&e in Jt&&(o=Jt[e]),""===i||i?(s=parseFloat(o),!0===i||isFinite(s)?s||0:o):o}}),w.each(["height","width"],(function(t,e){w.cssHooks[e]={get:function(t,i,n){if(i)return!Yt.test(w.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ee(t,e,n):Ht(t,Zt,(function(){return ee(t,e,n)}))},set:function(t,i,n){var o,s=$t(t),a=!u.scrollboxSize()&&"absolute"===s.position,r=(a||n)&&"border-box"===w.css(t,"boxSizing",!1,s),l=n?te(t,e,n,r,s):0;return r&&a&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-te(t,e,"border",!1,s)-.5)),l&&(o=et.exec(i))&&"px"!==(o[3]||"px")&&(t.style[e]=i,i=w.css(t,e)),Qt(0,i,l)}}})),w.cssHooks.marginLeft=Wt(u.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(zt(t,"marginLeft"))||t.getBoundingClientRect().left-Ht(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),w.each({margin:"",padding:"",border:"Width"},(function(t,e){w.cssHooks[t+e]={expand:function(i){for(var n=0,o={},s="string"==typeof i?i.split(" "):[i];n<4;n++)o[t+it[n]+e]=s[n]||s[n-2]||s[0];return o}},"margin"!==t&&(w.cssHooks[t+e].set=Qt)})),w.fn.extend({css:function(t,e){return N(this,(function(t,e,i){var n,o,s={},a=0;if(Array.isArray(e)){for(n=$t(t),o=e.length;a<o;a++)s[e[a]]=w.css(t,e[a],!1,n);return s}return void 0!==i?w.style(t,e,i):w.css(t,e)}),t,e,arguments.length>1)}}),w.Tween=ie,ie.prototype={constructor:ie,init:function(t,e,i,n,o,s){this.elem=t,this.prop=i,this.easing=o||w.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(w.cssNumber[i]?"":"px")},cur:function(){var t=ie.propHooks[this.prop];return t&&t.get?t.get(this):ie.propHooks._default.get(this)},run:function(t){var e,i=ie.propHooks[this.prop];return this.options.duration?this.pos=e=w.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):ie.propHooks._default.set(this),this}},ie.prototype.init.prototype=ie.prototype,ie.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=w.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){w.fx.step[t.prop]?w.fx.step[t.prop](t):1!==t.elem.nodeType||!w.cssHooks[t.prop]&&null==t.elem.style[Gt(t.prop)]?t.elem[t.prop]=t.now:w.style(t.elem,t.prop,t.now+t.unit)}}},ie.propHooks.scrollTop=ie.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},w.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},w.fx=ie.prototype.init,w.fx.step={};var ne,oe,se=/^(?:toggle|show|hide)$/,ae=/queueHooks$/;function re(){oe&&(!1===g.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(re):t.setTimeout(re,w.fx.interval),w.fx.tick())}function le(){return t.setTimeout((function(){ne=void 0})),ne=Date.now()}function ce(t,e){var i,n=0,o={height:t};for(e=e?1:0;n<4;n+=2-e)o["margin"+(i=it[n])]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function de(t,e,i){for(var n,o=(he.tweeners[e]||[]).concat(he.tweeners["*"]),s=0,a=o.length;s<a;s++)if(n=o[s].call(i,e,t))return n}function he(t,e,i){var n,o,s=0,a=he.prefilters.length,r=w.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var e=ne||le(),i=Math.max(0,c.startTime+c.duration-e),n=1-(i/c.duration||0),s=0,a=c.tweens.length;s<a;s++)c.tweens[s].run(n);return r.notifyWith(t,[c,n,i]),n<1&&a?i:(a||r.notifyWith(t,[c,1,0]),r.resolveWith(t,[c]),!1)},c=r.promise({elem:t,props:w.extend({},e),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},i),originalProperties:e,originalOptions:i,startTime:ne||le(),duration:i.duration,tweens:[],createTween:function(e,i){var n=w.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(o)return this;for(o=!0;i<n;i++)c.tweens[i].run(1);return e?(r.notifyWith(t,[c,1,0]),r.resolveWith(t,[c,e])):r.rejectWith(t,[c,e]),this}}),d=c.props;for(!function(t,e){var i,n,o,s,a;for(i in t)if(o=e[n=K(i)],s=t[i],Array.isArray(s)&&(o=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(a=w.cssHooks[n])&&"expand"in a)for(i in s=a.expand(s),delete t[n],s)i in t||(t[i]=s[i],e[i]=o);else e[n]=o}(d,c.opts.specialEasing);s<a;s++)if(n=he.prefilters[s].call(c,t,d,c.opts))return p(n.stop)&&(w._queueHooks(c.elem,c.opts.queue).stop=n.stop.bind(n)),n;return w.map(d,de,c),p(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),w.fx.timer(w.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}w.Animation=w.extend(he,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return rt(i.elem,t,et.exec(e),i),i}]},tweener:function(t,e){p(t)?(e=t,t=["*"]):t=t.match(F);for(var i,n=0,o=t.length;n<o;n++)i=t[n],he.tweeners[i]=he.tweeners[i]||[],he.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,o,s,a,r,l,c,d,h="width"in e||"height"in e,m=this,u={},p=t.style,f=t.nodeType&&at(t),g=Y.get(t,"fxshow");for(n in i.queue||(null==(a=w._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,r=a.empty.fire,a.empty.fire=function(){a.unqueued||r()}),a.unqueued++,m.always((function(){m.always((function(){a.unqueued--,w.queue(t,"fx").length||a.empty.fire()}))}))),e)if(o=e[n],se.test(o)){if(delete e[n],s=s||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!g||void 0===g[n])continue;f=!0}u[n]=g&&g[n]||w.style(t,n)}if((l=!w.isEmptyObject(e))||!w.isEmptyObject(u))for(n in h&&1===t.nodeType&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=g&&g.display)&&(c=Y.get(t,"display")),"none"===(d=w.css(t,"display"))&&(c?d=c:(dt([t],!0),c=t.style.display||c,d=w.css(t,"display"),dt([t]))),("inline"===d||"inline-block"===d&&null!=c)&&"none"===w.css(t,"float")&&(l||(m.done((function(){p.display=c})),null==c&&(d=p.display,c="none"===d?"":d)),p.display="inline-block")),i.overflow&&(p.overflow="hidden",m.always((function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}))),l=!1,u)l||(g?"hidden"in g&&(f=g.hidden):g=Y.access(t,"fxshow",{display:c}),s&&(g.hidden=!f),f&&dt([t],!0),m.done((function(){for(n in f||dt([t]),Y.remove(t,"fxshow"),u)w.style(t,n,u[n])}))),l=de(f?g[n]:0,n,m),n in g||(g[n]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?he.prefilters.unshift(t):he.prefilters.push(t)}}),w.speed=function(t,e,i){var n=t&&"object"==typeof t?w.extend({},t):{complete:i||!i&&e||p(t)&&t,duration:t,easing:i&&e||e&&!p(e)&&e};return w.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in w.fx.speeds?n.duration=w.fx.speeds[n.duration]:n.duration=w.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){p(n.old)&&n.old.call(this),n.queue&&w.dequeue(this,n.queue)},n},w.fn.extend({fadeTo:function(t,e,i,n){return this.filter(at).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var o=w.isEmptyObject(t),s=w.speed(e,i,n),a=function(){var e=he(this,w.extend({},t),s);(o||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,o||!1===s.queue?this.each(a):this.queue(s.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,o=null!=t&&t+"queueHooks",s=w.timers,a=Y.get(this);if(o)a[o]&&a[o].stop&&n(a[o]);else for(o in a)a[o]&&a[o].stop&&ae.test(o)&&n(a[o]);for(o=s.length;o--;)s[o].elem!==this||null!=t&&s[o].queue!==t||(s[o].anim.stop(i),e=!1,s.splice(o,1));!e&&i||w.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=Y.get(this),n=i[t+"queue"],o=i[t+"queueHooks"],s=w.timers,a=n?n.length:0;for(i.finish=!0,w.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;e<a;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),w.each(["toggle","show","hide"],(function(t,e){var i=w.fn[e];w.fn[e]=function(t,n,o){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(ce(e,!0),t,n,o)}})),w.each({slideDown:ce("show"),slideUp:ce("hide"),slideToggle:ce("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){w.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),w.timers=[],w.fx.tick=function(){var t,e=0,i=w.timers;for(ne=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||w.fx.stop(),ne=void 0},w.fx.timer=function(t){w.timers.push(t),w.fx.start()},w.fx.interval=13,w.fx.start=function(){oe||(oe=!0,re())},w.fx.stop=function(){oe=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(e,i){return e=w.fx&&w.fx.speeds[e]||e,i=i||"fx",this.queue(i,(function(i,n){var o=t.setTimeout(i,e);n.stop=function(){t.clearTimeout(o)}}))},function(){var t=g.createElement("input"),e=g.createElement("select").appendChild(g.createElement("option"));t.type="checkbox",u.checkOn=""!==t.value,u.optSelected=e.selected,(t=g.createElement("input")).value="t",t.type="radio",u.radioValue="t"===t.value}();var me,ue=w.expr.attrHandle;w.fn.extend({attr:function(t,e){return N(this,w.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){w.removeAttr(this,t)}))}}),w.extend({attr:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?w.prop(t,e,i):(1===s&&w.isXMLDoc(t)||(o=w.attrHooks[e.toLowerCase()]||(w.expr.match.bool.test(e)?me:void 0)),void 0!==i?null===i?void w.removeAttr(t,e):o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:(t.setAttribute(e,i+""),i):o&&"get"in o&&null!==(n=o.get(t,e))?n:null==(n=w.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!u.radioValue&&"radio"===e&&A(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,o=e&&e.match(F);if(o&&1===t.nodeType)for(;i=o[n++];)t.removeAttribute(i)}}),me={set:function(t,e,i){return!1===e?w.removeAttr(t,i):t.setAttribute(i,i),i}},w.each(w.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=ue[e]||w.find.attr;ue[e]=function(t,e,n){var o,s,a=e.toLowerCase();return n||(s=ue[a],ue[a]=o,o=null!=i(t,e,n)?a:null,ue[a]=s),o}}));var pe=/^(?:input|select|textarea|button)$/i,fe=/^(?:a|area)$/i;function ge(t){return(t.match(F)||[]).join(" ")}function be(t){return t.getAttribute&&t.getAttribute("class")||""}function ve(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(F)||[]}w.fn.extend({prop:function(t,e){return N(this,w.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[w.propFix[t]||t]}))}}),w.extend({prop:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&w.isXMLDoc(t)||(e=w.propFix[e]||e,o=w.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=w.find.attr(t,"tabindex");return e?parseInt(e,10):pe.test(t.nodeName)||fe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),u.optSelected||(w.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){w.propFix[this.toLowerCase()]=this})),w.fn.extend({addClass:function(t){var e,i,n,o,s,a,r,l=0;if(p(t))return this.each((function(e){w(this).addClass(t.call(this,e,be(this)))}));if((e=ve(t)).length)for(;i=this[l++];)if(o=be(i),n=1===i.nodeType&&" "+ge(o)+" "){for(a=0;s=e[a++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");o!==(r=ge(n))&&i.setAttribute("class",r)}return this},removeClass:function(t){var e,i,n,o,s,a,r,l=0;if(p(t))return this.each((function(e){w(this).removeClass(t.call(this,e,be(this)))}));if(!arguments.length)return this.attr("class","");if((e=ve(t)).length)for(;i=this[l++];)if(o=be(i),n=1===i.nodeType&&" "+ge(o)+" "){for(a=0;s=e[a++];)for(;n.indexOf(" "+s+" ")>-1;)n=n.replace(" "+s+" "," ");o!==(r=ge(n))&&i.setAttribute("class",r)}return this},toggleClass:function(t,e){var i=typeof t,n="string"===i||Array.isArray(t);return"boolean"==typeof e&&n?e?this.addClass(t):this.removeClass(t):p(t)?this.each((function(i){w(this).toggleClass(t.call(this,i,be(this),e),e)})):this.each((function(){var e,o,s,a;if(n)for(o=0,s=w(this),a=ve(t);e=a[o++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else void 0!==t&&"boolean"!==i||((e=be(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Y.get(this,"__className__")||""))}))},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+ge(be(i))+" ").indexOf(e)>-1)return!0;return!1}});var Ce=/\r/g;w.fn.extend({val:function(t){var e,i,n,o=this[0];return arguments.length?(n=p(t),this.each((function(i){var o;1===this.nodeType&&(null==(o=n?t.call(this,i,w(this).val()):t)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=w.map(o,(function(t){return null==t?"":t+""}))),(e=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))}))):o?(e=w.valHooks[o.type]||w.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(o,"value"))?i:"string"==typeof(i=o.value)?i.replace(Ce,""):null==i?"":i:void 0}}),w.extend({valHooks:{option:{get:function(t){var e=w.find.attr(t,"value");return null!=e?e:ge(w.text(t))}},select:{get:function(t){var e,i,n,o=t.options,s=t.selectedIndex,a="select-one"===t.type,r=a?null:[],l=a?s+1:o.length;for(n=s<0?l:a?s:0;n<l;n++)if(((i=o[n]).selected||n===s)&&!i.disabled&&(!i.parentNode.disabled||!A(i.parentNode,"optgroup"))){if(e=w(i).val(),a)return e;r.push(e)}return r},set:function(t,e){for(var i,n,o=t.options,s=w.makeArray(e),a=o.length;a--;)((n=o[a]).selected=w.inArray(w.valHooks.option.get(n),s)>-1)&&(i=!0);return i||(t.selectedIndex=-1),s}}}}),w.each(["radio","checkbox"],(function(){w.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=w.inArray(w(t).val(),e)>-1}},u.checkOn||(w.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),u.focusin="onfocusin"in t;var ye=/^(?:focusinfocus|focusoutblur)$/,we=function(t){t.stopPropagation()};w.extend(w.event,{trigger:function(e,i,n,o){var s,a,r,l,c,h,m,u,b=[n||g],v=d.call(e,"type")?e.type:e,C=d.call(e,"namespace")?e.namespace.split("."):[];if(a=u=r=n=n||g,3!==n.nodeType&&8!==n.nodeType&&!ye.test(v+w.event.triggered)&&(v.indexOf(".")>-1&&(C=v.split("."),v=C.shift(),C.sort()),c=v.indexOf(":")<0&&"on"+v,(e=e[w.expando]?e:new w.Event(v,"object"==typeof e&&e)).isTrigger=o?2:3,e.namespace=C.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+C.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:w.makeArray(i,[e]),m=w.event.special[v]||{},o||!m.trigger||!1!==m.trigger.apply(n,i))){if(!o&&!m.noBubble&&!f(n)){for(l=m.delegateType||v,ye.test(l+v)||(a=a.parentNode);a;a=a.parentNode)b.push(a),r=a;r===(n.ownerDocument||g)&&b.push(r.defaultView||r.parentWindow||t)}for(s=0;(a=b[s++])&&!e.isPropagationStopped();)u=a,e.type=s>1?l:m.bindType||v,(h=(Y.get(a,"events")||Object.create(null))[e.type]&&Y.get(a,"handle"))&&h.apply(a,i),(h=c&&a[c])&&h.apply&&q(a)&&(e.result=h.apply(a,i),!1===e.result&&e.preventDefault());return e.type=v,o||e.isDefaultPrevented()||m._default&&!1!==m._default.apply(b.pop(),i)||!q(n)||c&&p(n[v])&&!f(n)&&((r=n[c])&&(n[c]=null),w.event.triggered=v,e.isPropagationStopped()&&u.addEventListener(v,we),n[v](),e.isPropagationStopped()&&u.removeEventListener(v,we),w.event.triggered=void 0,r&&(n[c]=r)),e.result}},simulate:function(t,e,i){var n=w.extend(new w.Event,i,{type:t,isSimulated:!0});w.event.trigger(n,null,e)}}),w.fn.extend({trigger:function(t,e){return this.each((function(){w.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];if(i)return w.event.trigger(t,e,i,!0)}}),u.focusin||w.each({focus:"focusin",blur:"focusout"},(function(t,e){var i=function(t){w.event.simulate(e,t.target,w.event.fix(t))};w.event.special[e]={setup:function(){var n=this.ownerDocument||this.document||this,o=Y.access(n,e);o||n.addEventListener(t,i,!0),Y.access(n,e,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,o=Y.access(n,e)-1;o?Y.access(n,e,o):(n.removeEventListener(t,i,!0),Y.remove(n,e))}}}));var xe=t.location,_e={guid:Date.now()},Se=/\?/;w.parseXML=function(e){var i;if(!e||"string"!=typeof e)return null;try{i=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+e),i};var ke=/\[\]$/,Te=/\r?\n/g,Ae=/^(?:submit|button|image|reset|file)$/i,Ie=/^(?:input|select|textarea|keygen)/i;function Pe(t,e,i,n){var o;if(Array.isArray(e))w.each(e,(function(e,o){i||ke.test(t)?n(t,o):Pe(t+"["+("object"==typeof o&&null!=o?e:"")+"]",o,i,n)}));else if(i||"object"!==C(e))n(t,e);else for(o in e)Pe(t+"["+o+"]",e[o],i,n)}w.param=function(t,e){var i,n=[],o=function(t,e){var i=p(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!w.isPlainObject(t))w.each(t,(function(){o(this.name,this.value)}));else for(i in t)Pe(i,t[i],e,o);return n.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=w.prop(this,"elements");return t?w.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!w(this).is(":disabled")&&Ie.test(this.nodeName)&&!Ae.test(t)&&(this.checked||!ut.test(t))})).map((function(t,e){var i=w(this).val();return null==i?null:Array.isArray(i)?w.map(i,(function(t){return{name:e.name,value:t.replace(Te,"\r\n")}})):{name:e.name,value:i.replace(Te,"\r\n")}})).get()}});var Ee=/%20/g,De=/#.*$/,Ue=/([?&])_=[^&]*/,Me=/^(.*?):[ \t]*([^\r\n]*)$/gm,Le=/^(?:GET|HEAD)$/,Fe=/^\/\//,Ve={},Be={},Oe="*/".concat("*"),Re=g.createElement("a");function $e(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,o=0,s=e.toLowerCase().match(F)||[];if(p(i))for(;n=s[o++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function He(t,e,i,n){var o={},s=t===Be;function a(r){var l;return o[r]=!0,w.each(t[r]||[],(function(t,r){var c=r(e,i,n);return"string"!=typeof c||s||o[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),a(c),!1)})),l}return a(e.dataTypes[0])||!o["*"]&&a("*")}function Ne(t,e){var i,n,o=w.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);return n&&w.extend(!0,t,n),t}Re.href=xe.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xe.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(xe.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Oe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ne(Ne(t,w.ajaxSettings),e):Ne(w.ajaxSettings,t)},ajaxPrefilter:$e(Ve),ajaxTransport:$e(Be),ajax:function(e,i){"object"==typeof e&&(i=e,e=void 0),i=i||{};var n,o,s,a,r,l,c,d,h,m,u=w.ajaxSetup({},i),p=u.context||u,f=u.context&&(p.nodeType||p.jquery)?w(p):w.event,b=w.Deferred(),v=w.Callbacks("once memory"),C=u.statusCode||{},y={},x={},_="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(c){if(!a)for(a={};e=Me.exec(s);)a[e[1].toLowerCase()+" "]=(a[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=a[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(t,e){return null==c&&(t=x[t.toLowerCase()]=x[t.toLowerCase()]||t,y[t]=e),this},overrideMimeType:function(t){return null==c&&(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)S.always(t[S.status]);else for(e in t)C[e]=[C[e],t[e]];return this},abort:function(t){var e=t||_;return n&&n.abort(e),k(0,e),this}};if(b.promise(S),u.url=((e||u.url||xe.href)+"").replace(Fe,xe.protocol+"//"),u.type=i.method||i.type||u.method||u.type,u.dataTypes=(u.dataType||"*").toLowerCase().match(F)||[""],null==u.crossDomain){l=g.createElement("a");try{l.href=u.url,l.href=l.href,u.crossDomain=Re.protocol+"//"+Re.host!=l.protocol+"//"+l.host}catch(t){u.crossDomain=!0}}if(u.data&&u.processData&&"string"!=typeof u.data&&(u.data=w.param(u.data,u.traditional)),He(Ve,u,i,S),c)return S;for(h in(d=w.event&&u.global)&&0==w.active++&&w.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!Le.test(u.type),o=u.url.replace(De,""),u.hasContent?u.data&&u.processData&&0===(u.contentType||"").indexOf("application/x-www-form-urlencoded")&&(u.data=u.data.replace(Ee,"+")):(m=u.url.slice(o.length),u.data&&(u.processData||"string"==typeof u.data)&&(o+=(Se.test(o)?"&":"?")+u.data,delete u.data),!1===u.cache&&(o=o.replace(Ue,"$1"),m=(Se.test(o)?"&":"?")+"_="+_e.guid+++m),u.url=o+m),u.ifModified&&(w.lastModified[o]&&S.setRequestHeader("If-Modified-Since",w.lastModified[o]),w.etag[o]&&S.setRequestHeader("If-None-Match",w.etag[o])),(u.data&&u.hasContent&&!1!==u.contentType||i.contentType)&&S.setRequestHeader("Content-Type",u.contentType),S.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Oe+"; q=0.01":""):u.accepts["*"]),u.headers)S.setRequestHeader(h,u.headers[h]);if(u.beforeSend&&(!1===u.beforeSend.call(p,S,u)||c))return S.abort();if(_="abort",v.add(u.complete),S.done(u.success),S.fail(u.error),n=He(Be,u,i,S)){if(S.readyState=1,d&&f.trigger("ajaxSend",[S,u]),c)return S;u.async&&u.timeout>0&&(r=t.setTimeout((function(){S.abort("timeout")}),u.timeout));try{c=!1,n.send(y,k)}catch(t){if(c)throw t;k(-1,t)}}else k(-1,"No Transport");function k(e,i,a,l){var h,m,g,y,x,_=i;c||(c=!0,r&&t.clearTimeout(r),n=void 0,s=l||"",S.readyState=e>0?4:0,h=e>=200&&e<300||304===e,a&&(y=function(t,e,i){for(var n,o,s,a,r=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(o in r)if(r[o]&&r[o].test(n)){l.unshift(o);break}if(l[0]in i)s=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){s=o;break}a||(a=o)}s=s||a}if(s)return s!==l[0]&&l.unshift(s),i[s]}(u,S,a)),!h&&w.inArray("script",u.dataTypes)>-1&&(u.converters["text script"]=function(){}),y=function(t,e,i,n){var o,s,a,r,l,c={},d=t.dataTypes.slice();if(d[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(s=d.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=d.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(a=c[l+" "+s]||c["* "+s]))for(o in c)if((r=o.split(" "))[1]===s&&(a=c[l+" "+r[0]]||c["* "+r[0]])){!0===a?a=c[o]:!0!==c[o]&&(s=r[0],d.unshift(r[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}(u,y,S,h),h?(u.ifModified&&((x=S.getResponseHeader("Last-Modified"))&&(w.lastModified[o]=x),(x=S.getResponseHeader("etag"))&&(w.etag[o]=x)),204===e||"HEAD"===u.type?_="nocontent":304===e?_="notmodified":(_=y.state,m=y.data,h=!(g=y.error))):(g=_,!e&&_||(_="error",e<0&&(e=0))),S.status=e,S.statusText=(i||_)+"",h?b.resolveWith(p,[m,_,S]):b.rejectWith(p,[S,_,g]),S.statusCode(C),C=void 0,d&&f.trigger(h?"ajaxSuccess":"ajaxError",[S,u,h?m:g]),v.fireWith(p,[S,_]),d&&(f.trigger("ajaxComplete",[S,u]),--w.active||w.event.trigger("ajaxStop")))}return S},getJSON:function(t,e,i){return w.get(t,e,i,"json")},getScript:function(t,e){return w.get(t,void 0,e,"script")}}),w.each(["get","post"],(function(t,e){w[e]=function(t,i,n,o){return p(i)&&(o=o||n,n=i,i=void 0),w.ajax(w.extend({url:t,type:e,dataType:o,data:i,success:n},w.isPlainObject(t)&&t))}})),w.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),w._evalUrl=function(t,e,i){return w.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){w.globalEval(t,e,i)}})},w.fn.extend({wrapAll:function(t){var e;return this[0]&&(p(t)&&(t=t.call(this[0])),e=w(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return p(t)?this.each((function(e){w(this).wrapInner(t.call(this,e))})):this.each((function(){var e=w(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=p(t);return this.each((function(i){w(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){w(this).replaceWith(this.childNodes)})),this}}),w.expr.pseudos.hidden=function(t){return!w.expr.pseudos.visible(t)},w.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var ze={0:200,1223:204},We=w.ajaxSettings.xhr();u.cors=!!We&&"withCredentials"in We,u.ajax=We=!!We,w.ajaxTransport((function(e){var i,n;if(u.cors||We&&!e.crossDomain)return{send:function(o,s){var a,r=e.xhr();if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)r[a]=e.xhrFields[a];for(a in e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)r.setRequestHeader(a,o[a]);i=function(t){return function(){i&&(i=n=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===t?r.abort():"error"===t?"number"!=typeof r.status?s(0,"error"):s(r.status,r.statusText):s(ze[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=i(),n=r.onerror=r.ontimeout=i("error"),void 0!==r.onabort?r.onabort=n:r.onreadystatechange=function(){4===r.readyState&&t.setTimeout((function(){i&&n()}))},i=i("abort");try{r.send(e.hasContent&&e.data||null)}catch(t){if(i)throw t}},abort:function(){i&&i()}}})),w.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return w.globalEval(t),t}}}),w.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),w.ajaxTransport("script",(function(t){var e,i;if(t.crossDomain||t.scriptAttrs)return{send:function(n,o){e=w("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&o("error"===t.type?404:200,t.type)}),g.head.appendChild(e[0])},abort:function(){i&&i()}}}));var je,Ke=[],qe=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ke.pop()||w.expando+"_"+_e.guid++;return this[t]=!0,t}}),w.ajaxPrefilter("json jsonp",(function(e,i,n){var o,s,a,r=!1!==e.jsonp&&(qe.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&qe.test(e.data)&&"data");if(r||"jsonp"===e.dataTypes[0])return o=e.jsonpCallback=p(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,r?e[r]=e[r].replace(qe,"$1"+o):!1!==e.jsonp&&(e.url+=(Se.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return a||w.error(o+" was not called"),a[0]},e.dataTypes[0]="json",s=t[o],t[o]=function(){a=arguments},n.always((function(){void 0===s?w(t).removeProp(o):t[o]=s,e[o]&&(e.jsonpCallback=i.jsonpCallback,Ke.push(o)),a&&p(s)&&s(a[0]),a=s=void 0})),"script"})),u.createHTMLDocument=((je=g.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===je.childNodes.length),w.parseHTML=function(t,e,i){return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(u.createHTMLDocument?((n=(e=g.implementation.createHTMLDocument("")).createElement("base")).href=g.location.href,e.head.appendChild(n)):e=g),s=!i&&[],(o=I.exec(t))?[e.createElement(o[1])]:(o=yt([t],e,s),s&&s.length&&w(s).remove(),w.merge([],o.childNodes)));var n,o,s},w.fn.load=function(t,e,i){var n,o,s,a=this,r=t.indexOf(" ");return r>-1&&(n=ge(t.slice(r)),t=t.slice(0,r)),p(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),a.length>0&&w.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done((function(t){s=arguments,a.html(n?w("<div>").append(w.parseHTML(t)).find(n):t)})).always(i&&function(t,e){a.each((function(){i.apply(this,s||[t.responseText,e,t])}))}),this},w.expr.pseudos.animated=function(t){return w.grep(w.timers,(function(e){return t===e.elem})).length},w.offset={setOffset:function(t,e,i){var n,o,s,a,r,l,c=w.css(t,"position"),d=w(t),h={};"static"===c&&(t.style.position="relative"),r=d.offset(),s=w.css(t,"top"),l=w.css(t,"left"),("absolute"===c||"fixed"===c)&&(s+l).indexOf("auto")>-1?(a=(n=d.position()).top,o=n.left):(a=parseFloat(s)||0,o=parseFloat(l)||0),p(e)&&(e=e.call(t,i,w.extend({},r))),null!=e.top&&(h.top=e.top-r.top+a),null!=e.left&&(h.left=e.left-r.left+o),"using"in e?e.using.call(t,h):("number"==typeof h.top&&(h.top+="px"),"number"==typeof h.left&&(h.left+="px"),d.css(h))}},w.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){w.offset.setOffset(this,t,e)}));var e,i,n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,n=this[0],o={top:0,left:0};if("fixed"===w.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===w.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&((o=w(t).offset()).top+=w.css(t,"borderTopWidth",!0),o.left+=w.css(t,"borderLeftWidth",!0))}return{top:e.top-o.top-w.css(n,"marginTop",!0),left:e.left-o.left-w.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===w.css(t,"position");)t=t.offsetParent;return t||nt}))}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;w.fn[t]=function(n){return N(this,(function(t,n,o){var s;if(f(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===o)return s?s[e]:t[n];s?s.scrollTo(i?s.pageXOffset:o,i?o:s.pageYOffset):t[n]=o}),t,n,arguments.length)}})),w.each(["top","left"],(function(t,e){w.cssHooks[e]=Wt(u.pixelPosition,(function(t,i){if(i)return i=zt(t,e),Rt.test(i)?w(t).position()[e]+"px":i}))})),w.each({Height:"height",Width:"width"},(function(t,e){w.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){w.fn[n]=function(o,s){var a=arguments.length&&(i||"boolean"!=typeof o),r=i||(!0===o||!0===s?"margin":"border");return N(this,(function(e,i,o){var s;return f(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===o?w.css(e,i,r):w.style(e,i,o,r)}),e,a?o:void 0,a)}}))})),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){w.fn[e]=function(t){return this.on(e,t)}})),w.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){w.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}));var Ge=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.proxy=function(t,e){var i,n,s;if("string"==typeof e&&(i=t[e],e=t,t=i),p(t))return n=o.call(arguments,2),s=function(){return t.apply(e||this,n.concat(o.call(arguments)))},s.guid=t.guid=t.guid||w.guid++,s},w.holdReady=function(t){t?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=A,w.isFunction=p,w.isWindow=f,w.camelCase=K,w.type=C,w.now=Date.now,w.isNumeric=function(t){var e=w.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},w.trim=function(t){return null==t?"":(t+"").replace(Ge,"")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return w}));var Ye=t.jQuery,Xe=t.$;return w.noConflict=function(e){return t.$===w&&(t.$=Xe),e&&t.jQuery===w&&(t.jQuery=Ye),w},void 0===e&&(t.jQuery=t.$=w),w})),function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},e=t._,i=Array.prototype,n=Object.prototype,o="undefined"!=typeof Symbol?Symbol.prototype:null,s=i.push,a=i.slice,r=n.toString,l=n.hasOwnProperty,c=Array.isArray,d=Object.keys,h=Object.create,m=function(){},u=function(t){return t instanceof u?t:this instanceof u?void(this._wrapped=t):new u(t)};"undefined"==typeof exports||exports.nodeType?t._=u:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=u),exports._=u),u.VERSION="1.8.3";var p,f=function(t,e,i){if(void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case null:case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,s){return t.call(e,i,n,o,s)}}return function(){return t.apply(e,arguments)}},g=function(t,e,i){return u.iteratee!==p?u.iteratee(t,e):null==t?u.identity:u.isFunction(t)?f(t,e,i):u.isObject(t)&&!u.isArray(t)?u.matcher(t):u.property(t)};u.iteratee=p=function(t,e){return g(t,e,1/0)};var b=function(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),n=Array(i),o=0;o<i;o++)n[o]=arguments[o+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var s=Array(e+1);for(o=0;o<e;o++)s[o]=arguments[o];return s[e]=n,t.apply(this,s)}},v=function(t){if(!u.isObject(t))return{};if(h)return h(t);m.prototype=t;var e=new m;return m.prototype=null,e},C=function(t){return function(e){return null==e?void 0:e[t]}},y=function(t,e){for(var i=e.length,n=0;n<i;n++){if(null==t)return;t=t[e[n]]}return i?t:void 0},w=Math.pow(2,53)-1,x=C("length"),_=function(t){var e=x(t);return"number"==typeof e&&e>=0&&e<=w};u.each=u.forEach=function(t,e,i){var n,o;if(e=f(e,i),_(t))for(n=0,o=t.length;n<o;n++)e(t[n],n,t);else{var s=u.keys(t);for(n=0,o=s.length;n<o;n++)e(t[s[n]],s[n],t)}return t},u.map=u.collect=function(t,e,i){e=g(e,i);for(var n=!_(t)&&u.keys(t),o=(n||t).length,s=Array(o),a=0;a<o;a++){var r=n?n[a]:a;s[a]=e(t[r],r,t)}return s};var S=function(t){return function(e,i,n,o){var s=arguments.length>=3;return function(e,i,n,o){var s=!_(e)&&u.keys(e),a=(s||e).length,r=t>0?0:a-1;for(o||(n=e[s?s[r]:r],r+=t);r>=0&&r<a;r+=t){var l=s?s[r]:r;n=i(n,e[l],l,e)}return n}(e,f(i,o,4),n,s)}};u.reduce=u.foldl=u.inject=S(1),u.reduceRight=u.foldr=S(-1),u.find=u.detect=function(t,e,i){var n=(_(t)?u.findIndex:u.findKey)(t,e,i);if(void 0!==n&&-1!==n)return t[n]},u.filter=u.select=function(t,e,i){var n=[];return e=g(e,i),u.each(t,(function(t,i,o){e(t,i,o)&&n.push(t)})),n},u.reject=function(t,e,i){return u.filter(t,u.negate(g(e)),i)},u.every=u.all=function(t,e,i){e=g(e,i);for(var n=!_(t)&&u.keys(t),o=(n||t).length,s=0;s<o;s++){var a=n?n[s]:s;if(!e(t[a],a,t))return!1}return!0},u.some=u.any=function(t,e,i){e=g(e,i);for(var n=!_(t)&&u.keys(t),o=(n||t).length,s=0;s<o;s++){var a=n?n[s]:s;if(e(t[a],a,t))return!0}return!1},u.contains=u.includes=u.include=function(t,e,i,n){return _(t)||(t=u.values(t)),("number"!=typeof i||n)&&(i=0),u.indexOf(t,e,i)>=0},u.invoke=b((function(t,e,i){var n,o;return u.isFunction(e)?o=e:u.isArray(e)&&(n=e.slice(0,-1),e=e[e.length-1]),u.map(t,(function(t){var s=o;if(!s){if(n&&n.length&&(t=y(t,n)),null==t)return;s=t[e]}return null==s?s:s.apply(t,i)}))})),u.pluck=function(t,e){return u.map(t,u.property(e))},u.where=function(t,e){return u.filter(t,u.matcher(e))},u.findWhere=function(t,e){return u.find(t,u.matcher(e))},u.max=function(t,e,i){var n,o,s=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var r=0,l=(t=_(t)?t:u.values(t)).length;r<l;r++)null!=(n=t[r])&&n>s&&(s=n);else e=g(e,i),u.each(t,(function(t,i,n){((o=e(t,i,n))>a||o===-1/0&&s===-1/0)&&(s=t,a=o)}));return s},u.min=function(t,e,i){var n,o,s=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var r=0,l=(t=_(t)?t:u.values(t)).length;r<l;r++)null!=(n=t[r])&&n<s&&(s=n);else e=g(e,i),u.each(t,(function(t,i,n){((o=e(t,i,n))<a||o===1/0&&s===1/0)&&(s=t,a=o)}));return s},u.shuffle=function(t){return u.sample(t,1/0)},u.sample=function(t,e,i){if(null==e||i)return _(t)||(t=u.values(t)),t[u.random(t.length-1)];var n=_(t)?u.clone(t):u.values(t),o=x(n);e=Math.max(Math.min(e,o),0);for(var s=o-1,a=0;a<e;a++){var r=u.random(a,s),l=n[a];n[a]=n[r],n[r]=l}return n.slice(0,e)},u.sortBy=function(t,e,i){var n=0;return e=g(e,i),u.pluck(u.map(t,(function(t,i,o){return{value:t,index:n++,criteria:e(t,i,o)}})).sort((function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index})),"value")};var k=function(t,e){return function(i,n,o){var s=e?[[],[]]:{};return n=g(n,o),u.each(i,(function(e,o){var a=n(e,o,i);t(s,e,a)})),s}};u.groupBy=k((function(t,e,i){u.has(t,i)?t[i].push(e):t[i]=[e]})),u.indexBy=k((function(t,e,i){t[i]=e})),u.countBy=k((function(t,e,i){u.has(t,i)?t[i]++:t[i]=1}));var T=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;u.toArray=function(t){return t?u.isArray(t)?a.call(t):u.isString(t)?t.match(T):_(t)?u.map(t,u.identity):u.values(t):[]},u.size=function(t){return null==t?0:_(t)?t.length:u.keys(t).length},u.partition=k((function(t,e,i){t[i?0:1].push(e)}),!0),u.first=u.head=u.take=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[0]:u.initial(t,t.length-e)},u.initial=function(t,e,i){return a.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},u.last=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[t.length-1]:u.rest(t,Math.max(0,t.length-e))},u.rest=u.tail=u.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},u.compact=function(t){return u.filter(t,Boolean)};var A=function(t,e,i,n){for(var o=(n=n||[]).length,s=0,a=x(t);s<a;s++){var r=t[s];if(_(r)&&(u.isArray(r)||u.isArguments(r)))if(e)for(var l=0,c=r.length;l<c;)n[o++]=r[l++];else A(r,e,i,n),o=n.length;else i||(n[o++]=r)}return n};u.flatten=function(t,e){return A(t,e,!1)},u.without=b((function(t,e){return u.difference(t,e)})),u.uniq=u.unique=function(t,e,i,n){u.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=g(i,n));for(var o=[],s=[],a=0,r=x(t);a<r;a++){var l=t[a],c=i?i(l,a,t):l;e?(a&&s===c||o.push(l),s=c):i?u.contains(s,c)||(s.push(c),o.push(l)):u.contains(o,l)||o.push(l)}return o},u.union=b((function(t){return u.uniq(A(t,!0,!0))})),u.intersection=function(t){for(var e=[],i=arguments.length,n=0,o=x(t);n<o;n++){var s=t[n];if(!u.contains(e,s)){var a;for(a=1;a<i&&u.contains(arguments[a],s);a++);a===i&&e.push(s)}}return e},u.difference=b((function(t,e){return e=A(e,!0,!0),u.filter(t,(function(t){return!u.contains(e,t)}))})),u.unzip=function(t){for(var e=t&&u.max(t,x).length||0,i=Array(e),n=0;n<e;n++)i[n]=u.pluck(t,n);return i},u.zip=b(u.unzip),u.object=function(t,e){for(var i={},n=0,o=x(t);n<o;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i};var I=function(t){return function(e,i,n){i=g(i,n);for(var o=x(e),s=t>0?0:o-1;s>=0&&s<o;s+=t)if(i(e[s],s,e))return s;return-1}};u.findIndex=I(1),u.findLastIndex=I(-1),u.sortedIndex=function(t,e,i,n){for(var o=(i=g(i,n,1))(e),s=0,a=x(t);s<a;){var r=Math.floor((s+a)/2);i(t[r])<o?s=r+1:a=r}return s};var P=function(t,e,i){return function(n,o,s){var r=0,l=x(n);if("number"==typeof s)t>0?r=s>=0?s:Math.max(s+l,r):l=s>=0?Math.min(s+1,l):s+l+1;else if(i&&s&&l)return n[s=i(n,o)]===o?s:-1;if(o!=o)return(s=e(a.call(n,r,l),u.isNaN))>=0?s+r:-1;for(s=t>0?r:l-1;s>=0&&s<l;s+=t)if(n[s]===o)return s;return-1}};u.indexOf=P(1,u.findIndex,u.sortedIndex),u.lastIndexOf=P(-1,u.findLastIndex),u.range=function(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/i),0),o=Array(n),s=0;s<n;s++,t+=i)o[s]=t;return o},u.chunk=function(t,e){if(null==e||e<1)return[];for(var i=[],n=0,o=t.length;n<o;)i.push(a.call(t,n,n+=e));return i};var E=function(t,e,i,n,o){if(!(n instanceof e))return t.apply(i,o);var s=v(t.prototype),a=t.apply(s,o);return u.isObject(a)?a:s};u.bind=b((function(t,e,i){if(!u.isFunction(t))throw new TypeError("Bind must be called on a function");var n=b((function(o){return E(t,n,e,this,i.concat(o))}));return n})),u.partial=b((function(t,e){var i=u.partial.placeholder,n=function(){for(var o=0,s=e.length,a=Array(s),r=0;r<s;r++)a[r]=e[r]===i?arguments[o++]:e[r];for(;o<arguments.length;)a.push(arguments[o++]);return E(t,n,this,this,a)};return n})),u.partial.placeholder=u,u.bindAll=b((function(t,e){var i=(e=A(e,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=e[i];t[n]=u.bind(t[n],t)}})),u.memoize=function(t,e){var i=function(n){var o=i.cache,s=""+(e?e.apply(this,arguments):n);return u.has(o,s)||(o[s]=t.apply(this,arguments)),o[s]};return i.cache={},i},u.delay=b((function(t,e,i){return setTimeout((function(){return t.apply(null,i)}),e)})),u.defer=u.partial(u.delay,u,1),u.throttle=function(t,e,i){var n,o,s,a,r=0;i||(i={});var l=function(){r=!1===i.leading?0:u.now(),n=null,a=t.apply(o,s),n||(o=s=null)},c=function(){var c=u.now();r||!1!==i.leading||(r=c);var d=e-(c-r);return o=this,s=arguments,d<=0||d>e?(n&&(clearTimeout(n),n=null),r=c,a=t.apply(o,s),n||(o=s=null)):n||!1===i.trailing||(n=setTimeout(l,d)),a};return c.cancel=function(){clearTimeout(n),r=0,n=o=s=null},c},u.debounce=function(t,e,i){var n,o,s=function(e,i){n=null,i&&(o=t.apply(e,i))},a=b((function(a){if(n&&clearTimeout(n),i){var r=!n;n=setTimeout(s,e),r&&(o=t.apply(this,a))}else n=u.delay(s,e,this,a);return o}));return a.cancel=function(){clearTimeout(n),n=null},a},u.wrap=function(t,e){return u.partial(e,t)},u.negate=function(t){return function(){return!t.apply(this,arguments)}},u.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},u.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},u.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},u.once=u.partial(u.before,2),u.restArgs=b;var D=!{toString:null}.propertyIsEnumerable("toString"),U=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],M=function(t,e){var i=U.length,o=t.constructor,s=u.isFunction(o)&&o.prototype||n,a="constructor";for(u.has(t,a)&&!u.contains(e,a)&&e.push(a);i--;)(a=U[i])in t&&t[a]!==s[a]&&!u.contains(e,a)&&e.push(a)};u.keys=function(t){if(!u.isObject(t))return[];if(d)return d(t);var e=[];for(var i in t)u.has(t,i)&&e.push(i);return D&&M(t,e),e},u.allKeys=function(t){if(!u.isObject(t))return[];var e=[];for(var i in t)e.push(i);return D&&M(t,e),e},u.values=function(t){for(var e=u.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=t[e[o]];return n},u.mapObject=function(t,e,i){e=g(e,i);for(var n=u.keys(t),o=n.length,s={},a=0;a<o;a++){var r=n[a];s[r]=e(t[r],r,t)}return s},u.pairs=function(t){for(var e=u.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=[e[o],t[e[o]]];return n},u.invert=function(t){for(var e={},i=u.keys(t),n=0,o=i.length;n<o;n++)e[t[i[n]]]=i[n];return e},u.functions=u.methods=function(t){var e=[];for(var i in t)u.isFunction(t[i])&&e.push(i);return e.sort()};var L=function(t,e){return function(i){var n=arguments.length;if(e&&(i=Object(i)),n<2||null==i)return i;for(var o=1;o<n;o++)for(var s=arguments[o],a=t(s),r=a.length,l=0;l<r;l++){var c=a[l];e&&void 0!==i[c]||(i[c]=s[c])}return i}};u.extend=L(u.allKeys),u.extendOwn=u.assign=L(u.keys),u.findKey=function(t,e,i){e=g(e,i);for(var n,o=u.keys(t),s=0,a=o.length;s<a;s++)if(e(t[n=o[s]],n,t))return n};var F,V,B=function(t,e,i){return e in i};u.pick=b((function(t,e){var i={},n=e[0];if(null==t)return i;u.isFunction(n)?(e.length>1&&(n=f(n,e[1])),e=u.allKeys(t)):(n=B,e=A(e,!1,!1),t=Object(t));for(var o=0,s=e.length;o<s;o++){var a=e[o],r=t[a];n(r,a,t)&&(i[a]=r)}return i})),u.omit=b((function(t,e){var i,n=e[0];return u.isFunction(n)?(n=u.negate(n),e.length>1&&(i=e[1])):(e=u.map(A(e,!1,!1),String),n=function(t,i){return!u.contains(e,i)}),u.pick(t,n,i)})),u.defaults=L(u.allKeys,!0),u.create=function(t,e){var i=v(t);return e&&u.extendOwn(i,e),i},u.clone=function(t){return u.isObject(t)?u.isArray(t)?t.slice():u.extend({},t):t},u.tap=function(t,e){return e(t),t},u.isMatch=function(t,e){var i=u.keys(e),n=i.length;if(null==t)return!n;for(var o=Object(t),s=0;s<n;s++){var a=i[s];if(e[a]!==o[a]||!(a in o))return!1}return!0},F=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=typeof t;return("function"===o||"object"===o||"object"==typeof e)&&V(t,e,i,n)},V=function(t,e,i,n){t instanceof u&&(t=t._wrapped),e instanceof u&&(e=e._wrapped);var s=r.call(t);if(s!==r.call(e))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return o.valueOf.call(t)===o.valueOf.call(e)}var a="[object Array]"===s;if(!a){if("object"!=typeof t||"object"!=typeof e)return!1;var l=t.constructor,c=e.constructor;if(l!==c&&!(u.isFunction(l)&&l instanceof l&&u.isFunction(c)&&c instanceof c)&&"constructor"in t&&"constructor"in e)return!1}n=n||[];for(var d=(i=i||[]).length;d--;)if(i[d]===t)return n[d]===e;if(i.push(t),n.push(e),a){if((d=t.length)!==e.length)return!1;for(;d--;)if(!F(t[d],e[d],i,n))return!1}else{var h,m=u.keys(t);if(d=m.length,u.keys(e).length!==d)return!1;for(;d--;)if(h=m[d],!u.has(e,h)||!F(t[h],e[h],i,n))return!1}return i.pop(),n.pop(),!0},u.isEqual=function(t,e){return F(t,e)},u.isEmpty=function(t){return null==t||(_(t)&&(u.isArray(t)||u.isString(t)||u.isArguments(t))?0===t.length:0===u.keys(t).length)},u.isElement=function(t){return!(!t||1!==t.nodeType)},u.isArray=c||function(t){return"[object Array]"===r.call(t)},u.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},u.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(t){u["is"+t]=function(e){return r.call(e)==="[object "+t+"]"}})),u.isArguments(arguments)||(u.isArguments=function(t){return u.has(t,"callee")});var O=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof O&&(u.isFunction=function(t){return"function"==typeof t||!1}),u.isFinite=function(t){return!u.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},u.isNaN=function(t){return u.isNumber(t)&&isNaN(t)},u.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===r.call(t)},u.isNull=function(t){return null===t},u.isUndefined=function(t){return void 0===t},u.has=function(t,e){if(!u.isArray(e))return null!=t&&l.call(t,e);for(var i=e.length,n=0;n<i;n++){var o=e[n];if(null==t||!l.call(t,o))return!1;t=t[o]}return!!i},u.noConflict=function(){return t._=e,this},u.identity=function(t){return t},u.constant=function(t){return function(){return t}},u.noop=function(){},u.property=function(t){return u.isArray(t)?function(e){return y(e,t)}:C(t)},u.propertyOf=function(t){return null==t?function(){}:function(e){return u.isArray(e)?y(t,e):t[e]}},u.matcher=u.matches=function(t){return t=u.extendOwn({},t),function(e){return u.isMatch(e,t)}},u.times=function(t,e,i){var n=Array(Math.max(0,t));e=f(e,i,1);for(var o=0;o<t;o++)n[o]=e(o);return n},u.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},u.now=Date.now||function(){return(new Date).getTime()};var R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},$=u.invert(R),H=function(t){var e=function(e){return t[e]},i="(?:"+u.keys(t).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}};u.escape=H(R),u.unescape=H($),u.result=function(t,e,i){u.isArray(e)||(e=[e]);var n=e.length;if(!n)return u.isFunction(i)?i.call(t):i;for(var o=0;o<n;o++){var s=null==t?void 0:t[e[o]];void 0===s&&(s=i,o=n),t=u.isFunction(s)?s.call(t):s}return t};var N=0;u.uniqueId=function(t){var e=++N+"";return t?t+e:e},u.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/,W={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\u2028|\u2029/g,K=function(t){return"\\"+W[t]};u.template=function(t,e,i){!e&&i&&(e=i),e=u.defaults({},e,u.templateSettings);var n,o=RegExp([(e.escape||z).source,(e.interpolate||z).source,(e.evaluate||z).source].join("|")+"|$","g"),s=0,a="__p+='";t.replace(o,(function(e,i,n,o,r){return a+=t.slice(s,r).replace(j,K),s=r+e.length,i?a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":o&&(a+="';\n"+o+"\n__p+='"),e})),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(e.variable||"obj","_",a)}catch(t){throw t.source=a,t}var r=function(t){return n.call(this,t,u)},l=e.variable||"obj";return r.source="function("+l+"){\n"+a+"}",r},u.chain=function(t){var e=u(t);return e._chain=!0,e};var q=function(t,e){return t._chain?u(e).chain():e};u.mixin=function(t){return u.each(u.functions(t),(function(e){var i=u[e]=t[e];u.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),q(this,i.apply(u,t))}})),u},u.mixin(u),u.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=i[t];u.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],q(this,i)}})),u.each(["concat","join","slice"],(function(t){var e=i[t];u.prototype[t]=function(){return q(this,e.apply(this._wrapped,arguments))}})),u.prototype.value=function(){return this._wrapped},u.prototype.valueOf=u.prototype.toJSON=u.prototype.value,u.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],(function(){return u}))}(),function(){var t,e=this,i=e.Backbone,n=[],o=n.slice;(t="undefined"!=typeof exports?exports:e.Backbone={}).VERSION="1.1.0";var s=e._;s||"undefined"==typeof require||(s=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(t,e,i){return l(this,"on",t,[e,i])&&e?(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this}),this):this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var n=this,o=s.once((function(){n.off(t,o),e.apply(this,arguments)}));return o._callback=e,this.on(t,o,i)},off:function(t,e,i){var n,o,a,r,c,d,h,m;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(c=0,d=(r=t?[t]:s.keys(this._events)).length;c<d;c++)if(t=r[c],a=this._events[t]){if(this._events[t]=n=[],e||i)for(h=0,m=a.length;h<m;h++)o=a[h],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&n.push(o);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var o=!e&&!i;for(var a in i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t),n)(t=n[a]).off(e,i,this),(o||s.isEmpty(t._events))&&delete this._listeningTo[a];return this}},r=/\s+/,l=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var o in i)t[e].apply(t,[o,i[o]].concat(n));return!1}if(r.test(i)){for(var s=i.split(r),a=0,l=s.length;a<l;a++)t[e].apply(t,[s[a]].concat(n));return!1}return!0},c=function(t,e){var i,n=-1,o=t.length,s=e[0],a=e[1],r=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,a);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,a,r);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e)}};s.each({listenTo:"on",listenToOnce:"once"},(function(t,e){a[e]=function(e,i,n){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=s.uniqueId("l"))]=e,n||"object"!=typeof i||(n=this),e[t](i,n,this),this}})),a.bind=a.on,a.unbind=a.off,s.extend(t,a);var d=t.Model=function(t,e){var i=t||{};e||(e={}),this.cid=s.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=s.defaults({},i,s.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};s.extend(d.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return s.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return s.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,o,a,r,l,c,d,h;if(null==t)return this;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;for(n in a=i.unset,l=i.silent,r=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=s.clone(this.attributes),this.changed={}),h=this.attributes,d=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]),o)e=o[n],s.isEqual(h[n],e)||r.push(n),s.isEqual(d[n],e)?delete this.changed[n]:this.changed[n]=e,a?delete h[n]:h[n]=e;if(!l){r.length&&(this._pending=!0);for(var m=0,u=r.length;m<u;m++)this.trigger("change:"+r[m],this,h[r[m]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,s.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,s.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!s.isEmpty(this.changed):s.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&s.clone(this.changed);var e,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var o in t)s.isEqual(n[o],e=t[o])||((i||(i={}))[o]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(t){void 0===(t=t?s.clone(t):{}).parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){if(!e.set(e.parse(n,t),t))return!1;i&&i(e,n,t),e.trigger("sync",e,n,t)},D(this,t),this.sync("read",this,t)},save:function(t,e,i){var n,o,a,r=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,i=s.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=s.extend({},r,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(t){l.attributes=r;var e=l.parse(t,i);if(i.wait&&(e=s.extend(n||{},e)),s.isObject(e)&&!l.set(e,i))return!1;c&&c(l,t,i),l.trigger("sync",l,t,i)},D(this,i),"patch"===(o=this.isNew()?"create":i.patch?"patch":"update")&&(i.attrs=n),a=this.sync(o,this,i),n&&i.wait&&(this.attributes=r),a},destroy:function(t){t=t?s.clone(t):{};var e=this,i=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(o){(t.wait||e.isNew())&&n(),i&&i(e,o,t),e.isNew()||e.trigger("sync",e,o,t)},this.isNew())return t.success(),!1;D(this,t);var o=this.sync("delete",this,t);return t.wait||n(),o},url:function(){var t=s.result(this,"urlRoot")||s.result(this.collection,"url")||E();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},s.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=s.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,s.extend(e,{validationError:i})),!1)}});s.each(["keys","values","pairs","invert","pick","omit"],(function(t){d.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),s[t].apply(s,e)}}));var h=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,s.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},u={add:!0,remove:!1};s.extend(h.prototype,a,{model:d,initialize:function(){},toJSON:function(t){return this.map((function(e){return e.toJSON(t)}))},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,s.extend({merge:!1},e,u))},remove:function(t,e){var i,n,o,a,r=!s.isArray(t);for(e||(e={}),i=0,n=(t=r?[t]:s.clone(t)).length;i<n;i++)(a=t[i]=this.get(t[i]))&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,e.silent||(e.index=o,a.trigger("remove",a,this,e)),this._removeReference(a));return r?t[0]:t},set:function(t,e){(e=s.defaults({},e,m)).parse&&(t=this.parse(t,e));var i,n,o,a,r,l,c,h=!s.isArray(t);t=h?t?[t]:[]:s.clone(t);var u=e.at,p=this.model,f=this.comparator&&null==u&&!1!==e.sort,g=s.isString(this.comparator)?this.comparator:null,b=[],v=[],C={},y=e.add,w=e.merge,x=e.remove,_=!(f||!y||!x)&&[];for(i=0,n=t.length;i<n;i++){if(o=(r=t[i])instanceof d?a=r:r[p.prototype.idAttribute],l=this.get(o))x&&(C[l.cid]=!0),w&&(r=r===a?a.attributes:r,e.parse&&(r=l.parse(r,e)),l.set(r,e),f&&!c&&l.hasChanged(g)&&(c=!0)),t[i]=l;else if(y){if(!(a=t[i]=this._prepareModel(r,e)))continue;b.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)}_&&_.push(l||a)}if(x){for(i=0,n=this.length;i<n;++i)C[(a=this.models[i]).cid]||v.push(a);v.length&&this.remove(v,e)}if(b.length||_&&_.length)if(f&&(c=!0),this.length+=b.length,null!=u)for(i=0,n=b.length;i<n;i++)this.models.splice(u+i,0,b[i]);else{_&&(this.models.length=0);var S=_||b;for(i=0,n=S.length;i<n;i++)this.models.push(S[i])}if(c&&this.sort({silent:!0}),!e.silent){for(i=0,n=b.length;i<n;i++)(a=b[i]).trigger("add",a,this,e);(c||_&&_.length)&&this.trigger("sort",this,e)}return h?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;i<n;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t=this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,s.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,s.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){return s.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"]((function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0}))},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return s.invoke(this.models,"get",t)},fetch:function(t){void 0===(t=t?s.clone(t):{}).parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var o=t.reset?"reset":"set";i[o](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},D(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?s.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,n=e.success;return e.success=function(t,e,o){o.wait&&i.add(t,o),n&&n(t,e,o)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t.collection||(t.collection=this),t;(e=e?s.clone(e):{}).collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});s.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"],(function(t){h.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),s[t].apply(s,e)}}));s.each(["groupBy","countBy","sortBy"],(function(t){h.prototype[t]=function(e,i){var n=s.isFunction(e)?e:function(t){return t.get(e)};return s[t](this.models,n,i)}}));var p=t.View=function(t){this.cid=s.uniqueId("view"),t||(t={}),s.extend(this,s.pick(t,g)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},f=/^(\S+)\s*(.*)$/,g=["model","collection","el","id","attributes","className","tagName","events"];s.extend(p.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=s.result(this,"events")))return this;for(var e in this.undelegateEvents(),t){var i=t[e];if(s.isFunction(i)||(i=this[t[e]]),i){var n=e.match(f),o=n[1],a=n[2];i=s.bind(i,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,i):this.$el.on(o,a,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var e=s.extend({},s.result(this,"attributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e.class=s.result(this,"className"));var i=t.$("<"+s.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,n){var o=v[e];s.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:o,dataType:"json"};if(n.url||(a.url=s.result(i,"url")||E()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),n.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",n.emulateJSON&&(a.data._method=o);var r=n.beforeSend;n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),r)return r.apply(this,arguments)}}"GET"===a.type||n.emulateJSON||(a.processData=!1),"PATCH"===a.type&&b&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=t.ajax(s.extend(a,n));return i.trigger("request",i,l,n),l};var b=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),v={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,w=/(\(\?)?:\w+/g,x=/\*\w+/g,_=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(C.prototype,a,{initialize:function(){},route:function(e,i,n){s.isRegExp(e)||(e=this._routeToRegExp(e)),s.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var o=this;return t.history.route(e,(function(s){var a=o._extractParameters(e,s);n&&n.apply(o,a),o.trigger.apply(o,["route:"+i].concat(a)),o.trigger("route",i,a),t.history.trigger("route",o,i,a)})),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var t,e=s.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(_,"\\$&").replace(y,"(?:$1)?").replace(w,(function(t,e){return e?t:"([^/]+)"})).replace(x,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return s.map(i,(function(t){return t?decodeURIComponent(t):null}))}});var S=t.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},k=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,A=/msie [\w.]+/,I=/\/$/,P=/[?#].*$/;S.started=!1,s.extend(S.prototype,a,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(I,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(k,"")},start:function(e){if(S.started)throw new Error("Backbone.history has already been started");S.started=!0,this.options=s.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,o=A.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(T,"/"),o&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location,r=a.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!r)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&r&&a.hash&&(this.fragment=this.getHash().replace(k,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),S.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),s.any(this.handlers,(function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!S.started)return!1;e&&!0!==e||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(P,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),t.history=new S;d.extend=h.extend=C.extend=p.extend=S.extend=function(t,e){var i,n=this;i=t&&s.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,e);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,t&&s.extend(i.prototype,t),i.__super__=n.prototype,i};var E=function(){throw new Error('A "url" property or function must be specified')},D=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}}}.call(this),define("backbone",["underscore","jquery"],function(t){return function(){return t.Backbone}}(this)),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");if(function(t){"use strict";var e=jQuery.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||e[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function(t){"use strict";t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",(function(){i=!0}));return setTimeout((function(){i||t(n).trigger(t.support.transition.end)}),e),this},t((function(){t.support.transition=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})}))}(jQuery),function(t){"use strict";var e='[data-dismiss="alert"]',i=function(i){t(i).on("click",e,this.close)};i.VERSION="3.4.1",i.TRANSITION_DURATION=150,i.prototype.close=function(e){var n=t(this),o=n.attr("data-target");o||(o=(o=n.attr("href"))&&o.replace(/.*(?=#[^\s]*$)/,"")),o="#"===o?[]:o;var s=t(document).find(o);function a(){s.detach().trigger("closed.bs.alert").remove()}e&&e.preventDefault(),s.length||(s=n.closest(".alert")),s.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",a).emulateTransitionEnd(i.TRANSITION_DURATION):a())};var n=t.fn.alert;t.fn.alert=function(e){return this.each((function(){var n=t(this),o=n.data("bs.alert");o||n.data("bs.alert",o=new i(this)),"string"==typeof e&&o[e].call(n)}))},t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=n,this},t(document).on("click.bs.alert.data-api",e,i.prototype.close)}(jQuery),function(t){"use strict";var e=function(i,n){this.$element=t(i),this.options=t.extend({},e.DEFAULTS,n),this.isLoading=!1};function i(i){return this.each((function(){var n=t(this),o=n.data("bs.button"),s="object"==typeof i&&i;o||n.data("bs.button",o=new e(this,s)),"toggle"==i?o.toggle():i&&o.setState(i)}))}e.VERSION="3.4.1",e.DEFAULTS={loadingText:"loading..."},e.prototype.setState=function(e){var i="disabled",n=this.$element,o=n.is("input")?"val":"html",s=n.data();e+="Text",null==s.resetText&&n.data("resetText",n[o]()),setTimeout(t.proxy((function(){n[o](null==s[e]?this.options[e]:s[e]),"loadingText"==e?(this.isLoading=!0,n.addClass(i).attr(i,i).prop(i,!0)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i).prop(i,!1))}),this),0)},e.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),t&&i.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=i,t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',(function(e){var n=t(e.target).closest(".btn");i.call(n,"toggle"),t(e.target).is('input[type="radio"], input[type="checkbox"]')||(e.preventDefault(),n.is("input,button")?n.trigger("focus"):n.find("input:visible,button:visible").first().trigger("focus"))})).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',(function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))}))}(jQuery),function(t){"use strict";var e=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};function i(i){return this.each((function(){var n=t(this),o=n.data("bs.carousel"),s=t.extend({},e.DEFAULTS,n.data(),"object"==typeof i&&i),a="string"==typeof i?i:s.slide;o||n.data("bs.carousel",o=new e(this,s)),"number"==typeof i?o.to(i):a?o[a]():s.interval&&o.pause().cycle()}))}e.VERSION="3.4.1",e.TRANSITION_DURATION=600,e.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},e.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},e.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},e.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},e.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e);if(("prev"==t&&0===i||"next"==t&&i==this.$items.length-1)&&!this.options.wrap)return e;var n=(i+("prev"==t?-1:1))%this.$items.length;return this.$items.eq(n)},e.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",(function(){e.to(t)})):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},e.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},e.prototype.next=function(){if(!this.sliding)return this.slide("next")},e.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},e.prototype.slide=function(i,n){var o=this.$element.find(".item.active"),s=n||this.getItemForDirection(i,o),a=this.interval,r="next"==i?"left":"right",l=this;if(s.hasClass("active"))return this.sliding=!1;var c=s[0],d=t.Event("slide.bs.carousel",{relatedTarget:c,direction:r});if(this.$element.trigger(d),!d.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var h=t(this.$indicators.children()[this.getItemIndex(s)]);h&&h.addClass("active")}var m=t.Event("slid.bs.carousel",{relatedTarget:c,direction:r});return t.support.transition&&this.$element.hasClass("slide")?(s.addClass(i),"object"==typeof s&&s.length&&s[0].offsetWidth,o.addClass(r),s.addClass(r),o.one("bsTransitionEnd",(function(){s.removeClass([i,r].join(" ")).addClass("active"),o.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout((function(){l.$element.trigger(m)}),0)})).emulateTransitionEnd(e.TRANSITION_DURATION)):(o.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(m)),a&&this.cycle(),this}};var n=t.fn.carousel;t.fn.carousel=i,t.fn.carousel.Constructor=e,t.fn.carousel.noConflict=function(){return t.fn.carousel=n,this};var o=function(e){var n=t(this),o=n.attr("href");o&&(o=o.replace(/.*(?=#[^\s]+$)/,""));var s=n.attr("data-target")||o,a=t(document).find(s);if(a.hasClass("carousel")){var r=t.extend({},a.data(),n.data()),l=n.attr("data-slide-to");l&&(r.interval=!1),i.call(a,r),l&&a.data("bs.carousel").to(l),e.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",o).on("click.bs.carousel.data-api","[data-slide-to]",o),t(window).on("load",(function(){t('[data-ride="carousel"]').each((function(){var e=t(this);i.call(e,e.data())}))}))}(jQuery),function(t){"use strict";var e=function(i,n){this.$element=t(i),this.options=t.extend({},e.DEFAULTS,n),this.$trigger=t('[data-toggle="collapse"][href="#'+i.id+'"],[data-toggle="collapse"][data-target="#'+i.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function i(e){var i,n=e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return t(document).find(n)}function n(i){return this.each((function(){var n=t(this),o=n.data("bs.collapse"),s=t.extend({},e.DEFAULTS,n.data(),"object"==typeof i&&i);!o&&s.toggle&&/show|hide/.test(i)&&(s.toggle=!1),o||n.data("bs.collapse",o=new e(this,s)),"string"==typeof i&&o[i]()}))}e.VERSION="3.4.1",e.TRANSITION_DURATION=350,e.DEFAULTS={toggle:!0},e.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},e.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var i,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(i=o.data("bs.collapse"))&&i.transitioning)){var s=t.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){o&&o.length&&(n.call(o,"hide"),i||o.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return r.call(this);var l=t.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(e.TRANSITION_DURATION)[a](this.$element[0][l])}}}},e.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var i=t.Event("hide.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!t.support.transition)return o.call(this);this.$element[n](0).one("bsTransitionEnd",t.proxy(o,this)).emulateTransitionEnd(e.TRANSITION_DURATION)}}},e.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},e.prototype.getParent=function(){return t(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy((function(e,n){var o=t(n);this.addAriaAndCollapsedClass(i(o),o)}),this)).end()},e.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var o=t.fn.collapse;t.fn.collapse=n,t.fn.collapse.Constructor=e,t.fn.collapse.noConflict=function(){return t.fn.collapse=o,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',(function(e){var o=t(this);o.attr("data-target")||e.preventDefault();var s=i(o),a=s.data("bs.collapse")?"toggle":o.data();n.call(s,a)}))}(jQuery),function(t){"use strict";var e='[data-toggle="dropdown"]',i=function(e){t(e).on("click.bs.dropdown",this.toggle)};function n(e){var i=e.attr("data-target");i||(i=(i=e.attr("href"))&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n="#"!==i?t(document).find(i):null;return n&&n.length?n:e.parent()}function o(i){i&&3===i.which||(t(".dropdown-backdrop").remove(),t(e).each((function(){var e=t(this),o=n(e),s={relatedTarget:this};o.hasClass("open")&&(i&&"click"==i.type&&/input|textarea/i.test(i.target.tagName)&&t.contains(o[0],i.target)||(o.trigger(i=t.Event("hide.bs.dropdown",s)),i.isDefaultPrevented()||(e.attr("aria-expanded","false"),o.removeClass("open").trigger(t.Event("hidden.bs.dropdown",s)))))})))}i.VERSION="3.4.1",i.prototype.toggle=function(e){var i=t(this);if(!i.is(".disabled, :disabled")){var s=n(i),a=s.hasClass("open");if(o(),!a){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",o);var r={relatedTarget:this};if(s.trigger(e=t.Event("show.bs.dropdown",r)),e.isDefaultPrevented())return;i.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger(t.Event("shown.bs.dropdown",r))}return!1}},i.prototype.keydown=function(i){if(/(38|40|27|32)/.test(i.which)&&!/input|textarea/i.test(i.target.tagName)){var o=t(this);if(i.preventDefault(),i.stopPropagation(),!o.is(".disabled, :disabled")){var s=n(o),a=s.hasClass("open");if(!a&&27!=i.which||a&&27==i.which)return 27==i.which&&s.find(e).trigger("focus"),o.trigger("click");var r=s.find(".dropdown-menu li:not(.disabled):visible a");if(r.length){var l=r.index(i.target);38==i.which&&l>0&&l--,40==i.which&&l<r.length-1&&l++,~l||(l=0),r.eq(l).trigger("focus")}}}};var s=t.fn.dropdown;t.fn.dropdown=function(e){return this.each((function(){var n=t(this),o=n.data("bs.dropdown");o||n.data("bs.dropdown",o=new i(this)),"string"==typeof e&&o[e].call(n)}))},t.fn.dropdown.Constructor=i,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=s,this},t(document).on("click.bs.dropdown.data-api",o).on("click.bs.dropdown.data-api",".dropdown form",(function(t){t.stopPropagation()})).on("click.bs.dropdown.data-api",e,i.prototype.toggle).on("keydown.bs.dropdown.data-api",e,i.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",i.prototype.keydown)}(jQuery),function(t){"use strict";var e=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy((function(){this.$element.trigger("loaded.bs.modal")}),this))};function i(i,n){return this.each((function(){var o=t(this),s=o.data("bs.modal"),a=t.extend({},e.DEFAULTS,o.data(),"object"==typeof i&&i);s||o.data("bs.modal",s=new e(this,a)),"string"==typeof i?s[i](n):a.show&&s.show(n)}))}e.VERSION="3.4.1",e.TRANSITION_DURATION=300,e.BACKDROP_TRANSITION_DURATION=150,e.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},e.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},e.prototype.show=function(i){var n=this,o=t.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",(function(){n.$element.one("mouseup.dismiss.bs.modal",(function(e){t(e.target).is(n.$element)&&(n.ignoreBackdropClick=!0)}))})),this.backdrop((function(){var o=t.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),o&&n.$element[0].offsetWidth,n.$element.addClass("in"),n.enforceFocus();var s=t.Event("shown.bs.modal",{relatedTarget:i});o?n.$dialog.one("bsTransitionEnd",(function(){n.$element.trigger("focus").trigger(s)})).emulateTransitionEnd(e.TRANSITION_DURATION):n.$element.trigger("focus").trigger(s)})))},e.prototype.hide=function(i){i&&i.preventDefault(),i=t.Event("hide.bs.modal"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(e.TRANSITION_DURATION):this.hideModal())},e.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy((function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")}),this))},e.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy((function(t){27==t.which&&this.hide()}),this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},e.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},e.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop((function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")}))},e.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},e.prototype.backdrop=function(i){var n=this,o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=t.support.transition&&o;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+o).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy((function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())}),this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;s?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(e.BACKDROP_TRANSITION_DURATION):i()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){n.removeBackdrop(),i&&i()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(e.BACKDROP_TRANSITION_DURATION):a()}else i&&i()},e.prototype.handleUpdate=function(){this.adjustDialog()},e.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},e.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},e.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},e.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var i=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",e+i),t(this.fixedContent).each((function(e,n){var o=n.style.paddingRight,s=t(n).css("padding-right");t(n).data("padding-right",o).css("padding-right",parseFloat(s)+i+"px")})))},e.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),t(this.fixedContent).each((function(e,i){var n=t(i).data("padding-right");t(i).removeData("padding-right"),i.style.paddingRight=n||""}))},e.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var n=t.fn.modal;t.fn.modal=i,t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=n,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',(function(e){var n=t(this),o=n.attr("href"),s=n.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,""),a=t(document).find(s),r=a.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(o)&&o},a.data(),n.data());n.is("a")&&e.preventDefault(),a.one("show.bs.modal",(function(t){t.isDefaultPrevented()||a.one("hidden.bs.modal",(function(){n.is(":visible")&&n.trigger("focus")}))})),i.call(a,r,this)}))}(jQuery),function(t){"use strict";var e=["sanitize","whiteList","sanitizeFn"],i=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],n={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},o=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,s=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function a(e,n){var a=e.nodeName.toLowerCase();if(-1!==t.inArray(a,n))return-1===t.inArray(a,i)||Boolean(e.nodeValue.match(o)||e.nodeValue.match(s));for(var r=t(n).filter((function(t,e){return e instanceof RegExp})),l=0,c=r.length;l<c;l++)if(a.match(r[l]))return!0;return!1}function r(e,i,n){if(0===e.length)return e;if(n&&"function"==typeof n)return n(e);if(!document.implementation||!document.implementation.createHTMLDocument)return e;var o=document.implementation.createHTMLDocument("sanitization");o.body.innerHTML=e;for(var s=t.map(i,(function(t,e){return e})),r=t(o.body).find("*"),l=0,c=r.length;l<c;l++){var d=r[l],h=d.nodeName.toLowerCase();if(-1!==t.inArray(h,s))for(var m=t.map(d.attributes,(function(t){return t})),u=[].concat(i["*"]||[],i[h]||[]),p=0,f=m.length;p<f;p++)a(m[p],u)||d.removeAttribute(m[p].nodeName);else d.parentNode.removeChild(d)}return o.body.innerHTML}var l=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};l.VERSION="3.4.1",l.TRANSITION_DURATION=150,l.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:n},l.prototype.init=function(e,i,n){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&t(document).find(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),s=o.length;s--;){var a=o[s];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},l.prototype.getDefaults=function(){return l.DEFAULTS},l.prototype.getOptions=function(i){var n=this.$element.data();for(var o in n)n.hasOwnProperty(o)&&-1!==t.inArray(o,e)&&delete n[o];return(i=t.extend({},this.getDefaults(),n,i)).delay&&"number"==typeof i.delay&&(i.delay={show:i.delay,hide:i.delay}),i.sanitize&&(i.template=r(i.template,i.whiteList,i.sanitizeFn)),i},l.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,(function(t,n){i[t]!=n&&(e[t]=n)})),e},l.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState)i.hoverState="in";else{if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout((function(){"in"==i.hoverState&&i.show()}),i.options.delay.show)}},l.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},l.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout((function(){"out"==i.hoverState&&i.hide()}),i.options.delay.hide)}},l.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var n=this,o=this.tip(),s=this.getUID(this.type);this.setContent(),o.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&o.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,r=/\s?auto?\s?/i,c=r.test(a);c&&(a=a.replace(r,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?o.appendTo(t(document).find(this.options.container)):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var d=this.getPosition(),h=o[0].offsetWidth,m=o[0].offsetHeight;if(c){var u=a,p=this.getPosition(this.$viewport);a="bottom"==a&&d.bottom+m>p.bottom?"top":"top"==a&&d.top-m<p.top?"bottom":"right"==a&&d.right+h>p.width?"left":"left"==a&&d.left-h<p.left?"right":a,o.removeClass(u).addClass(a)}var f=this.getCalculatedOffset(a,d,h,m);this.applyPlacement(f,a);var g=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",g).emulateTransitionEnd(l.TRANSITION_DURATION):g()}},l.prototype.applyPlacement=function(e,i){var n=this.tip(),o=n[0].offsetWidth,s=n[0].offsetHeight,a=parseInt(n.css("margin-top"),10),r=parseInt(n.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),e.top+=a,e.left+=r,t.offset.setOffset(n[0],t.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),n.addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;"top"==i&&c!=s&&(e.top=e.top+s-c);var d=this.getViewportAdjustedDelta(i,e,l,c);d.left?e.left+=d.left:e.top+=d.top;var h=/top|bottom/.test(i),m=h?2*d.left-o+l:2*d.top-s+c,u=h?"offsetWidth":"offsetHeight";n.offset(e),this.replaceArrow(m,n[0][u],h)},l.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},l.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();this.options.html?(this.options.sanitize&&(e=r(e,this.options.whiteList,this.options.sanitizeFn)),t.find(".tooltip-inner").html(e)):t.find(".tooltip-inner").text(e),t.removeClass("fade in top bottom left right")},l.prototype.hide=function(e){var i=this,n=t(this.$tip),o=t.Event("hide.bs."+this.type);function s(){"in"!=i.hoverState&&n.detach(),i.$element&&i.$element.removeAttr("aria-describedby").trigger("hidden.bs."+i.type),e&&e()}if(this.$element.trigger(o),!o.isDefaultPrevented())return n.removeClass("in"),t.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",s).emulateTransitionEnd(l.TRANSITION_DURATION):s(),this.hoverState=null,this},l.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},l.prototype.hasContent=function(){return this.getTitle()},l.prototype.getPosition=function(e){var i=(e=e||this.$element)[0],n="BODY"==i.tagName,o=i.getBoundingClientRect();null==o.width&&(o=t.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var s=window.SVGElement&&i instanceof window.SVGElement,a=n?{top:0,left:0}:s?null:e.offset(),r={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},l=n?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},o,r,l,a)},l.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},l.prototype.getViewportAdjustedDelta=function(t,e,i,n){var o={top:0,left:0};if(!this.$viewport)return o;var s=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-s-a.scroll,l=e.top+s-a.scroll+n;r<a.top?o.top=a.top-r:l>a.top+a.height&&(o.top=a.top+a.height-l)}else{var c=e.left-s,d=e.left+s+i;c<a.left?o.left=a.left-c:d>a.right&&(o.left=a.left+a.width-d)}return o},l.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},l.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},l.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},l.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},l.prototype.enable=function(){this.enabled=!0},l.prototype.disable=function(){this.enabled=!1},l.prototype.toggleEnabled=function(){this.enabled=!this.enabled},l.prototype.toggle=function(e){var i=this;e&&((i=t(e.currentTarget).data("bs."+this.type))||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},l.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide((function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null}))},l.prototype.sanitizeHtml=function(t){return r(t,this.options.whiteList,this.options.sanitizeFn)};var c=t.fn.tooltip;t.fn.tooltip=function(e){return this.each((function(){var i=t(this),n=i.data("bs.tooltip"),o="object"==typeof e&&e;!n&&/destroy|hide/.test(e)||(n||i.data("bs.tooltip",n=new l(this,o)),"string"==typeof e&&n[e]())}))},t.fn.tooltip.Constructor=l,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=c,this}}(jQuery),function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.VERSION="3.4.1",e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),(e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype)).constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();if(this.options.html){var n=typeof i;this.options.sanitize&&(e=this.sanitizeHtml(e),"string"===n&&(i=this.sanitizeHtml(i))),t.find(".popover-title").html(e),t.find(".popover-content").children().detach().end()["string"===n?"html":"append"](i)}else t.find(".popover-title").text(e),t.find(".popover-content").children().detach().end().text(i);t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=t.fn.popover;t.fn.popover=function(i){return this.each((function(){var n=t(this),o=n.data("bs.popover"),s="object"==typeof i&&i;!o&&/destroy|hide/.test(i)||(o||n.data("bs.popover",o=new e(this,s)),"string"==typeof i&&o[i]())}))},t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),function(t){"use strict";function e(i,n){this.$body=t(document.body),this.$scrollElement=t(i).is(document.body)?t(window):t(i),this.options=t.extend({},e.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function i(i){return this.each((function(){var n=t(this),o=n.data("bs.scrollspy"),s="object"==typeof i&&i;o||n.data("bs.scrollspy",o=new e(this,s)),"string"==typeof i&&o[i]()}))}e.VERSION="3.4.1",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,i="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(i="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map((function(){var e=t(this),o=e.data("target")||e.attr("href"),s=/^#./.test(o)&&t(o);return s&&s.length&&s.is(":visible")&&[[s[i]().top+n,o]]||null})).sort((function(t,e){return t[0]-e[0]})).each((function(){e.offsets.push(this[0]),e.targets.push(this[1])}))},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),o=this.offsets,s=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=n)return a!=(t=s[s.length-1])&&this.activate(t);if(a&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)a!=s[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(s[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',n=t(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var n=t.fn.scrollspy;t.fn.scrollspy=i,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=n,this},t(window).on("load.bs.scrollspy.data-api",(function(){t('[data-spy="scroll"]').each((function(){var e=t(this);i.call(e,e.data())}))}))}(jQuery),function(t){"use strict";var e=function(e){this.element=t(e)};function i(i){return this.each((function(){var n=t(this),o=n.data("bs.tab");o||n.data("bs.tab",o=new e(this)),"string"==typeof i&&o[i]()}))}e.VERSION="3.4.1",e.TRANSITION_DURATION=150,e.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),n=e.data("target");if(n||(n=(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var o=i.find(".active:last a"),s=t.Event("hide.bs.tab",{relatedTarget:e[0]}),a=t.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(s),e.trigger(a),!a.isDefaultPrevented()&&!s.isDefaultPrevented()){var r=t(document).find(n);this.activate(e.closest("li"),i),this.activate(r,r.parent(),(function(){o.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:o[0]})}))}}},e.prototype.activate=function(i,n,o){var s=n.find("> .active"),a=o&&t.support.transition&&(s.length&&s.hasClass("fade")||!!n.find("> .fade").length);function r(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),i.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(i[0].offsetWidth,i.addClass("in")):i.removeClass("fade"),i.parent(".dropdown-menu").length&&i.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),o&&o()}s.length&&a?s.one("bsTransitionEnd",r).emulateTransitionEnd(e.TRANSITION_DURATION):r(),s.removeClass("in")};var n=t.fn.tab;t.fn.tab=i,t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=n,this};var o=function(e){e.preventDefault(),i.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',o).on("click.bs.tab.data-api",'[data-toggle="pill"]',o)}(jQuery),function(t){"use strict";var e=function(i,n){this.options=t.extend({},e.DEFAULTS,n);var o=this.options.target===e.DEFAULTS.target?t(this.options.target):t(document).find(this.options.target);this.$target=o.on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(i),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};function i(i){return this.each((function(){var n=t(this),o=n.data("bs.affix"),s="object"==typeof i&&i;o||n.data("bs.affix",o=new e(this,s)),"string"==typeof i&&o[i]()}))}e.VERSION="3.4.1",e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0,target:window},e.prototype.getState=function(t,e,i,n){var o=this.$target.scrollTop(),s=this.$element.offset(),a=this.$target.height();if(null!=i&&"top"==this.affixed)return o<i&&"top";if("bottom"==this.affixed)return null!=i?!(o+this.unpin<=s.top)&&"bottom":!(o+a<=t-n)&&"bottom";var r=null==this.affixed,l=r?o:s.top;return null!=i&&o<=i?"top":null!=n&&l+(r?a:e)>=t-n&&"bottom"},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=this.$element.height(),n=this.options.offset,o=n.top,s=n.bottom,a=Math.max(t(document).height(),t(document.body).height());"object"!=typeof n&&(s=o=n),"function"==typeof o&&(o=n.top(this.$element)),"function"==typeof s&&(s=n.bottom(this.$element));var r=this.getState(a,i,o,s);if(this.affixed!=r){null!=this.unpin&&this.$element.css("top","");var l="affix"+(r?"-"+r:""),c=t.Event(l+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented())return;this.affixed=r,this.unpin="bottom"==r?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==r&&this.$element.offset({top:a-i-s})}};var n=t.fn.affix;t.fn.affix=i,t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=n,this},t(window).on("load",(function(){t('[data-spy="affix"]').each((function(){var e=t(this),n=e.data();n.offset=n.offset||{},null!=n.offsetBottom&&(n.offset.bottom=n.offsetBottom),null!=n.offsetTop&&(n.offset.top=n.offsetTop),i.call(e,n)}))}))}(jQuery),define("bootstrap",["jquery"],(function(){})),void 0===Common)var Common={};if(define("notification",["backbone"],(function(t){"use strict";var e=function(){};if(_.extend(e.prototype,t.Events),void 0!==Common.NotificationCenter)throw"Native Common.NotificationCenter instance already defined.";e.extend=t.Model.extend,Common.NotificationCenter=new e})),function(){var t=function(t,e){for(var i=t.split("."),n=e||window,o=0,s=i.length;o<s;o++)n=n[i[o]]||{};return n},e=function(t){_.extend(this,t||{}),this.eventbus=new n({application:this}),this.createApplicationNamespace(),this.initialize.apply(this,arguments),!1!==this.autoCreate&&$($.proxy(this.onReady,this))};if(_.extend(e.prototype,{nameSpace:"Application",models:{},collections:{},controllers:{},allocationMap:{model:"Models",collection:"Collections",controller:"Controllers",view:"Views"},createApplicationNamespace:function(){var t=window;this.nameSpace&&void 0===t[this.nameSpace]&&(t[this.nameSpace]={}),t[this.nameSpace]=this,_.each(this.allocationMap,(function(t,e){this[t]=this[t]||{}}),this)},initialize:function(){},onReady:function(){this.start()},start:function(){this.initializeControllers(this.controllers||{}),this.launchControllers(),this.launch.call(this)},getClasseRefs:function(e,i){var n={},o=this[this.allocationMap[e]];return _.each(i,(function(e){n[e]=t(e,e.indexOf(".")>-1?window:o)}),this),n},initializeControllers:function(e){this.controllers={},_.each(e,(function(e){var i=e.indexOf(".")>-1?window:this[this.allocationMap.controller],n=t(e,i),o=(e.split(".").pop(),new n({id:e,application:this}));o.views=this.getClasseRefs("view",o.views||[]),_.extend(this.models,this.getClasseRefs("model",o.models||[])),_.extend(this.collections,this.getClasseRefs("collection",o.collections||{})),this.buildCollections(),this.controllers[e]=o}),this)},launchControllers:function(){_.each(this.controllers,(function(t,e){t.onLaunch(this)}),this)},launch:function(){},addListeners:function(t,e){this.eventbus.addListeners(t,e)},getController:function(t){return this.controllers[t]},getModel:function(t){this._modelsCache=this._modelsCache||{};var e=this._modelsCache[t],i=this.getModelConstructor(t);return!e&&i&&(e=this.createModel(t),this._modelsCache[t]=e),e||null},getModelConstructor:function(t){return this.models[t]},createModel:function(t,e){var i=this.getModelConstructor(t),n=null;return i&&(n=new i(_.extend(e||{}))),n},getCollection:function(t){this._collectionsCache=this._collectionsCache||{};var e=this._collectionsCache[t],i=this.getCollectionConstructor(t);return!e&&i&&(e=this.createCollection(t),this._collectionsCache[t]=e),e||null},getCollectionConstructor:function(t){return this.collections[t]},createCollection:function(t){var e=this.getCollectionConstructor(t),i=null;return e&&(i=new e),i},buildCollections:function(){_.each(this.collections,(function(t,e){this.getCollection(e)}),this)}}),void 0!==Backbone.Application)throw"Native Backbone.Application instance already defined.";Backbone.Application=e,Backbone.Application.extend=Backbone.Model.extend;var i=function(t){_.extend(this,t||{}),this.initialize.apply(this,arguments)};if(_.extend(i.prototype,{name:null,views:{},models:{},collections:{},initialize:function(t){},addListeners:function(t){this.getApplication().addListeners(t,this)},onLaunch:function(t){},getApplication:function(){return this.application},getView:function(t){return this._viewsCache[t]},getViewConstructor:function(t){return this.views[t]},createView:function(t,e){var i=this.getViewConstructor(t),n=_.extend(e||{},{alias:t});return this._viewsCache=this._viewsCache||{},this._viewsCache[t]=new i(n),this._viewsCache[t].options=_.extend({},n),this._viewsCache[t]},getModel:function(t){return this.application.getModel(t)},getModelConstructor:function(t){return this.application.getModelConstructor(t)},createModel:function(t,e){return this.application.createModel(t)},getCollection:function(t){return this.application.getCollection(t)},getCollectionConstructor:function(t){return this.application.getCollectionConstructor(t)},createCollection:function(t){return this.application.createCollection(t)},fireEvent:function(t,e,i){this.application.eventbus.fireEvent(t,e,i)},bindViewEvents:function(t,e){for(var i in this.unbindViewEvents(t),e=_.isFunction(e)?e.call(this):e){var n=e[i];_.isFunction(n)||(n=this[e[i]]);var o=i.match(/^(\S+)\s*(.*)$/),s=o[1],a=o[2];n=_.bind(n,this),s+=".bindViewEvents"+t.cid,t.$el.on(s,a,n)}return this},unbindViewEvents:function(t){return t.$el.off(".bindViewEvents"+t.cid),this}}),void 0!==Backbone.Controller)throw"Native Backbone.Controller instance already defined.";Backbone.Controller=i,Backbone.Controller.extend=Backbone.Model.extend;var n=function(t){var e=this;_.extend(this,t||{}),_.extend(Backbone.View.prototype,{alias:null,hidden:!1,getAlias:function(){return this.options.alias},fireEvent:function(t,i){this.trigger.apply(this,arguments),e.fireEvent(this.getAlias(),t,i)},hide:function(){this.$el.hide(),this.hidden=!0},show:function(){this.$el.show(),this.hidden=!1}})};if(_.extend(n.prototype,{pool:{},addListeners:function(t,e){this.pool[e.id]=this.pool[e.id]||{};var i=this.pool[e.id];_.isArray(t)?_.each(t,(function(t){this.addListeners(t,e)}),this):_.isObject(t)&&_.each(t,(function(t,e){_.each(t,(function(t,n){i[e]=i[e]||{},i[e][n]=i[e][n]||[],i[e][n].push(t)}),this)}),this)},fireEvent:function(t,e,i){var n=this.getApplication();_.each(this.pool,(function(o,s){var a=o[t];if(a){var r=a[e],l=n.getController(s);_.each(r,(function(t){t.apply(l,i)}))}}),this)},getApplication:function(){return this.application}}),void 0!==Backbone.EventBus)throw"Native Backbone.Application instance already defined.";Backbone.EventBus=n}(),define("core",["backbone","notification"],(function(){})),void 0===window.Common&&(window.Common={}),Common.component=Common.component||{},Common.Analytics=Common.component.Analytics=new function(){var t;return{initialize:function(e,i){if(void 0===e)throw"Analytics: invalid id.";if(void 0===i||"[object String]"!==Object.prototype.toString.apply(i))throw"Analytics: invalid category type.";t=i,$("head").append('<script type="text/javascript">var _gaq = _gaq || [];_gaq.push(["_setAccount", "'+e+'"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);})();<\/script>')},trackEvent:function(e,i,n){if(void 0!==e&&"[object String]"!==Object.prototype.toString.apply(e))throw"Analytics: invalid action type.";if(void 0!==i&&"[object String]"!==Object.prototype.toString.apply(i))throw"Analytics: invalid label type.";if(void 0!==n&&("[object Number]"!==Object.prototype.toString.apply(n)||!isFinite(n)))throw"Analytics: invalid value type.";if("undefined"!=typeof _gaq){if("undefined"===t)throw"Analytics is not initialized.";_gaq.push(["_trackEvent",t,e,i,n])}}}},define("analytics",["jquery"],(function(){})),void 0===window.Common&&(window.Common={}),Common.Gateway=new function(){var t=this,e=$(t),i={init:function(t){e.trigger("init",t)},openDocument:function(t){e.trigger("opendocument",t)},showMessage:function(t){e.trigger("showmessage",t)},applyEditRights:function(t){e.trigger("applyeditrights",t)},processSaveResult:function(t){e.trigger("processsaveresult",t)},processRightsChange:function(t){e.trigger("processrightschange",t)},refreshHistory:function(t){e.trigger("refreshhistory",t)},setHistoryData:function(t){e.trigger("sethistorydata",t)},setEmailAddresses:function(t){e.trigger("setemailaddresses",t)},setActionLink:function(t){e.trigger("setactionlink",t.url)},processMailMerge:function(t){e.trigger("processmailmerge",t)},downloadAs:function(t){e.trigger("downloadas",t)},processMouse:function(t){e.trigger("processmouse",t)},internalCommand:function(t){e.trigger("internalcommand",t)},resetFocus:function(t){e.trigger("resetfocus",t)},setUsers:function(t){e.trigger("setusers",t)},showSharingSettings:function(t){e.trigger("showsharingsettings",t)},setSharingSettings:function(t){e.trigger("setsharingsettings",t)},insertImage:function(t){e.trigger("insertimage",t)},setMailMergeRecipients:function(t){e.trigger("setmailmergerecipients",t)},setRevisedFile:function(t){e.trigger("setrevisedfile",t)},setFavorite:function(t){e.trigger("setfavorite",t)},requestClose:function(t){e.trigger("requestclose",t)},blurFocus:function(t){e.trigger("blurfocus",t)},grabFocus:function(t){e.trigger("grabfocus",t)},setReferenceData:function(t){e.trigger("setreferencedata",t)},setRequestedDocument:function(t){e.trigger("setrequesteddocument",t)},setRequestedSpreadsheet:function(t){e.trigger("setrequestedspreadsheet",t)},setReferenceSource:function(t){e.trigger("setreferencesource",t)}},n=function(t){window.parent&&window.JSON&&(t.frameEditorId=window.frameEditorId,window.parent.postMessage(window.JSON.stringify(t),"*"))},o=function(t){!function(t){if(t.origin===window.parentOrigin||t.origin===window.location.origin||"null"===t.origin&&("file://"===window.parentOrigin||"file://"===window.location.origin)){var e=t.data;if("[object String]"===Object.prototype.toString.apply(e)&&window.JSON){var n,o;try{n=window.JSON.parse(e)}catch(t){n=""}n&&(o=i[n.command])&&o.call(this,n.data)}}}(t)};return window.attachEvent?window.attachEvent("onmessage",o):window.addEventListener("message",o,!1),{appReady:function(){n({event:"onAppReady"})},requestEditRights:function(){n({event:"onRequestEditRights"})},requestHistory:function(){n({event:"onRequestHistory"})},requestHistoryData:function(t){n({event:"onRequestHistoryData",data:t})},requestRestore:function(t,e,i){n({event:"onRequestRestore",data:{version:t,url:e,fileType:i}})},requestEmailAddresses:function(){n({event:"onRequestEmailAddresses"})},requestStartMailMerge:function(){n({event:"onRequestStartMailMerge"})},requestHistoryClose:function(t){n({event:"onRequestHistoryClose"})},reportError:function(t,e){n({event:"onError",data:{errorCode:t,errorDescription:e}})},reportWarning:function(t,e){n({event:"onWarning",data:{warningCode:t,warningDescription:e}})},sendInfo:function(t){n({event:"onInfo",data:t})},setDocumentModified:function(t){n({event:"onDocumentStateChange",data:t})},internalMessage:function(t,e){n({event:"onInternalMessage",data:{type:t,data:e}})},updateVersion:function(){n({event:"onOutdatedVersion"})},downloadAs:function(t,e){n({event:"onDownloadAs",data:{url:t,fileType:e}})},requestSaveAs:function(t,e,i){n({event:"onRequestSaveAs",data:{url:t,title:e,fileType:i}})},collaborativeChanges:function(){n({event:"onCollaborativeChanges"})},requestRename:function(t){n({event:"onRequestRename",data:t})},metaChange:function(t){n({event:"onMetaChange",data:t})},documentReady:function(){n({event:"onDocumentReady"})},requestClose:function(){n({event:"onRequestClose"})},requestMakeActionLink:function(t){n({event:"onMakeActionLink",data:t})},requestUsers:function(t){n({event:"onRequestUsers",data:{c:t}})},requestSendNotify:function(t){n({event:"onRequestSendNotify",data:t})},requestInsertImage:function(t){n({event:"onRequestInsertImage",data:{c:t}})},requestMailMergeRecipients:function(){n({event:"onRequestMailMergeRecipients"})},requestCompareFile:function(){n({event:"onRequestCompareFile"})},requestSharingSettings:function(){n({event:"onRequestSharingSettings"})},requestCreateNew:function(){n({event:"onRequestCreateNew"})},requestReferenceData:function(t){n({event:"onRequestReferenceData",data:t})},requestOpen:function(t){n({event:"onRequestOpen",data:t})},requestSelectDocument:function(t){n({event:"onRequestSelectDocument",data:{c:t}})},requestSelectSpreadsheet:function(t){n({event:"onRequestSelectSpreadsheet",data:{c:t}})},requestReferenceSource:function(){n({event:"onRequestReferenceSource"})},pluginsReady:function(){n({event:"onPluginsReady"})},on:function(i,n){e.on(i,(function(e,i){n.call(t,i)}))}}},define("gateway",["jquery"],(function(){})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("../vendor/es6-promise/es6-promise.auto.min",e):t.ES6Promise=e()}(this,(function(){"use strict";function t(t){return"function"==typeof t}function e(){var t=setTimeout;return function(){return t(i,1)}}function i(){for(var t=0;t<b;t+=2){(0,T[t])(T[t+1]),T[t]=void 0,T[t+1]=void 0}b=0}function n(t,e){var i=this,n=new this.constructor(s);void 0===n[I]&&p(n);var o=i._state;if(o){var a=arguments[o-1];y((function(){return u(o,n,a,i._result)}))}else h(i,n,t,e);return n}function o(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(s);return r(e,t),e}function s(){}function a(e,i,s){i.constructor===e.constructor&&s===n&&i.constructor.resolve===o?function(t,e){e._state===E?c(t,e._result):e._state===D?d(t,e._result):h(e,void 0,(function(e){return r(t,e)}),(function(e){return d(t,e)}))}(e,i):void 0===s?c(e,i):t(s)?function(t,e,i){y((function(t){var n=!1,o=function(t,e,i,n){try{t.call(e,i,n)}catch(t){return t}}(i,e,(function(i){n||(n=!0,e!==i?r(t,i):c(t,i))}),(function(e){n||(n=!0,d(t,e))}),t._label);!n&&o&&(n=!0,d(t,o))}),t)}(e,i,s):c(e,i)}function r(t,e){if(t===e)d(t,new TypeError("You cannot resolve a promise with itself"));else if(function(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}(e)){var i=void 0;try{i=e.then}catch(e){return void d(t,e)}a(t,e,i)}else c(t,e)}function l(t){t._onerror&&t._onerror(t._result),m(t)}function c(t,e){t._state===P&&(t._result=e,t._state=E,0!==t._subscribers.length&&y(m,t))}function d(t,e){t._state===P&&(t._state=D,t._result=e,y(l,t))}function h(t,e,i,n){var o=t._subscribers,s=o.length;t._onerror=null,o[s]=e,o[s+E]=i,o[s+D]=n,0===s&&t._state&&y(m,t)}function m(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var n=void 0,o=void 0,s=t._result,a=0;a<e.length;a+=3)n=e[a],o=e[a+i],n?u(i,n,o,s):o(s);t._subscribers.length=0}}function u(e,i,n,o){var s=t(n),a=void 0,l=void 0,h=!0;if(s){try{a=n(o)}catch(t){h=!1,l=t}if(i===a)return void d(i,new TypeError("A promises callback cannot return that same promise."))}else a=o;i._state!==P||(s&&h?r(i,a):!1===h?d(i,l):e===E?c(i,a):e===D&&d(i,a))}function p(t){t[I]=U++,t._state=void 0,t._result=void 0,t._subscribers=[]}var f;f=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var g=f,b=0,v=void 0,C=void 0,y=function(t,e){T[b]=t,T[b+1]=e,2===(b+=2)&&(C?C(i):A())},w="undefined"!=typeof window?window:void 0,x=w||{},_=x.MutationObserver||x.WebKitMutationObserver,S="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),k="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,T=new Array(1e3),A=void 0;A=S?function(){return process.nextTick(i)}:_?function(){var t=0,e=new _(i),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():k?function(){var t=new MessageChannel;return t.port1.onmessage=i,function(){return t.port2.postMessage(0)}}():void 0===w&&"function"==typeof require?function(){try{var t=Function("return this")().require("vertx");return void 0!==(v=t.runOnLoop||t.runOnContext)?function(){v(i)}:e()}catch(t){return e()}}():e();var I=Math.random().toString(36).substring(2),P=void 0,E=1,D=2,U=0,M=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(s),this.promise[I]||p(this.promise),g(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?c(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&c(this.promise,this._result))):d(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===P&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,r=i.resolve;if(r===o){var l=void 0,c=void 0,h=!1;try{l=t.then}catch(t){h=!0,c=t}if(l===n&&t._state!==P)this._settledAt(t._state,e,t._result);else if("function"!=typeof l)this._remaining--,this._result[e]=t;else if(i===L){var m=new i(s);h?d(m,c):a(m,t,l),this._willSettleAt(m,e)}else this._willSettleAt(new i((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,i){var n=this.promise;n._state===P&&(this._remaining--,t===D?d(n,i):this._result[e]=i),0===this._remaining&&c(n,this._result)},t.prototype._willSettleAt=function(t,e){var i=this;h(t,void 0,(function(t){return i._settledAt(E,e,t)}),(function(t){return i._settledAt(D,e,t)}))},t}(),L=function(){function e(t){this[I]=U++,this._result=this._state=void 0,this._subscribers=[],s!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){r(t,e)}),(function(e){d(t,e)}))}catch(e){d(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var i=this,n=i.constructor;return t(e)?i.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):i.then(e,e)},e}();return L.prototype.then=n,L.all=function(t){return new M(this,t).promise},L.race=function(t){var e=this;return new e(g(t)?function(i,n){for(var o=t.length,s=0;s<o;s++)e.resolve(t[s]).then(i,n)}:function(t,e){return e(new TypeError("You must pass an array to race."))})},L.resolve=o,L.reject=function(t){var e=new this(s);return d(e,t),e},L._setScheduler=function(t){C=t},L._setAsap=function(t){y=t},L._asap=y,L.polyfill=function(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=L},L.Promise=L,L.polyfill(),L})),void 0===Common)var Common={};if(Common.Locale=new function(){"use strict";var l10n=null,loadcallback,apply=!1,defLang="en",currentLang=defLang,_4letterLangs=["pt-pt","zh-tw"],_applyLocalization=function(t){try{if(t&&(loadcallback=t),l10n){for(var e in l10n){var i=e.split(".");if(i&&i.length>2){for(var n=window,o=0;o<i.length-1;++o)void 0===n[i[o]]&&(n[i[o]]=new Object),n=n[i[o]];n&&(n[i[i.length-1]]=l10n[e])}}loadcallback&&loadcallback()}else apply=!0}catch(t){}},_get=function(prop,scope){var res="";return l10n&&scope&&scope.name&&(res=l10n[scope.name+"."+prop],!res&&scope.default&&(res=scope.default)),res||(scope?eval(scope.name).prototype[prop]:"")},_getCurrentLanguage=function(){return currentLang},_getDefaultLanguage=function(){return defLang},_getLoadedLanguage=function(){return loadedLang},_getUrlParameterByName=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))},_requireLang=function(t){"string"!=typeof t&&(t=null);var e=t||_getUrlParameterByName("lang")||defLang,i=_4letterLangs.indexOf(e.replace("_","-").toLowerCase());e=i<0?e.split(/[\-_]/)[0]:_4letterLangs[i],currentLang=e,fetch("locale/"+e+".json").then((function(t){if(!t.ok){if(i>=0)throw new Error("4letters error");if(currentLang=defLang,e!=defLang)return fetch("locale/"+defLang+".json");throw new Error("server error")}return t.json()})).then((function(t){if(t.json){if(!t.ok)throw new Error("server error");return t.json()}throw l10n=t,new Error("loaded")})).then((function(t){l10n=t||{},apply&&_applyLocalization()})).catch((function(t){return/4letters/.test(t)?setTimeout((function(){_requireLang(e.split(/[\-_]/)[0])}),0):!/loaded/.test(t)&&currentLang!=defLang&&defLang&&defLang.length<3?setTimeout((function(){_requireLang(defLang)}),0):(l10n=l10n||{},apply&&_applyLocalization(),void("loaded"==t.message||(currentLang=null,console.log("fetch error: "+t))))}))};if(window.fetch)_requireLang();else{var polyfills=["../vendor/fetch/fetch.umd"];window.Promise?require(polyfills,_requireLang):require(["../vendor/es6-promise/es6-promise.auto.min"],(function(){require(polyfills,_requireLang)}))}const _isCurrentRtl=function(){return!1};return{apply:_applyLocalization,get:_get,getCurrentLanguage:_getCurrentLanguage,isCurrentLanguageRtl:_isCurrentRtl,getDefaultLanguage:_getDefaultLanguage}},define("locale",(function(){})),define("common/main/lib/util/LocalStorage",["gateway"],(function(){Common.localStorage=new function(){var t,e,i={};Common.Gateway.on("internalcommand",(function(t){"localstorage"==t.type&&(i=t.keys)}));var n=function(t,e,n){if(s)try{localStorage.setItem(t,e)}catch(t){}else i[t]=e},o=function(t){return s?localStorage.getItem(t):void 0===i[t]?null:i[t]};try{var s=!!window.localStorage}catch(t){s=!1}return{getId:function(){return t},setId:function(e){t=e},getItem:o,getBool:function(t,e){var i=o(t);return e=e||!1,null!==i?0!=parseInt(i):e},setBool:function(t,e,i){n(t,e?1:0)},setItem:n,removeItem:function(t){s?localStorage.removeItem(t):delete i[t]},setKeysFilter:function(t){e=t},getKeysFilter:function(){return e},itemExists:function(t){return null!==o(t)},sync:function(){},save:function(){}}}})),define("common/main/lib/controller/Scaling",["core"],(function(){"use strict";!Common.UI&&(Common.UI={}),Common.UI.Scaling=new function(){const t={"pixel-ratio__1":1,"pixel-ratio__1_25":1.25,"pixel-ratio__1_5":1.5,"pixel-ratio__1_75":1.75,"pixel-ratio__2":2,"pixel-ratio__2_5":2.25};let e=document.body.className;const i=function(e){const i=/(pixel-ratio__[\w-]+)/.exec(e);return i&&i[1]in t?i[1]:"pixel-ratio__1"};let n=i(e);return new MutationObserver(function(e,o){const s=i(document.body.className);s!=n&&($("[ratio]").trigger("app:scaling",{ratio:t[s]}),n=s)}.bind(this)).observe(document.body,{attributes:!0,attributeFilter:["class"]}),{currentRatio:function(){return t[n]},currentRatioSelector:function(){return n}}}})),define("common/main/lib/controller/Themes",["core"],(function(){"use strict";!Common.UI&&(Common.UI={}),Common.UI.Themes=new function(t){!t&&(t={});const e="light",i="dark",n="system";var o={"theme-system":{text:t.txtThemeSystem||"Same as system",type:n,source:"static"},"theme-light":{text:t.txtThemeLight||"Light",type:"light",source:"static"},"theme-classic-light":{text:t.txtThemeClassicLight||"Classic Light",type:"light",source:"static"},"theme-dark":{text:t.txtThemeDark||"Dark",type:"dark",source:"static"},"theme-contrast-dark":{text:t.txtThemeContrastDark||"Dark Contrast",type:"dark",source:"static"}},s="theme-classic-light",a="theme-dark",r=["toolbar-header-document","toolbar-header-spreadsheet","toolbar-header-presentation","toolbar-header-pdf","text-toolbar-header-on-background-document","text-toolbar-header-on-background-spreadsheet","text-toolbar-header-on-background-presentation","text-toolbar-header-on-background-pdf","background-normal","background-toolbar","background-toolbar-additional","background-primary-dialog-button","background-tab-underline","background-notification-popover","background-notification-badge","background-scrim","background-loader","background-accent-button","background-contrast-popover","shadow-contrast-popover","highlight-button-hover","highlight-button-pressed","highlight-button-pressed-hover","highlight-primary-dialog-button-hover","highlight-header-button-hover","highlight-header-button-pressed","highlight-toolbar-tab-underline","highlight-text-select","highlight-accent-button-hover","highlight-accent-button-pressed","border-toolbar","border-divider","border-regular-control","border-toolbar-button-hover","border-preview-hover","border-preview-select","border-control-focus","border-color-shading","border-error","border-contrast-popover","text-normal","text-normal-pressed","text-secondary","text-tertiary","text-link","text-link-hover","text-link-active","text-link-visited","text-inverse","text-toolbar-header","text-contrast-background","text-alt-key-hint","icon-normal","icon-normal-pressed","icon-inverse","icon-toolbar-header","icon-notification-badge","icon-contrast-popover","icon-success","canvas-background","canvas-content-background","canvas-page-border","canvas-ruler-background","canvas-ruler-border","canvas-ruler-margins-background","canvas-ruler-mark","canvas-ruler-handle-border","canvas-ruler-handle-border-disabled","canvas-high-contrast","canvas-high-contrast-disabled","canvas-cell-border","canvas-cell-title","canvas-cell-title-border","canvas-cell-title-border-hover","canvas-cell-title-border-selected","canvas-cell-title-hover","canvas-cell-title-selected","canvas-dark-cell-title","canvas-dark-cell-title-hover","canvas-dark-cell-title-selected","canvas-dark-cell-title-border","canvas-dark-cell-title-border-hover","canvas-dark-cell-title-border-selected","canvas-dark-content-background","canvas-dark-page-border","canvas-scroll-thumb","canvas-scroll-thumb-hover","canvas-scroll-thumb-pressed","canvas-scroll-thumb-border","canvas-scroll-thumb-border-hover","canvas-scroll-thumb-border-pressed","canvas-scroll-arrow","canvas-scroll-arrow-hover","canvas-scroll-arrow-pressed","canvas-scroll-thumb-target","canvas-scroll-thumb-target-hover","canvas-scroll-thumb-target-pressed","canvas-sheet-view-cell-background","canvas-sheet-view-cell-background-hover","canvas-sheet-view-cell-background-pressed","canvas-sheet-view-cell-title-label","canvas-freeze-line-1px","canvas-freeze-line-2px","canvas-select-all-icon"],l=function(t){const e=t||r;var i={};if(!Common.Utils.isIE10&&!Common.Utils.isIE11){var n=getComputedStyle(document.body);e.forEach((function(t,e){i[t]=n.getPropertyValue("--"+t).trim()}))}return i},c=function(t,e){if(e&&t){var i=[":root .",t,"{"];for(var n in e)i.push("--",n,":",e[n],";");return i.push("}"),i.join("")}},d=function(t){if(t){var e=document.createElement("style");e.type="text/css",e.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(e)}},h=function(t){var e,i=Common.Locale.getCurrentLanguage();t.themes&&t.themes instanceof Array?t.themes.forEach((function(t){t.id?(e=t.l10n&&t.l10n[i]?t.l10n[i]:t.name,o[t.id]={text:e,type:t.type},d(c(t.id,t.colors))):"string"==typeof t&&u(t)})):t.id&&(e=t.l10n&&t.l10n[i]?t.l10n[i]:t.name,o[t.id]={text:e,type:t.type},d(c(t.id,t.colors))),Common.NotificationCenter.trigger("uitheme:countchanged")};const m=function(){let t=window.uitheme.id;if(o[t]){if("static"!=o[t].source){const e=document.body.className.match("theme-type-"+o[t].type);e?e.length&&(document.body.className=document.body.className.replace(/theme-type-(?:dark|ligth)/i,"theme-type-"+o[t].type)):document.body.classList.add("theme-type-"+o[t].type)}}else t=b().id,document.body.className=document.body.className.replace(/theme-[\w-]+\s?/gi,"").trim(),document.body.classList.add(t,"theme-type-"+o[t].type);const e=Common.localStorage.getItem("ui-theme");if(!e||f(e)!==t){var i={id:t,type:o[t].type,text:o[t].text,colors:l()};Common.localStorage.setItem("ui-theme",JSON.stringify(i))}};var u=function(t){Common.Utils.loadConfig(t,(function(t){"error"!=t?(h(t),m()):console.warn("failed to load/parse themes.json")}))},p=function(t){Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.localThemes()&&(h({themes:Common.Controllers.Desktop.localThemes()}),m()):u.call(this,"../../../../themes.json")},f=function(t){return"string"==typeof t&&t.startsWith("{")&&t.endsWith("}")&&(t=JSON.parse(t)),t&&"object"==typeof t?t.id:t},g=function(t){};const b=function(){const t=(Common.Controllers.Desktop&&Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.systemThemeType():window.matchMedia("(prefers-color-scheme: dark)").matches?i:e)==i?a:s;return{id:t,info:o[t]}},v=function(t){window.uitheme.is_theme_system()&&y.call(this,!0)},C=function(t){window.uitheme.set_id(t);const e=window.uitheme.relevant_theme_id();document.body.className=document.body.className.replace(/theme-[\w-]+\s?/gi,"").trim(),document.body.classList.add(e,"theme-type-"+o[e].type),this.api.asc_setContentDarkMode&&("dark"==o[e].type?(this.api.asc_setContentDarkMode(this.isContentThemeDark()),Common.NotificationCenter.trigger("contenttheme:dark",this.isContentThemeDark())):this.api.asc_setContentDarkMode(!1));const i=l();if(i.type=o[e].type,i.name=e,this.api.asc_setSkin(i),!Common.Utils.isIE10&&!Common.Utils.isIE11&&"static"!=o[t].source){const e={id:t,type:o[t].type,text:o[t].text,colors:i};Common.localStorage.setItem("ui-theme",JSON.stringify(e))}},y=function(t){if(t||Common.localStorage.getItem("ui-theme-id")!=window.uitheme.id){const t=Common.localStorage.getItem("ui-theme-id");t&&(C.call(this,t),Common.NotificationCenter.trigger("uitheme:changed",t))}};return{init:function(t){Common.Gateway.on("opendocument",g.bind(this)),$(window).on("storage",function(t){"ui-theme-id"!=t.key||Common.Controllers.Desktop.isActive()?"content-theme"==t.key&&this.setContentTheme(t.originalEvent.newValue,!0):t.originalEvent.newValue&&y.call(this)}.bind(this)),this.api=t;const i=window.uitheme.relevant_theme_id(),n=l(r);n.type=window.uitheme.type?window.uitheme.type:o[i]?o[i].type:e,n.name=i,t.asc_setSkin(n);const s=o[i]&&"dark"==o[i].type&&window.uitheme.iscontentdark;t.asc_setContentDarkMode&&t.asc_setContentDarkMode(s),Common.Utils.isIE10||Common.Utils.isIE11||window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",v.bind(this)),Common.NotificationCenter.on("document:ready",p.bind(this))},available:function(){return!Common.Utils.isIE&&!this.locked},setAvailable:function(t){this.locked=!t},map:function(){if(Common.Controllers.Desktop.isActive()&&!Common.Controllers.Desktop.systemThemeSupported()){const t=Object.assign({},o);return delete t["theme-system"],t}return o},get:function(t){return o[t]},currentThemeId:function(){return o[window.uitheme.id]?window.uitheme.id:s},defaultThemeId:function(t){return"dark"==t?a:s},defaultTheme:function(t){return o[this.defaultThemeId(t)]},isDarkTheme:function(t){return!t&&(t=this.currentThemeId()),(function(t){return o[t].type==n}(t)?b().info.type:o[t].type)==i},isContentThemeDark:function(){return window.uitheme.iscontentdark},setContentTheme:function(t,e){var i="dark"==t;(i!=window.uitheme.iscontentdark||e)&&(this.isDarkTheme()&&this.api.asc_setContentDarkMode(i),window.uitheme.iscontentdark=t,Common.localStorage.getItem("content-theme")!=t&&Common.localStorage.setItem("content-theme",t),Common.NotificationCenter.trigger("contenttheme:dark",i))},toggleContentTheme:function(){window.uitheme.iscontentdark=!window.uitheme.iscontentdark,Common.localStorage.setItem("content-theme",window.uitheme.iscontentdark?"dark":"light"),this.isDarkTheme()&&this.api.asc_setContentDarkMode(window.uitheme.iscontentdark),Common.NotificationCenter.trigger("contenttheme:dark",window.uitheme.iscontentdark)},setTheme:function(t){if(!t)return;const e=f(t);o[e]&&e!=window.uitheme.id&&(C.call(this,e),Common.localStorage.setItem("ui-theme-id",e),Common.NotificationCenter.trigger("uitheme:changed",e))},refreshTheme:y,toggleTheme:function(){this.setTheme(this.isDarkTheme()?s:a)}}}(Common.UI.Themes)})),define("common/main/lib/controller/Desktop",["core"],(function(){"use strict";var t=window.DE||window.PE||window.SSE||window.PDFE,e=Object.assign({version:"7.5.1.0",eventloading:!0,titlebuttons:!0,uithemes:!0,btnhome:!0,quickprint:!0},t.features),i=window.desktop||window.AscDesktopEditor;i&&i.execCommand("webapps:features",JSON.stringify(e));!Common.Controllers&&(Common.Controllers={}),Common.Controllers.Desktop=new function(){var n,o={version:"7.5.1.0"},s={"btn-save":"save","btn-save-coauth":"coauth","btn-synch":"synch"};let a=[];var l,c;if(i){if(i.features=i.features||{},l=window.RendererProcessVariable,window.on_native_message=function(e,s){if(/^style:change/.test(e)){if("toolbar"==(r=JSON.parse(s)).element)"off"==r.action&&"native-color"==r.style&&$(".toolbar").removeClass("editor-native-color");else if("body"==r.element&&"merge"==r.action){var a=document.createElement("style");a.innerHTML=r.style,document.body.appendChild(a)}}else if(/window:features/.test(e)){var r=JSON.parse(s);_.isNumber(r.skiptoparea)&&($(".asc-window.modal").length&&$(".asc-window.modal").position().top<r.skiptoparea&&$(".asc-window.modal").css("top",r.skiptoparea),Common.Utils.InternalSettings.set("window-inactive-area-top",r.skiptoparea)),void 0!==r.singlewindow&&(i.features.singlewindow=r.singlewindow,o.isFillFormApp?$("#title-doc-name")[r.singlewindow?"hide":"show"]():n&&n.home&&n.home.btn.setVisible(r.singlewindow))}else if(/editor:config/.test(e)){if("request"==s){var l={user:o.user,title:{buttons:[]}};if(n){if(!$.isEmptyObject(n))if(t.getController("Viewport").getView("Common.Views.Header"))for(var c in n)l.title.buttons.push(m(c,n[c]));i.execCommand("editor:config",JSON.stringify(l))}else o.callback_editorconfig||(o.callback_editorconfig=function(){setTimeout((function(){window.on_native_message(e,s)}),0)})}}else if(/button:click/.test(e)){(r=JSON.parse(s)).action&&n[r.action]&&n[r.action].btn.click()}else if(/theme:changed/.test(e))Common.UI.Themes.setTheme(s);else if(/renderervars:changed/.test(e)){const t=JSON.parse(s);t.theme&&t.theme.system&&(window.RendererProcessVariable.theme.system=t.theme.system,"theme-system"==Common.UI.Themes.currentThemeId()&&Common.UI.Themes.refreshTheme(!0))}else if(/element:show/.test(e)){var d=/title:(?:(true|show)|(false|hide))/.exec(s);d&&(d[1]?$("#app-title").show():d[2]&&$("#app-title").hide())}else/althints:show/.test(e)?/false|hide/.test(s)&&Common.NotificationCenter.trigger("hints:clear"):/file:print/.test(e)?t.getController("Main").onPrint():/file:saveas/.test(e)?t.getController("Main").api.asc_DownloadAs():/file:save/.test(e)&&t.getController("Main").api.asc_Save()},window.on_native_message("editor:config","request"),window.native_message_cmd)for(var d in window.native_message_cmd)"uitheme:changed"!=d&&window.on_native_message(d,window.native_message_cmd[d]);i.execCommand("webapps:features",JSON.stringify(e)),window.onupdaterecents=function(t){a=S(t),Common.NotificationCenter.trigger("update:recents",a)};var h=document.createElement("style");h.appendChild(document.createTextNode(".modals-mask{opacity:0 !important;}")),document.getElementsByTagName("head")[0].appendChild(h)}var m=function(t,e){return{action:t,icon:e.icon||void 0,hint:e.btn.options.hint,disabled:e.btn.isDisabled(),visible:e.visible}},u=function(t,e,n){var o={};o[t]=n,i.execCommand("title:button",JSON.stringify({disabled:o}))},p=function(t,e){i.execCommand("title:button",JSON.stringify({"icon:changed":{save:s[e.next]}}))},f=function(t){if("open"==t)i.execCommand("title:button",JSON.stringify({disabled:{all:!0}}));else{var e={};for(var o in n)e[o]=n[o].btn.isDisabled();i.execCommand("title:button",JSON.stringify({disabled:e}))}},g=function(t,e){let o={visible:t&&!(e>0)};n&&(o.hints={},n.print&&(o.hints.print=n.print.btn.btnEl.attr("data-hint-title")),n.quickprint&&(o.hints.quickprint=n.quickprint.btn.btnEl.attr("data-hint-title")),n.undo&&(o.hints.undo=n.undo.btn.btnEl.attr("data-hint-title")),n.redo&&(o.hints.redo=n.redo.btn.btnEl.attr("data-hint-title")),n.save&&(o.hints.save=n.save.btn.btnEl.attr("data-hint-title"))),i.execCommand("althints:show",JSON.stringify(o))},b=function(t){Common.UI.HintManager&&Common.UI.HintManager.isHintVisible()&&(i.execCommand("althints:keydown",JSON.stringify({code:t.keyCode})),console.log("hint keydown",t.keyCode))};const v=function(t){if(n.quickprint){const t=window.SSE?"sse-settings-quick-print-button":window.PE?"pe-settings-quick-print-button":window.PDFE?"pdfe-settings-quick-print-button":"de-settings-quick-print-button",e=Common.localStorage.getBool(t,!1);if(n.quickprint.visible!=e){n.quickprint.visible=e;const t={visible:{quickprint:e}};i.execCommand("title:button",JSON.stringify(t))}}},C=function(){const t=this,e=function(t,e,i){return(/\/$/.test(t)?t:t+"/")+e+i};fetch(e("resources/help/",Common.Locale.getDefaultLanguage(),"/Contents.json")).then((function(t){t.ok&&fetch(e("resources/help/",Common.Locale.getCurrentLanguage(),"/Contents.json")).then((function(t){t.ok&&(c=e("resources/help/",Common.Locale.getCurrentLanguage(),""))})).catch((function(t){c=e("resources/help/",Common.Locale.getDefaultLanguage(),"")}))})).catch((function(i){t.helpUrl()&&fetch(e(t.helpUrl(),Common.Locale.getDefaultLanguage(),"/Contents.json")).then((function(t){return t.json()})).then((function(i){fetch(e(t.helpUrl(),Common.Locale.getCurrentLanguage(),"/Contents.json")).then((function(t){return t.json()})).then((function(i){c=e(t.helpUrl(),Common.Locale.getCurrentLanguage(),"")})).catch((function(i){c=e(t.helpUrl(),Common.Locale.getDefaultLanguage(),"")}))})).catch((function(t){}))}))},y=function(t){_.extend(o,t),i&&i.execCommand("doc:onready",""),i&&i.LocalFileRecents(),$(".toolbar").addClass("editor-native-color")},w=function(){if(o.isEdit){const o=t.getController("Viewport").getView("Common.Views.Header"),s=t.getController("Main").api,a=s.asc_getLocalRestrictions?s.asc_getLocalRestrictions():Asc.c_oAscLocalRestrictionType.None;Asc.c_oAscLocalRestrictionType.None!==a&&(e.readonly=!0,o.setDocumentReadOnly(!0),s.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None),new Common.UI.SynchronizeTip({extCls:"no-arrow",placement:"bottom",target:$(".toolbar"),text:(n=a,n===Asc.c_oAscLocalRestrictionType.ReadOnly?Common.Locale.get("tipFileReadOnly",{name:"Common.Translation",default:"Document is read only. You can make changes and save its local copy later."}):Common.Locale.get("tipFileLocked",{name:"Common.Translation",default:"Document is locked for editing. You can make changes and save its local copy later."})),showLink:!1}).on("closeclick",(function(){this.close()})).show(),i.execCommand("webapps:features",JSON.stringify(e)),s.asc_registerCallback("asc_onDocumentName",(function(){e.readonly&&s.asc_getLocalRestrictions()==Asc.c_oAscLocalRestrictionType.None&&(e.readonly=!1,o.setDocumentReadOnly(!1),i.execCommand("webapps:features",JSON.stringify(e)))})))}var n;C.call(this)},x=function(a){if(e.viewmode=!a.isEdit,e.viewmode&&(e.btnhome=!1),e.crypted=a.isCrypted,i.execCommand("webapps:features",JSON.stringify(e)),n={},a.isEdit){var r=t.getController("Viewport").getView("Common.Views.Header");if(r.btnHome=new Common.UI.Button({cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-home",visible:!1,hint:Common.Locale.get("hintBtnHome",{name:"Common.Controllers.Desktop",default:"Show Main window"}),dataHint:"0",dataHintDirection:"right",dataHintOffset:"10, -18",dataHintTitle:"K"}).render($("#box-document-title #slot-btn-dt-home")),n.home={btn:r.btnHome},r.btnHome.on("click",(function(t){i.execCommand("title:button",JSON.stringify({click:"home"}))})),$("#id-box-doc-name").on({dblclick:function(t){i.execCommand("title:dblclick",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mousedown:function(t){i.execCommand("title:mousedown",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mousemove:function(t){i.execCommand("title:mousemove",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mouseup:function(t){i.execCommand("title:mouseup",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))}}),r.btnSave){n.save={btn:r.btnSave};var l=/\s?([^\s]+)$/.exec(n.save.btn.$icon.attr("class"));l&&l.length&&(n.save.icon=s[l])}for(var c in r.btnPrint&&(n.print={btn:r.btnPrint}),r.btnPrintQuick&&(n.quickprint={btn:r.btnPrintQuick,visible:r.btnPrintQuick.isVisible()}),r.btnUndo&&(n.undo={btn:r.btnUndo}),r.btnRedo&&(n.redo={btn:r.btnRedo}),n)n[c].btn.options.signals=["disabled"],n[c].btn.on("disabled",u.bind(this,c));n.save&&(n.save.btn.options.signals.push("icon:changed"),n.save.btn.on("icon:changed",p.bind(this)))}o.callback_editorconfig&&(o.callback_editorconfig(),delete o.callback_editorconfig),void 0!==i.features.singlewindow&&(o.isFillFormApp&&$("#title-doc-name")[i.features.singlewindow?"hide":"show"](),n.home&&n.home.btn.setVisible(i.features.singlewindow))},S=function(t){let e=[];const i=/Win/.test(navigator.platform)?/([^\\/]+\.[a-zA-Z0-9]{1,})$/:/([^/]+\.[a-zA-Z0-9]{1,})$/;for(let n in t){const o=t[n];if(r.matchFileFormat(o.type)&&i.test(o.path)){const t=i.exec(o.path)[1],n=o.path.slice(0,o.path.length-t.length-1);e.push({fileid:o.id,type:o.type,format:r.parseFileFormat(o.type),title:t,url:o.path,folder:n})}}return e},k=function(t,e,i){console.log("open recent")},T=function(e){console.log("extend menu file");{const e=t.getController("LeftMenu").leftMenu.getMenu("file");if(e.miNew.visible){const t=new Common.UI.MenuItem({el:$('<li id="fm-btn-create-fromtpl" class="fm-btn"></li>'),action:"create:fromtemplate",caption:A("itemCreateFromTemplate","Create from template"),canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]});t.$el.insertAfter(e.miNew.$el),e.items.push(t)}}},A=function(t,e){return Common.Locale.get(t,{name:"Common.Controllers.Desktop",default:e})};return{init:function(n){if(_.extend(o,n),o.isDesktopApp){let n=l&&"winxp"===l.os;Common.UI.Themes.setAvailable(!n),Common.NotificationCenter.on({"app:ready":y,"document:ready":w.bind(this),"app:face":x.bind(this),"modal:show":f.bind(this,"open"),"modal:close":f.bind(this,"close"),"modal:hide":f.bind(this,"hide"),"uitheme:changed":function(t){if(window.uitheme.is_theme_system())i.execCommand("uitheme:changed",JSON.stringify({name:"theme-system"}));else{var e=Common.UI.Themes.get(t);e&&i.execCommand("uitheme:changed",JSON.stringify({name:t,type:e.type}))}},"hints:show":g.bind(this)}),t.addListeners({FileMenu:{"item:click":function(t,e,n){"file:exit"==e?(i.execCommand("editor:event",JSON.stringify({action:"file:close"})),t.hide()):"file:open"==e?(i.execCommand("editor:event",JSON.stringify({action:"file:open"})),t.hide()):"create:fromtemplate"==e&&(i.execCommand("create:new","template:"+(window.SSE?"cell":window.PE?"slide":"word")),t.hide())},"settings:apply":v.bind(this),"recent:open":k.bind(this),"render:after":T}},{id:"desktop"}),$(document).on("keydown",b.bind(this)),"fillform"==e.uitype&&(o.isFillFormApp=!0,$("#header-logo, .brand-logo").hide())}},process:function(t){if(o.isDesktopApp&&i){if("goback"==t)return i.execCommand("go:folder",o.isOffline?"offline":o.customization.goback.url),!0;if("preloader:hide"==t)return i.execCommand("editor:onready",""),!0;if("create:new"==t&&"desktop://create.new"==o.createUrl)return i.execCommand("create:new",window.SSE?"cell":window.PE?"slide":"word"),!0}return!1},requestClose:function(){o.isDesktopApp&&i&&i.execCommand("editor:event",JSON.stringify({action:"file:close",url:o.customization.goback.url}))},isActive:function(){return!!i},isOffline:function(){return o.isFillFormApp?t.getController("ApplicationController").appOptions.isOffline:t.getController("Main").appOptions.isOffline},isFeatureAvailable:function(t){return!!i&&!!i[t]},isWinXp:function(){return l&&"winxp"===l.os},call:function(t){if(i[t]){let e=[].slice.call(arguments,1);return i[t].apply(this,e)}},helpUrl:function(){if(c)return c;if(l&&l.helpUrl){var t=window.SSE?"spreadsheeteditor":window.PE?"presentationeditor":window.PDFE?"pdfeditor":"documenteditor";return l.helpUrl+"/"+t+"/main/resources/help"}},isHelpAvailable:function(){return!!c},getDefaultPrinterName:function(){return l?l.defaultPrinterName:""},systemThemeType:function(){return l.theme&&l.theme.system?l.theme.system:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},systemThemeSupported:function(){return l.theme&&"disabled"!==l.theme.system},localThemes:function(){return l?l.localthemes:void 0},recentFiles:function(){return a},openRecent:function(t){if(this.isActive()){const e={name:Common.Utils.String.htmlDecode(t.get("title")),path:Common.Utils.String.htmlDecode(t.get("url"))};return null!=t.get("fileid")&&null!=t.get("fileid")?(e.id=t.get("fileid"),e.type=t.type):e.id=-1,i.execCommand("open:recent",JSON.stringify(e)),!0}return!1}}};const n=64,o=128,s=256,a=512,r={defines:{}};r.defines.FileFormat={FILE_UNKNOWN:0,FILE_DOCUMENT:n,FILE_DOCUMENT_DOCX:65,FILE_DOCUMENT_DOC:66,FILE_DOCUMENT_ODT:67,FILE_DOCUMENT_RTF:68,FILE_DOCUMENT_TXT:69,FILE_DOCUMENT_HTML:70,FILE_DOCUMENT_MHT:71,FILE_DOCUMENT_EPUB:72,FILE_DOCUMENT_FB2:73,FILE_DOCUMENT_MOBI:74,FILE_DOCUMENT_DOCM:75,FILE_DOCUMENT_DOTX:76,FILE_DOCUMENT_DOTM:77,FILE_DOCUMENT_ODT_FLAT:78,FILE_DOCUMENT_OTT:79,FILE_DOCUMENT_DOC_FLAT:80,FILE_DOCUMENT_OFORM:85,FILE_DOCUMENT_DOCXF:86,FILE_PRESENTATION:o,FILE_PRESENTATION_PPTX:129,FILE_PRESENTATION_PPT:130,FILE_PRESENTATION_ODP:131,FILE_PRESENTATION_PPSX:132,FILE_PRESENTATION_PPTM:133,FILE_PRESENTATION_PPSM:134,FILE_PRESENTATION_POTX:135,FILE_PRESENTATION_POTM:136,FILE_PRESENTATION_ODP_FLAT:137,FILE_PRESENTATION_OTP:138,FILE_SPREADSHEET:s,FILE_SPREADSHEET_XLSX:257,FILE_SPREADSHEET_XLS:258,FILE_SPREADSHEET_ODS:259,FILE_SPREADSHEET_CSV:260,FILE_SPREADSHEET_XLSM:261,FILE_SPREADSHEET_XLTX:262,FILE_SPREADSHEET_XLTM:263,FILE_SPREADSHEET_ODS_FLAT:264,FILE_SPREADSHEET_OTS:265,FILE_CROSSPLATFORM:a,FILE_CROSSPLATFORM_PDF:513,FILE_CROSSPLATFORM_SWF:514,FILE_CROSSPLATFORM_DJVU:515,FILE_CROSSPLATFORM_XPS:516,FILE_CROSSPLATFORM_PDFA:521},r.parseFileFormat=function(t){switch(t){case r.defines.FileFormat.FILE_DOCUMENT_DOC:return"doc";case r.defines.FileFormat.FILE_DOCUMENT_DOCX:return"docx";case r.defines.FileFormat.FILE_DOCUMENT_ODT:return"odt";case r.defines.FileFormat.FILE_DOCUMENT_RTF:return"rtf";case r.defines.FileFormat.FILE_DOCUMENT_TXT:return"txt";case r.defines.FileFormat.FILE_DOCUMENT_HTML:return"htm";case r.defines.FileFormat.FILE_DOCUMENT_MHT:return"mht";case r.defines.FileFormat.FILE_DOCUMENT_EPUB:return"epub";case r.defines.FileFormat.FILE_DOCUMENT_FB2:return"fb2";case r.defines.FileFormat.FILE_DOCUMENT_DOTX:return"dotx";case r.defines.FileFormat.FILE_DOCUMENT_OTT:return"ott";case r.defines.FileFormat.FILE_DOCUMENT_OFORM:return"oform";case r.defines.FileFormat.FILE_DOCUMENT_DOCXF:return"docxf";case r.defines.FileFormat.FILE_SPREADSHEET_XLS:return"xls";case r.defines.FileFormat.FILE_SPREADSHEET_XLTX:return"xltx";case r.defines.FileFormat.FILE_SPREADSHEET_XLSX:return"xlsx";case r.defines.FileFormat.FILE_SPREADSHEET_ODS:return"ods";case r.defines.FileFormat.FILE_SPREADSHEET_CSV:return"csv";case r.defines.FileFormat.FILE_SPREADSHEET_OTS:return"ots";case r.defines.FileFormat.FILE_PRESENTATION_PPT:return"ppt";case r.defines.FileFormat.FILE_PRESENTATION_POTX:return"potx";case r.defines.FileFormat.FILE_PRESENTATION_PPTX:return"pptx";case r.defines.FileFormat.FILE_PRESENTATION_ODP:return"odp";case r.defines.FileFormat.FILE_PRESENTATION_PPSX:return"ppsx";case r.defines.FileFormat.FILE_PRESENTATION_OTP:return"otp";case r.defines.FileFormat.FILE_CROSSPLATFORM_PDFA:case r.defines.FileFormat.FILE_CROSSPLATFORM_PDF:return"pdf";case r.defines.FileFormat.FILE_CROSSPLATFORM_DJVU:return"djvu";case r.defines.FileFormat.FILE_CROSSPLATFORM_XPS:return"xps"}return""},r.matchFileFormat=function(t){return window.PE?t>r.defines.FileFormat.FILE_PRESENTATION&&!(t>r.defines.FileFormat.FILE_SPREADSHEET):window.DE?t>r.defines.FileFormat.FILE_DOCUMENT&&!(t>r.defines.FileFormat.FILE_PRESENTATION)||t==r.defines.FileFormat.FILE_CROSSPLATFORM_PDF||t==r.defines.FileFormat.FILE_CROSSPLATFORM_PDFA||t==r.defines.FileFormat.FILE_CROSSPLATFORM_DJVU:window.SSE?t>r.defines.FileFormat.FILE_SPREADSHEET&&!(t>r.defines.FileFormat.FILE_CROSSPLATFORM)||t==r.defines.FileFormat.FILE_CROSSPLATFORM_XPS:!!window.PDFE&&(t==r.defines.FileFormat.FILE_CROSSPLATFORM_PDFA||t==r.defines.FileFormat.FILE_CROSSPLATFORM_PDF||t==r.defines.FileFormat.FILE_CROSSPLATFORM_DJVU||t==r.defines.FileFormat.FILE_CROSSPLATFORM_XPS)}})),define("text",["module"],(function(t){"use strict";var e,i,n,o,s,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,m=c&&(location.port||void 0),u={},p=t.config&&t.config()||{};return e={version:"2.0.10",strip:function(t){if(t){var e=(t=t.replace(r,"")).match(l);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=a[e];try{t=new ActiveXObject(i)}catch(t){}if(t){a=[i];break}}return t},parseName:function(t){var e,i,n,o=!1,s=t.indexOf("."),a=0===t.indexOf("./")||0===t.indexOf("../");return-1!==s&&(!a||s>1)?(e=t.substring(0,s),i=t.substring(s+1,t.length)):e=t,-1!==(s=(n=i||e).indexOf("!"))&&(o="strip"===n.substring(s+1),n=n.substring(0,s),i?i=n:e=n),{moduleName:e,ext:i,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,o){var s,a,r,l=e.xdRegExp.exec(t);return!l||(s=l[2],r=(a=(a=l[3]).split(":"))[1],a=a[0],!(s&&s!==i||a&&a.toLowerCase()!==n.toLowerCase()||(r||a)&&r!==o))},finishLoad:function(t,i,n,o){n=i?e.strip(n):n,p.isBuild&&(u[t]=n),o(n)},load:function(t,i,n,o){if(!o.isBuild||o.inlineText){p.isBuild=o.isBuild;var s=e.parseName(t),a=s.moduleName+(s.ext?"."+s.ext:""),r=i.toUrl(a),l=p.useXhr||e.useXhr;0!==r.indexOf("empty:")?!c||l(r,d,h,m)?e.get(r,(function(i){e.finishLoad(t,s.strip,i,n)}),(function(t){n.error&&n.error(t)})):i([a],(function(t){e.finishLoad(s.moduleName+"."+s.ext,s.strip,t,n)})):n()}else n()},write:function(t,i,n,o){if(u.hasOwnProperty(i)){var s=e.jsEscape(u[i]);n.asModule(t+"!"+i,"define(function () { return '"+s+"';});\n")}},writeFile:function(t,i,n,o,s){var a=e.parseName(i),r=a.ext?"."+a.ext:"",l=a.moduleName+r,c=n.toUrl(a.moduleName+r)+".js";e.load(l,n,(function(i){var n=function(t){return o(c,t)};n.asModule=function(t,e){return o.asModule(t,c,e)},e.write(t,l,n,s)}),s)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var o=i.readFileSync(t,"utf8");0===o.indexOf("\ufeff")&&(o=o.substring(1)),e(o)}catch(t){n(t)}}):"xhr"===p.env||!p.env&&e.createXhr()?e.get=function(t,i,n,o){var s,a=e.createXhr();if(a.open("GET",t,!0),o)for(s in o)o.hasOwnProperty(s)&&a.setRequestHeader(s.toLowerCase(),o[s]);p.onXhr&&p.onXhr(a,t),a.onreadystatechange=function(e){var o,s;4===a.readyState&&((o=a.status)>399&&o<600?((s=new Error(t+" HTTP status: "+o)).xhr=a,n(s)):i(a.responseText),p.onXhrComplete&&p.onXhrComplete(a,t))},a.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,o=new java.io.File(t),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),"utf-8")),r="";try{for(i=new java.lang.StringBuffer,(n=a.readLine())&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(s),i.append(n);r=String(i.toString())}finally{a.close()}e(r)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,o=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,a,r,l={};s&&(t=t.replace(/\//g,"\\")),r=new FileUtils.File(t);try{(i=n["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream)).init(r,1,0,!1),(a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream)).init(i,"utf-8",i.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),l),a.close(),i.close(),e(l.value)}catch(t){throw new Error((r&&r.path||"")+": "+t)}}),e})),define("text!common/main/lib/template/Header.template",[],(function(){return'<div id="header-container">\n    <div id="header-logo"></div>\n    <div id="header-caption"><div><%= headerCaption %></div></div>\n    <div id="header-documentcaption"><div><%= documentCaption %></div></div>\n    <div id="header-back" style="display: <%= canBack ? \'table-cell\' : \'none\' %>;"><div><%= textBack %></div></div>\n</div>'})),void 0===Common)var Common={};if(define("common/main/lib/component/BaseView",["backbone"],(function(t){"use strict";Common.UI=_.extend(Common.UI||{},{Keys:{BACKSPACE:8,TAB:9,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,HOME:36,END:35,SPACE:32,PAGEUP:33,PAGEDOWN:34,INSERT:45,ZERO:48,EQUALITY_FF:61,NUM_ZERO:96,NUM_PLUS:107,NUM_MINUS:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,MINUS_FF:173,EQUALITY:187,MINUS:189},BaseView:t.View.extend({isSuspendEvents:!1,initialize:function(t){this.options=this.options?_({}).extend(this.options,t):t},setVisible:function(t){return this[t?"show":"hide"]()},isVisible:function(){return $(this.el).is(":visible")},suspendEvents:function(){this.isSuspendEvents=!0},resumeEvents:function(){this.isSuspendEvents=!1}}),getId:function(t){return _.uniqueId(t||"asc-gen")}})})),void 0===Common)var Common={};if(define("common/main/lib/component/CheckBox",["common/main/lib/component/BaseView","underscore"],(function(t,e){"use strict";Common.UI.CheckBox=Common.UI.BaseView.extend({options:{labelText:""},disabled:!1,rendered:!1,indeterminate:!1,checked:!1,value:"unchecked",template:e.template('<label class="checkbox-indeterminate"><input id="<%= id %>" type="checkbox" class="checkbox__native"><label for="<%= id %>" class="checkbox__shape" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"></label><span></span></label>'),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(t){var e=this;if(!e.rendered){var i=this.template({id:Common.UI.getId("chb-"),dataHint:e.options.dataHint,dataHintDirection:e.options.dataHintDirection,dataHintOffset:e.options.dataHintOffset});t?(this.setElement(t,!1),t.html(i)):e.$el.html(i),this.$chk=e.$el.find("input[type=checkbox]"),this.$label=e.$el.find("label.checkbox-indeterminate"),this.$span=e.$label.find("span"),this.$chk.on("click",this.onItemCheck.bind(this)),this.$label.on("keydown",this.onKeyDown.bind(this)),this.rendered=!0}return this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.value&&this.setValue(this.options.value,!0),this.setCaption(this.options.labelText),this},setDisabled:function(t){this.rendered&&((t=!0===t)!==this.disabled&&(this.$label.toggleClass("disabled",t),t?this.$chk.attr({disabled:t}):this.$chk.removeAttr("disabled"),void 0!==this.tabindex&&(t&&(this.tabindex=this.$label.attr("tabindex")),this.$label.attr("tabindex",t?"-1":this.tabindex))),this.disabled=t)},isDisabled:function(){return this.disabled},onItemCheck:function(t){this.disabled||(this.indeterminate?(this.indeterminate=!1,this.setValue(!1)):this.setValue(!this.checked))},setRawValue:function(t){this.checked=!0===t||"true"===t||"1"===t||1===t||"checked"===t,this.indeterminate="indeterminate"===t,this.value=this.indeterminate?"indeterminate":this.checked?"checked":"unchecked",this.$chk.prop({indeterminate:this.indeterminate,checked:this.checked})},setValue:function(t,e){this.rendered?t!=this.value&&(this.lastValue=this.value,this.setRawValue(t),!0!==e&&this.trigger("change",this,this.value,this.lastValue)):this.options.value=t},getValue:function(){return this.value},isChecked:function(){return this.checked},setCaption:function(t){this.$span.text(t),this.$span.css("visibility",t?"visible":"hidden")},onKeyDown:function(t){t.isDefaultPrevented()||t.keyCode===Common.UI.Keys.SPACE&&this.onItemCheck(t)},focus:function(){this.$label&&this.$label.focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),!this.disabled&&this.$label.attr("tabindex",this.tabindex))}})})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.FocusManager=new function(){var t=[],e=0,i=function(t){var e=[];return t.forEach||(t=[t]),t.forEach((function(t){if(t){var i={};t.cmp&&"string"==typeof t.selector?i=t:(i.cmp=t,Common.UI.ListView&&t instanceof Common.UI.ListView?i.selector=".listview":t instanceof Common.UI.CheckBox?i.selector=".checkbox-indeterminate":t instanceof Common.UI.RadioBox?i.selector=".radiobox":t instanceof Common.UI.TreeView?i.selector=".treeview":t instanceof Common.UI.Button?i.selector="button":i.selector=".form-control"),i.el=(i.cmp.$el||$(i.cmp.el||i.cmp)).find(i.selector).addBack().filter(i.selector),i.el&&i.el.attr&&(i.cmp.setTabIndex?i.cmp.setTabIndex(1):i.el.attr("tabindex",1..toString())),e.push(i)}})),e},n=function(t){if(t&&!t.traps&&t.fields&&!(t.fields.length<1)){var e=$('<span aria-hidden="true" tabindex="1"></span>');e.on("focus",(function(){if(!t.hidden)for(var e=t.fields,i=e.length-1;i>=0;i--){var n=e[i];if((n.cmp.isVisible?n.cmp.isVisible():n.cmp.is(":visible"))&&(!n.cmp.isDisabled||!n.cmp.isDisabled())){var o=n.selector?(n.cmp.$el||$(n.cmp.el||n.cmp)).find(n.selector).addBack().filter(n.selector):n.el;o&&setTimeout((function(){o.focus()}),10);break}}})),t.parent.$window.prepend(e);var i=$('<span aria-hidden="true" tabindex="2"></span>');i.on("focus",(function(){if(!t.hidden)for(var e=t.fields,i=0;i<e.length;i++){var n=e[i];if((n.cmp.isVisible?n.cmp.isVisible():n.cmp.is(":visible"))&&(!n.cmp.isDisabled||!n.cmp.isDisabled())){var o=n.selector?(n.cmp.$el||$(n.cmp.el||n.cmp)).find(n.selector).addBack().filter(n.selector):n.el;o&&setTimeout((function(){o.focus()}),10);break}}})),t.parent.$window.append(i),t.traps=[e,i]}},o=function(i){var n=i?1:-1;for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];s&&s.index<e-1&&s.traps&&s.traps[1].attr("tabindex",(parseInt(s.traps[1].attr("tabindex"))+n).toString())}};return{init:function(){Common.NotificationCenter.on({"modal:show":function(i){i&&i.cid&&(t[i.cid]?t[i.cid].hidden=!1:(t[i.cid]={parent:i,hidden:!1,index:e++},o(!0)))},"window:show":function(e){e&&e.cid&&t[e.cid]&&!t[e.cid].fields&&(t[e.cid].fields=i(e.getFocusedComponents()),n(t[e.cid]));var o=e?e.getDefaultFocusableComponent():null;o&&setTimeout((function(){o.focus()}),100)},"modal:close":function(i,n){i&&i.cid&&t[i.cid]&&(o(!1),delete t[i.cid],e--)},"modal:hide":function(e,i){e&&e.cid&&t[e.cid]&&(t[e.cid].hidden=!0)}})},add:function(o,s){o&&o.cid&&(t[o.cid]?t[o.cid].fields=(t[o.cid].fields||[]).concat(i(s)):t[o.cid]={parent:o,fields:i(s),hidden:!1,index:e++},n(t[o.cid]))}}},define("common/main/lib/controller/FocusManager",(function(){})),void 0===Common)var Common={};if(define("common/main/lib/component/Window",["common/main/lib/component/BaseView","common/main/lib/component/CheckBox","common/main/lib/controller/FocusManager"],(function(){"use strict";Common.UI.Window=Common.UI.BaseView.extend(_.extend(function(){var t={closable:!0,header:!0,modal:!0,width:"auto",height:"auto",title:"Title",alias:"Window",cls:"",toolclose:"close",help:!1,maxwidth:void 0,maxheight:void 0,minwidth:0,minheight:0,enableKeyEvents:!0,automove:!0};function e(){var t=$(".modals-mask");return 0==t.length&&(t=$("<div class='modals-mask'>").appendTo(document.body).hide()).attr("counter",0),t}function i(t){if(!this.isLocked()&&this.isVisible()&&this.initConfig.enableKeyEvents&&!1!==this.pauseKeyEvents)switch(t.keyCode){case Common.UI.Keys.ESC:if($(".asc-loadmask").length<1)return t.preventDefault(),t.stopPropagation(),!1!==this.initConfig.closable&&(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close()),!1;break;case Common.UI.Keys.RETURN:if(this.$window.find(".btn.primary").length&&$(".asc-loadmask").length<1&&!1===(this.initConfig.onprimary||this.onPrimary).call(this))return t.preventDefault(),!1}}function n(){if(null==window.innerHeight)var t=document.documentElement.offsetWidth,e=document.documentElement.offsetHeight;else t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight();return{width:t,height:e-=Common.Utils.InternalSettings.get("window-inactive-area-top"),top:Common.Utils.InternalSettings.get("window-inactive-area-top")}}function o(){if("auto"==this.initConfig.height){var t=Math.ceil(parseFloat(this.$window.find("> .body").css("height")));this.initConfig.header&&(t+=parseInt(this.$window.find("> .header").css("height"))),this.$window.height(t)}}function s(){var t=n(),e=t.width,i=t.height;if("auto"==this.initConfig.height){var o=parseInt(this.$window.find(".body").css("height"));this.initConfig.header&&(o+=parseInt(this.$window.find(".header").css("height")))}else(o=this.initConfig.height)>i&&(o=i);var s="auto"==this.initConfig.width?parseInt(this.$window.find(".body").css("width")):this.initConfig.width,a=t.top+Math.floor((parseInt(i)-parseInt(o))/2),r=Math.floor((parseInt(e)-parseInt(s))/2);this.$window.css({left:r<0?0:r,top:a<0?0:a})}function a(){var t=n(),e=t.width,i=t.height;this.getLeft()+this.getWidth()>e&&this.$window.css("left",e-this.getWidth()),this.getTop()<t.top?this.$window.css("top",t.top):this.getTop()+this.getHeight()>i&&(i-this.getHeight()<0?this.$window.css("top",t.top):this.$window.css("top",t.top+i-this.getHeight()))}function r(t){return{"-webkit-transition":"0.3s opacity","-moz-transition":"0.3s opacity","-ms-transition":"0.3s opacity","-o-transition":"0.3s opacity",opacity:t}}function l(t){if(!$(t.target).hasClass("close")&&!$(t.target).hasClass("help")){Common.UI.Menu.Manager.hideAll();var e=t instanceof jQuery.Event?Common.Utils.zoom():1;this.dragging.enabled=!0,this.dragging.initx=t.pageX*e-this.getLeft(),this.dragging.inity=t.pageY*e-this.getTop();var i=n(),o=i.width,s=i.height;this.dragging.maxx=o-this.getWidth(),this.dragging.maxy=s-this.getHeight(),this.dragging.maxy<0&&(this.dragging.maxy=0),this.dragging.maxy+=i.top,$(document).on("mousemove",this.binding.drag),$(document).on("mouseup",this.binding.dragStop),this.fireEvent("drag",[this,"start"])}}function c(){$(document).off("mousemove",this.binding.drag),$(document).off("mouseup",this.binding.dragStop),this.dragging.enabled=!1,this.fireEvent("drag",[this,"end"])}function d(t){if(this.dragging.enabled){var e=t instanceof jQuery.Event?Common.Utils.zoom():1,i=t.pageX*e-this.dragging.initx,n=t.pageY*e-this.dragging.inity,o=Common.Utils.InternalSettings.get("window-inactive-area-top");i<0?i=0:i>this.dragging.maxx&&(i=this.dragging.maxx),n<o?n=o:n>this.dragging.maxy&&(n=this.dragging.maxy),this.$window.css({left:i,top:n})}}function h(t){"mouseup"==t.type&&this.dragging.enabled&&c.call(this)}function m(){var t=n(),e=t.width,i=t.height,o=this.getHeight(),s=this.getWidth(),a=this.getTop(),r=this.getLeft();a=a+o>i?i-o:a,r=r+s>e?e-s:r,this.$window.css({left:r<0?0:r,top:a<0?0:a})}function u(t){Common.UI.Menu.Manager.hideAll();var e=$(t.target),i=this.getLeft(),o=this.getTop();this.resizing.enabled=!0,this.resizing.initpage_x=t.pageX*Common.Utils.zoom(),this.resizing.initpage_y=t.pageY*Common.Utils.zoom(),this.resizing.initx=this.resizing.initpage_x-i,this.resizing.inity=this.resizing.initpage_y-o,this.resizing.initw=this.getWidth(),this.resizing.inith=this.getHeight(),this.resizing.type=[e.hasClass("left")?-1:e.hasClass("right")?1:0,e.hasClass("top")?-1:e.hasClass("bottom")?1:0];var s=n(),a=s.width,r=s.height,l=this.initConfig.maxwidth?this.initConfig.maxwidth:a,c=this.initConfig.maxheight?this.initConfig.maxheight:r;this.resizing.minw=this.initConfig.minwidth,this.resizing.maxw=this.resizing.type[0]>0?Math.min(a-i,l):Math.min(i+this.resizing.initw,l),this.resizing.minh=this.initConfig.minheight,this.resizing.maxh=this.resizing.type[1]>0?Math.min(r-o,c):Math.min(o+this.resizing.inith,c),$(document.body).css("cursor",e.css("cursor")),this.$window.find(".resize-border").addClass("resizing"),this.$window.find(".header").addClass("resizing"),$(document).on("mousemove",this.binding.resize),$(document).on("mouseup",this.binding.resizeStop),this.fireEvent("resize",[this,"start"])}function p(t){if(this.resizing.enabled){var e=!1,i=t instanceof jQuery.Event?Common.Utils.zoom():1,n=t.pageX*i,o=t.pageY*i;if(this.resizing.type[0]){var s=this.resizing.initw+(n-this.resizing.initpage_x)*this.resizing.type[0];s>this.resizing.maxw?(n-=(s-this.resizing.maxw)*this.resizing.type[0],s=this.resizing.maxw):s<this.resizing.minw&&(n-=(s-this.resizing.minw)*this.resizing.type[0],s=this.resizing.minw),this.resizing.type[0]<0&&this.$window.css({left:n-this.resizing.initx}),this.setWidth(s),e=!0}if(this.resizing.type[1]){var a=this.resizing.inith+(o-this.resizing.initpage_y)*this.resizing.type[1];a>this.resizing.maxh?(o-=(a-this.resizing.maxh)*this.resizing.type[1],a=this.resizing.maxh):a<this.resizing.minh&&(o-=(a-this.resizing.minh)*this.resizing.type[1],a=this.resizing.minh),this.resizing.type[1]<0&&this.$window.css({top:o-this.resizing.inity}),this.setHeight(a),e=!0}e&&this.fireEvent("resizing")}}function f(){$(document).off("mousemove",this.binding.resize),$(document).off("mouseup",this.binding.resizeStop),$(document.body).css("cursor","auto"),this.$window.find(".resize-border").removeClass("resizing"),this.$window.find(".header").removeClass("resizing"),this.resizing.enabled=!1,this.fireEvent("resize",[this,"end"])}return Common.UI.alert=function(t){this.Window.prototype;t.buttons||(t.buttons=["ok"]),t.dontshow=t.dontshow||!1,t.width||(t.width="auto");var e='<div class="info-box"><% if (typeof iconCls !== "undefined") { %><div class="icon <%= iconCls %>"></div><% } %><div class="text" <% if (typeof iconCls == "undefined") { %> style="padding-'+(Common.UI.isRTL()?"right":"left")+':10px;"<% } %>><span><%= msg %></span><% if (dontshow) { %><div class="dont-show-checkbox"></div><% } %></div></div><% if (dontshow) { %><div class="separator horizontal" style="width: 100%;"></div><% } %>';_.extend(t,{cls:"alert",onprimary:function(t){return o({currentTarget:i.getChild(".footer .dlg-btn")[0]}),!1},tpl:_.template(e)(t)});var i=new Common.UI.Window(t),n=null;function o(e){t.callback&&t.callback.call(i,e.currentTarget.attributes.result.value,!!n&&"checked"==n.getValue()),i.close(!0)}return i.on({"render:after":function(e){var s=e.getChild(".footer");t.dontshow&&s.addClass("dontshow"),s.find(".dlg-btn").on("click",o),n=new Common.UI.CheckBox({el:i.$window.find(".dont-show-checkbox"),labelText:t.textDontShow||i.textDontShow}),function(e){var i=e.getChild(".info-box"),n=e.getChild(".info-box .text > span"),o=e.getChild(".footer"),s=e.getChild(".header"),a=e.getChild(".body"),r=e.getChild(".icon"),l=r.length>0?r.height():0,c=r.length>0?$(r).outerWidth(!0):0,d=e.getChild(".info-box .dont-show-checkbox");if(t.dontshow||a.css("padding-bottom","10px"),t.maxwidth&&"auto"==t.width&&(m=Common.UI.isRTL()?parseInt(i.css("padding-right"))+c+n.width()+parseInt(i.css("padding-left")):n.position().left+n.width()+parseInt(i.css("padding-right")))>t.maxwidth&&(t.width=t.maxwidth),"auto"==t.width){i.height(Math.max(n.height(),l)+(d.length>0?d.height()+parseInt(d.css("margin-top")):0)),a.height(parseInt(i.css("height"))+parseInt(o.css("height")));var h=d.find("span"),m=Common.UI.isRTL()?parseInt(i.css("padding-right"))+c+parseInt(i.css("padding-left"))+Math.max(n.width(),d.length>0?$(d).find(".checkbox-indeterminate").outerWidth(!0):0):Math.max(n.width(),h.length>0?h.position().left+h.width():0)+n.position().left+parseInt(i.css("padding-right"));e.setSize(m,parseInt(a.css("height"))+parseInt(s.css("height")))}else n.css("white-space","normal"),e.setWidth(t.width),i.height(Math.max(n.height(),l)+(d.length>0?d.height()+parseInt(d.css("margin-top")):0)),a.height(parseInt(i.css("height"))+parseInt(o.css("height"))),e.setHeight(parseInt(a.css("height"))+parseInt(s.css("height")));n.height()<l/2&&n.css({"vertical-align":"baseline","line-height":l+"px"})}(e)},show:function(t){t.getChild(".footer .dlg-btn").focus()},close:function(){t.callback&&t.callback.call(i,"close")}}),i.show(),i},Common.UI.error=function(t){return!(t=t||{}).title&&(t.title=this.Window.prototype.textError),Common.UI.alert(_.extend(t,{iconCls:"error"}))},Common.UI.confirm=function(t){return!(t=t||{}).title&&(t.title=this.Window.prototype.textConfirmation),Common.UI.alert(_.extend(t,{iconCls:"confirm"}))},Common.UI.info=function(t){return!(t=t||{}).title&&(t.title=this.Window.prototype.textInformation),Common.UI.alert(_.extend(t,{iconCls:"info"}))},Common.UI.warning=function(t){return!(t=t||{}).title&&(t.title=this.Window.prototype.textWarning),Common.UI.alert(_.extend(t,{iconCls:"warn"}))},{$window:void 0,$lastmodal:void 0,dragging:{enabled:!1},resizing:{enabled:!1},initialize:function(e){this.initConfig={},this.binding={};var i={ok:this.okButtonText,cancel:this.cancelButtonText,yes:this.yesButtonText,no:this.noButtonText,close:this.closeButtonText};if(e.buttons&&_.isArray(e.buttons)){null==e.primary&&(e.primary="ok");var n={};_.each(e.buttons,(function(t){"object"==typeof t?void 0!==t.value&&(n[t.value]={text:t.caption,cls:"custom"+(t.primary||e.primary==t.value?" primary":"")}):void 0!==t&&(n[t]={text:"custom"==t?e.customButtonText:i[t],cls:e.primary==t||_.indexOf(e.primary,t)>-1?"primary":""},"custom"==t&&(n[t].cls+=" custom"))})),e.buttons=n,e.footerCls=e.footerCls||"center"}_.extend(this.initConfig,t,e||{}),!this.initConfig.id&&(this.initConfig.id="window-"+this.cid),!this.initConfig.tpl&&(this.initConfig.tpl=""),Common.UI.BaseView.prototype.initialize.call(this,this.initConfig)},render:function(){var t=this.initConfig.renderTo||document.body;if($(t).append(_.template('<div class="asc-window<%= modal?" modal":"" %><%= cls?" "+cls:"" %>" id="<%= id %>" style="width:<%= width %>px;"><% if (header==true) { %><div class="header"><div class="tools"><% if (closable!==false) %><div class="tool close"></div><% %><% if (help===true) %><div class="tool help">?</div><% %></div><div class="title"><%= title %></div> </div><% } %><div class="body"><%= tpl %><% if (typeof (buttons) !== "undefined" && _.size(buttons) > 0) { %><div class="footer"><% for(var bt in buttons) { %><button class="btn normal dlg-btn <%= buttons[bt].cls %>" result="<%= bt %>"><%= buttons[bt].text %></button><% } %></div><% } %></div></div>')(this.initConfig)),this.$window=$("#"+this.initConfig.id),Common.Locale.getCurrentLanguage()&&"en"!==Common.Locale.getCurrentLanguage()&&this.$window.attr("applang",Common.Locale.getCurrentLanguage()),this.binding.keydown=_.bind(i,this),this.initConfig.header){this.binding.drag=_.bind(d,this),this.binding.dragStop=_.bind(c,this),this.binding.dragStart=_.bind(l,this);this.$window.find(".header").on("mousedown",this.binding.dragStart),this.$window.find(".tool.close").on("click",_.bind((function(){this.$window.find(".tool.close").hasClass("disabled")||(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close())}),this)),this.$window.find(".tool.help").on("click",_.bind((function(){this.$window.find(".tool.help").hasClass("disabled")||this.fireEvent("help",this)}),this)),this.initConfig.modal||Common.Gateway.on("processmouse",_.bind(h,this))}else this.$window.find(".body").css({top:0,"border-radius":"5px"});"auto"!==this.initConfig.height&&this.$window.css("height",this.initConfig.height),this.initConfig.resizable&&this.setResizable(this.initConfig.resizable);var e=this;return this.binding.winclose=function(t){e.$window&&e.isVisible()&&e.$window==t.$window&&e.close()},Common.NotificationCenter.on("window:close",this.binding.winclose),this.initConfig.footerCls&&this.$window.find(".footer").addClass(this.initConfig.footerCls),this.menuAddAlign=function(t,i,n){var o=this;e.$window.hasClass("notransform")?(t.css({left:i,top:n}),o.options.additionalAlign=null):(e.$window.addClass("notransform"),t.addClass("hidden"),setTimeout((function(){t.removeClass("hidden"),t.css({left:i,top:n}),o.options.additionalAlign=null}),300))},this.fireEvent("render:after",this),this},show:function(t,i){if(this.initConfig.modal){var n=e();if(!1===this.options.animate||this.options.animate&&!1===this.options.animate.mask)n.attr("counter",parseInt(n.attr("counter"))+1),n.show();else{var l=$(":root").css("--modal-window-mask-opacity");n.css("opacity",0),n.attr("counter",parseInt(n.attr("counter"))+1),n.show(),setTimeout((function(){n.css(r(l))}),1)}Common.NotificationCenter.trigger("modal:show",this),this.$lastmodal=$(".asc-window.modal:not(.dethrone):visible").first().addClass("dethrone")}this.$window?this.$window.is(":visible")||(this.$window.css({opacity:0}),a.call(this),this.$window.show()):(this.render(),o.call(this),_.isNumber(t)&&_.isNumber(i)?(this.$window.css("left",Math.floor(t)),this.$window.css("top",Math.floor(i))):s.call(this)),$(document).on("keydown."+this.cid,this.binding.keydown),this.initConfig.automove&&(this.binding.windowresize=_.bind(m,this),$(window).on("resize",this.binding.windowresize));var c=this;setTimeout((function(){c.fireEvent("animate:before",c)}),10),!1!==this.options.animate?(this.$window.css({"-webkit-transform":"scale(0.8)","-moz-transform":"scale(0.8)","-ms-transform":"scale(0.8)","-o-transform":"scale(0.8)",opacity:0}),setTimeout((function(){c.$window.css({"-webkit-transition":"0.2s opacity, 0.2s -webkit-transform","-webkit-transform":"scale(1)","-moz-transition":"0.2s opacity, 0.2s -moz-transform","-moz-transform":"scale(1)","-ms-transition":"0.2s opacity, 0.2s -ms-transform","-ms-transform":"scale(1)","-o-transition":"0.2s opacity, 0.2s -o-transform","-o-transform":"scale(1)",opacity:"1"}),setTimeout((function(){c.fireEvent("animate:after",c)}),210)}),1),setTimeout((function(){c.$window.addClass("notransform"),c.fireEvent("show",c)}),this.initConfig.modal?1e3:350)):(this.$window.css({opacity:1}),this.$window.addClass("notransform"),this.fireEvent("show",this),setTimeout((function(){c.fireEvent("animate:after",c)}),10)),Common.NotificationCenter.trigger("window:show",this)},close:function(t){if($(document).off("keydown."+this.cid),this.initConfig.automove&&$(window).off("resize",this.binding.windowresize),this.initConfig.header&&this.$window.find(".header").off("mousedown",this.binding.dragStart),Common.NotificationCenter.off({"window:close":this.binding.winclose}),this.initConfig.modal){var i=e(),n=!0;if(i.attr("counter",parseInt(i.attr("counter"))-1),this.$lastmodal.length>0&&(this.$lastmodal.removeClass("dethrone"),n=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),n)if(!1!==this.options.animate){var o=$(":root").css("--modal-window-mask-opacity");i.css(r(0)),setTimeout((function(){parseInt(i.attr("counter"))<1&&(i.css("opacity",o),i.hide(),i.attr("counter",0))}),300)}else parseInt(i.attr("counter"))<1&&(i.hide(),i.attr("counter",0));Common.NotificationCenter.trigger("modal:close",this,n&&parseInt(i.attr("counter"))<1)}this.$window.remove(),!0!==t&&this.fireEvent("close",this)},hide:function(){if($(document).off("keydown."+this.cid),this.initConfig.automove&&$(window).off("resize",this.binding.windowresize),this.$window){if(this.initConfig.modal){var t=e(),i=!0;if(t.attr("counter",parseInt(t.attr("counter"))-1),this.$lastmodal.length>0&&(this.$lastmodal.removeClass("dethrone"),i=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),i)if(!1!==this.options.animate){var n=$(":root").css("--modal-window-mask-opacity");t.css(r(0)),setTimeout((function(){parseInt(t.attr("counter"))<1&&(t.css("opacity",n),t.hide(),t.attr("counter",0))}),300)}else parseInt(t.attr("counter"))<1&&(t.hide(),t.attr("counter",0));Common.NotificationCenter.trigger("modal:hide",this,i&&parseInt(t.attr("counter"))<1)}this.$window.hide(),this.$window.removeClass("notransform"),this.fireEvent("hide",this)}},isLocked:function(){return this.$window.hasClass("dethrone")||!this.initConfig.modal&&this.$window.parent().find(".asc-window.modal:visible").length},getChild:function(t){return t?this.$window.find(t):this.$window},setWidth:function(t){if(t>=0){var e=parseInt(this.$window.css("min-width"));t<e&&(t=e),t-=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),this.$window.width(t)}},getWidth:function(){return parseInt(this.$window.css("width"))},setHeight:function(t){if(t>=0){var e=parseInt(this.$window.css("min-height"));t<e&&(t=e),t-=parseInt(this.$window.css("border-bottom-width"))+parseInt(this.$window.css("border-top-width")),this.$window.height(t),this.initConfig.header&&(t-=parseInt(this.$window.find("> .header").css("height"))),this.$window.find("> .body").css("height",t)}},getHeight:function(){return parseInt(this.$window.css("height"))},setSize:function(t,e){this.setWidth(t),this.setHeight(e)},getSize:function(){return[this.getWidth(),this.getHeight()]},setTitle:function(t){this.$window.find("> .header > .title").text(t)},getTitle:function(){return this.$window.find("> .header > .title").text()},getLeft:function(){return parseInt(this.$window.css("left"))},getTop:function(){return parseInt(this.$window.css("top"))},isVisible:function(){return this.$window&&this.$window.is(":visible")},setResizable:function(t,e,i){if(t!==this.resizable){if(t){var n='<div class="resize-border left" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-right-style: solid; cursor: w-resize;"></div><div class="resize-border left bottom" style="border-bottom-left-radius: 5px; cursor: sw-resize;"></div><div class="resize-border bottom" style="left: 4px; right: 4px; width: auto; z-index: 2; border-top-style: solid; cursor: s-resize;"></div><div class="resize-border right bottom" style="border-bottom-right-radius: 5px; cursor: se-resize;"></div><div class="resize-border right" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-left-style: solid; cursor: e-resize;"></div><div class="resize-border left top" style="border-top-left-radius: 5px; cursor: nw-resize;"></div><div class="resize-border top" style="left: 4px; right: 4px; width: auto; z-index: 2; border-bottom-style:'+(this.initConfig.header?"none":"solid")+'; cursor: n-resize;"></div><div class="resize-border right top" style="border-top-right-radius: 5px; cursor: ne-resize;"></div>';this.initConfig.header&&(n+='<div class="resize-border left" style="top: 5px; height: 28px; cursor: w-resize;"></div><div class="resize-border right" style="top: 5px; height: 28px; cursor: e-resize;"></div>'),this.$window.append(_.template(n)),this.binding.resize=_.bind(p,this),this.binding.resizeStop=_.bind(f,this),this.binding.resizeStart=_.bind(u,this),e&&e.length>1&&(this.initConfig.minwidth=e[0]),e&&e.length>1&&(this.initConfig.minheight=e[1]),i&&i.length>1&&(this.initConfig.maxwidth=i[0]),i&&i.length>1&&(this.initConfig.maxheight=i[1]),this.$window.find(".resize-border").on("mousedown",this.binding.resizeStart)}else this.$window.find(".resize-border").remove();this.resizable=t}else t&&(e&&e.length>1&&(this.initConfig.minwidth=e[0]),e&&e.length>1&&(this.initConfig.minheight=e[1]),i&&i.length>1&&(this.initConfig.maxwidth=i[0]),i&&i.length>1&&(this.initConfig.maxheight=i[1]))},suspendKeyEvents:function(){this.pauseKeyEvents=!1},resumeKeyEvents:function(){this.initConfig.enableKeyEvents&&(this.pauseKeyEvents=!0)},onPrimary:function(){},getFocusedComponents:function(){return[]},getDefaultFocusableComponent:function(){},cancelButtonText:"Cancel",okButtonText:"OK",yesButtonText:"Yes",noButtonText:"No",closeButtonText:"Close",textWarning:"Warning",textError:"Error",textConfirmation:"Confirmation",textInformation:"Information",textDontShow:"Don't show this message again"}}(),Common.UI.Window||{}))})),define("common/main/lib/view/RenameDialog",["common/main/lib/component/Window"],(function(){"use strict";Common.Views.RenameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",filename:"",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textName+"</label>","</div>",'<div id="id-dlg-newname" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputName=new Common.UI.InputField({el:$("#id-dlg-newname"),style:"width: 100%;",validateOnBlur:!1,maxLength:t.options.maxLength,validation:function(e){return!/[\t*\+:\"<>?|\\\\/]/gim.test(e)||t.txtInvalidName+'*+:"<>?|/'}});var e=this.getChild();e.find(".btn").on("click",_.bind(this.onBtnClick,this)),t.inputNameEl=e.find("input")},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this,e=t.options.filename.lastIndexOf(".");e>0&&(t.options.filename=t.options.filename.substring(0,e)),_.delay((function(){t.inputName.setValue(t.options.filename),t.inputNameEl.focus().select()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputNameEl.focus();this.options.handler.call(this,t,this.inputName.getValue())}this.close()},textName:"File name",txtInvalidName:"The file name cannot contain any of the following characters: "},Common.Views.RenameDialog||{}))})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/Header",["backbone","text!common/main/lib/template/Header.template","core","common/main/lib/view/RenameDialog"],(function(t,e){"use strict";Common.Views.Header=t.View.extend(_.extend(function(){var t,i,n,o,s,a,r,l=!1,c=!!window.PDFE,d='<li id="<%= user.get("iid") %>" class="<% if (!user.get("online")) { %> offline <% } if (user.get("view")) {%> viewmode <% } %>"><div class="user-name"><div class="color" style="background-color: <%= user.get("color") %>;"></div><label><%= fnEncode(user.get("username")) %></label><% if (len>1) { %><label class="margin-left-3">(<%=len%>)</label><% } %></div></li>',h=_.template("<ul><% for (originalId in users) { %><%= usertpl({user: users[originalId][0], fnEncode: fnEncode, len: users[originalId].length}) %><% } %></ul>");function m(t,e){var a=t.getVisibleEditingCount();n&&(i&&(a>1&&(i.isEdit||i.isRestrictedEdit)||a>0&&i.canLiveView)?(n.html(h({users:t.chain().filter((function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")})).groupBy((function(t){return t.get("idOriginal")})).value(),usertpl:_.template(d),fnEncode:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))}})),n.scroller=new Common.UI.Scroller({el:n.find("ul"),useKeyboard:!0,minScrollbarLength:40,alwaysVisibleY:!0}),n.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})):n.empty()),function(t,e){if(!s)return;i&&(t>1&&(i.isEdit||i.isRestrictedEdit)||t>0&&i.canLiveView)?(o.show(),s.find(".caption").html(e)):o.hide();g(i)}(a,t.getVisibleEditingOriginalCount())}function u(t){m(t.collection)}function p(){l=!0,this.btnShare&&this.btnShare.setVisible(!1),g(i)}function f(t){var e=s.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide())}function g(t){if(r&&t){var e=r.parent();if(t.isEdit){if(!t.customization||!t.customization.compactHeader){o=e.position().left,s=e.next().outerWidth();var i=r.outerWidth(),n=r[0].style.width;(n=n?parseFloat(n):i)-i>.1?(e.css("padding-left",o<s?Math.max(2,e.outerWidth()-2-n):2),e.css("padding-right",o<s?2:Math.max(2,e.outerWidth()-2-n))):(e.css("padding-left",o<s?Math.max(2,Math.min(s-o+2,e.outerWidth()-2-n)):2),e.css("padding-right",o<s?2:Math.max(2,Math.min(o-s+2,e.outerWidth()-2-n))))}}else{var o=e.position().left,s=e.next().outerWidth();e.css("padding-left",o<s?Math.max(2,s-o):2),e.css("padding-right",o<s?2:Math.max(2,o-s))}if((!t.customization||!t.customization.toolbarHideFileName)&&(!t.isEdit||t.customization&&t.customization.compactHeader)){var a=parseFloat(e.css("padding-left")||0)+parseFloat(e.css("padding-right")||0)+parseInt(r.css("min-width")||50);t.isCrypted&&(a+=20),e.css("flex-basis",Math.ceil(a)+"px"),e.closest(".extra.right").css("flex-basis",Math.ceil(a)+e.next().outerWidth()+"px"),Common.NotificationCenter.trigger("tab:resize")}}}function b(t){var e=this;t=t||i,e.btnPDFMode&&t&&(e.btnPDFMode.setIconCls("toolbar__icon icon--inverse "+(t.isPDFEdit?"btn-edit":t.isPDFAnnotate?"btn-menu-comments":"btn-sheet-view")),e.btnPDFMode.setCaption(t.isPDFEdit?e.textEdit:t.isPDFAnnotate?e.textComment:e.textView),e.btnPDFMode.updateHint(t.isPDFEdit?e.tipEdit:t.isPDFAnnotate?e.tipComment:e.tipView))}function v(){!i||!i.isEdit||i.customization&&i.customization.compactHeader||g(i)}function C(t){r&&(t.isCrypted&&(r.before('<div class="inner-box-icon crypted hidden"><svg class="icon"><use xlink:href="#svg-icon-crypted"></use></svg></div>'),this.imgCrypted=r.parent().find(".crypted"),this._showImgCrypted=!0),g(t))}function y(e){i=e;var a=this;if(a.btnGoBack.on("click",(function(t){Common.NotificationCenter.trigger("goback")})),a.btnFavorite.on("click",(function(t){Common.NotificationCenter.trigger("markfavorite",!a.options.favorite)})),a.btnShare&&(a.btnShare.on("click",(function(t){Common.NotificationCenter.trigger("collaboration:sharing")})),a.btnShare.updateHint(a.tipAccessRights),a.btnShare.setVisible(!l&&i&&(i.sharingSettingsUrl&&i.sharingSettingsUrl.length||i.canRequestSharingSettings)),g(i)),a.logo&&a.logo.children(0).on("click",(function(t){var e=a.branding&&a.branding.logo&&void 0!==a.branding.logo.url?a.branding.logo.url:"https://www.onlyoffice.com";if(e){var i=window.open(e);i&&i.focus()}})),o){m(t),o.on("shown.bs.dropdown",(function(){n.scroller&&n.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})})),o.find(".cousers-menu").on("click",(function(t){return!1}));var r=t.getVisibleEditingCount();s.tooltip({title:a.tipUsers,placement:"bottom",html:!0}),s.on("click",f.bind(a)),o[i&&(r>1&&(i.isEdit||i.isRestrictedEdit)||r>0&&i.canLiveView)?"show":"hide"](),g(i)}if(i.user.guest&&i.canRenameAnonymous&&a.btnUserName&&a.btnUserName.on("click",(function(t){Common.NotificationCenter.trigger("user:rename")})),a.btnPrint&&(a.btnPrint.updateHint(a.tipPrint+Common.Utils.String.platformKey("Ctrl+P")),a.btnPrint.on("click",(function(t){a.fireEvent("print",a)}))),a.btnPrintQuick&&(a.btnPrintQuick.updateHint(a.tipPrintQuick),a.btnPrintQuick.on("click",(function(t){a.fireEvent("print-quick",a)}))),a.btnSave&&(a.btnSave.updateHint(a.tipSave+(c?"":Common.Utils.String.platformKey("Ctrl+S"))),a.btnSave.on("click",(function(t){a.fireEvent("save",a)}))),a.btnUndo&&(a.btnUndo.updateHint(a.tipUndo+Common.Utils.String.platformKey("Ctrl+Z")),a.btnUndo.on("click",(function(t){a.fireEvent("undo",a)}))),a.btnRedo&&(a.btnRedo.updateHint(a.tipRedo+Common.Utils.String.platformKey("Ctrl+Y")),a.btnRedo.on("click",(function(t){a.fireEvent("redo",a)}))),e.isEdit||(a.btnDownload&&(a.btnDownload.updateHint(a.tipDownload),a.btnDownload.on("click",(function(t){a.fireEvent("downloadas",["original"])}))),a.btnEdit&&(a.btnEdit.updateHint(a.tipGoEdit),a.btnEdit.on("click",(function(t){a.fireEvent("go:editor",a)})))),a.btnSearch&&a.btnSearch.updateHint(a.tipSearch+Common.Utils.String.platformKey("Ctrl+F")),a.btnPDFMode){var d=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><% if (!_.isEmpty(iconCls)) { %><span class="menu-item-icon <%= iconCls %>"></span><% } %><b><%= caption %></b></div><% if (options.description !== null) { %><label class="margin-left-10 description"><%= options.description %></label><% } %></a>'),h=[];i.canPDFEdit&&h.push({caption:a.textEdit,iconCls:"menu__icon btn-edit",template:d,description:a.textEditDesc,value:"edit"}),h.push({caption:a.textComment,iconCls:"menu__icon btn-menu-comments",template:d,description:a.textCommentDesc,value:"comment",disabled:!i.canPDFAnnotate}),h.push({caption:a.textView,iconCls:"menu__icon btn-sheet-view",template:d,description:a.textViewDesc,value:"view"}),a.btnPDFMode.setMenu(new Common.UI.Menu({cls:"ppm-toolbar",style:"width: 220px;",menuAlign:"tr-br",items:h})),a.btnPDFMode.menu.on("item:click",(function(t,e){Common.NotificationCenter.trigger("pdf:mode",e.value,_.bind(b,a))}))}!i.isEdit||i.customization&&i.customization.compactHeader||Common.NotificationCenter.on("window:resize",v)}function w(t){var e=this;if(e.imgCrypted&&e.imgCrypted.toggleClass("hidden",!0),e.isSaveDocName=!1,!e.withoutExt){var i=e.cutDocName(r.val());e.withoutExt=!0,_.delay((function(){e.setDocTitle(i),r.select()}),100)}}function x(t){var e=this,i=r.val();t.keyCode==Common.UI.Keys.RETURN?(i=i.trim(),_.isEmpty(i)||e.cutDocName(e.documentCaption)===i?Common.NotificationCenter.trigger("edit:complete",e):(e.isSaveDocName=!0,/[\t*\+:\"<>?|\\\\/]/gim.test(i)?_.defer((function(){Common.UI.error({msg:(new Common.Views.RenameDialog).txtInvalidName+'*+:"<>?|/',callback:function(){_.delay((function(){r.focus(),e.isSaveDocName=!0}),50)}})})):e.withoutExt&&(i=e.cutDocName(i),e.fireEvent("rename",[i]),i+=e.fileExtention,e.withoutExt=!1,e.setDocTitle(i),Common.NotificationCenter.trigger("edit:complete",e)))):t.keyCode==Common.UI.Keys.ESC?Common.NotificationCenter.trigger("edit:complete",this):_.delay((function(){e.setDocTitle()}),10)}return{options:{branding:{},documentCaption:"",canBack:!1,wopi:!1},el:"#header",template:_.template(e),events:{},initialize:function(e){var n=this;this.options=this.options?_.extend(this.options,e):e,this.documentCaption=this.options.documentCaption,this.branding=this.options.customization,this.isModified=!1,n.btnGoBack=new Common.UI.Button({id:"btn-go-back",cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-goback",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),(t=this.options.storeUsers).bind({add:u,change:u,reset:m}),n.btnSearch=new Common.UI.Button({cls:"btn-header no-caret",iconCls:"toolbar__icon icon--inverse btn-menu-search",enableToggle:!0,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),n.btnFavorite=new Common.UI.Button({id:"id-btn-favorite",cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-favorite",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),Common.NotificationCenter.on({"app:ready":function(t){Common.Utils.asyncCall(y,n,t)},"app:face":function(t){Common.Utils.asyncCall(C,n,t)},"tab:visible":function(){Common.Utils.asyncCall(g,n,i)},"collaboration:sharingdeny":function(t){Common.Utils.asyncCall(p,n,t)}}),Common.NotificationCenter.on("uitheme:changed",this.changeLogo.bind(this))},render:function(t,e){return $(t).html(this.getPanel(e)),this},getPanel:function(t,e){var i=this;function d(t,i,n,o,s,a){return new Common.UI.Button({cls:"btn-header",iconCls:t,disabled:!0===n,dataHint:"0",dataHintDirection:o||(e.isDesktopApp?"right":"left"),dataHintOffset:s||(e.isDesktopApp?"10, -18":"10, 10"),dataHintTitle:a}).render(i)}if(!("left"!=t||e&&e.isDesktopApp)){if(m=$('<section class="logo"><div id="header-logo"><i></i></div></section>'),this.logo=m.find("#header-logo"),this.branding&&this.branding.logo&&(this.branding.logo.image||this.branding.logo.imageDark)&&this.logo){var h=Common.UI.Themes.isDarkTheme()?this.branding.logo.imageDark||this.branding.logo.image:this.branding.logo.image||this.branding.logo.imageDark;this.logo.html('<img src="'+h+'" style="max-width:100px; max-height:20px; margin: 0;"/>'),this.logo.css({"background-image":"none",width:"auto"}),(this.branding.logo.url||void 0===this.branding.logo.url)&&this.logo.addClass("link")}return m}if("right"==t){var m=$(_.template('<section><section id="box-doc-name"><input id="rib-doc-name" autofill="off" autocomplete="off"/></input></section><section style="display: inherit;"><div class="hedset"><div class="btn-slot" id="slot-hbtn-edit"></div><div class="btn-slot" id="slot-hbtn-print"></div><div class="btn-slot" id="slot-hbtn-print-quick"></div><div class="btn-slot" id="slot-hbtn-download"></div></div><div class="hedset" data-layout-name="header-users"><section id="tlb-box-users" class="box-cousers dropdown"><div class="btn-users dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="bottom" data-hint-offset="big"><div class="inner-box-icon"><svg class=""><use xlink:href="#svg-icon-users"></use></svg></div><label class="caption"></label></div><div class="cousers-menu dropdown-menu"><label id="tlb-users-menu-descr"><%= tipUsers %></label><div class="cousers-list"></div></div></section></div><div class="hedset"><div class="btn-slot" id="slot-btn-share"></div></div><div class="hedset"><div class="btn-slot" id="slot-btn-pdf-mode"></div></div><div class="hedset"><div class="btn-slot" id="slot-btn-mode"></div><div class="btn-slot" id="slot-btn-back"></div><div class="btn-slot" id="slot-btn-favorite"></div><div class="btn-slot" id="slot-btn-search"></div></div><div class="hedset"><div class="btn-slot"><button type="button" class="btn btn-header slot-btn-user-name hidden"><div class="color-user-name"></div></button><div class="btn-current-user hidden"><div class="color-user-name"></div></div></div></div></section></section>')({tipUsers:this.labelCoUsersDescr,textShare:this.textShare}));return r?m.find("#rib-doc-name").hide():(r=m.find("#rib-doc-name"),i.documentCaption&&setTimeout((function(){i.setDocTitle(i.documentCaption)}),50)),this.setCanRename(!!this.options.canRename),!0===this.options.canBack?i.btnGoBack.render(m.find("#slot-btn-back")):m.find("#slot-btn-back").hide(),void 0!==this.options.favorite&&null!==this.options.favorite?(i.btnFavorite.render(m.find("#slot-btn-favorite")),i.btnFavorite.changeIcon(i.options.favorite?{next:"btn-in-favorite",curr:"btn-favorite"}:{next:"btn-favorite",curr:"btn-in-favorite"}),i.btnFavorite.updateHint(i.options.favorite?i.textRemoveFavorite:i.textAddFavorite)):m.find("#slot-btn-favorite").hide(),e.isEdit||(!e.canDownload&&!e.canDownloadOrigin||e.isOffline||(this.btnDownload=d("toolbar__icon icon--inverse btn-download",m.findById("#slot-hbtn-download"),void 0,"bottom","big")),e.canPrint&&(this.btnPrint=d("toolbar__icon icon--inverse btn-print",m.findById("#slot-hbtn-print"),void 0,"bottom","big","P")),e.canQuickPrint&&(this.btnPrintQuick=d("toolbar__icon icon--inverse btn-quick-print",m.findById("#slot-hbtn-print-quick"),void 0,"bottom","big","Q")),e.canEdit&&e.canRequestEditRights&&!c&&(this.btnEdit=d("toolbar__icon icon--inverse btn-edit",m.findById("#slot-hbtn-edit"),void 0,"bottom","big"))),i.btnSearch.render(m.find("#slot-btn-search")),(!e.isEdit||e.customization&&e.customization.compactHeader)&&(e.user.guest&&e.canRenameAnonymous?(i.btnUserName=new Common.UI.Button({el:m.findById(".slot-btn-user-name"),cls:"btn-header",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big",visible:!0}),i.btnUserName.cmpEl.removeClass("hidden")):(i.elUserName=m.find(".btn-current-user"),i.elUserName.removeClass("hidden")),a=m.find(".color-user-name"),i.setUserName(i.options.userName)),!l&&e&&(e.sharingSettingsUrl&&e.sharingSettingsUrl.length||e.canRequestSharingSettings)?(i.btnShare=new Common.UI.Button({cls:"btn-header btn-header-share",iconCls:"toolbar__icon icon--inverse btn-users-share",caption:i.textShare,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),i.btnShare.render(m.find("#slot-btn-share"))):m.find("#slot-btn-share").hide(),c&&e.isEdit&&!e.isOffline&&e.canSwitchMode?(i.btnPDFMode=new Common.UI.Button({cls:"btn-header btn-header-pdf-mode no-caret",iconCls:"toolbar__icon icon--inverse btn-sheet-view",caption:i.textView,menu:!0,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),i.btnPDFMode.render(m.find("#slot-btn-pdf-mode")),b.call(i,e)):m.find("#slot-btn-pdf-mode").hide(),n=m.find(".cousers-list"),o=m.find(".box-cousers"),s=o.find("> .btn-users"),o.hide(),m}if("title"==t){m=$(_.template('<section id="box-document-title"><div class="extra"></div><div class="hedset"><div class="btn-slot" id="slot-btn-dt-home"></div><div class="btn-slot" id="slot-btn-dt-save" data-layout-name="header-save"></div><div class="btn-slot" id="slot-btn-dt-print"></div><div class="btn-slot" id="slot-btn-dt-print-quick"></div><div class="btn-slot" id="slot-btn-dt-undo"></div><div class="btn-slot" id="slot-btn-dt-redo"></div></div><div class="lr-separator" id="id-box-doc-name"><input id="title-doc-name" autofill="off" autocomplete="off"/></input></div><div class="hedset"><div class="btn-slot"><button type="button" class="btn btn-header slot-btn-user-name hidden"><div class="color-user-name"></div></button><div class="btn-current-user hidden"><div class="color-user-name"></div></div></div></div></section>')());return r&&r.hide().off(),r=m.find("#title-doc-name"),setTimeout((function(){i.setDocTitle(i.documentCaption)}),50),i.options.wopi&&r.attr("maxlength",i.options.wopi.FileNameMaxLength),e.user.guest&&e.canRenameAnonymous?(i.btnUserName=new Common.UI.Button({el:m.findById(".slot-btn-user-name"),cls:"btn-header",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big",visible:!0}),i.btnUserName.cmpEl.removeClass("hidden")):(i.elUserName=m.find(".btn-current-user"),i.elUserName.removeClass("hidden")),a=m.find(".color-user-name"),i.setUserName(i.options.userName),e.canPrint&&e.isEdit&&(i.btnPrint=d("toolbar__icon icon--inverse btn-print",m.findById("#slot-btn-dt-print"),!0,void 0,void 0,"P")),e.canQuickPrint&&e.isEdit&&(i.btnPrintQuick=d("toolbar__icon icon--inverse btn-quick-print",m.findById("#slot-btn-dt-print-quick"),!0,void 0,void 0,"Q")),i.btnSave=d("toolbar__icon icon--inverse btn-save",m.findById("#slot-btn-dt-save"),!0,void 0,void 0,"S"),i.btnUndo=d("toolbar__icon icon--inverse btn-undo",m.findById("#slot-btn-dt-undo"),!0,void 0,void 0,"Z"),i.btnRedo=d("toolbar__icon icon--inverse btn-redo",m.findById("#slot-btn-dt-redo"),!0,void 0,void 0,"Y"),m}},setVisible:function(t){},setBranding:function(t){var e;if(this.branding=t,t&&t.logo&&(t.logo.image||t.logo.imageDark)){var i=Common.UI.Themes.isDarkTheme()?t.logo.imageDark||t.logo.image:t.logo.image||t.logo.imageDark;(e=$("#header-logo"))&&(e.html('<img src="'+i+'" style="max-width:100px; max-height:20px; margin: 0;"/>'),e.css({"background-image":"none",width:"auto"}),(t.logo.url||void 0===t.logo.url)&&e.addClass("link"))}},changeLogo:function(){var t=this.branding;if(t&&t.logo&&t.logo.image&&t.logo.imageDark&&t.logo.image!==t.logo.imageDark){var e=Common.UI.Themes.isDarkTheme()?t.logo.imageDark||t.logo.image:t.logo.image||t.logo.imageDark;$("#header-logo img").attr("src",e)}},setDocumentCaption:function(t){!t&&(t=""),this.documentCaption=t;var e=this.documentCaption.lastIndexOf(".");return e>0&&(this.fileExtention=this.documentCaption.substring(e)),this.isModified&&(t+="*"),this.readOnly&&(t+=" ("+this.textReadOnly+")"),r&&this.setDocTitle(t),t},getDocumentCaption:function(){return this.documentCaption},setDocumentChanged:function(t){this.isModified=t;var e=this.documentCaption;t&&(e+="*"),this.setDocTitle(e)},setCanBack:function(t,e){return this.options.canBack=t,this.btnGoBack[t?"show":"hide"](),t&&this.btnGoBack.updateHint(e&&"string"==typeof e?e:this.textBack),g(i),this},getCanBack:function(){return this.options.canBack},setFavorite:function(t){return this.options.favorite=t,this.btnFavorite[null!=t?"show":"hide"](),this.btnFavorite.changeIcon(t?{next:"btn-in-favorite",curr:"btn-favorite"}:{next:"btn-favorite",curr:"btn-in-favorite"}),this.btnFavorite.updateHint(t?this.textRemoveFavorite:this.textAddFavorite),g(i),this},getFavorite:function(){return this.options.favorite},setWopi:function(t){this.options.wopi=t},setCanRename:function(t){var e=this;if(e.options.canRename=t,r){var i=r;if(t)i.removeAttr("disabled").tooltip({title:e.txtRename,placement:"cursor"}),i.on({keydown:x.bind(this),focus:w.bind(this),blur:function(t){e.imgCrypted&&e.imgCrypted.toggleClass("hidden",!1),Common.Utils.isGecko&&(i[0].selectionStart=i[0].selectionEnd=0),e.isSaveDocName||(e.withoutExt=!1,e.setDocTitle(e.documentCaption))},paste:function(t){setTimeout((function(){var t=e.cutDocName(r.val());e.setDocTitle(t)}))}});else{i.off(),i.attr("disabled",!0);var n=i.data("bs.tooltip");n&&(n.options.title="",n.setContent())}i.attr("data-can-copy",t)}},cutDocName:function(t){if(t.length<=this.fileExtention.length)return t;var e=t.length-this.fileExtention.length;return t.substring(e)==this.fileExtention?t.substring(0,e):t},setDocTitle:function(t){var e=this.getTextWidth(t||r.val());e>=0&&r.width(e),t&&e>=0&&r.val(t),this._showImgCrypted&&e>=0&&(this.imgCrypted.toggleClass("hidden",!1),this._showImgCrypted=!1),e>=0&&v()},getTextWidth:function(t){if(!this._testCanvas){var e=(r.css("font-size")+" "+r.css("font-family")).trim();if(e){var i=document.createElement("canvas");this._testCanvas=i.getContext("2d"),this._testCanvas.font=e}}if(this._testCanvas){var n=this._testCanvas.measureText(t);return void 0!==n.actualBoundingBoxLeft?Math.ceil(Math.abs(n.actualBoundingBoxLeft)+Math.abs(n.actualBoundingBoxRight))+1:n.width?Math.ceil(n.width)+2:0}return-1},setUserName:function(t){return this.options.userName=t,this.btnUserName?this.btnUserName.updateHint(t):this.elUserName&&this.elUserName.tooltip({title:Common.Utils.String.htmlEncode(t),placement:"cursor",html:!0}),a&&a.text(this.getInitials(t)),this},getButton:function(t){return"save"==t?this.btnSave:"users"==t?o:"share"==t?this.btnShare:void 0},lockHeaderBtns:function(t,e){var i=this;if("users"==t)e?s.addClass("disabled").attr("disabled","disabled"):s.removeClass("disabled").removeAttr("disabled"),i.btnShare&&i.btnShare.setDisabled(e);else if("rename-user"==t)i.btnUserName&&i.btnUserName.setDisabled(e);else{var n=function(t){t&&(e?(t.keepState={disabled:t.isDisabled()},t.setDisabled(!0)):(t.setDisabled(t.keepState&&t.keepState.disabled||e),delete t.keepState))};switch(t){case"undo":n(i.btnUndo);break;case"redo":n(i.btnRedo)}}},getInitials:function(t){for(var e=t.split(" "),i=e[0].substring(0,1).toUpperCase(),n=e.length-1;n>0;n--)if("("!==e[n][0]&&")"!==e[n][0]){i+=e[n].substring(0,1).toUpperCase();break}return i},setDocumentReadOnly:function(t){this.readOnly=t,this.setDocumentCaption(this.documentCaption)},textBack:"Go to Documents",txtRename:"Rename",txtAccessRights:"Change access rights",tipAccessRights:"Manage document access rights",labelCoUsersDescr:"Document is currently being edited by several users.",tipViewUsers:"View users and manage document access rights",tipUsers:"View users",tipDownload:"Download file",tipPrint:"Print file",tipGoEdit:"Edit current file",tipSave:"Save",tipUndo:"Undo",tipRedo:"Redo",textCompactView:"Hide Toolbar",textHideStatusBar:"Combine sheet and status bars",textHideLines:"Hide Rulers",textZoom:"Zoom",textAdvSettings:"Advanced Settings",tipViewSettings:"View Settings",textRemoveFavorite:"Remove from Favorites",textAddFavorite:"Mark as favorite",textHideNotes:"Hide Notes",tipSearch:"Search",textShare:"Share",tipPrintQuick:"Quick print",textReadOnly:"Read only",textView:"Viewing",textComment:"Commenting",textEdit:"Editing",textViewDesc:"All changes will be saved locally",textCommentDesc:"All changes will be saved to the file. Real time collaboration",textEditDesc:"All changes will be saved to the file. Real time collaboration",tipView:"Viewing",tipComment:"Commenting",tipEdit:"Editing"}}(),Common.Views.Header||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/ToggleManager",["common/main/lib/component/BaseView"],(function(){"use strict";var t={};function e(e,i){var n,o,s;if(i)for(o=0,s=(n=t[e.toggleGroup]).length;o<s;o++)n[o]!==e&&(n[o].isActive?n[o].isActive()&&n[o].toggle(!1):n[o].toggle(!1))}Common.UI.ToggleManager={register:function(i){if(i.toggleGroup){var n=t[i.toggleGroup];n||(n=t[i.toggleGroup]=[]),n.push(i),i.on("toggle",e)}},unregister:function(i){if(i.toggleGroup){var n=t[i.toggleGroup];n&&(_.without(n,i),i.off("toggle",e))}},getToggled:function(e){var i,n=t[e],o=0;if(n)for(i=n.length;o<i;o++)if(!0===n[o].pressed||!0===n[o].checked)return n[o];return null}}})),void 0===Common)var Common={};if(define("common/main/lib/component/Button",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],(function(){"use strict";window.createButtonSet=function(){function t(t){}t.prototype=new Array,t.prototype.constructor=t;var e=!1;t.prototype.add=function(t){t.setDisabled(e),this.push(t)},t.prototype.setDisabled=function(t){e=t,this.forEach((function(e){e.setDisabled(t)}))},t.prototype.toggle=function(t,e){this.forEach((function(i){i.toggle(t,e)}))},t.prototype.pressed=function(){return this.some((function(t){return t.pressed}))},t.prototype.contains=function(t){return this.some((function(e){return e.id==t}))},t.prototype.concat=function(){var t=Array.prototype.slice.call(arguments),e=Array.prototype.slice.call(this);return t.forEach((function(t){t instanceof Array?Array.prototype.push.apply(e,t):t&&e.push(t)})),e};var i=Object.create(t.prototype);for(var n in arguments)i.add(arguments[n]);return i};var t='<% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %>',e='<button type="button" class="btn <%= cls %>" id="<%= id %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>> <div class="inner-box-icon">'+t+'</div><div class="inner-box-caption"><span class="caption"><%= caption %></span></div></button>',i='<div class="btn-group icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><div class="inner-box-icon">'+t+'</div><div class="inner-box-caption"><span class="caption"><%= caption %><i class="caret"></i></span><i class="caret compact-caret"></i></div></button></div>',n='<div class="btn-group x-huge split icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn <%= cls %> inner-box-icon"><span class="btn-fixflex-hcenter">'+t+'</span></button><button type="button" class="btn <%= cls %> inner-box-caption dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><span class="btn-fixflex-vcenter"><span class="caption"><%= caption %><i class="caret"></i></span><i class="caret compact-caret"></i></span></button></div>',o=function(t){var e=document.createElement("span");e.style.fontSize=document.documentElement.style.getPropertyValue("--font-size-base-app-custom")||"11px",e.style.fontFamily='Arial, Helvetica, "Helvetica Neue", sans-serif',e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.innerHTML=t,document.body.appendChild(e);var i=e.offsetWidth;return document.body.removeChild(e),i},s=function(t,e){for(var i=t.length-1,n=t;o(n)>e;)n=t.slice(0,i).trim()+"...",i--;return n};Common.UI.Button=Common.UI.BaseView.extend({options:{id:null,hint:!1,enableToggle:!1,allowDepress:!0,toggleGroup:null,cls:"",iconCls:"",caption:"",menu:null,disabled:!1,pressed:!1,split:!1,visible:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"0, 0",scaling:!0},template:_.template(["<% var applyicon = function() { %>","<% if (iconImg) { print('<img src=\"' + iconImg + '\">'); } else { %>",'<% if (iconCls != "") {  if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); }} %>',"<% } %>","<% if ( !menu ) { %>",'<button type="button" class="btn <%= cls %>" id="<%= id %>" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>","<% } else if (split == false) {%>",'<div class="btn-group" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>','<span class="inner-box-caret"><i class="caret"></i></span>',"</button>","</div>","<% } else { %>",'<div class="btn-group split" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn <%= cls %>">',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>",'<button type="button" class="btn <%= cls %> dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>','<i class="caret"></i>','<span class="sr-only"></span>',"</button>","</div>","<% } %>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.id=e.options.id||Common.UI.getId(),e.hint=e.options.hint,e.enableToggle=e.options.enableToggle,e.allowDepress=e.options.allowDepress,e.cls=e.options.cls,e.iconCls=e.options.iconCls,e.menu=e.options.menu,e.split=e.options.split,e.toggleGroup=e.options.toggleGroup,e.disabled=e.options.disabled,e.visible=e.options.visible,e.pressed=e.options.pressed,e.caption=e.options.caption,e.template=e.options.template||e.template,e.style=e.options.style,e.rendered=!1,!1===e.options.scaling&&e.options.iconCls&&(e.iconCls=e.options.iconCls+" scaling-off"),e.options.el?e.render():e.options.parentEl&&e.render(e.options.parentEl)},getCaptionWithBreaks:function(t){var e=t.split(" "),i=null,n=156,a=e.indexOf("&");if(a>-1&&(e[a-1]+=" &",e.splice(a,1)),e.length>1)if(n=this.menu||!0===this.split?n-10:n,e.length<3)e[0]=s(e[0],this.menu?n+10:n),e[1]=s(e[1],n),i=e[0]+"<br>"+e[1];else{var r="";if(o(e[0]+" "+e[1])<n){for(var l=2;l<e.length;l++)r+=e[l]+" ";2*o(r+(this.menu?10:0))<o(e[0]+" "+e[1])?(r=s((e[1]+" "+r).trim(),n),i=e[0]+"<br>"+r):(r=s(r.trim(),n),i=e[0]+" "+e[1]+"<br>"+r)}else{for(var c=1;c<e.length;c++)r+=e[c]+" ";r=s(r.trim(),n),i=e[0]+"<br>"+r}}else i=o(t)<n?t:s(t,n),(this.menu||!0===this.split)&&(i+="<br>");return i},render:function(t){var o=this;if(o.trigger("render:before",o),o.cmpEl=o.$el||$(o.el),t&&(o.setElement(t,!1),!o.rendered)){if(/icon-top/.test(o.cls)&&o.caption&&/huge/.test(o.cls)){!0===o.split?(o.cls&&(o.cls=o.cls.replace(/\s?(?:x-huge|icon-top)/g,"")),this.template=_.template(n)):o.menu?this.template=_.template(i):this.template=_.template(e);var s=this.getCaptionWithBreaks(this.caption);s&&(o.caption=s)}o.cmpEl=$(this.template({id:o.id,cls:o.cls,iconCls:o.iconCls,iconImg:o.options.iconImg,menu:o.menu,split:o.split,disabled:o.disabled,pressed:o.pressed,caption:o.caption,style:o.style,dataHint:o.options.dataHint,dataHintDirection:o.options.dataHintDirection,dataHintOffset:o.options.dataHintOffset,dataHintTitle:o.options.dataHintTitle})),o.menu&&_.isObject(o.menu)&&_.isFunction(o.menu.render)&&o.menu.render(o.cmpEl),t.html(o.cmpEl),o.$icon=o.$el.find(".icon")}if(!o.rendered){var a=o.cmpEl,r=a.hasClass("btn-group"),l=a.hasClass("split");if(o.options.hint){var c=o.cmpEl.closest(".asc-window");if("object"==typeof o.options.hint&&o.options.hint.length>1&&$("button",a).length>0){var d=$("button",a);o.btnEl=$(d[0]),o.btnMenuEl=$(d[1])}else o.btnEl=o.cmpEl,o.btnEl.attr("data-toggle","tooltip");if(o.btnEl.tooltip({title:"string"==typeof o.options.hint?o.options.hint:o.options.hint[0],placement:o.options.hintAnchor||"cursor"}),o.btnMenuEl&&o.btnMenuEl.tooltip({title:o.options.hint[1],placement:o.options.hintAnchor||"cursor"}),c.length>0){o.btnEl.data("bs.tooltip").tip().css("z-index",parseInt(c.css("z-index"))+10),o.btnMenuEl&&o.btnMenuEl.data("bs.tooltip").tip().css("z-index",parseInt(c.css("z-index"))+10);var h=function(t){if(c[0]===t.$window[0]){var e=o.btnEl.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),Common.NotificationCenter.off({"modal:close":h})}};Common.NotificationCenter.on({"modal:close":h})}}_.isString(o.toggleGroup)&&(o.enableToggle=!0);var m,u=function(t){if(!o.disabled&&1==t.which){if(o.doToggle(),o.options.hint){var e=o.btnEl.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide())}o.trigger("click",o,t)}},p=function(t,e,i){if(!t){var n=!1;$("button",a).each((function(t,e){if($(e).is(":hover"))return n=!0,!1})),n||(a.removeClass("over"),$("button",a).removeClass("over"))}if("button"==e){if(!t&&o.enableToggle&&o.allowDepress&&o.pressed)return;if(t&&!l&&o.enableToggle&&o.allowDepress&&!o.pressed)return void i.preventDefault();$("button:first",a).toggleClass("active",t)}else $("[data-toggle^=dropdown]",a).toggleClass("active",t);a.toggleClass("active",t)},f=function(t){p(!1,m,t),$(document).off("mouseup",f)};r?(l&&($("[data-toggle^=dropdown]",a).on("mousedown",_.bind((function(t){if(!o.disabled&&1==t.which&&l){if(o.options.hint){var e=(o.btnMenuEl?o.btnMenuEl:o.btnEl).data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide())}var i=a.hasClass("open");p(!i,"arrow",t)}}),this)),$("button",a).on("mousedown",_.bind((function(t){m=t.currentTarget.className.match(/dropdown/)?"arrow":"button",p(!0,m,t),$(document).on("mouseup",f)}),this)),o.options.width>0&&$("button:first",a).css("width",o.options.width-$("[data-toggle^=dropdown]",a).outerWidth())),a.on("hide.bs.dropdown",_.bind(p,o,!1,"arrow")),a.on("show.bs.dropdown",_.bind(p,o,!0,"arrow")),a.on("hidden.bs.dropdown",_.bind((function(t,e){o.cmpEl.find(".dropdown-toggle").blur(),o.cmpEl.hasClass("active")!==o.pressed&&o.cmpEl.trigger("button.internal.active",[o.pressed])}),o)),$("button:first",a).on("click",u)):a.on("click",u),a.on("button.internal.active",_.bind((function(t,e){l?p(e,"button",t):(a.toggleClass("active",e),$("button",a).toggleClass("active",e))}),o)),a.on("mouseover",(function(t){o.disabled||(o.cmpEl.addClass("over"),o.trigger("mouseover",o,t))})),a.on("mouseout",(function(t){o.cmpEl.removeClass("over"),o.disabled||o.trigger("mouseout",o,t)})),Common.UI.ToggleManager.register(o),!1!==o.options.scaling&&(a.attr("ratio","ratio"),o.applyScaling(Common.UI.Scaling.currentRatio()),a.on("app:scaling",(function(t,e){o.options.scaling!=e.ratio&&o.applyScaling(e.ratio)})))}return o.rendered=!0,o.pressed&&o.toggle(o.pressed,!0),o.disabled&&o.setDisabled(!(o.disabled=!1)),o.visible||o.setVisible(o.visible),o.trigger("render:after",o),this},doToggle:function(){var t=this;!t.enableToggle||!1===t.allowDepress&&t.pressed||t.toggle()},toggle:function(t,e){var i=void 0===t?!this.pressed:!!t;this.pressed=i,this.cmpEl&&this.cmpEl.trigger("button.internal.active",[i]),e||this.trigger("toggle",this,i)},click:function(t){this.disabled||(this.doToggle(),this.trigger("click",this,t))},isActive:function(){return this.enableToggle?this.pressed:this.cmpEl.hasClass("active")},setDisabled:function(t){if(this.rendered&&this.disabled!=t){var e=this.cmpEl,i=e.hasClass("btn-group"),n=this;if((t=!0===t)!==e.hasClass("disabled")){var o=function(e){e.toggleClass("disabled",t),n.options.allowMouseEventsOnDisabled||(t?e.attr({disabled:t}):e.removeAttr("disabled"))};o(e),i&&o(e.children("button"))}if((t||!Common.Utils.isGecko)&&this.options.hint){var s=this.btnEl.data("bs.tooltip");s&&(t&&s.hide(),!Common.Utils.isGecko&&(s.enabled=!t)),this.btnMenuEl&&(s=this.btnMenuEl.data("bs.tooltip"))&&(t&&s.hide(),!Common.Utils.isGecko&&(s.enabled=!t))}if(t&&this.menu&&_.isObject(this.menu)&&this.menu.rendered&&this.menu.isVisible()&&setTimeout((function(){n.menu.hide()}),1),n.options.signals)n.options.signals.indexOf("disabled")<0||n.trigger("disabled",n,t)}this.disabled=t},isDisabled:function(){return this.disabled},setIconCls:function(t){var e=$(this.el).find(".icon"),i=this.iconCls,n=e.find("use.zoom-int");if(this.iconCls=t,/svgicon/.test(this.iconCls)){var o=/svgicon\s(\S+)/.exec(this.iconCls);n.attr("xlink:href",o&&o.length>1?"#"+o[1]:"")}else if(n.length){o=/btn-[^\s]+/.exec(this.iconCls);n.attr("href",o?"#"+o[0]:"")}else e.removeClass(i),e.addClass(t||""),!1===this.options.scaling&&e.addClass("scaling-off")},changeIcon:function(t){var e=this,i=$(this.el).find(".icon");if(t&&(t.curr||t.next)&&i){var n=i.find("use.zoom-int");t.curr&&i.removeClass(t.curr),t.next&&!i.hasClass(t.next)&&i.addClass(t.next),n.length&&t.next&&n.attr("href","#"+t.next),e.options.signals&&(e.options.signals.indexOf("icon:changed")<0||e.trigger("icon:changed",e,t))}},hasIcon:function(t){return this.$icon.hasClass(t)},setVisible:function(t){this.cmpEl&&this.cmpEl.toggleClass("hidden",!t),this.visible=t},isVisible:function(){return this.cmpEl?this.cmpEl.is(":visible"):$(this.el).is(":visible")},updateHint:function(t,e){if(this.options.hint=t,this.rendered){var i=this.cmpEl,n=i.closest(".asc-window");if(!this.btnEl)if("object"==typeof this.options.hint&&this.options.hint.length>1&&$("button",i).length>0){var o=$("button",i);this.btnEl=$(o[0]),this.btnMenuEl=$(o[1])}else this.btnEl=i,this.btnEl.attr("data-toggle","tooltip");if(this.btnEl.data("bs.tooltip")&&this.btnEl.removeData("bs.tooltip"),this.btnMenuEl&&this.btnMenuEl.data("bs.tooltip")&&this.btnMenuEl.removeData("bs.tooltip"),this.btnEl.tooltip({html:!!e,title:"string"==typeof t?t:t[0],placement:this.options.hintAnchor||"cursor"}),this.btnMenuEl&&this.btnMenuEl.tooltip({html:!!e,title:t[1],placement:this.options.hintAnchor||"cursor"}),n.length>0&&(this.btnEl.data("bs.tooltip").tip().css("z-index",parseInt(n.css("z-index"))+10),this.btnMenuEl&&this.btnMenuEl.data("bs.tooltip").tip().css("z-index",parseInt(n.css("z-index"))+10)),this.disabled||!Common.Utils.isGecko){var s=this.btnEl.data("bs.tooltip");s&&(this.disabled&&s.hide(),!Common.Utils.isGecko&&(s.enabled=!this.disabled)),this.btnMenuEl&&(s=this.btnMenuEl.data("bs.tooltip"))&&(this.disabled&&s.hide(),!Common.Utils.isGecko&&(s.enabled=!this.disabled))}}},setCaption:function(t){if(this.caption!=t){if(/icon-top/.test(this.cls)&&this.caption&&/huge/.test(this.cls)){var e=this.getCaptionWithBreaks(t);this.caption=e||t}else this.caption=t;if(this.rendered){var i=this.cmpEl.find(".caption");i.length>0?i.html(this.caption):this.cmpEl.find("button:first").addBack().filter("button").html(this.caption)}}},setMenu:function(t){t&&_.isObject(t)&&_.isFunction(t.render)&&(this.menu=t,this.rendered&&this.menu.render(this.cmpEl))},applyScaling:function(t){const e=this;if(e.options.scaling!=t)if(e.options.scaling=t,t>2){if(!e.$el.find("svg.icon").length){const t=e.iconCls||e.$el.find("i.icon").attr("class"),i=/btn-[^\s]+/.exec(t),n=i?i[0]:"null",o='<svg class="icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",n);e.$el.find("i.icon").after(o)}}else if(!e.$el.find("i.icon")){const t='<i class="icon %cls">&nbsp;</i>'.replace("%cls",e.iconCls);e.$el.find("svg.icon").after(t)}},focus:function(){this.$el&&this.$el.find("button").addBack().filter("button").focus()}})})),define("common/main/lib/view/SearchBar",["common/main/lib/component/Window","common/main/lib/component/Button"],(function(){"use strict";Common.UI.SearchBar=Common.UI.Window.extend(_.extend({options:{modal:!1,width:328,height:54,header:!1,cls:"search-bar",alias:"SearchBar",showOpenPanel:!0,toolclose:"hide",automove:!1},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="search-input-group">','<input type="text" id="search-bar-text" class="input-field form-control" maxlength="255" placeholder="'+this.textFind+'" autocomplete="off">','<div id="search-bar-results">0/0</div>',"</div>",'<div class="tools">','<div id="search-bar-back"></div>','<div id="search-bar-next"></div>',this.options.showOpenPanel?'<div id="search-bar-open-panel"></div>':"",'<div id="search-bar-close"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.iconType=this.options.iconType,Common.UI.Window.prototype.initialize.call(this,this.options),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this)),$(window).on("resize",_.bind(this.onLayoutChanged,this))},render:function(){Common.UI.Window.prototype.render.call(this),this.inputSearch=this.$window.find("#search-bar-text"),this.inputSearch.on("input",_.bind((function(){this.disableNavButtons(),this.fireEvent("search:input",[this.inputSearch.val()])}),this)).on("keydown",_.bind((function(t){this.fireEvent("search:keydown",[this.inputSearch.val(),t])}),this));const t="svg"===this.iconType;return this.btnBack=new Common.UI.Button({parentEl:$("#search-bar-back"),cls:"btn-toolbar",iconCls:t?"svg-icon search-arrow-up":"toolbar__icon btn-arrow-up",hint:this.tipPreviousResult,scaling:!t}),this.btnBack.on("click",_.bind(this.onBtnNextClick,this,"back")),this.btnNext=new Common.UI.Button({parentEl:$("#search-bar-next"),cls:"btn-toolbar",iconCls:t?"svg-icon search-arrow-down":"toolbar__icon btn-arrow-down",hint:this.tipNextResult,scaling:!t}),this.btnNext.on("click",_.bind(this.onBtnNextClick,this,"next")),this.options.showOpenPanel&&(this.btnOpenPanel=new Common.UI.Button({parentEl:$("#search-bar-open-panel"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-more-vertical",hint:this.tipOpenAdvancedSettings}),this.btnOpenPanel.on("click",_.bind(this.onOpenPanel,this))),this.btnClose=new Common.UI.Button({parentEl:$("#search-bar-close"),cls:"btn-toolbar",iconCls:t?"svg-icon search-close":"toolbar__icon btn-close",hint:this.tipCloseSearch,scaling:!t}),this.btnClose.on("click",_.bind((function(){this.hide()}),this)),this.searchResults=$("#search-bar-results"),this.on("animate:before",_.bind(this.focus,this)),Common.NotificationCenter.on("search:updateresults",_.bind((function(t,e){this.disableNavButtons(t,e),this.updateResultsNumber(t,e)}),this)),this},show:function(t){var e=($("#app-title").length>0?$("#app-title").height():0)+$("#toolbar").height()+2,i=Common.UI.isRTL()?($("#right-menu").is(":visible")?$("#right-menu").width():0)+32:Common.Utils.innerWidth()-($("#right-menu").is(":visible")?$("#right-menu").width():0)-this.options.width-32;Common.UI.Window.prototype.show.call(this,i,e),this.disableNavButtons(),t?(this.inputSearch.val(t),this.fireEvent("search:input",[t])):(this.inputSearch.val(""),window.SSE&&this.fireEvent("search:input",["",!0])),this.focus()},focus:function(){var t=this;setTimeout((function(){t.inputSearch.focus(),t.inputSearch.select()}),10)},setText:function(t){this.inputSearch.val(t),this.fireEvent("search:input",[t])},getSettings:function(){return{}},onLayoutChanged:function(){var t=$("#app-title").height()+$("#toolbar").height()+2,e=Common.UI.isRTL()?($("#right-menu").is(":visible")?$("#right-menu").width():0)+32:Common.Utils.innerWidth()-($("#right-menu").is(":visible")?$("#right-menu").width():0)-this.options.width-32;this.$window.css({left:e,top:t})},onBtnNextClick:function(t){this.fireEvent("search:"+t,[this.inputSearch.val(),!1])},onOpenPanel:function(){this.hide(),this.fireEvent("search:show",[!0,this.inputSearch.val()])},disableNavButtons:function(t,e){var i=""===this.inputSearch.val()&&!window.SSE||!e;this.btnBack.setDisabled(i),this.btnNext.setDisabled(i)},updateResultsNumber:function(t,e){this.searchResults.text(!e||""===this.inputSearch.val()&&!window.SSE?"0/0":Common.UI.isRTL()?e+"/"+(t+1):t+1+"/"+e),this.inputSearch.css(Common.UI.isRTL()?"padding-left":"padding-right",this.searchResults.outerWidth()+"px")},textFind:"Find",tipPreviousResult:"Previous result",tipNextResult:"Next result",tipOpenAdvancedSettings:"Open advanced settings",tipCloseSearch:"Close search"},Common.UI.SearchBar||{}))})),define("text!pdfeditor/main/app/template/Viewport.template",[],(function(){return'<div class="layout-region">\n    <div id="viewport-vbox-layout" class="layout-ct vbox">\n        <section class="layout-ct">\n            <div id="file-menu-panel" class="toolbar-fullview-panel hint-section" style="display:none;"></div>\n        </section>\n        <section id="app-title" class="layout-item"></section>\n        <div id="toolbar" class="layout-item hint-section" data-layout-name="toolbar"></div>\n        <div class="layout-item middle">\n            <div id="viewport-hbox-layout" class="layout-ct hbox">\n                <div id="left-menu" class="layout-item hint-section" data-layout-name="leftMenu" style="width: 40px;"></div>\n                <div id="about-menu-panel" class="left-menu-full-ct" style="display:none;"></div>\n                <div id="editor-container" class="layout-item"><div id="editor_sdk"></div></div>\n            </div>\n        </div>\n        <div id="statusbar" class="layout-item" data-layout-name="statusBar"></div>\n    </div>\n</div>'})),void 0===Common)var Common={};if(define("common/main/lib/component/Layout",["backbone"],(function(){"use strict";var t=function(t){this.box=null,this.panels=[],this.splitters=[],_.extend(this,t||{})},e=function(){return{width:null,height:null,resize:!1,stretch:!1,rely:!1}};_.extend(t.prototype,Backbone.Events,{initialize:function(t){this.$parent=this.box.parent(),this.resize={eventMove:_.bind(this.resizeMove,this),eventStop:_.bind(this.resizeStop,this)};this.freeze=t.freeze,this.changeLayout(t.items)},doLayout:function(){},changeLayout:function(t){var i,n,o=!1;this.splitters&&this.splitters.forEach((function(t){t.resizer&&t.resizer.el.remove()}),this),this.splitters=[],this.panels=[],t.forEach((function(t){t.el instanceof HTMLElement&&(t.el=$(t.el)),(i=_.extend(new e,t)).stretch&&(o=!0,i.rely=!1,i.resize=!1),this.panels.push(i),i.resize&&(n={isresizer:!0,minpos:i.resize.min||0,maxpos:i.resize.max||0,fmin:i.resize.fmin,fmax:i.resize.fmax,behaviour:i.behaviour,index:this.splitters.length,offset:i.resize.offset||0,multiply:i.resize.multiply},o?(i.resize.el=n.el=i.el.before('<div class="layout-resizer before"></div>').prev(),this.panels.splice(this.panels.length-1,0,n)):(i.resize.el=n.el=i.el.after('<div class="layout-resizer after"></div>').next(),this.panels.push(n)),this.splitters.push({resizer:n}),i.resize.hidden&&n.el.hide(),Common.Gateway.on("processmouse",this.resize.eventStop))}),this),this.freezePanels(this.freeze)},getElementHeight:function(t){return parseInt(t.css("height"))},getElementWidth:function(t){return parseInt(t.css("width"))},getItem:function(t){for(var e in this.panels){var i=this.panels[e];if(i.alias==t)return i}},onSelectStart:function(t){return t.preventDefault&&t.preventDefault(),!1},addHandler:function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},removeHandler:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null},clearSelection:function(){if(window.getSelection){var t=window.getSelection();t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges()}else document.selection&&document.selection.empty()},resizeStart:function(t){if(!this.freeze){this.clearSelection(),this.addHandler(window.document,"selectstart",this.onSelectStart),$(document).on({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),Common.NotificationCenter.on({"frame:mousemove":this.resize.eventMove,"frame:mouseup":this.resize.eventStop});var e=t.data.panel;this.resize.type=t.data.type,this.resize.$el=e.el,this.resize.min=e.minpos>0?e.minpos:this.resize.$el.parent().width()+e.minpos,this.resize.fmin=e.fmin,this.resize.fmax=e.fmax,this.resize.behaviour=e.behaviour,this.resize.multiply=e.multiply,this.resize.$el.addClass("move"),"vertical"==t.data.type?(this.resize.height=parseInt(this.resize.$el.css("height")),this.resize.max=(e.maxpos>0?e.maxpos:this.resize.$el.parent().height()+e.maxpos)-this.resize.height,this.resize.inity=t.pageY*Common.Utils.zoom()-parseInt(t.currentTarget.style.top)):"horizontal"==t.data.type&&(this.resize.width=parseInt(this.resize.$el.css("width")),this.resize.max=(e.maxpos>0?e.maxpos:this.resize.$el.parent().width()+e.maxpos)-this.resize.width,this.resize.initx=t.pageX*Common.Utils.zoom()-parseInt(t.currentTarget.style.left)),this.resize.multiply&&this.resize.multiply.koeff&&(this.resize.max=Math.floor(this.resize.max/this.resize.multiply.koeff)*this.resize.multiply.koeff+(this.resize.multiply.offset||0)),Common.NotificationCenter.trigger("layout:resizestart")}},resizeMove:function(t){var e=t instanceof jQuery.Event?Common.Utils.zoom():1;if("vertical"==this.resize.type)var i="top",n=t.pageY*e-this.resize.inity;else"horizontal"==this.resize.type&&(i="left",n=t.pageX*e-this.resize.initx);if(this.resize.multiply&&this.resize.multiply.koeff){var o=this.resize.multiply.koeff,s=n/o,a=Math.floor(s)*o+(this.resize.multiply.offset||0),r=Math.ceil(s)*o+(this.resize.multiply.offset||0);n=n>a+o/2?r:a}this.resize.fmin&&this.resize.fmax?n<this.resize.fmin()||n>this.resize.fmax()||(this.resize.$el[0].style[i]=n+"px"):n<this.resize.min||n>this.resize.max||(this.resize.$el[0].style[i]=n+"px")},resizeStop:function(t){if(this.removeHandler(window.document,"selectstart",this.onSelectStart),$(document).off({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),Common.NotificationCenter.off({"frame:mousemove":this.resize.eventMove,"frame:mouseup":this.resize.eventStop}),this.resize.$el){var e=t instanceof jQuery.Event?Common.Utils.zoom():1;if(t instanceof jQuery.Event||void 0!==t.pageY&&void 0!==t.pageX||(t.pageY=t.y,t.pageX=t.x),"vertical"==this.resize.type)var i="height",n=t.pageY*e-this.resize.inity;else"horizontal"==this.resize.type&&(i="width",n=t.pageX*e-this.resize.initx);if(this.resize.multiply&&this.resize.multiply.koeff){var o=this.resize.multiply.koeff,s=n/o,a=Math.floor(s)*o+(this.resize.multiply.offset||0),r=Math.ceil(s)*o+(this.resize.multiply.offset||0);n=n>a+o/2?r:a}this.resize.fmin&&this.resize.fmax?(n<this.resize.fmin()&&(n=this.resize.fmin()),n>this.resize.fmax()&&(n=this.resize.fmax())):(n<this.resize.min&&(n=this.resize.min),n>this.resize.max&&(n=this.resize.max));var l=null,c=null,d=0;this.resize.$el.hasClass("after")?(l=this.resize.$el.prev(),c=this.resize.$el.next(),d=parseInt(l.css(i))):(l=this.resize.$el.next(),c=this.resize.$el.prev(),d=parseInt(l.css(i)),n=l.parent()[i]()-(n+this.resize[i])),"vertical"==this.resize.type&&(n-=l.position().top),l.css(i,n+"px"),this.resize.behaviour&&c.css(i,parseInt(c.css(i))-(n-d)),this.resize.$el.removeClass("move"),delete this.resize.$el,this.resize.value!=n&&(this.doLayout(),this.trigger("layout:resizedrag",this)),Common.NotificationCenter.trigger("layout:resizestop")}},freezePanels:function(t){this.panels.forEach((function(e){!e.stretch&&e.resize&&$(e.resize.el).css("cursor",t?"default":"")})),this.freeze=t},setResizeValue:function(t,e){if(t>=this.splitters.length)return this.doLayout(),!1;var i=null,n=null,o=0,s=this.splitters[t].resizer,a="height";return e<s.fmin()&&(e=s.fmin()),e>s.fmax()&&(e=s.fmax()),s.el.hasClass("after")?(i=s.el.prev(),n=s.el.next(),o=parseInt(i.css(a))):(e=(i=s.el.next()).parent()[a]()-(e+s[a]),n=s.el.next(),o=parseInt(i.css(a))),e-=i.position().top,i.css(a,e+"px"),s.behaviour&&n.css(a,parseInt(n.css(a))-(e-o)),s.value!=e&&this.doLayout(),Math.abs(o-e)>.99}}),!Common.UI&&(Common.UI={}),Common.UI.VBoxLayout=function(e){t.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.VBoxLayout.prototype=_.extend(new t,{initialize:function(e){t.prototype.initialize.call(this,e)},doLayout:function(){var t,e,i=0;this.panels.forEach((function(n){n.stretch?t=n:((e=n.el.is(":visible"))&&(i+=!0!==n.rely?n.height:this.getElementHeight(n.el)),n.resize&&!1!==n.resize.autohide&&n.resize.el&&(e?(n.resize.el.show(),t&&(i+=n.resize.height)):(n.resize.el.hide(),t&&(i-=n.resize.height))))}),this),t&&(t.height=this.$parent.height()-i),i=0,this.panels.forEach((function(t){t.el.is(":visible")&&(e={top:i},!0!==t.rely&&(e.height=t.height),t.el.css(e),i+=e.height||this.getElementHeight(t.el))}),this)},changeLayout:function(e){t.prototype.changeLayout.call(this,e),this.panels.forEach((function(t){!t.stretch&&!t.height&&(t.height=this.getElementHeight(t.el)),t.isresizer&&t.el.on("mousedown",{type:"vertical",panel:t},_.bind(this.resizeStart,this))}),this),this.doLayout.call(this)}}),Common.UI.HBoxLayout=function(e){t.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.HBoxLayout.prototype=_.extend(new t,{initialize:function(e){t.prototype.initialize.call(this,e)},doLayout:function(t){var e,i,n=0;this.panels.forEach((function(t){t.stretch?e=t:((i=t.el.is(":visible"))&&(t.isresizer?n+=t.offset:n+=!0!==t.rely?t.width:this.getElementWidth(t.el)),t.resize&&!1!==t.resize.autohide&&t.resize.el&&(i?(t.resize.el.show(),e&&(n-=t.resize.width)):(t.resize.el.hide(),e&&(n-=t.resize.width))))}),this),e&&(e.width=this.$parent.width()-n),n=0,this.panels.forEach((function(t){t.el.is(":visible")&&(i={left:n-(t.isresizer?t.width:0)},!0!==t.rely&&(i.width=t.width),t.el.css(i),t.isresizer?n+=t.offset:n+=this.getElementWidth(t.el))}),this)},changeLayout:function(e){t.prototype.changeLayout.call(this,e),this.panels.forEach((function(t){!t.stretch&&!t.width&&(t.width=this.getElementWidth(t.el)),t.isresizer&&t.el.on("mousedown",{type:"horizontal",panel:t},_.bind(this.resizeStart,this))}),this),this.doLayout.call(this)}}),Common.UI.VBoxLayout.prototype.constructor=Common.UI.VBoxLayout,Common.UI.HBoxLayout.prototype.constructor=Common.UI.HBoxLayout})),define("pdfeditor/main/app/view/Viewport",["text!pdfeditor/main/app/template/Viewport.template","jquery","underscore","backbone","common/main/lib/component/Layout"],(function(t,e,i,n){"use strict";PDFE.Views.Viewport=n.View.extend({el:"#viewport",template:i.template(t),events:{},initialize:function(){},render:function(){this.$el.html(this.template({})),Common.Utils.isSafari?(e("body").addClass("safari"),e("body").mousewheel((function(t){t.preventDefault(),t.stopPropagation()}))):Common.Utils.isChrome&&e("body").addClass("chrome");var t=e("#viewport-vbox-layout",this.$el);this.vlayout=new Common.UI.VBoxLayout({box:t,items:[{el:t.find("> .layout-item#app-title").hide(),alias:"title",height:Common.Utils.InternalSettings.get("document-title-height")},{el:t.find(" > .layout-item#toolbar"),alias:"toolbar",height:Common.localStorage.getBool("pdfe-compact-toolbar")?Common.Utils.InternalSettings.get("toolbar-height-compact"):Common.Utils.InternalSettings.get("toolbar-height-normal")},{el:t.find(" > .layout-item.middle"),stretch:!0},{el:t.find(" > .layout-item#statusbar"),height:25}]});var i=(t=e("#viewport-hbox-layout",this.$el)).find(" > .layout-item");let n=[{el:i[0],rely:!0,alias:"left",resize:{hidden:!0,autohide:!1,min:300,max:600}},{el:i[1],stretch:!0}];return Common.UI.isRTL()&&(n[0].resize.min=-600,n[0].resize.max=-300,[n[0],n[1]]=[n[1],n[0]]),this.hlayout=new Common.UI.HBoxLayout({box:t,items:n}),this},applyEditorMode:function(){},applyCommonMode:function(){Common.localStorage.getBool("pdfe-hidden-status")&&PDFE.getController("Statusbar").getView("Statusbar").setVisible(!1);var t=Common.UI.LayoutManager.getInitValue("leftMenu");t=void 0!==t&&!t,Common.localStorage.getBool("pdfe-hidden-leftmenu",t)&&PDFE.getController("LeftMenu").getView("LeftMenu").hide()},setMode:function(t){t.isDisconnected?(i.isUndefined(this.mode)&&(this.mode={}),this.mode.canCoAuthoring=!1):this.mode=t}})})),define("text!pdfeditor/main/app/template/LeftMenu.template",[],(function(){return'<div id="view-left-menu" class="tool-menu left">\n    <div class="tool-menu-btns">\n        <button id="left-btn-searchbar" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-search"><i class="icon toolbar__icon btn-menu-search">&nbsp;</i></button>\n        \x3c!-- /** coauthoring begin **/ --\x3e\n        <button id="left-btn-comments" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-comments"><i class="icon toolbar__icon btn-menu-comments">&nbsp;</i></button>\n        <button id="left-btn-chat" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-chat"><i class="icon toolbar__icon btn-menu-chat">&nbsp;</i></button>\n        \x3c!-- /** coauthoring end **/ --\x3e\n        <button id="left-btn-plugins" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-plugin">&nbsp;</i></button>\n        <button id="left-btn-navigation" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="" data-layout-name="leftMenu-navigation"><i class="icon toolbar__icon btn-menu-navigation">&nbsp;</i></button>\n        <button id="left-btn-thumbnails" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-thumbs">&nbsp;</i></button>\n        <button id="left-btn-support" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-support">&nbsp;</i></button>\n        <button id="left-btn-about" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-about">&nbsp;</i></button>\n    </div>\n    <div class="left-panel" style="">\n        <div id="left-panel-search" class="" style="display: none;"></div>\n        \x3c!-- /** coauthoring begin **/ --\x3e\n        <div id="left-panel-comments" class="" style="display: none;"></div>\n        <div id="left-panel-chat" class="" style="display: none;"></div>\n        \x3c!-- /** coauthoring end **/ --\x3e\n        <div id="left-panel-navigation" class="" style="display: none; height: 100%;"></div>\n        <div id="left-panel-thumbnails" class="" style="display: none; height: 100%;"></div>\n        <div id="left-panel-plugins" class="" style="display: none; height: 100%;"></div>\n    </div>\n</div>'})),function(t){"function"==typeof define&&define.amd?define("jmousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}((function(t){var e,i,n=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],s=Array.prototype.slice;if(t.event.fixHooks)for(var a=n.length;a;)t.event.fixHooks[n[--a]]=t.event.mouseHooks;var r=t.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var e=o.length;e;)this.addEventListener(o[--e],l,!1);else this.onmousewheel=l;t.data(this,"mousewheel-line-height",r.getLineHeight(this)),t.data(this,"mousewheel-page-height",r.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=o.length;t;)this.removeEventListener(o[--t],l,!1);else this.onmousewheel=null},getLineHeight:function(e){return parseInt(t(e)["offsetParent"in t.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0}};function l(n){var o,a=n||window.event,r=s.call(arguments,1),l=0,h=0,m=0;if((n=t.event.fix(a)).type="mousewheel","detail"in a&&(m=-1*a.detail),"wheelDelta"in a&&(m=a.wheelDelta),"wheelDeltaY"in a&&(m=a.wheelDeltaY),"wheelDeltaX"in a&&(h=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(h=-1*m,m=0),l=0===m?h:m,"deltaY"in a&&(l=m=-1*a.deltaY),"deltaX"in a&&(h=a.deltaX,0===m&&(l=-1*h)),0!==m||0!==h){if(1===a.deltaMode){var u=t.data(this,"mousewheel-line-height");l*=u,m*=u,h*=u}else if(2===a.deltaMode){var p=t.data(this,"mousewheel-page-height");l*=p,m*=p,h*=p}return o=Math.max(Math.abs(m),Math.abs(h)),(!i||o<i)&&(i=o,d(a,o)&&(i/=40)),d(a,o)&&(l/=40,h/=40,m/=40),l=Math[l>=1?"floor":"ceil"](l/i),h=Math[h>=1?"floor":"ceil"](h/i),m=Math[m>=1?"floor":"ceil"](m/i),n.deltaX=h,n.deltaY=m,n.deltaFactor=i,n.deltaMode=0,r.unshift(n,l,h,m),e&&clearTimeout(e),e=setTimeout(c,200),(t.event.dispatch||t.event.handle).apply(this,r)}}function c(){i=null}function d(t,e){return r.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})),function(t){"use strict";"function"==typeof define&&define.amd?define("perfectscrollbar",["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}((function(t){"use strict";var e,i={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1,includeMargin:!0},n=(e=0,function(){var t=e;return e+=1,".perfect-scrollbar-"+t});t.fn.perfectScrollbar=function(e,o){return this.each((function(){var s=t.extend(!0,{},i),a=t(this);if("object"==typeof e?t.extend(!0,s,e):o=e,"update"===o)return a.data("perfect-scrollbar-update")&&a.data("perfect-scrollbar-update")(),a;if("destroy"===o)return a.data("perfect-scrollbar-destroy")&&a.data("perfect-scrollbar-destroy")(),a;if(a.data("perfect-scrollbar"))return a.data("perfect-scrollbar");a.addClass("ps-container oo");var r,l,c,d,h,m,u,p,f,g,b,v,C,y,w,x,_,S,k,T,A,I,P,E,D=t("<div class='ps-scrollbar-x-rail'></div>").appendTo(a),U=t("<div class='ps-scrollbar-y-rail'></div>").appendTo(a),M=t("<div class='ps-scrollbar-x'></div>").appendTo(D),L=t("<div class='ps-scrollbar-y'></div>").appendTo(U),F=parseInt(D.css("bottom"),10),V=parseInt(U.css("right"),10),B=n(),O=function(t){return s.minScrollbarLength&&(t=Math.max(t,s.minScrollbarLength)),t},R=function(){D.css({left:a.scrollLeft(),bottom:F-a.scrollTop(),width:f,display:r?"inherit":"none"}),U.hasClass("in-scrolling")?U.css({right:V-a.scrollLeft(),height:v,display:l?"inherit":"none"}):U.css({top:a.scrollTop(),right:V-a.scrollLeft(),height:v,display:l?"inherit":"none"}),M&&M.css({left:p,width:u}),L&&L.css({top:b,height:g})},$=function(){c=s.includePadding?a.innerWidth():a.width(),d=s.includePadding?a.innerHeight():a.height(),v=d-(s.includeMargin?parseInt(U.css("margin-top"))+parseInt(U.css("margin-bottom")):0),f=c-(s.includeMargin?parseInt(D.css("margin-left"))+parseInt(D.css("margin-right")):0),h=a.prop("scrollWidth"),m=a.prop("scrollHeight"),!s.suppressScrollX&&c+s.scrollXMarginOffset<h?(r=!0,u=O(parseInt(f*c/h,10)),p=parseInt(a.scrollLeft()*(f-u)/(h-c),10)):(r=!1,u=0,p=0,a.scrollLeft(0)),!s.suppressScrollY&&d+s.scrollYMarginOffset<m?(l=!0,g=O(parseInt(v*d/m,10)),b=parseInt(a.scrollTop()*(v-g)/(m-d),10)):(l=!1,g=0,b=0,a.scrollTop(0)),b>=v-g&&(b=v-g),p>=f-u&&(p=f-u),R(),s.onChange&&s.onChange(this)},H=function(){var e,i;M.bind("mousedown"+B,(function(t){Common.NotificationCenter.trigger("hints:clear"),i=t.pageX,e=M.position().left,D.addClass("in-scrolling"),t.stopPropagation(),t.preventDefault()})),t(document).bind("mousemove"+B,(function(t){D.hasClass("in-scrolling")&&(!function(t,e){var i=t+e,n=f-u;p=i<0?0:i>n?n:i;var o=parseInt(p*(h-c)/(f-u),10);a.scrollLeft(o),U.css({right:V-o})}(e,t.pageX-i),t.stopPropagation(),t.preventDefault())})),t(document).bind("mouseup"+B,(function(t){D.hasClass("in-scrolling")&&D.removeClass("in-scrolling")})),e=i=null},N=function(){var e,i;L.bind("mousedown"+B,(function(t){Common.NotificationCenter.trigger("hints:clear"),i=t.pageY,e=L.position().top,U.addClass("in-scrolling");var n=parseInt(U.css("margin-top")),o=U[0].getBoundingClientRect();U.css({position:"fixed",left:o.left,top:o.top-n}),t.stopPropagation(),t.preventDefault()})),t(document).bind("mousemove"+B,(function(t){U.hasClass("in-scrolling")&&(!function(t,e){var i=t+e,n=v-g;b=i<0?0:i>n?n:i;var o=parseInt(b*(m-d)/(v-g),10);a.scrollTop(o),D.css({bottom:F-o})}(e,t.pageY-i),t.stopPropagation(),t.preventDefault())})),t(document).bind("mouseup"+B,(function(t){U.hasClass("in-scrolling")&&(U.removeClass("in-scrolling"),U.css({position:"",left:"",top:""}),R())})),e=i=null},z=function(t,e){var i=a.scrollTop();if(0===t){if(!l)return!1;if(0===i&&e>0||i>=m-d&&e<0)return!s.wheelPropagation}var n=a.scrollLeft();if(0===e){if(!r)return!1;if(0===n&&t<0||n>=h-c&&t>0)return!s.wheelPropagation}return!0},W=function(){a.unbind(B),t(window).unbind(B),t(document).unbind(B),a.data("perfect-scrollbar",null),a.data("perfect-scrollbar-update",null),a.data("perfect-scrollbar-destroy",null),M.remove(),L.remove(),D.remove(),U.remove(),M=L=c=d=h=m=u=p=F=g=b=V=null},j="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;return(E=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/))&&"msie"===E[1]&&(C=parseInt(E[2],10),a.addClass("ie").addClass("ie"+C),6===C&&(y=function(){t(this).addClass("hover")},w=function(){t(this).removeClass("hover")},a.bind("mouseenter"+B,y).bind("mouseleave"+B,w),D.bind("mouseenter"+B,y).bind("mouseleave"+B,w),U.bind("mouseenter"+B,y).bind("mouseleave"+B,w),M.bind("mouseenter"+B,y).bind("mouseleave"+B,w),L.bind("mouseenter"+B,y).bind("mouseleave"+B,w),R=function(){M.css({left:p+a.scrollLeft(),bottom:F,width:u}),L.css({top:b+a.scrollTop(),right:V,height:g}),M.hide().show(),L.hide().show()})),$(),a.bind("scroll"+B,(function(t){$()})),H(),N(),x=function(t){t.stopPropagation()},L.bind("click"+B,x),U.bind("click"+B,(function(t){var e=parseInt(g/2,10),i=(t.pageY-U.offset().top-e)/(v-g);i<0?i=0:i>1&&(i=1),a.scrollTop((m-d)*i)})),M.bind("click"+B,x),D.bind("click"+B,(function(t){var e=parseInt(u/2,10),i=(t.pageX-D.offset().left-e)/(f-u);i<0?i=0:i>1&&(i=1),a.scrollLeft((h-c)*i)})),j&&(_=function(t,e){a.scrollTop(a.scrollTop()-e),a.scrollLeft(a.scrollLeft()-t),$()},S={},k=0,T={},A=null,I=!1,t(window).bind("touchstart"+B,(function(t){I=!0})),t(window).bind("touchend"+B,(function(t){I=!1})),a.bind("touchstart"+B,(function(t){var e=t.originalEvent.targetTouches[0];S.pageX=e.pageX,S.pageY=e.pageY,k=(new Date).getTime(),null!==A&&clearInterval(A),t.stopPropagation()})),a.bind("touchmove"+B,(function(t){if(!I&&1===t.originalEvent.targetTouches.length){var e=t.originalEvent.targetTouches[0],i={};i.pageX=e.pageX,i.pageY=e.pageY;var n=i.pageX-S.pageX,o=i.pageY-S.pageY;_(n,o),S=i;var s=(new Date).getTime(),a=s-k;a>0&&(T.x=n/a,T.y=o/a,k=s),t.preventDefault()}})),a.bind("touchend"+B,(function(t){clearInterval(A),A=setInterval((function(){Math.abs(T.x)<.01&&Math.abs(T.y)<.01?clearInterval(A):(_(30*T.x,30*T.y),T.x*=.8,T.y*=.8)}),10)}))),a.mousewheel&&function(){s.wheelSpeed/=10;var e=!1;a.bind("mousewheel"+B,(function(i,n,o,c){Common.NotificationCenter.trigger("hints:clear");var d=i.deltaX*i.deltaFactor||o,h=i.deltaY*i.deltaFactor||c;if(i&&i.target&&("textarea"===i.target.type||"input"===i.target.type)){i.stopImmediatePropagation(),i.preventDefault();var m=t(i.target).scrollTop(),u=0;return i.originalEvent?i.originalEvent.wheelDelta?u=i.originalEvent.wheelDelta:i.originalEvent.deltaY?u=40*-i.originalEvent.deltaY:i.originalEvent.detail&&(u=i.originalEvent.detail):u=void 0!==i.wheelDelta?i.wheelDelta:i.deltaY,void t(i.target).scrollTop(m-u)}e=!1,s.useBothWheelAxes?l&&!r?(h?a.scrollTop(a.scrollTop()-h*s.wheelSpeed):a.scrollTop(a.scrollTop()+d*s.wheelSpeed),e=!0):r&&!l&&(d?a.scrollLeft(a.scrollLeft()+d*s.wheelSpeed):a.scrollLeft(a.scrollLeft()-h*s.wheelSpeed),e=!0):(a.scrollTop(a.scrollTop()-h*s.wheelSpeed),a.scrollLeft(a.scrollLeft()+d*s.wheelSpeed)),$(),(e=e||z(d,h))&&(i.stopPropagation(),i.preventDefault())})),a.bind("MozMousePixelScroll"+B,(function(t){e&&t.preventDefault()}))}(),s.useKeyboard&&(P=!1,a.bind("mouseenter"+B,(function(t){P=!0})),a.bind("mouseleave"+B,(function(t){P=!1})),t(document).bind("keydown"+B,(function(e){if(P&&!t(document.activeElement).is(":input,[contenteditable]")){var i=0,n=0;switch(e.which){case 37:i=-30;break;case 38:n=30;break;case 39:i=30;break;case 40:n=-30;break;case 33:n=90;break;case 32:case 34:n=-90;break;case 35:n=-d;break;case 36:n=d;break;default:return}a.scrollTop(a.scrollTop()-n),a.scrollLeft(a.scrollLeft()+i),z(i,n)&&e.preventDefault()}}))),a.data("perfect-scrollbar",a),a.data("perfect-scrollbar-update",$),a.data("perfect-scrollbar-destroy",W),a}))}})),void 0===Common)var Common={};function _extend_object(t,e){return"undefined"!=typeof _?_.extend({},t,e):Object?Object.assign({},t,e):e}define("common/main/lib/component/Scroller",["jmousewheel","perfectscrollbar","common/main/lib/component/BaseView"],(function(){"use strict";var t;Common.UI.Scroller=_.extend(Common.UI.BaseView.extend({options:{wheelSpeed:20,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:5,scrollYMarginOffset:5,includePadding:!0,includeMargin:!0,alwaysVisibleX:!1,alwaysVisibleY:!1,scrollYStyle:null},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(){var t=this;return t.cmpEl=t.$el||$(this.el),t.rendered||(t.cmpEl.perfectScrollbar(_.extend({},t.options)),t.rendered=!0,this.setAlwaysVisibleX(t.options.alwaysVisibleX),this.setAlwaysVisibleY(t.options.alwaysVisibleY),this.options.scrollYStyle&&this.setOptionStyleY(this.options.scrollYStyle)),this},remove:function(){this.destroy(),Backbone.View.prototype.remove.call(this)},update:function(e){var i=this.options;e?(this.destroy(),i=_.extend(this.options,e),this.cmpEl.perfectScrollbar(i)):this.cmpEl.perfectScrollbar("update"),this.setAlwaysVisibleX(i.alwaysVisibleX),this.setAlwaysVisibleY(i.alwaysVisibleY),i.scrollYStyle&&this.setOptionStyleY(i.scrollYStyle);var n=function(e){t=!0;var i=function(e){$(document).unbind("mouseup",i),_.delay((function(){t=!1}),10)};$(document).mouseup(i)};$(".ps-scrollbar-x-rail, .ps-scrollbar-y-rail, .ps-scrollbar-x, .ps-scrollbar-y",this.cmpEl).off("mousedown",n).on("mousedown",n)},destroy:function(){this.cmpEl.perfectScrollbar("destroy")},scrollLeft:function(t){this.cmpEl.scrollLeft(t),this.update()},scrollTop:function(t){this.cmpEl.scrollTop(t),this.update()},getScrollTop:function(){return this.cmpEl.scrollTop()},getScrollLeft:function(){return this.cmpEl.scrollLeft()},setAlwaysVisibleX:function(t){t?($(this.el).find(".ps-scrollbar-x-rail").addClass("always-visible-x"),$(this.el).find(".ps-scrollbar-x").addClass("always-visible-x")):($(this.el).find(".ps-scrollbar-x-rail").removeClass("always-visible-x"),$(this.el).find(".ps-scrollbar-x").addClass("always-visible-x"))},setAlwaysVisibleY:function(t){t?($(this.el).find(".ps-scrollbar-y-rail").addClass("always-visible-y"),$(this.el).find(".ps-scrollbar-y").addClass("always-visible-y")):($(this.el).find(".ps-scrollbar-y-rail").removeClass("always-visible-y"),$(this.el).find(".ps-scrollbar-y").addClass("always-visible-y"))},setOptionStyleY:function(t){$(this.el).find(".ps-scrollbar-y-rail").css(t),this.cmpEl.perfectScrollbar("update")},isVisible:function(){return $(this.el).find(".ps-scrollbar-y-rail").is(":visible")}}),{isMouseCapture:function(){return t}})})),define("common/main/lib/view/About",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],(function(){"use strict";Common.Views.About=Common.UI.BaseView.extend(_.extend({menu:void 0,rendered:!1,options:{alias:"Common.Views.About"},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.txtVersionNum="7.5.1.0",!/\s$/.test(this.txtAddress)&&(this.txtAddress+=" "),!/\s$/.test(this.txtMail)&&(this.txtMail+=" "),!/\s$/.test(this.txtTel)&&(this.txtTel+=" "),!/\s$/.test(this.txtVersion)&&(this.txtVersion+=" "),this.template=_.template(['<table id="id-about-licensor-logo" cols="1" style="width: 100%; margin-top: 20px;">',"<tr>",'<td align="center"><div class="asc-about-office"></div></td>',"</tr>","<tr>",'<td align="center"><label class="asc-about-version">'+t.appName.toUpperCase()+"</label></td>","</tr>","<tr>",'<td align="center"><label class="asc-about-version" id="id-about-licensor-version-name">'+this.txtVersion+this.txtVersionNum+"</label></td>","</tr>","</table>",'<table id="id-about-licensor-info" cols="3" style="width: 100%;" class="margin-bottom">',"<tr>",'<td colspan="3" align="center" style="padding: 20px 0 10px 0;"><label class="asc-about-companyname"><%= publishername %></label></td>',"</tr>","<tr>",'<td colspan="3" align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtAddress+"</label>",'<label class="asc-about-desc"><%= publisheraddr %></label>',"</td>","</tr>","<tr>",'<td colspan="3" align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtMail+"</label>",'<a href="mailto:<%= supportemail %>"><%= supportemail %></a>',"</td>","</tr>","<tr>",'<td colspan="3" align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtTel+"</label>",'<label class="asc-about-desc"><%= phonenum %></label>',"</td>","</tr>","<tr>",'<td colspan="3" align="center">','<a href="<%= publisherurl %>" target="_blank"><% print(publisherurl.replace(/https?:\\/{2}/, "").replace(/\\/$/,"")) %></a>',"</td>","</tr>","</table>",'<table id="id-about-licensee-info" cols="1" style="width: 100%; margin-top: 20px;" class="hidden margin-bottom"><tbody>',"<tr>",'<td align="center" class="padding-small"><div id="id-about-company-logo"></div></td>',"</tr>","<tr>",'<td align="center"><label class="asc-about-version">'+t.appName.toUpperCase()+"</label></td>","</tr>","<tr>",'<td align="center"><label style="padding-bottom: 29px;" class="asc-about-version" id="id-about-licensee-version-name">'+this.txtVersion+this.txtVersionNum+"</label></td>","</tr>","<tr>",'<td align="center" class="padding-small">','<label class="asc-about-companyname" id="id-about-company-name"></label>',"</td>","</tr>","<tr>",'<td align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtAddress+"</label>",'<label class="asc-about-desc" id="id-about-company-address"></label>',"</td>","</tr>","<tr>",'<td align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtMail+"</label>",'<a href="mailto:" id="id-about-company-mail"></a>',"</td>","</tr>","<tr>",'<td align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtTel+"</label>",'<label class="asc-about-desc" id="id-about-company-tel"></label>',"</td>","</tr>","<tr>",'<td align="center" class="padding-small">','<a href="" target="_blank" id="id-about-company-url"></a>',"</td>","</tr>","<tr>",'<td align="center">','<label class="asc-about-lic" id="id-about-company-lic"></label>',"</td>","</tr>","</table>",'<table id="id-about-licensor-short" cols="1" style="width: 100%; margin-top: 31px;" class="hidden"><tbody>',"<tr>",'<td style="width:50%;"><div class="separator horizontal short left"></div></td>','<td align="center"><label class="asc-about-header">'+this.txtPoweredBy+"</label></td>",'<td style="width:50%;"><div class="separator horizontal short"></div></td>',"</tr>","<tr>",'<td colspan="3" align="center" style="padding: 9px 0 10px;"><label class="asc-about-companyname"><%= publishername %></label></td>',"</tr>","<tr>",'<td colspan="3" align="center">','<a href="<%= publisherurl %>" target="_blank"><% print(publisherurl.replace(/https?:\\/{2}/, "").replace(/\\/$/,"")) %></a>',"</td>","</tr>","</table>"].join("")),this.menu=t.menu},render:function(){if(!this.rendered){this.rendered=!0;var t=$(this.template({publishername:"Ascensio System SIA",publisheraddr:"20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050",publisherurl:"https://www.onlyoffice.com",supportemail:"support@onlyoffice.com",phonenum:"+371 633-99867",scope:this}));this.cntLicenseeInfo=t.findById("#id-about-licensee-info"),this.cntLicensorInfo=t.findById("#id-about-licensor-info"),this.divCompanyLogo=t.findById("#id-about-company-logo"),this.lblCompanyName=t.findById("#id-about-company-name"),this.lblCompanyAddress=t.findById("#id-about-company-address"),this.lblCompanyMail=t.findById("#id-about-company-mail"),this.lblCompanyUrl=t.findById("#id-about-company-url"),this.lblCompanyLic=t.findById("#id-about-company-lic"),this.lblCompanyTel=t.findById("#id-about-company-tel"),this.$el.html(t),this.$el.addClass("about-dlg"),this.licData&&this.setLicInfo(this.licData),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0}))}return this},setLicInfo:function(t){if(this.rendered)if(t&&"object"==typeof t&&t.customer&&"object"==typeof t.customer){this.licData=t;var e=t.customer;$("#id-about-licensor-logo").addClass("hidden"),$("#id-about-licensor-short").removeClass("hidden"),this.cntLicensorInfo.addClass("hidden"),this.cntLicenseeInfo.removeClass("hidden"),this.cntLicensorInfo.removeClass("margin-bottom");var i=e.name;if(i&&i.length?this.lblCompanyName.text(i):this.lblCompanyName.parents("tr").addClass("hidden"),(i=e.address)&&i.length?this.lblCompanyAddress.text(i):this.lblCompanyAddress.parents("tr").addClass("hidden"),(i=e.mail)&&i.length?this.lblCompanyMail.attr("href","mailto:"+i).text(i):this.lblCompanyMail.parents("tr").addClass("hidden"),(i=e.phone)&&i.length?this.lblCompanyTel.text(i):this.lblCompanyTel.parents("tr").addClass("hidden"),(i=e.www)&&i.length){var n=/^https?:\/{2}/i.test(i)?"":"http://";this.lblCompanyUrl.attr("href",n+i).text(i)}else this.lblCompanyUrl.parents("tr").addClass("hidden");(i=e.info)&&i.length?this.lblCompanyLic.text(i):this.lblCompanyLic.parents("tr").addClass("hidden"),(i=Common.UI.Themes.isDarkTheme()?e.logoDark||e.logo:e.logo||e.logoDark)&&i.length?this.divCompanyLogo.html('<img src="'+i+'" style="max-width:216px; max-height: 35px;" />'):this.divCompanyLogo.parents("tr").addClass("hidden"),i&&i.length&&Common.NotificationCenter.on("uitheme:changed",this.changeLogo.bind(this))}else this.cntLicenseeInfo.addClass("hidden"),this.cntLicensorInfo.addClass("margin-bottom");else this.licData=t||!0},changeLogo:function(){if(this.licData){var t=this.licData.customer;t.logo&&t.logoDark&&t.logo!==t.logoDark&&this.divCompanyLogo.find("img").attr("src",Common.UI.Themes.isDarkTheme()?t.logoDark||t.logo:t.logo||t.logoDark)}},show:function(){this.rendered||this.render(),Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this)},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},setMode:function(t){t.isLightVersion&&($("#id-about-licensor-version-name").text(this.txtEdition+this.txtVersion+this.txtVersionNum),$("#id-about-licensee-version-name").text(this.txtEdition+this.txtVersion+this.txtVersionNum))},txtPoweredBy:"Powered by",txtVersion:"Version ",txtLicensor:"LICENSOR",txtLicensee:"LICENSEE",txtAddress:"address: ",txtMail:"email: ",txtTel:"tel.: ",txtEdition:"Integration Edition "},Common.Views.About||{}))})),define("text!common/main/lib/template/Comments.template",[],(function(){return'<% if (!hide && !filtered) { %>\r\n    <div id="<%= id %>" class="user-comment-item">\r\n\r\n        \x3c!-- comment block --\x3e\r\n\r\n        <div class="user-name">\r\n            <div class="color" style="display: inline-block; background-color: <% if (usercolor!==null) { %><%=usercolor%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(parsedName) %>\r\n        </div>\r\n        <div class="user-date"><%=date%></div>\r\n        <% if (quote!==null && quote!==\'\') { %>\r\n        <div class="user-quote"><%=scope.getFixedQuote(quote)%></div>\r\n        <% } %>\r\n        <% if (!editText || scope.viewmode) { %>\r\n            <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(comment)%></div>\r\n        <% } else { %>\r\n            <div class="inner-edit-ct">\r\n                <textarea class="msg-reply user-select textarea-control" maxlength="maxCommLength"><%=comment%></textarea>\r\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change">textEdit</button>\r\n                <button class="btn normal dlg-btn btn-inner-close">textCancel</button>\r\n            </div>\r\n        <% } %>\r\n\r\n        \x3c!-- replys elements --\x3e\r\n\r\n        <% var add_arrow = true; %>\r\n        <% if (replys.length) { %>\r\n            <% _.each(replys, function (item, index) { %>\r\n                <% if (!item.get("hide")) { %>\r\n                <% if (add_arrow) { add_arrow = false; %>\r\n                    <div class="reply-arrow img-commonctrl"></div>\r\n                <% } %>\r\n                <div class="reply-item-ct" <% if (scope.viewmode && index==replys.length-1) { %>style="padding-bottom: 0;" <% } %>;>\r\n                    <div class="user-name">\r\n                        <div class="color" style="display: inline-block; background-color: <% if (item.get("usercolor")!==null) { %><%=item.get("usercolor")%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(item.get("parsedName")) %>\r\n                    </div>\r\n                    <div class="user-date"><%=item.get("date")%></div>\r\n                    <% if (!item.get("editText")) { %>\r\n                        <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(item.get("reply"))%></div>\r\n                        <% if (!scope.viewmode) { %>\r\n                            <div class="btns-reply-ct">\r\n                            <% if (item.get("editable")) { %>\r\n                                <div class="btn-edit img-commonctrl" data-value="<%=item.get("id")%>"></div>\r\n                            <% } %>\r\n                            <% if (item.get("removable")) { %>\r\n                                <div class="btn-delete img-commonctrl" data-value="<%=item.get("id")%>"></div>\r\n                            <% } %>\r\n                            </div>\r\n                        <%}%>\r\n                    <% } else { %>\r\n                        <div class="inner-edit-ct">\r\n                            <textarea class="msg-reply textarea-fix user-select textarea-control" maxlength="maxCommLength"><%=item.get("reply")%></textarea>\r\n                            <button class="btn normal dlg-btn primary btn-inner-edit btn-fix" id="id-comments-change">textEdit</button>\r\n                            <button class="btn normal dlg-btn btn-inner-close">textClose</button>\r\n                        </div>\r\n                    <% } %>\r\n                </div>\r\n                <% } %>\r\n            <% }); %>\r\n        <% } %>\r\n\r\n        \x3c!-- add reply button --\x3e\r\n\r\n        <% if (!showReply && !scope.viewmode) { %>\r\n            <% if (replys.length && !add_arrow) { %>\r\n                <label class="user-reply with-reply" role="presentation" tabindex="-1">textAddReply</label>\r\n            <% } else { %>\r\n                <label class="user-reply" role="presentation" tabindex="-1">textAddReply</label>\r\n            <% } %>\r\n        <% } %>\r\n\r\n        \x3c!-- edit buttons --\x3e\r\n\r\n        <% if (!editText && !lock) { %>\r\n            <div class="edit-ct">\r\n                <% if (!scope.viewmode) { %>\r\n                    <% if (editable) { %>\r\n                        <div class="btn-edit img-commonctrl"></div>\r\n                    <% } %>\r\n                    <% if (removable) { %>\r\n                        <div class="btn-delete img-commonctrl"></div>\r\n                    <% } %>\r\n                <% } %>\r\n                <% if (editable && !scope.viewmode) { %>\r\n                    <div class="btn-resolve <% if (resolved) print(\'comment-resolved\') %>" data-toggle="tooltip"></div>\r\n                <% } else if ((!editable || scope.viewmode) && resolved) { %>\r\n                    <div class="icon-resolve i-comment-resolved" data-toggle="tooltip"></div>\r\n                <% } %>\r\n            </div>\r\n        <% } %>\r\n\r\n        \x3c!-- reply --\x3e\r\n\r\n        <% if (showReply) { %>\r\n            <div class="reply-ct">\r\n                <textarea class="msg-reply user-select textarea-control" placeholder="textAddReply" maxlength="maxCommLength"></textarea>\r\n                <button class="btn normal dlg-btn primary btn-reply" id="id-comments-change">textReply</button>\r\n                <button class="btn normal dlg-btn btn-close">textClose</button>\r\n            </div>\r\n        <% } %>\r\n        <% if (lock) { %>\r\n            <div class="lock-area"></div>\r\n            <div class="lock-author"><%=lockuserid%></div>\r\n        <% } %>\r\n        <% if (!last) { %>\r\n            <div class="separator-cmt"></div>\r\n        <% } %>\r\n    </div>\r\n<% } %>\r\n'})),define("text!common/main/lib/template/CommentsPanel.template",[],(function(){return'<div id="comments-box" class="layout-ct vbox">\r\n    <div class="layout-item messages-ct"></div>\r\n    <div class="layout-item add-link-ct">\r\n        <label id="add-comment-doc" class="btn new" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%=textAddCommentToDoc%></label>\r\n    </div>\r\n    <div style="display: none;" class="layout-item new-comment-ct">\r\n        <div class="inner-ct">\r\n            <textarea id="comment-msg-new" class="user-select textarea-control" placeholder="<%=textEnterCommentHint%>" maxlength="<%=maxCommLength%>" data-hint="1" data-hint-direction="left-top"></textarea>\r\n        </div>\r\n        <button class="btn add normal dlg-btn primary" data-hint="1" data-hint-direction="bottom" data-hint-offset="big" style="width: auto;min-width: 86px;"><%=textAddComment%></button>\r\n        <button class="btn cancel normal dlg-btn" data-hint="1" data-hint-direction="bottom" data-hint-offset="big" style="width: auto;min-width: 86px;"><%=textCancel%></button>\r\n    </div>\r\n    <div id="comments-header" class="">\r\n        <label><%=textComments%></label>\r\n        <div id="comments-btn-close" class="float-right margin-left-4"></div>\r\n        <div id="comments-btn-sort" class="float-right"></div>\r\n    </div>\r\n</div>\r\n'})),void 0===window.Common&&(window.Common={}),void 0===Common.Utils&&(Common.Utils={});var utils=new function(){var t=navigator.userAgent.toLowerCase(),e=function(e){return e.test(t)},i="CSS1Compat"==document.compatMode,n=function(e,i){var n;return e&&(n=i.exec(t))?parseFloat(n[1]):0},o=document.documentMode,s=(e(/edge/),e(/opera/)),a=s&&e(/version\/10\.5/),r=!s&&(e(/msie/)||e(/trident/)||e(/edge/)),l=r&&(e(/msie 7/)&&8!=o&&9!=o&&10!=o||7==o),c=r&&(e(/msie 8/)&&7!=o&&9!=o&&10!=o||8==o),d=r&&(e(/msie 9/)&&7!=o&&8!=o&&10!=o||9==o),h=r&&(e(/msie 10/)&&7!=o&&8!=o&&9!=o||10==o),m=r&&(e(/trident\/7\.0/)&&7!=o&&8!=o&&9!=o&&10!=o||11==o),u=r&&e(/msie 6/),p=!r&&e(/\bchrome\b/),f=!r&&e(/webkit/),g=!r&&!p&&e(/safari/),b=g&&e(/applewebkit\/4/),v=g&&e(/version\/3/),C=g&&e(/version\/4/),y=g&&e(/version\/5\.0/),w=g&&e(/version\/5/),x=!f&&!r&&e(/gecko/),_=x&&e(/rv:1\.9/),S=x&&e(/rv:2\.0/),k=x&&e(/rv:5\./),T=x&&e(/rv:10\./),A=_&&e(/rv:1\.9\.0/),I=_&&e(/rv:1\.9\.1/),P=_&&e(/rv:1\.9\.2/),E=e(/windows|win32/),D=e(/macintosh|mac os x/),U=e(/linux/),M=n(!0,/\bchrome\/(\d+\.\d+)/),L=n(!0,/\bfirefox\/(\d+\.\d+)/),F=n(r,/msie (\d+\.\d+)/),V=n(s,/version\/(\d+\.\d+)/),B=n(g,/version\/(\d+\.\d+)/),O=n(f,/webkit\/(\d+\.\d+)/),R=/^https/i.test(window.location.protocol),H=(/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent||navigator.vendor||window.opera),this),N=function(){var t={};if(window.AscCommon&&window.AscCommon.checkDeviceScale)t=window.AscCommon.checkDeviceScale(),AscCommon.correctApplicationScale(t);else{const e="screen and (-webkit-min-device-pixel-ratio: 2.25), screen and (min-resolution: 2.25dppx), screen and (min-resolution: 216dpi)";window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.25) and (-webkit-max-device-pixel-ratio: 1.49), screen and (min-resolution: 1.25dppx) and (max-resolution: 1.49dppx)").matches||window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5) and (-webkit-max-device-pixel-ratio: 1.74), screen and (min-resolution: 1.5dppx) and (max-resolution: 1.74dppx)").matches?t.devicePixelRatio=1.5:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.75) and (-webkit-max-device-pixel-ratio: 1.99), screen and (min-resolution: 1.75dppx) and (max-resolution: 1.99dppx)").matches?t.devicePixelRatio=1.75:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2), screen and (min-resolution: 2dppx), screen and (min-resolution: 192dpi)").matches?t.devicePixelRatio=2:t.devicePixelRatio=1,window.matchMedia(e).matches&&(t.devicePixelRatio=2.25)}$(document.body);var e=document.body.className,i=e.replace(/pixel-ratio__[\w-]+/gi,"").trim();t.devicePixelRatio<1.25?/pixel-ratio__/.test(e)&&(document.body.className=i):t.devicePixelRatio<1.5?/pixel-ratio__1_25/.test(e)||(document.body.className=i+" pixel-ratio__1_25"):t.devicePixelRatio<1.75?/pixel-ratio__1_5/.test(e)||(document.body.className=i+" pixel-ratio__1_5"):!(t.devicePixelRatio<1.75)&&t.devicePixelRatio<2?/pixel-ratio__1_75/.test(e)||(document.body.className=i+" pixel-ratio__1_75"):!(t.devicePixelRatio<2)&&t.devicePixelRatio<2.25?/pixel-ratio__2\b/.test(e)||(document.body.className=i+" pixel-ratio__2"):/pixel-ratio__2_5/.test(e)||(document.body.className=i+" pixel-ratio__2_5"),H.zoom=t.correct?t.zoom:1,H.innerWidth=window.innerWidth*H.zoom,H.innerHeight=window.innerHeight*H.zoom,H.applicationPixelRatio=t.applicationPixelRatio||t.devicePixelRatio};return checkSizeIE=function(){H.innerWidth=window.innerWidth,H.innerHeight=window.innerHeight},H.zoom=1,H.applicationPixelRatio=1,H.innerWidth=window.innerWidth,H.innerHeight=window.innerHeight,r?($(document.body).addClass("ie"),$(window).on("resize",checkSizeIE)):(N(),$(window).on("resize",N)),{checkSize:N,userAgent:t,isStrict:i,isIEQuirks:r&&!i&&(u||l||c||d),isOpera:s,isOpera10_5:a,isWebKit:f,isChrome:p,isSafari:g,isSafari3:v,isSafari4:C,isSafari5:w,isSafari5_0:y,isSafari2:b,isIE:r,isIE6:u,isIE7:l,isIE7m:u||l,isIE7p:r&&!u,isIE8:c,isIE8m:u||l||c,isIE8p:r&&!(u||l),isIE9:d,isIE9m:u||l||c||d,isIE9p:r&&!(u||l||c),isIE10:h,isIE10m:u||l||c||d||h,isIE10p:r&&!(u||l||c||d),isIE11:m,isIE11m:u||l||c||d||h||m,isIE11p:r&&!(u||l||c||d||h),isGecko:x,isGecko3:_,isGecko4:S,isGecko5:k,isGecko10:T,isFF3_0:A,isFF3_5:I,isFF3_6:P,isFF4:4<=L&&L<5,isFF5:5<=L&&L<6,isFF10:10<=L&&L<11,isLinux:U,isWindows:E,isMac:D,chromeVersion:M,firefoxVersion:L,ieVersion:F,operaVersion:V,safariVersion:B,webKitVersion:O,isSecure:R,emailRe:/^(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-ÑÑ0-9\._%+-=\? :&]*)/i,ipRe:/^(((https?)|(ftps?)):\/\/)?([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/+@&#;:`~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?/i,hostnameRe:/^(((https?)|(ftps?)):\/\/)?([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?(([\-\wÐ°-ÑÑ]+\.)+[\wÐ°-ÑÑ\-]{2,}(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?)/i,localRe:/^(((https?)|(ftps?)):\/\/)([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?(([\-\wÐ°-ÑÑ]+)(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?)/i,emailStrongRe:/(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-ÑÑ0-9\._%+-=\?:&]*)/gi,emailAddStrongRe:/(mailto:|\s[@]|\s[+])?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-ÑÑ0-9\._%\+-=\?:&]*)/gi,ipStrongRe:/(((https?)|(ftps?)):\/\/([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?)(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?/gi,hostnameStrongRe:/((((https?)|(ftps?)):\/\/([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?)|(([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?www\.))((([\-\wÐ°-ÑÑ]+\.)+[\wÐ°-ÑÑ\-]{2,}|([\-\wÐ°-ÑÑ]+))(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?)/gi,documentSettingsType:{Paragraph:0,Table:1,Header:2,TextArt:3,Shape:4,Image:5,Slide:6,Chart:7,MailMerge:8,Signature:9,Pivot:10,Cell:11,Slicer:12,Form:13},importTextType:{DRM:0,CSV:1,TXT:2,Paste:3,Columns:4,Data:5},zoom:function(){return H.zoom},applicationPixelRatio:function(){return H.applicationPixelRatio},topOffset:0,innerWidth:function(){return H.innerWidth},innerHeight:function(){return H.innerHeight},croppedGeometry:function(){return{left:0,top:Common.Utils.InternalSettings.get("window-inactive-area-top"),width:H.innerWidth,height:H.innerHeight-Common.Utils.InternalSettings.get("window-inactive-area-top")}}}};Common.Utils=_extend_object(Common.Utils,utils);var themecolor=new function(){var t=!0;return{txtBlack:"Black",txtWhite:"White",txtRed:"Red",txtGreen:"Green",txtBlue:"Blue",txtYellow:"Yellow",txtPurple:"Purple",txtAqua:"Aqua",txtDarkRed:"Dark red",txtDarkGreen:"Dark green",txtDarkBlue:"Dark blue",txtDarkYellow:"Dark yellow",txtDarkPurple:"Dark purple",txtDarkTeal:"Dark teal",txtLightGray:"Light gray",txtGray:"Gray",txtLightBlue:"Light blue",txtPink:"Pink",txtLightYellow:"Light yellow",txtSkyBlue:"Sky blue",txtRose:"Rose",txtTurquosie:"Turquosie",txtLightGreen:"Light green",txtLavender:"Lavender",txtLightOrange:"Light orange",txtTeal:"Teal",txtGold:"Gold",txtOrange:"Orange",txtIndigo:"Indigo",txtBrown:"Brown",txtDarkGray:"Dark gray",txtbackground:"Background",txttext:"Text",txtaccent:"Accent",txtDarker:"Darker",txtLighter:"Lighter",txtBrightGreen:"Bright green",txtViolet:"Violet",ThemeValues:[6,15,7,16,0,1,2,3,4,5],getTranslation:function(t){return t?this["txt"+t.replace(" ","")]||t:""},getEffectTranslation:function(t){return 0!==(t=parseInt(100*t))?(t>0?this.txtLighter:this.txtDarker)+" "+Math.abs(t)+"%":""},setColors:function(e,i){if(t){for(var n=1;n<3;n++)this["txtbackground"+n]=this.txtbackground+" "+n,this["txttext"+n]=this.txttext+" "+n;for(n=1;n<7;n++)this["txtaccent"+n]=this.txtaccent+" "+n;t=!1}var o,s;if(i&&i.length>0){var a=[];for(n=0;n<i.length;n++)s={color:this.getHexColor(i[n].get_r(),i[n].get_g(),i[n].get_b()),tip:this.getTranslation(i[n].asc_getName())},a.push(s);this.standartcolors=a}var r=[];for(n=0;n<6;n++)for(o=0;o<10;o++){var l=n+6*o,c=this.getTranslation(e[l].asc_getName()),d=this.getTranslation(e[l].asc_getNameInColorScheme()),h=this.getEffectTranslation(e[l].asc_getEffectValue());c&&(d&&(c+=", "+d),h&&(c+=", "+h)),s={color:this.getHexColor(e[l].get_r(),e[l].get_g(),e[l].get_b()),effectId:l,effectValue:this.ThemeValues[o],tip:c},r.push(s)}this.effectcolors=r},getEffectColors:function(){return this.effectcolors},getStandartColors:function(){return this.standartcolors},getHexColor:function(t,e,i){return t=t.toString(16),e=e.toString(16),i=i.toString(16),1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),t+e+i},getRgbColor:function(t){var e="object"==typeof t?t.color:t;3==(e=e.replace(/#/,"")).length&&(e=e.replace(/(.)/g,"$1$1")),e=parseInt(e,16);var i=new Asc.asc_CColor;return i.put_type("object"==typeof t&&void 0!==t.effectId?Asc.c_oAscColor.COLOR_TYPE_SCHEME:Asc.c_oAscColor.COLOR_TYPE_SRGB),i.put_r(e>>16),i.put_g((65280&e)>>8),i.put_b(255&e),i.put_a(255),void 0!==t.effectId&&i.put_value(t.effectId),i},colorValue2EffectId:function(t){if("object"==typeof t&&t&&void 0!==t.effectValue&&this.effectcolors)for(var e=0;e<this.effectcolors.length;e++)if(this.effectcolors[e].effectValue===t.effectValue&&t.color.toUpperCase()===this.effectcolors[e].color.toUpperCase()){t.effectId=this.effectcolors[e].effectId;break}return t}}};Common.Utils.ThemeColor=_extend_object(themecolor,Common.Utils.ThemeColor);var metrics=new function(){var t=this;return t.c_MetricUnits={cm:0,pt:1,inch:2},t.currentMetric=t.c_MetricUnits.pt,t.metricName=["Cm","Pt","Inch"],t.defaultMetric=t.c_MetricUnits.cm,{c_MetricUnits:t.c_MetricUnits,txtCm:"cm",txtPt:"pt",txtInch:'"',setCurrentMetric:function(e){t.currentMetric=e},getCurrentMetric:function(){return t.currentMetric},getCurrentMetricName:function(){return this["txt"+t.metricName[t.currentMetric]]},getMetricName:function(e){return this["txt"+t.metricName[void 0!==e?e:0]]},setDefaultMetric:function(e){t.defaultMetric=e},getDefaultMetric:function(){return t.defaultMetric},fnRecalcToMM:function(e){if(null!=e)switch(t.currentMetric){case t.c_MetricUnits.cm:return 10*e;case t.c_MetricUnits.pt:return 25.4*e/72;case t.c_MetricUnits.inch:return 25.4*e}return e},fnRecalcFromMM:function(e){switch(t.currentMetric){case t.c_MetricUnits.cm:return parseFloat((e/10).toFixed(4));case t.c_MetricUnits.pt:return parseFloat((72*e/25.4).toFixed(3));case t.c_MetricUnits.inch:return parseFloat((e/25.4).toFixed(3))}return e}}};Common.Utils.Metric=_extend_object(metrics,Common.Utils.Metric),Common.Utils.RGBColor=function(t){var e,i,n;"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^hsb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){var e={},i=Math.round(t[1]),n=Math.round(255*t[2]/100),o=Math.round(255*t[3]/100);if(0==n)e.r=e.g=e.b=o;else{var s=o,a=(255-n)*o/255,r=i%60*(s-a)/60;360==i&&(i=0),i<60?(e.r=s,e.b=a,e.g=a+r):i<120?(e.g=s,e.b=a,e.r=s-r):i<180?(e.g=s,e.r=a,e.b=a+r):i<240?(e.b=s,e.r=a,e.g=s-r):i<300?(e.b=s,e.g=a,e.r=a+r):i<360?(e.r=s,e.g=a,e.b=s-r):(e.r=0,e.g=0,e.b=0)}return[Math.round(e.r),Math.round(e.g),Math.round(e.b)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],s=0;s<o.length;s++){var a=o[s].re,r=o[s].process,l=a.exec(t);if(l){var c=r(l);e=c[0],i=c[1],n=c[2]}}e=e<0||isNaN(e)?0:e>255?255:e,i=i<0||isNaN(i)?0:i>255?255:i,n=n<0||isNaN(n)?0:n>255?255:n;return{r:e,g:i,b:n,isEqual:function(t){return e==t.r&&i==t.g&&n==t.b},toRGB:function(){return"rgb("+e+", "+i+", "+n+")"},toRGBA:function(t){return void 0===t&&(t=1),"rgba("+e+", "+i+", "+n+", "+t+")"},toHex:function(){var t=e.toString(16),o=i.toString(16),s=n.toString(16);return 1==t.length&&(t="0"+t),1==o.length&&(o="0"+o),1==s.length&&(s="0"+s),"#"+t+o+s},toHSB:function(){var t={h:0,s:0,b:0},o=Math.min(e,i,n),s=Math.max(e,i,n),a=s-o;return t.b=s,t.s=0!=s?255*a/s:0,0!=t.s?t.h=e==s?0+(i-n)/a:i==s?2+(n-e)/a:4+(e-i)/a:t.h=0,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t.h=parseInt(t.h),t.s=parseInt(t.s),t.b=parseInt(t.b),t}}};var utilsString=new function(){return{textCtrl:"Ctrl",textShift:"Shift",textAlt:"Alt",format:function(t){var e=_.toArray(arguments).slice(1);return e.length&&"object"==typeof e[0]&&(e=e[0]),t.replace(/\{(\d+)\}/g,(function(t,i){return e[i]}))},htmlEncode:function(t){return"undefined"!=typeof _?_.escape(t):t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},htmlDecode:function(t){return _.unescape(t)},ellipsis:function(t,e,i){if(t&&t.length>e){if(i){var n=t.substr(0,e-2),o=Math.max(n.lastIndexOf(" "),n.lastIndexOf("."),n.lastIndexOf("!"),n.lastIndexOf("?"));if(-1!==o&&o>=e-15)return n.substr(0,o)+"..."}return t.substr(0,e-3)+"..."}return t},platformKey:function(t,e,i){return _.isEmpty(e)&&(e=" ({0})"),Common.Utils.isMac?(_.isFunction(i)&&(t=i.call(this,t)),Common.Utils.String.format(e,t.replace(/\+(?=\S)/g,"").replace(/Ctrl|ctrl/g,"â").replace(/Alt|alt/g,"â¥").replace(/Shift|shift/g,"â§"))):Common.Utils.String.format(e,t.replace(/Ctrl|ctrl/g,this.textCtrl).replace(/Alt|alt/g,this.textAlt).replace(/Shift|shift/g,this.textShift))},parseFloat:function(t){return"string"==typeof t&&(t=t.replace(",",".")),parseFloat(t)},encodeSurrogateChar:function(t){if(t<65536)return String.fromCharCode(t);var e=55296|(t-=65536)>>10,i=56320|1023&t;return String.fromCharCode(e)+String.fromCharCode(i)},fixedDigits:function(t,e,i){void 0===i&&(i="0");for(var n="",o=t.toString(),s=o.length;s<e;s++)n+=i;return n+o}}};if(Common.Utils.String=_extend_object(utilsString,Common.Utils.String),Common.Utils.isBrowserSupported=function(){return!(0!=Common.Utils.ieVersion&&Common.Utils.ieVersion<10||0!=Common.Utils.safariVersion&&Common.Utils.safariVersion<5||0!=Common.Utils.firefoxVersion&&Common.Utils.firefoxVersion<4||0!=Common.Utils.chromeVersion&&Common.Utils.chromeVersion<7||0!=Common.Utils.operaVersion&&Common.Utils.operaVersion<10.5)},Common.Utils.showBrowserRestriction=function(){if(!(document.getElementsByClassName&&document.getElementsByClassName("app-error-panel").length>0)){var t=window.DE?"Document":window.SSE?"Spreadsheet":window.PE?"Presentation":window.PDFE?"PDF":"that",e=document.createElement("div");e.innerHTML='<div class="app-error-panel"><div class="message-block"><div class="message-inner"><div class="title">Your browser is not supported.</div><div class="text">Sorry, '+t+' Editor is currently only supported in the latest versions of the Chrome, Firefox, Safari or Internet Explorer web browsers.</div></div></div><div class="message-auxiliary"></div></div>',document.body.appendChild(e),$("#loading-mask").hide().remove(),$("#viewport").hide().remove()}},Common.Utils.applyCustomization=function(t,e){for(var i in t){var n;if(e[i]&&(n=$(e[i])).length){var o=t[i];!1===o||!1===o.visible?n.hide():(o.text&&n.text(o.text),!1===o.visible&&n.hide())}}},Common.Utils.applyCustomizationPlugins=function(plugins){if(plugins&&!(plugins.length<1)){var _createXMLHTTPObject=function(){var t;if("undefined"!=typeof XMLHttpRequest)t=new XMLHttpRequest;else try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}return t},_getPluginCode=function(url){if(!url)return"";try{var xhrObj=_createXMLHTTPObject();xhrObj&&url&&(xhrObj.open("GET",url,!1),xhrObj.send(""),200==xhrObj.status&&eval(xhrObj.responseText))}catch(t){}return null};plugins.forEach((function(t){t&&_getPluginCode(t)}))}},Common.Utils.fillUserInfo=function(t,e,i,n){var o=t||{};return o.anonymous=!o.id,!o.id&&(o.id=n),o.fullname=o.name?o.name:i,o.group&&(o.fullname=o.group.toString()+AscCommon.UserInfoParser.getSeparator()+o.fullname),o.guest=!o.name,o},Common.Utils.createXhr=function(){var t;if("undefined"!=typeof XMLHttpRequest)t=new XMLHttpRequest;else try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}return t},Common.Utils.getConfigJson=function(t){if(t)try{var e=Common.Utils.createXhr();if(e)return e.open("GET",t,!1),e.send(""),JSON.parse(e.responseText)}catch(t){}return null},Common.Utils.loadConfig=function(t,e){fetch(t,{method:"get",headers:{Accept:"application/json"}}).then((function(t){return t.ok?t.json():"error"})).then((function(t){e(t)})).catch((function(t){e("error")}))},Common.Utils.asyncCall=function(t,e,i){new Promise((function(t,e){t()})).then((function(){t.call(e,i)}))},String.prototype.strongMatch=function(t){if(t&&t instanceof RegExp){var e=this.toString().match(t);return!!(e&&e.length>0&&e[0].length==this.length)}return!1},Common.Utils.InternalSettings=new function(){var t={};return{get:function(e){return t[e]},set:function(e,i){t[e]=i}}},Common.Utils.lockControls=function(t,e,i,n){!i&&(i={});var o=i.array||n;function s(t,i){if(t&&t.options&&_.contains(t.options.lock,i)){var n=t.keepState.indexOf(i);e?n<0&&t.keepState.push(i):n<0||t.keepState.splice(n,1)}}i.merge&&(o=_.union(n,o)),_.each(o,(function(e){e&&_.isFunction(e.setDisabled)&&(!e.keepState&&(e.keepState=[]),i.clear&&i.clear.length>0&&e.keepState.length>0&&(e.keepState=_.difference(e.keepState,i.clear)),_.isArray(t)?_.each(t,(function(t){s(e,t)})):s(e,t),e.keepState.length>0?!e.isDisabled()&&e.setDisabled(!0):e.isDisabled()&&e.setDisabled(!1))}))},Common.Utils.injectButtons=function(t,e,i,n,o,s,a,r,l,c,d,h){var m=createButtonSet();return m.setDisabled(!0),e=e||"id-toolbar-"+i,t.each((function(u,p){var f="btn-toolbar";/x-huge/.test(p.className)&&(f+=" x-huge icon-top");var g=new Common.UI.Button({parentEl:t.eq(u),id:e+u,cls:f,iconCls:i,caption:n,split:s||!1,menu:a||!1,enableToggle:r||!1,lock:o,disabled:!0,dataHint:l,dataHintDirection:c,dataHintOffset:d,dataHintTitle:h});m.add(g)})),m},Common.Utils.injectComponent=function(t,e){e&&t.length&&(e.rendered?t.append(e.$el):e.render(t))},Common.Utils.warningDocumentIsLocked=function(t){t.disablefunc&&t.disablefunc(!0);var e=window.DE||window.PE||window.SSE||window.PDFE;Common.UI.warning({msg:Common.Locale.get("warnFileLocked",{name:"Common.Translation",default:"You can't edit this file. Document is in use by another application."}),buttons:[{value:"view",caption:Common.Locale.get("warnFileLockedBtnView",{name:"Common.Translation",default:"Open for viewing"})},{value:"edit",caption:Common.Locale.get("warnFileLockedBtnEdit",{name:"Common.Translation",default:"Create a copy"})}],primary:"view",callback:function(i){"edit"==i&&(t.disablefunc&&t.disablefunc(!1),e.getController("Main").api.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None))}})},jQuery.fn.extend({elementById:function(t,e){var i=document.getElementById(t.substring(1));if(!i)if((e=e||this)&&e.length>0)e.each((function(e,n){if(n.querySelectorAll)if(0==(i=n.querySelectorAll(t)).length){if("#"+n.id==t)return i=n,!1}else if(i.length)return i=i[0],!1}));else if(e&&e.querySelectorAll&&(i=e.querySelectorAll(t))&&i.length)return i[0];return i},findById:function(t,e){var i=$.fn.elementById.apply(this,arguments);return i?$(i):$()}}),Common.Utils.InternalSettings.set("toolbar-height-tabs",32),Common.Utils.InternalSettings.set("toolbar-height-tabs-top-title",28),Common.Utils.InternalSettings.set("toolbar-height-controls",67),Common.Utils.InternalSettings.set("document-title-height",28),Common.Utils.InternalSettings.set("window-inactive-area-top",0),Common.Utils.InternalSettings.set("toolbar-height-compact",Common.Utils.InternalSettings.get("toolbar-height-tabs")),Common.Utils.InternalSettings.set("toolbar-height-normal",Common.Utils.InternalSettings.get("toolbar-height-tabs")+Common.Utils.InternalSettings.get("toolbar-height-controls")),Common.Utils.ModalWindow=new function(){var t=0;return{show:function(){t++},close:function(){t--},isVisible:function(){return t>0}}},Common.Utils.UserInfoParser=new function(){var t=!1,e=String.fromCharCode(160);return{setParser:function(e){t=!!e},getSeparator:function(){return e},getParsedName:function(i){return t&&i?i.substring(i.indexOf(e)+1):i},getParsedGroups:function(i){if(t&&i){for(var n=i.indexOf(e),o=n>-1?i.substring(0,n).split(","):[],s=0;s<o.length;s++)o[s]=o[s].trim();return o}}}},Common.Utils.getKeyByValue=function(t,e){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e)return i},!Common.UI&&(Common.UI={}),Common.UI.isRTL=function(){return null==window.isrtl&&(window.isrtl=Common.localStorage.itemExists("ui-rtl")?Common.localStorage.getBool("ui-rtl"):Common.Locale.isCurrentLanguageRtl()),window.isrtl},define("common/main/lib/util/utils",(function(){})),void 0===Common)var Common={};if(define("common/main/lib/component/ComboBox",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],(function(){"use strict";Common.UI.ComboBoxModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),value:null,displayValue:null}}}),Common.UI.ComboBoxStore=Backbone.Collection.extend({model:Common.UI.ComboBoxModel}),Common.UI.ComboBox=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,editable:!0,disabled:!1,menuCls:"",menuStyle:"",restoreMenuHeight:!0,displayField:"displayValue",valueField:"value",search:!1,placeHolder:"",scrollAlwaysVisible:!1,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<span class="input-group combobox <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control" spellcheck="false" placeholder="<%= placeHolder %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>","</ul>","</span>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.menuCls=e.options.menuCls,this.menuStyle=e.options.menuStyle,this.template=e.options.template||e.template,this.itemsTemplate=e.options.itemsTemplate,this.hint=e.options.hint,this.editable=e.options.editable,this.disabled=e.options.disabled,this.store=e.options.store||new Common.UI.ComboBoxStore,this.displayField=e.options.displayField,this.valueField=e.options.valueField,this.placeHolder=e.options.placeHolder,this.search=e.options.search,this.scrollAlwaysVisible=e.options.scrollAlwaysVisible,this.focusWhenNoSelection=!1!==e.options.focusWhenNoSelection,this.restoreMenuHeight=e.options.restoreMenuHeight,e.rendered=e.options.rendered||!1,this.lastValue=null,e.store.add(e.options.data),e.options.el&&e.render()},render:function(t){var e=this;if(e.rendered)this.cmpEl=e.$el||$(this.el);else{var i=this.store.toJSON();this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,menuCls:this.menuCls,menuStyle:this.menuStyle,items:i,scope:e,placeHolder:this.placeHolder,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),this.itemsTemplate&&this.cmpEl.find("ul").html($(this.itemsTemplate({items:i,scope:e}))),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)}if(!e.rendered){var n=this.cmpEl;if(this._input=n.find("input"),this._button=n.find(".btn"),n.on("click","a",_.bind(this.itemClicked,this)),n.on("mousedown","a",_.bind(this.itemMouseDown,this)),this.editable?(n.on("change","input",_.bind(this.onInputChanged,this)),n.on("input","input",_.bind(this.onInputChanging,this)),n.on("keydown","input",_.bind(this.onInputKeyDown,this)),n.on("focusin","input",_.bind(this.onInputFocusIn,this)),n.on("click",".form-control",_.bind(this.onEditableInputClick,this))):(n.on("click",".form-control",_.bind(this.onInputClick,this)),this._input.attr("readonly","readonly"),this._input.attr("data-can-copy",!1),this._input.on("mousedown",(function(t){t.preventDefault()}))),e.options.hint){n.attr("data-toggle","tooltip"),n.tooltip({title:e.options.hint,placement:e.options.hintAnchor||"cursor"});var o=n.closest(".asc-window");if(o.length>0){n.data("bs.tooltip").tip().css("z-index",parseInt(o.css("z-index"))+10);var s=function(t){if(o[0]===t.$window[0]){var e=n.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),Common.NotificationCenter.off({"modal:close":s})}};Common.NotificationCenter.on({"modal:close":s})}n.find(".dropdown-menu").on("mouseenter",(function(){var t=n.data("bs.tooltip");t&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide())}))}var a=n.find(".dropdown-menu");a.hasClass("menu-absolute")&&a.css("min-width",n.outerWidth()),n.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),n.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),n.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),n.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),n.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),Common.NotificationCenter.on("menumanager:hideall",_.bind(e.closeMenu,e)),this.setDefaultSelection(),this.listenTo(this.store,"reset",this.onResetItems)}return e.rendered=!0,e.disabled&&e.setDisabled(e.disabled),this},setData:function(t){this.store.reset([]),this.store.add(t),this.setRawValue(""),this.onResetItems()},openMenu:function(t){if(!(this.store.length<1)){var e=this;this.scroller||(this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))),_.delay((function(){e.cmpEl.addClass("open")}),t||0)}},closeMenu:function(){this.cmpEl.removeClass("open")},isMenuOpen:function(){return this.cmpEl.hasClass("open")},onBeforeShowMenu:function(t){if(this.scroller||(this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))),Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),this.options.hint){var e=this.cmpEl.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide())}var i=this.cmpEl.find("ul");if(i.hasClass("menu-absolute")){var n=(o=this.cmpEl.offset()).left;n+i.outerWidth()>Common.Utils.innerWidth()&&(n+=this.cmpEl.outerWidth()-i.outerWidth()),i.css({left:n,top:o.top+this.cmpEl.outerHeight()+2})}else if(i.hasClass("menu-aligned")){var o=this.cmpEl.offset();i.toggleClass("show-top",o.top+this.cmpEl.outerHeight()+i.outerHeight()>Common.Utils.innerHeight())}},onAfterShowMenu:function(t){this.alignMenuPosition();var e=$(this.el).find("ul"),i=e.find("> li.selected");if(i.length){var n=i.position().top,o=i.outerHeight(),s=e.outerHeight();if(n<0||n+o>s){var a=e.scrollTop()+n+(o-s)/2;a=Math.floor(a/o)*o,e.scrollTop(a)}setTimeout((function(){i.find("a").focus()}),1)}else if(this.focusWhenNoSelection){var r=this;setTimeout((function(){r.cmpEl.find("ul li:first a").focus()}),1)}this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),this.trigger("show:after",this,t,{fromKeyDown:void 0===t}),this._search={}},alignMenuPosition:function(){if(this.restoreMenuHeight){var t=$(this.el).find("ul");if("number"!=typeof this.restoreMenuHeight){var e=parseFloat(t.css("max-height"));t.hasClass("scrollable-menu")||e?this.restoreMenuHeight=e||1e5:this.restoreMenuHeight=1e5}var i=Common.Utils.croppedGeometry().height-10,n=t.outerHeight(),o=t.get(0).getBoundingClientRect().top,s=n;n<this.restoreMenuHeight&&(s=this.restoreMenuHeight),o+s>i&&(s=i-o),s!==n&&t.css("max-height",s+"px")}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){if(this.cmpEl.find(".dropdown-toggle").blur(),this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e),this.options.takeFocusOnClose){var i=this;i._input&&i._input.length>0&&!i.editable&&i._input[0].selectionStart===i._input[0].selectionEnd&&setTimeout((function(){i._input[0].selectionStart=i._input[0].selectionEnd=0}),1),setTimeout((function(){i.focus()}),1)}},onAfterKeydownMenu:function(t){if(t.keyCode==Common.UI.Keys.DOWN&&!this.editable&&!this.isMenuOpen())return this.openMenu(),this.onAfterShowMenu(),!1;if(this.focusWhenNoSelection||t.keyCode!=Common.UI.Keys.DOWN&&t.keyCode!=Common.UI.Keys.UP){if(t.keyCode==Common.UI.Keys.RETURN&&(this.editable||this.isMenuOpen())){var e=this.isMenuOpen();return $(t.target).click(),this.rendered&&(Common.Utils.isIE?this._input.trigger("change",{onkeydown:!0}):this._input.blur()),!e}if(t.keyCode==Common.UI.Keys.ESC&&this.isMenuOpen())return this._input.val(this.lastValue),this.closeMenu(),this.onAfterHideMenu(t),!1;if(this.search&&t.keyCode>64&&t.keyCode<91&&t.key){if("object"!=typeof this._search)return;var i=this;clearTimeout(this._search.timer),this._search.timer=setTimeout((function(){i._search={}}),1e3),!this._search.text&&(this._search.text=""),!this._search.char&&(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(n=this.cmpEl.find("ul > li").find("> a"),this._search.index=n.index(n.filter(":focus"))),this.selectCandidate()}}else{var n;0===(n=this.cmpEl.find("ul > li a")).filter(":focus").length&&n.length>0&&setTimeout((function(){n[t.keyCode==Common.UI.Keys.DOWN?0:n.length-1].focus()}),1)}},selectCandidate:function(){for(var t,e,i=this._search.index&&-1!=this._search.index?this._search.index:0,n=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),o=n.test(this.store.at(i).get(this.displayField)),s=0;s<this.store.length;s++){var a=this.store.at(s);if(n.test(a.get(this.displayField))){if(!t&&(t=a,e=s,!o))break;if(this._search.full&&s==i||s>i){t=a,e=s;break}}}if(t){if(this._search.index=e,a=$("#"+t.get("id")+" a",$(this.el)),this.scroller){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});var r=$(this.el).find("ul"),l=a.position().top,c=a.outerHeight(),d=r.outerHeight();if(l<0||l+c>d){var h=r.scrollTop()+l;h=Math.floor(h/c)*c,r.scrollTop(h)}}a.focus()}},onInputKeyDown:function(t){var e=this;t.keyCode==Common.UI.Keys.ESC?(this._input.val(this.lastValue),this.closeMenu(),this.onAfterHideMenu(t)):t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?(this.isMenuOpen()||(this.openMenu(),this.onAfterShowMenu()),_.delay((function(){e._skipInputChange=!0,e.cmpEl.find("ul li:first a").focus()}),10)):t.keyCode==Common.UI.Keys.RETURN&&$(t.target).val()===e.lastValue?this._input.trigger("change",{reapply:!0}):e._skipInputChange=!1},onInputFocusIn:function(t){this.trigger("combo:focusin",this,t)},onInputChanged:function(t,e){if(!e||!e.synthetic)if(this._skipInputChange)this._skipInputChange=!1;else{var i,n=$(t.target).val(),o={};this.lastValue!==n||e&&e.reapply?(o[this.valueField]=n,this.trigger("changed:before",this,o,t),t.isDefaultPrevented()||(this._selectedItem=this.store.findWhere(((i={})[this.displayField]=n,i)),this._selectedItem&&(o=this._selectedItem.toJSON(),$(".selected",$(this.el)).removeClass("selected"),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")),this.trigger("changed:after",this,o,t))):e&&e.onkeydown&&this.trigger("combo:blur",this,t)}},onInputChanging:function(t,e){var i=$(t.target).val();t.isDefaultPrevented()||this.trigger("changing",this,i,t)},onInputClick:function(t){this._button&&this._button.dropdown("toggle"),t.preventDefault(),t.stopPropagation()},onEditableInputClick:function(t){if(this.options.hint){var e=this.cmpEl.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide())}this.isMenuOpen()&&1==t.which&&t.stopPropagation()},setDefaultSelection:function(){if(this.rendered){var t,e=this._input.val();e&&(this._selectedItem=this.store.findWhere(((t={})[this.displayField]=e,t)),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")))}},setDisabled:function(t){t=!!t,this.disabled=t,this.rendered&&(t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},setRawValue:function(t){this.rendered&&(this._input.val(t).trigger("change",{synthetic:!0}),this.lastValue=null!=t?t.toString():t)},getRawValue:function(){return this.rendered?this._input.val():null},setValue:function(t,e){var i;this.rendered&&(this._selectedItem=this.store.findWhere(((i={})[this.valueField]=t,i)),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.setRawValue(this._selectedItem.get(this.displayField)),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):this.setRawValue(void 0!==e?e:t))},getValue:function(){return this.rendered?this._selectedItem&&!_.isUndefined(this._selectedItem.get(this.valueField))?this._selectedItem.get(this.valueField):this._input.val():null},getDisplayValue:function(t){return Common.Utils.String.htmlEncode(t[this.displayField])},getSelectedRecord:function(){return this.rendered&&this._selectedItem&&!_.isUndefined(this._selectedItem.get(this.valueField))?_.extend({},this._selectedItem.toJSON()):null},selectRecord:function(t){this.rendered&&t&&(this._selectedItem=t,$(".selected",$(this.el)).removeClass("selected"),this.setRawValue(this._selectedItem.get(this.displayField)),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected"))},clearSelection:function(){$(".selected",$(this.el)).removeClass("selected"),this._selectedItem=null},itemClicked:function(t){var e=$(t.target).closest("li");this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&(this.lastValue=this._selectedItem.get(this.displayField),this._input.val(this.lastValue).trigger("change",{synthetic:!0}),$(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault()),this._isMouseDownMenu=!1},itemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;this._isMouseDownMenu=!0},onResetItems:function(){this.itemsTemplate?$(this.el).find("ul").html($(this.itemsTemplate({items:this.store.toJSON(),scope:this}))):$(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""))({items:this.store.toJSON(),scope:this})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))},focus:function(){this._input&&this._input.focus()}}),Common.UI.ComboBoxCustom=Common.UI.ComboBox.extend(_.extend({itemClicked:function(t){Common.UI.ComboBox.prototype.itemClicked.call(this,t),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem)},setValue:function(t,e){Common.UI.ComboBox.prototype.setValue.call(this,t,e),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem,e)},selectRecord:function(t){Common.UI.ComboBox.prototype.selectRecord.call(this,t),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem)},focus:function(){this.cmpEl&&this.cmpEl.find(".form-control").focus()}},Common.UI.ComboBoxCustom||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/DataView",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],(function(){"use strict";Common.UI.DataViewGroupModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),caption:"",inline:!1,headername:void 0}}}),Common.UI.DataViewGroupStore=Backbone.Collection.extend({model:Common.UI.DataViewGroupModel}),Common.UI.DataViewModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),selected:!1,allowSelected:!0,value:null,disabled:!1}}}),Common.UI.DataViewStore=Backbone.Collection.extend({model:Common.UI.DataViewModel}),Common.UI.DataViewItem=Common.UI.BaseView.extend({options:{},template:_.template(['<div id="<%= id %>"><%= value %></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.dataHint=e.options.dataHint||"",e.dataHintDirection=e.options.dataHintDirection||"",e.dataHintOffset=e.options.dataHintOffset||"",e.scaling=e.options.scaling,e.listenTo(e.model,"change",this.model.get("skipRenderOnChange")?e.onChange:e.render),e.listenTo(e.model,"change:selected",e.onSelectChange),e.listenTo(e.model,"remove",e.remove)},render:function(){if(_.isUndefined(this.model.id))return this;var t=this.$el||$(this.el);t.html(this.template(this.model.toJSON())),t.addClass("item"),t.toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),""!==this.dataHint&&(t.attr("data-hint",this.dataHint),t.attr("data-hint-direction",this.dataHintDirection),t.attr("data-hint-offset",this.dataHintOffset)),_.isUndefined(this.model.get("contentTarget"))||t.attr("content-target",this.model.get("contentTarget")),t.off("click dblclick contextmenu"),t.on({click:_.bind(this.onClick,this),dblclick:_.bind(this.onDblClick,this),contextmenu:_.bind(this.onContextMenu,this)}),t.toggleClass("disabled",!!this.model.get("disabled")),_.isUndefined(this.model.get("cls"))||t.addClass(this.model.get("cls"));var e=t.data("bs.tooltip");return e&&void 0===e.dontShow&&t.is(":hover")&&(e.dontShow=!0),!1!==this.scaling&&t.find(".options__icon").length&&(t.attr("ratio","ratio"),this.applyScaling(Common.UI.Scaling.currentRatio()),t.on("app:scaling",_.bind((function(t,e){this.scaling!=e.ratio&&this.applyScaling(e.ratio)}),this))),this.trigger("change",this,this.model),this},remove:function(){this.stopListening(this.model),this.trigger("remove",this,this.model),Common.UI.BaseView.prototype.remove.call(this)},onClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("click",this,this.model,t)},onDblClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("dblclick",this,this.model,t)},onContextMenu:function(t){this.trigger("contextmenu",this,this.model,t)},onSelectChange:function(t,e){this.trigger("select",this,t,e)},onChange:function(){if(_.isUndefined(this.model.id))return this;var t=this.$el||$(this.el);return t.toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),t.toggleClass("disabled",!!this.model.get("disabled")),this.trigger("change",this,this.model),this},applyScaling:function(t){if(this.scaling=t,t>2){var e=this.$el||$(this.el),i=e.find(".options__icon");if(i.length>0&&!e.find("svg.icon").length){var n=i.attr("class"),o=/btn-[^\s]+/.exec(n),s=o?o[0]:"null",a='<svg class="icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",s);i.after(a)}}}}),Common.UI.DataView=Common.UI.BaseView.extend({options:{multiSelect:!1,handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,emptyText:"",listenStoreEvents:!0,allowScrollbar:!0,scrollAlwaysVisible:!1,minScrollbarLength:40,scrollYStyle:null,showLast:!0,useBSKeydown:!1,cls:""},template:_.template(['<div class="dataview inner <%= cls %>" style="<%= style %>">',"<% _.each(groups, function(group) { %>","<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.store=e.options.store||new Common.UI.DataViewStore,e.groups=e.options.groups||null,e.itemTemplate=e.options.itemTemplate||null,e.itemDataHint=e.options.itemDataHint||"",e.itemDataHintDirection=e.options.itemDataHintDirection||"",e.itemDataHintOffset=e.options.itemDataHintOffset||"",e.multiSelect=e.options.multiSelect,e.handleSelect=e.options.handleSelect,e.parentMenu=e.options.parentMenu,e.outerMenu=e.options.outerMenu,e.enableKeyEvents=e.options.enableKeyEvents,e.useBSKeydown=e.options.useBSKeydown,e.showLast=e.options.showLast,e.style=e.options.style||"",e.cls=e.options.cls||"",e.emptyText=e.options.emptyText||"",e.listenStoreEvents=void 0===e.options.listenStoreEvents||e.options.listenStoreEvents,e.allowScrollbar=void 0===e.options.allowScrollbar||e.options.allowScrollbar,e.scrollAlwaysVisible=e.options.scrollAlwaysVisible||!1,e.minScrollbarLength=e.options.minScrollbarLength||40,e.scrollYStyle=e.options.scrollYStyle,e.tabindex=e.options.tabindex||0,e.delayRenderTips=e.options.delayRenderTips||!1,e.parentMenu&&(e.parentMenu.options.restoreHeight=e.options.restoreHeight>0),e.delaySelect=e.options.delaySelect||!1,e.rendered=!1,e.dataViewItems=[],"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],!1===e.options.scaling&&(e.cls=e.options.cls+" scaling-off"),e.options.el&&e.render()},render:function(t){var e=this;this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({groups:e.groups?e.groups.toJSON():null,style:e.style,cls:e.cls,options:e.options})),t.html(this.cmpEl)):(this.cmpEl=e.$el||$(this.el),this.cmpEl.html(this.template({groups:e.groups?e.groups.toJSON():null,style:e.style,cls:e.cls,options:e.options})));var i=this.cmpEl.closest(".asc-window");return i.length<1&&(i=this.cmpEl.closest('[id^="menu-container-"]')),i.length>0&&(this.tipZIndex=parseInt(i.css("z-index"))+10),this.rendered||(this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems),this.groups&&(this.listenTo(this.groups,"add",this.onAddGroup),this.listenTo(this.groups,"remove",this.onRemoveGroup))),this.onResetItems(),this.parentMenu&&(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this))),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(e.showLast||this.parentMenu.on("show:before",(function(t){e.deselectAll()})),this.parentMenu.on("show:after",(function(t,i){i&&t.el!==i.target||(e.showLast&&e.showLastSelected(),Common.NotificationCenter.trigger("dataview:focus"),_.delay((function(){t.cmpEl.find(".dataview").focus()}),10))})).on("hide:after",(function(){Common.NotificationCenter.trigger("dataview:blur")})))),_.isUndefined(this.scroller)&&this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,this.cmpEl.on("click",(function(t){if(/dataview/.test(t.target.className))return!1})),this.trigger("render:after",this),this},setStore:function(t){t&&(this.stopListening(this.store),this.store=t,this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems)))},selectRecord:function(t,e){if(this.handleSelect){if(e&&this.suspendEvents(),this.extremeSeletedRec=t,!this.multiSelect||!this.pressedShift&&!this.pressedCtrl||!this.currentSelectedRec||this.pressedShift&&this.currentSelectedRec==t)_.each(this.store.where({selected:!0}),(function(t){t.set({selected:!1})})),t&&(t.set({selected:!0}),this.currentSelectedRec=t);else if(t)if(this.pressedCtrl)t.set({selected:!t.get("selected")}),this.currentSelectedRec=t;else if(this.pressedShift){var i=this,n=!1;_.each(i.store.models,(function(e){i.currentSelectedRec==e||t==e?(n=!n,e.set({selected:!0})):e.set({selected:n})}))}return e&&this.resumeEvents(),t}},selectByIndex:function(t,e){if(this.store.length>0&&t>-1&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),(function(t){t.set({selected:!1})})),t&&this.resumeEvents()},getSelectedRec:function(){return this.multiSelect?this.store.where({selected:!0}):this.store.findWhere({selected:!0})},onAddItem:function(t,e,i){var n=new Common.UI.DataViewItem({template:this.itemTemplate,model:t,scaling:this.options.scaling,dataHint:this.itemDataHint,dataHintDirection:this.itemDataHintDirection,dataHintOffset:this.itemDataHintOffset});if(n){var o=$(this.el).find(".inner").addBack().filter(".inner");if(this.groups&&this.groups.length>0){var s=this.groups.findWhere({id:t.get("group")});s&&(o=o.find("#"+s.id+" .group-items-container"))}var a=_.indexOf(this.store.models,t);if(o){if(i&&"number"==typeof i.at&&i.at>=0)if(0==i.at)o.prepend(n.render().el);else if(this.groups&&this.groups.length>0)o.append(n.render().el);else{var r=o.find("> div");a>0?$(r.get(a-1)).after(n.render().el):r.length>0?$(r[a]).before(n.render().el):o.append(n.render().el)}else o.append(n.render().el);this.dataViewItems.length<1&&o.find(".empty-text").remove(),this.dataViewItems=this.dataViewItems.slice(0,a).concat(n).concat(this.dataViewItems.slice(a));var l=this,c=$(n.el),d=t.get("tip");null!=d&&(this.delayRenderTips?c.one("mouseenter",(function(){c.attr("data-toggle","tooltip"),c.tooltip({title:t.get("tip"),placement:"cursor",zIndex:l.tipZIndex}),c.mouseenter()})):(c.attr("data-toggle","tooltip"),c.tooltip({title:t.get("tip"),placement:"cursor",zIndex:l.tipZIndex}))),this.listenTo(n,"change",this.onChangeItem),this.listenTo(n,"remove",this.onRemoveItem),this.listenTo(n,"click",this.onClickItem),this.listenTo(n,"dblclick",this.onDblClickItem),this.listenTo(n,"select",this.onSelectItem),this.listenTo(n,"contextmenu",this.onContextMenuItem),this.isSuspendEvents||this.trigger("item:add",this,n,t)}}this._layoutParams=void 0},onAddGroup:function(t){var e=$(_.template(["<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> group.inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>"].join(""))({group:t.toJSON()})),i=$(this.el).find(".inner").addBack().filter(".inner");if(i){var n=_.indexOf(this.groups.models,t),o=i.find(".grouped-data");n>0?$(o.get(n-1)).after(e):o.length>0?$(o[n]).before(e):i.append(e)}},onRemoveGroup:function(t){var e=$(this.el).find(".inner").addBack().filter(".inner");if(e){var i=e.find("#"+t.get("id")+".grouped-data");i&&i.remove()}this._layoutParams=void 0},onResetItems:function(){this.trigger("reset:before",this),_.each(this.dataViewItems,(function(t){var e=t.$el.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.tip().remove())}),this),$(this.el).html(this.template({groups:this.groups?this.groups.toJSON():null,style:this.style,cls:this.cls,options:this.options})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.store.length<1&&this.emptyText.length>0&&$(this.el).find(".inner").addBack().filter(".inner").append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>"),_.each(this.dataViewItems,(function(t){this.stopListening(t),t.stopListening(t.model)}),this),this.dataViewItems=[];var t=this;this.store.each((function(e){t.onAddItem(e,t.store)}),this),this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.disabled&&this.setDisabled(this.disabled),this.attachKeyEvents(),this.lastSelectedRec=null,this._layoutParams=void 0},onChangeItem:function(t,e){this.isSuspendEvents||this.trigger("item:change",this,t,e)},onRemoveItem:function(t,e){var i=t.$el.data("bs.tooltip");if(i&&(void 0===i.dontShow&&(i.dontShow=!0),i.tip().remove()),this.stopListening(t),t.stopListening(),this.store.length<1&&this.emptyText.length>0){var n=$(this.el).find(".inner").addBack().filter(".inner");n.find(".empty-text").length<=0&&n.append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>")}for(var o=0;o<this.dataViewItems.length;o++)if(_.isEqual(t,this.dataViewItems[o])){this.dataViewItems.splice(o,1);break}this.isSuspendEvents||this.trigger("item:remove",this,t,e),this._layoutParams=void 0},onClickItem:function(t,e,i){if(!this.disabled){window._event=i,this.multiSelect&&(i&&i.ctrlKey?this.pressedCtrl=!0:i&&i.shiftKey&&(this.pressedShift=!0)),this.showLast&&(this.delaySelect?(_.each(this.store.where({selected:!0}),(function(t){t.set({selected:!1})})),e&&setTimeout(_.bind((function(){e.set({selected:!0}),this.trigger("item:click",this,t,e,i)}),this),300)):this.selectRecord(e)),this.lastSelectedRec=null;var n=t.$el.data("bs.tooltip");n&&n.tip().remove(),this.isSuspendEvents||this.delaySelect||this.trigger("item:click",this,t,e,i)}},onDblClickItem:function(t,e,i){this.disabled||(window._event=i,this.showLast&&this.selectRecord(e),this.lastSelectedRec=null,this.isSuspendEvents||this.trigger("item:dblclick",this,t,e,i))},onSelectItem:function(t,e,i){this.isSuspendEvents||this.trigger(i?"item:select":"item:deselect",this,t,e,this._fromKeyDown)},onContextMenuItem:function(t,e,i){this.isSuspendEvents||this.trigger("item:contextmenu",this,t,e,i)},scrollToRecord:function(t,e,i){if(t){var n=$(this.el).find(".inner"),o=n.offset().top+(i||0),s=_.indexOf(this.store.models,t),a=s>=0&&this.dataViewItems.length>s?$(this.dataViewItems[s].el):n.find("#"+t.get("id"));if(!(a.length<=0)){var r=a.offset().top,l=$(this.dataViewItems[0].el),c=l.length>0?l[0].clientTop:0;(e||r<o+c||r+.9*a.outerHeight()>o+c+n.height())&&(this.scroller&&this.allowScrollbar?this.scroller.scrollTop(n.scrollTop()+r-o-c,0):n.scrollTop(n.scrollTop()+r-o-c))}}},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),this.multiSelect&&(e.keyCode==Common.UI.Keys.CTRL?this.pressedCtrl=!0:e.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!0)),_.indexOf(this.moveKeys,e.keyCode)>-1||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.multiSelect?this.extremeSeletedRec:this.getSelectedRec();if(null===this.lastSelectedRec&&(this.lastSelectedRec=i),e.keyCode==Common.UI.Keys.RETURN)this.lastSelectedRec=null,this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.trigger("item:click",this,this,i,t),this.trigger("item:select",this,this,i,t),this.trigger("entervalue",this,i,t),this.parentMenu&&this.parentMenu.hide();else{this.pressedCtrl=!1;var n=_.indexOf(this.store.models,i);if(n<0)if(e.keyCode==Common.UI.Keys.LEFT)(a=$(t.target).closest(".dropdown-submenu.over")).length>0?(a.removeClass("over"),a.find("> a").focus()):n=0;else n=0;else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o=this.dataViewItems[n].topIdx,s=this.dataViewItems[n].leftIdx;if(n=void 0,e.keyCode==Common.UI.Keys.LEFT)for(;void 0===n;){if(--s<0){var a;if((a=$(t.target).closest(".dropdown-submenu.over")).length>0){a.removeClass("over"),a.find("> a").focus();break}s=this._layoutParams.columns-1}n=this._layoutParams.itemsIndexes[o][s]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===n;)++s>this._layoutParams.columns-1&&(s=0),n=this._layoutParams.itemsIndexes[o][s];else if(e.keyCode==Common.UI.Keys.UP){if(0==o&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)--o<0&&(o=this._layoutParams.rows-1),n=this._layoutParams.itemsIndexes[o][s]}else{if(o==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)++o>this._layoutParams.rows-1&&(o=0),n=this._layoutParams.itemsIndexes[o][s]}}else n=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,n-1):Math.min(this.store.length-1,n+1);void 0!==n&&n>=0&&(i=this.store.at(n)),i&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},onKeyUp:function(t){t.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!1),t.keyCode==Common.UI.Keys.CTRL&&(this.pressedCtrl=!1),this.trigger("item:keyup",this,t)},attachKeyEvents:function(){if(this.enableKeyEvents&&this.handleSelect){var t=$(this.el).find(".inner").addBack().filter(".inner");t.addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this)),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keyup":"keyup",_.bind(this.onKeyUp,this))}},showLastSelected:function(){if(this.lastSelectedRec)this.selectRecord(this.lastSelectedRec,!0),this.scrollToRecord(this.lastSelectedRec),this.lastSelectedRec=null;else{var t=this.getSelectedRec();this.multiSelect?t&&t.length>0&&this.scrollToRecord(t[t.length-1]):this.scrollToRecord(t)}},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},setEmptyText:function(t){if(this.emptyText=t,this.store.length<1){var e=$(this.el).find(".inner").addBack().filter(".inner").find(".empty-text td");e.length>0&&e.text(this.emptyText)}},alignPosition:function(){var t="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),e=Common.Utils.innerHeight()-10,i=$(this.el).find(".inner").addBack().filter(".inner"),n=t.outerHeight(),o=i.height(),s=Math.max(n-o,0),a=parseInt(t.css("top")),r={minScrollbarLength:this.minScrollbarLength};this.scrollAlwaysVisible&&(r.alwaysVisibleY=this.scrollAlwaysVisible),a+n>e?(i.css("max-height",e-a-s+"px"),this.allowScrollbar&&this.scroller.update(r)):a+n<e&&o<this.options.restoreHeight&&(i.css("max-height",Math.min(e-a-s,this.options.restoreHeight)+"px"),this.allowScrollbar&&this.scroller.update(r))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=$(this.dataViewItems[0].el),e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.$el.offset().left,n=t.offset().top,o=-1,s=0,a=0,r=0;r<this.dataViewItems.length;r++){var l=$(this.dataViewItems[r].el).offset().top-n;a=Math.floor(($(this.dataViewItems[r].el).offset().left-i)/e+.01),l>o&&(o=l,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][a]=r,this.dataViewItems[r].topIdx=s,this.dataViewItems[r].leftIdx=a,this._layoutParams.columns<a&&(this._layoutParams.columns=a)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},setMultiselectMode:function(t){this.pressedCtrl=!!t},onResize:function(){this._layoutParams=void 0},focus:function(t){var e;$(this.el).find(".inner").addBack().filter(".inner").focus(),"string"==typeof t?"first"==t?e=this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),e=this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&(e=this.selectByIndex(t,!0)),this.scrollToRecord(e)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")}}),Common.UI.DataViewSimple=Common.UI.BaseView.extend({options:{handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,scrollAlwaysVisible:!1,useBSKeydown:!1},template:_.template(['<div class="dataview inner" style="<%= style %>">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.store=e.options.store||new Common.UI.DataViewStore,e.itemTemplate=e.options.itemTemplate||null,e.handleSelect=e.options.handleSelect,e.parentMenu=e.options.parentMenu,e.enableKeyEvents=e.options.enableKeyEvents,e.useBSKeydown=e.options.useBSKeydown,e.style=e.options.style||"",e.scrollAlwaysVisible=e.options.scrollAlwaysVisible||!1,e.tabindex=e.options.tabindex||0,e.parentMenu&&(e.parentMenu.options.restoreHeight=e.options.restoreHeight>0),e.rendered=!1,"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],e.options.el&&e.render()},render:function(t){var e=this;this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style})),t.html(this.cmpEl)):(this.cmpEl=e.$el||$(this.el),this.cmpEl.html(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style,options:e.options})));var i=this.cmpEl.closest(".asc-window");return i.length<1&&(i=this.cmpEl.closest('[id^="menu-container-"]')),i.length>0&&(this.tipZIndex=parseInt(i.css("z-index"))+10),this.rendered||(this.parentMenu?(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this)),this.parentMenu.on("show:after",_.bind(this.onAfterShowMenu,this))):this.store.length>0&&this.onAfterShowMenu(),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(this.parentMenu.on("show:before",(function(t){e.deselectAll()})),this.parentMenu.on("show:after",(function(t){Common.NotificationCenter.trigger("dataview:focus"),_.delay((function(){t.cmpEl.find(".dataview").focus()}),10)})).on("hide:after",(function(){Common.NotificationCenter.trigger("dataview:blur")}))),this.attachKeyEvents(),this.cmpEl.on("click","div.item",_.bind(e.onClickItem,e))),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,this.cmpEl.on("click",(function(t){if(/dataview/.test(t.target.className))return!1})),this.trigger("render:after",this),this},selectRecord:function(t,e){if(this.handleSelect){if(e&&this.suspendEvents(),this.deselectAll(e),t){t.set({selected:!0});var i=_.indexOf(this.store.models,t);i>=0&&this.dataViewItems&&this.dataViewItems.length>i&&this.dataViewItems[i].el.addClass("selected")}return e&&this.resumeEvents(),t}},selectByIndex:function(t,e){if(this.store.length>0&&t>-1&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),(function(t){t.set({selected:!1})})),this.cmpEl.find(".item.selected").removeClass("selected"),t&&this.resumeEvents()},getSelectedRec:function(){return this.store.findWhere({selected:!0})},onResetItems:function(){this.dataViewItems&&_.each(this.dataViewItems,(function(t){var e=t.el.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.tip().remove())}),this),this.dataViewItems=null;var t=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>"].join(""));this.cmpEl&&this.cmpEl.find(".inner").html(t({items:this.store.toJSON(),itemTemplate:this.itemTemplate,style:this.style})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible}),!this.parentMenu&&this.store.length>0&&this.onAfterShowMenu(),this._layoutParams=void 0},setStore:function(t){t&&(this.store=t,this.onResetItems())},onClickItem:function(t){if(!this.disabled){window._event=t;var e=$(t.currentTarget).closest("div.item").index(),i=e>=0?this.store.at(e):null,n=e>=0?this.dataViewItems[e]:null;if(i&&n){i.set({selected:!0});var o=n.el.data("bs.tooltip");o&&o.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,n.el,i,t)}}},onAfterShowMenu:function(t){if(!this.dataViewItems){var e=this;this.dataViewItems=[],_.each(this.cmpEl.find("div.item"),(function(t,i){var n=$(t),o=e.store.at(i);e.dataViewItems.push({el:n}),o.get("tip")&&n.tooltip({title:o.get("tip"),placement:"cursor",zIndex:e.tipZIndex})}))}},scrollToRecord:function(t){if(t){var e=$(this.el).find(".inner"),i=e.offset().top,n=_.indexOf(this.store.models,t),o=n>=0&&this.dataViewItems.length>n?this.dataViewItems[n].el:e.find("#"+t.get("id"));if(!(o.length<=0)){var s=o.offset().top,a=this.dataViewItems[0].el,r=a.length>0?a[0].offsetTop:0;(s<i+r||s+o.outerHeight()>i+e.height())&&(this.scroller?this.scroller.scrollTop(e.scrollTop()+s-i-r,0):e.scrollTop(e.scrollTop()+s-i-r))}}},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),_.indexOf(this.moveKeys,e.keyCode)>-1||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.getSelectedRec();if(e.keyCode==Common.UI.Keys.RETURN)this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.canAddRecents&&this.addRecentItem(i),this.trigger("item:click",this,this,i,t),this.parentMenu&&this.parentMenu.hide();else{var n=_.indexOf(this.store.models,i);if(n<0){function r(){for(var t=0;!this.dataViewItems[t].el.is(":visible");)t++;return t}if(e.keyCode==Common.UI.Keys.LEFT)(a=$(t.target).closest(".dropdown-submenu.over")).length>0?(a.removeClass("over"),a.find("> a").focus()):n=r.call(this);else n=r.call(this)}else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o=this.dataViewItems[n].topIdx,s=this.dataViewItems[n].leftIdx;if(n=void 0,e.keyCode==Common.UI.Keys.LEFT)for(;void 0===n;){if(--s<0){var a;if((a=$(t.target).closest(".dropdown-submenu.over")).length>0){a.removeClass("over"),a.find("> a").focus();break}s=this._layoutParams.columns-1}n=this._layoutParams.itemsIndexes[o][s]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===n;)++s>this._layoutParams.columns-1&&(s=0),n=this._layoutParams.itemsIndexes[o][s];else if(e.keyCode==Common.UI.Keys.UP){if(0==o&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)--o<0&&(o=this._layoutParams.rows-1),n=this._layoutParams.itemsIndexes[o][s]}else{if(o==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)++o>this._layoutParams.rows-1&&(o=0),n=this._layoutParams.itemsIndexes[o][s]}}else n=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,n-1):Math.min(this.store.length-1,n+1);void 0!==n&&n>=0&&(i=this.store.at(n)),i&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},attachKeyEvents:function(){if(this.enableKeyEvents&&this.handleSelect){var t=$(this.el).find(".inner").addBack().filter(".inner");t.addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this))}},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},alignPosition:function(){var t="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),e=Common.Utils.innerHeight()-10,i=$(this.el).find(".inner").addBack().filter(".inner"),n=i.parent(),o=parseInt(n.css("margin-top"))+parseInt(n.css("margin-bottom"))+parseInt(t.css("margin-top")),s=parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom")),a=t.outerHeight(),r=parseInt(t.css("top")),l={minScrollbarLength:this.minScrollbarLength};this.scrollAlwaysVisible&&(l.alwaysVisibleY=this.scrollAlwaysVisible);var c=!1;if(this.parentMenu.menuAlign){var d=this.parentMenu.menuAlign.match(/^([a-z]+)-([a-z]+)/);c="bl"===d[1]||"br"===d[1]}if(c){var h=r+a;r<0?(i.css("max-height",h-s-o+"px"),t.css("top",0),this.scroller.update(l)):r>0&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(h-s-o,this.options.restoreHeight)+"px"),t.css("top",h-t.outerHeight()),this.scroller.update(l))}else r+a>e?(i.css("max-height",e-r-s-o+"px"),this.scroller.update(l)):r+a<e&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(e-r-s-o,this.options.restoreHeight)+"px"),this.scroller.update(l))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.$el.offset().left,n=t.offset().top,o=-1,s=0,a=0,r=0;r<this.dataViewItems.length;r++){var l=this.dataViewItems[r],c=l.el.offset().top-n;a=Math.floor((l.el.offset().left-i)/e),c>o&&(o=c,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][a]=r,l.topIdx=s,l.leftIdx=a,this._layoutParams.columns<a&&(this._layoutParams.columns=a)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},onResize:function(){this._layoutParams=void 0},focus:function(){this.cmpEl&&this.cmpEl.find(".dataview").focus()}}),$(document).on("keydown.dataview","[data-toggle=dropdown], [role=menu]",(function(t){t.keyCode!==Common.UI.Keys.UP&&t.keyCode!==Common.UI.Keys.DOWN&&t.keyCode!==Common.UI.Keys.LEFT&&t.keyCode!==Common.UI.Keys.RIGHT&&t.keyCode!==Common.UI.Keys.RETURN||_.defer((function(){var e=$(t.target).closest(".dropdown-toggle");e.length?e.parent().find(".inner.canfocused").trigger("dataview:keydown",t):$(t.target).closest(".dropdown-submenu").find(".inner.canfocused").trigger("dataview:keydown",t)}),100)})),Common.UI.DataViewShape=Common.UI.DataViewSimple.extend(_.extend({template:_.template(['<div class="dataview inner" style="<%= style %>">',"<% _.each(options.groupsWithRecent, function(group, index) { %>",'<div class="grouped-data <% if (index === 0) { %> recent-group <% } %> " id="<%= group.id %>" >',"<% if (!_.isEmpty(group.groupName)) { %>",'<div class="group-description">',"<span><%= group.groupName %></span>","</div>","<% } %>",'<div class="group-items-container <% if (index === 0) { %> recent-items <% } %>">',"<% _.each(group.groupStore.toJSON(), function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }); %>","</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){var e=this;this.canAddRecents=!0,this._state={hideTextRect:t.hideTextRect,hideLines:t.hideLines};var i=Common.localStorage.getKeysFilter();this.appPrefix=i&&i.length?i.split(",")[0]:"",e.groups=t.groups.toJSON();var n=new Common.UI.DataViewGroupStore,o=t.recentShapes||[],s=o.length>18?7:6,a=35*Math.ceil(o.length/s)+3,r=30*s;if((e.recentShapes=o,e.recentShapes.length>0)&&!_.findWhere(e.groups,{groupName:e.recentShapes[0].groupName})){for(var l=0;l<e.recentShapes.length;l++)for(var c,d=e.recentShapes[l].data.shapeType,h=0;h<e.groups.length;h++){for(var m=e.groups[h].groupStore,u=e.groups[h].groupName,p=0;p<m.length;p++)if(m.at(p).get("data").shapeType===d){c=m.at(p).toJSON(),e.recentShapes[l]={data:c.data,tip:c.tip,allowSelected:c.allowSelected,selected:!1,groupName:u};break}if(c){c=void 0;break}}Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(e.recentShapes))}if(e.recentShapes.length<12){var f=12-e.recentShapes.length,g=[],b=function(t,e){var i=t.toJSON(),n={data:i.data,tip:i.tip,allowSelected:i.allowSelected,selected:!1,groupName:e};g.push(n)};for(p=0;p<e.groups.length&&f>0;p++){var v=e.groups[p].groupStore;u=e.groups[p].groupName;0===p?(b(v.at(1),u),--f>0&&(b(v.at(2),u),f--)):3!==p&&6!==p&&7!==p&&(b(v.at(0),u),--f>0&&(b(v.at(1),u),f--))}e.recentShapes=e.recentShapes.concat(g)}n.add(e.recentShapes),e.groups.unshift({groupName:t.textRecentlyUsed,groupStore:n,groupWidth:r,groupHeight:a}),e.options.groupsWithRecent=e.groups;m=new Common.UI.DataViewStore;_.each(e.groups,(function(t,e){var i=t.groupStore.models;if(e>0)for(var n=0;n<i.length;n++)i[n].set({groupName:t.groupName});m.add(i)})),t.store=m,Common.UI.DataViewSimple.prototype.initialize.call(this,t),e.parentMenu.on("show:before",(function(){e.updateRecents()})),e._state.hideLines&&e.hideLinesGroup()},onAfterShowMenu:function(t){var e=this,i=!1;if(e.dataViewItems||(e.dataViewItems=[],_.each(e.cmpEl.find("div.grouped-data"),(function(t,i){_.each($(t).find("div.item"),(function(t,n){var o=$(t),s=e.groups[i].groupStore.at(n);e.dataViewItems.push({el:o,groupIndex:i,index:n});var a=s.get("tip");a&&o.one("mouseenter",(function(){o.attr("data-toggle","tooltip"),o.tooltip({title:a,placement:"cursor",zIndex:e.tipZIndex}),o.mouseenter()}))}))})),i=!0),e.updateDataViewItems&&e.cmpEl.is(":visible")){for(var n=_.where(e.dataViewItems,{groupIndex:0}),o=n?n.length:0,s=0;s<o;s++){var a=e.dataViewItems[s].el.data("bs.tooltip");a&&(void 0===a.dontShow&&(a.dontShow=!0),a.tip().remove())}e.dataViewItems=e.dataViewItems.slice(o);var r=[];_.each(e.cmpEl.find(".recent-group div.item"),(function(t,i){var n=$(t),o=e.recentShapes[i];r.push({el:n,groupIndex:0,index:i});var s=o.tip;s&&n.one("mouseenter",(function(){n.attr("data-toggle","tooltip"),n.tooltip({title:s,placement:"cursor",zIndex:e.tipZIndex}),n.mouseenter()}))})),e.dataViewItems=r.concat(e.dataViewItems),1===e.recentShapes.length&&$(".recent-group").show(),e.updateDataViewItems=!1,i=!0}this._state.hideLines&&e.hideLines(),i&&e.hideTextRect(e._state.hideTextRect),e.fillIndexesArray()},onClickItem:function(t){if(!this.disabled){window._event=t;var e=$(t.currentTarget).closest("div.grouped-data").index(),i=$(t.currentTarget).closest("div.item").data("index"),n=_.findIndex(this.dataViewItems,(function(t){return t.groupIndex===e&&t.index===i})),o=n>=0?this.store.at(n):null,s=n>=0?this.dataViewItems[n]:null;if(o&&s){o.set({selected:!0});var a=s.el.data("bs.tooltip");a&&a.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,s.el,o,t),this.addRecentItem(o)}}},addRecentItem:function(t){for(var e=this,i=!1,n=t.get("data").shapeType,o=t.get("groupName"),s=0;s<e.recentShapes.length;s++)if(e.recentShapes[s].data.shapeType===n){i=!0;break}if(!i){var a=t.toJSON(),r=[{data:a.data,tip:a.tip,allowSelected:a.allowSelected,selected:!1,groupName:o}].concat(e.recentShapes.slice(0,11));Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(r)),e.recentShapes=void 0}},updateRecents:function(){var t=this,e=Common.localStorage.getItem(this.appPrefix+"recent-shapes");e=e?JSON.parse(e):[];var i=!1;if(t.recentShapes)for(var n=0;n<e.length;n++)(!t.recentShapes[n]||t.recentShapes[n]&&e[n].tip!==t.recentShapes[n].tip)&&(i=!0);else i=!0;if(e.length>0&&i){t.recentShapes=e;var o=new Common.UI.DataViewStore;_.each(t.recentShapes,(function(t){var e={data:{shapeType:t.data.shapeType},tip:t.tip,allowSelected:t.allowSelected,selected:t.selected,groupName:t.groupName};o.push(e)})),t.groups[0].groupStore=o;var s=new Common.UI.DataViewStore;_.each(t.groups,(function(t){s.add(t.groupStore.models)})),t.store=s;var a=_.template(["<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }) %>"].join(""));t.cmpEl&&t.cmpEl.find(".recent-items").html(a({items:t.recentShapes,itemTemplate:this.itemTemplate,style:this.style})),t.updateDataViewItems=!0}},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=0;!this.dataViewItems[e].el.is(":visible");){if(e++,!this.dataViewItems[e])return;t=this.dataViewItems[e].el}for(var i=t.outerWidth()+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right")),n=this.$el.offset().left,o=t.offset().top,s=-1,a=0,r=e,l=0;l<this.dataViewItems.length;l++){var c=this.dataViewItems[l];if(c.el.is(":visible")){var d=c.el.offset().top-o;r=Math.floor((c.el.offset().left-n)/i),d>s&&(s=d,this._layoutParams.itemsIndexes.push([]),a=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[a][r]=l,c.topIdx=a,c.leftIdx=r,this._layoutParams.columns<r&&(this._layoutParams.columns=r)}else c.topIdx=-1,c.leftIdx=-1}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},hideTextRect:function(t){var e=this;this.store.each((function(i,n){"textRect"===i.get("data").shapeType&&e.dataViewItems[n].el[t?"addClass":"removeClass"]("hidden")}),this),this._state.hideTextRect=t},hideLinesGroup:function(){$(this.cmpEl.find("div.grouped-data")[9]).hide()},hideLines:function(){var t=this;this.store.each((function(e,i){if("Lines"===e.get("groupName")){var n=t.dataViewItems[i].el;n.is(":visible")&&n.addClass("hidden")}}),this)}}))})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/Comments",["text!common/main/lib/template/Comments.template","text!common/main/lib/template/CommentsPanel.template","common/main/lib/util/utils","common/main/lib/component/Button","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/Layout","common/main/lib/component/Window"],(function(t,e){"use strict";function i(t,e){var i,n,o=t;for(i in e)void 0!==i&&(n=e[i],o=o.replace(new RegExp(i,"g"),n));return o}var n=Common.UI.DataView.extend({options:{handleSelect:!1,scrollable:!0,listenStoreEvents:!1,template:_.template('<div class="dataview-ct inner"></div>')},getTextBox:function(){var t=$(this.el).find("textarea");return t&&t.length?t:void 0},setFocusToTextBox:function(){var t=$(this.el).find("textarea");if(t&&t.length){var e=t.val();t.focus(),t.val(""),t.val(e)}},getActiveTextBoxVal:function(){var t=$(this.el).find("textarea");return t&&t.length?t.val().trim():""},disableTextBoxButton:function(t){var e=$(t.siblings("#id-comments-change")[0]);t.val().trim().length>0?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},autoHeightTextBox:function(){var t=this,e=$(this.el).find("textarea"),i=null,n=55,o=0,s=0;function a(){i.scrollHeight>i.clientHeight?e.css({height:i.scrollHeight+o+"px"}):i.clientHeight>=n&&(e.css({height:n+"px"}),i.scrollHeight>i.clientHeight&&(s=Math.max(i.scrollHeight+o,n),e.css({height:s+"px"}))),t.autoScrollToEditButtons()}e&&e.length&&(i=e.get(0),t.disableTextBoxButton(e),i&&(o=.25*parseInt(e.css("lineHeight"),10),a(),e.bind("input propertychange",(function(e){a(),t.disableTextBoxButton($(e.target))})))),this.textBox=e},clearTextBoxBind:function(){this.textBox&&(this.textBox.unbind("input propertychange"),this.textBox=void 0)},autoScrollToEditButtons:function(){var t=$("#id-comments-change"),e=null,i=this.el.getBoundingClientRect(),n=0;t.length&&(e=t.get(0).getBoundingClientRect())&&i&&(n=i.bottom-(e.bottom+7))<0&&this.scroller.scrollTop(this.scroller.getScrollTop()-n)}});Common.Views.Comments=Common.UI.BaseView.extend(_.extend({el:"#left-panel-comments",template:_.template(e),addCommentHeight:45,newCommentHeight:110,textBoxAutoSizeLocked:void 0,viewmode:!1,_commentsViewOnItemClick:function(t,e,i,n){var o,s,a,r,l,c=this;function d(){c.update()}if(o=$(n.target))if(s=i.get("editText"),a=i.get("showReply"),r=i.get("uid"),l=o.attr("data-value"),o.hasClass("btn-edit"))_.isUndefined(l)?s||(c.fireEvent("comment:closeEditing"),i.set("editText",!0),t.autoHeightTextBox(),d(),t.setFocusToTextBox(),c.hookTextBox()):(c.fireEvent("comment:closeEditing",[r]),c.fireEvent("comment:editReply",[r,l]),c.commentsView.reply=l,t.autoHeightTextBox(),d(),c.hookTextBox(),t.autoScrollToEditButtons(),t.setFocusToTextBox());else if(o.hasClass("btn-delete"))_.isUndefined(l)?(c.fireEvent("comment:remove",[r]),Common.NotificationCenter.trigger("edit:complete",c)):c.fireEvent("comment:removeReply",[r,l]),c.fireEvent("comment:closeEditing"),d();else if(o.hasClass("user-reply"))c.fireEvent("comment:closeEditing"),i.set("showReply",!0),d(),t.autoHeightTextBox(),c.hookTextBox(),t.autoScrollToEditButtons(),t.setFocusToTextBox();else if(o.hasClass("btn-reply",!1))a&&(c.fireEvent("comment:addReply",[r,t.getActiveTextBoxVal()]),c.fireEvent("comment:closeEditing"),d());else if(o.hasClass("btn-close",!1))c.fireEvent("comment:closeEditing",[r]);else if(o.hasClass("btn-inner-edit",!1))_.isUndefined(c.commentsView.reply)?s&&c.fireEvent("comment:change",[r,t.getActiveTextBoxVal()]):(c.fireEvent("comment:changeReply",[r,c.commentsView.reply,t.getActiveTextBoxVal()]),c.commentsView.reply=void 0),c.fireEvent("comment:closeEditing"),d();else if(o.hasClass("btn-inner-close",!1))c.fireEvent("comment:closeEditing"),c.commentsView.reply=void 0,d();else if(o.hasClass("btn-resolve",!1)){var h=o.data("bs.tooltip");h&&(h.dontShow=!0),c.fireEvent("comment:resolve",[r]),d()}else if(!o.hasClass("msg-reply")&&!o.hasClass("btn-resolve")){var m=!1;if(o.hasClass("user-message"))if(window.getSelection)m=""!==window.getSelection().toString();else document.selection&&(m=document.selection);c.fireEvent("comment:show",[r,!1,m])}},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.store=this.options.store;var e=Common.localStorage.getKeysFilter();this.appPrefix=e&&e.length?e.split(",")[0]:""},render:function(){var e=this;if(this.rendered||(this.$el.html(this.template({textAddCommentToDoc:e.textAddCommentToDoc,textAddComment:e.textAddComment,textCancel:e.textCancel,textEnterCommentHint:e.textEnterCommentHint,maxCommLength:Asc.c_oAscMaxCellOrCommentLength,textComments:e.textComments})),this.buttonAddCommentToDoc=new Common.UI.Button({el:$(".btn.new",this.$el),enableToggle:!1}),this.buttonAdd=new Common.UI.Button({action:"add",el:$(".btn.add",this.$el),enableToggle:!1}),this.buttonCancel=new Common.UI.Button({el:$(".btn.cancel",this.$el),enableToggle:!1}),this.buttonSort=new Common.UI.Button({parentEl:$("#comments-btn-sort",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-sorting",hint:this.textSort,menu:new Common.UI.Menu({menuAlign:"tr-br",style:"min-width: auto;",items:[{caption:this.mniDateDesc,value:"date-desc",checkable:!0,checked:"date-desc"===(Common.localStorage.getItem(this.appPrefix+"comments-sort")||"date-desc"),toggleGroup:"sortcomments"},{caption:this.mniDateAsc,value:"date-asc",checkable:!0,checked:"date-asc"===(Common.localStorage.getItem(this.appPrefix+"comments-sort")||"date-desc"),toggleGroup:"sortcomments"},{caption:this.mniAuthorAsc,value:"author-asc",checkable:!0,checked:"author-asc"===Common.localStorage.getItem(this.appPrefix+"comments-sort"),toggleGroup:"sortcomments"},{caption:this.mniAuthorDesc,value:"author-desc",checkable:!0,checked:"author-desc"===Common.localStorage.getItem(this.appPrefix+"comments-sort"),toggleGroup:"sortcomments"},{caption:this.mniPositionAsc,value:"position-asc",checkable:!0,visible:"de-"===this.appPrefix,checked:"position-asc"===Common.localStorage.getItem(this.appPrefix+"comments-sort"),toggleGroup:"sortcomments"},{caption:this.mniPositionDesc,value:"position-desc",checkable:!0,visible:"de-"===this.appPrefix,checked:"position-desc"===Common.localStorage.getItem(this.appPrefix+"comments-sort"),toggleGroup:"sortcomments"},{caption:"--",visible:!1},this.menuFilterGroups=new Common.UI.MenuItem({caption:this.mniFilterGroups,checkable:!1,visible:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[]})})]})}),this.buttonClose=new Common.UI.Button({parentEl:$("#comments-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.buttonAddCommentToDoc.on("click",_.bind(this.onClickShowBoxDocumentComment,this)),this.buttonAdd.on("click",_.bind(this.onClickAddDocumentComment,this)),this.buttonCancel.on("click",_.bind(this.onClickCancelDocumentComment,this)),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.buttonSort.menu.on("item:toggle",_.bind(this.onSortClick,this)),this.menuFilterGroups.menu.on("item:toggle",_.bind(this.onFilterGroupsClick,this)),this.txtComment=$("#comment-msg-new",this.el),this.scrollerNewCommet=new Common.UI.Scroller({el:$(".new-comment-ct")}),this.txtComment.keydown((function(t){if(!t.ctrlKey&&!t.metaKey||t.altKey||t.keyCode!=Common.UI.Keys.RETURN){if(t.keyCode===Common.UI.Keys.TAB){var i,n,o;o=this.selectionStart,n=this.selectionEnd,(i=$(this)).val(i.val().substring(0,o)+"\t"+i.val().substring(n)),this.selectionStart=this.selectionEnd=o+1,t.stopImmediatePropagation(),t.preventDefault()}}else e.onClickAddDocumentComment(),t.stopImmediatePropagation()}))),this.commentsView)this.commentsView.onResetItems();else{this.commentsView=new n({el:$(".messages-ct",e.el),store:e.store,itemTemplate:_.template(i(t,{textAddReply:e.textAddReply,textAdd:e.textAdd,textCancel:e.textCancel,textEdit:e.textEdit,textReply:e.textReply,textClose:e.textClose,maxCommLength:Asc.c_oAscMaxCellOrCommentLength})),emptyText:e.txtEmpty});var o=function(t,i,n){i.tipsArray&&i.tipsArray.forEach((function(t){t.remove()}));var o=[],s=$(i.el).find(".btn-resolve:not(.comment-resolved)");s.tooltip({title:e.textResolve,placement:"cursor"}),s.each((function(t,e){o.push($(e).data("bs.tooltip").tip())})),(s=$(i.el).find(".comment-resolved")).tooltip({title:e.textOpenAgain,placement:"cursor"}),s.each((function(t,e){o.push($(e).data("bs.tooltip").tip())})),(s=$(i.el).find(".i-comment-resolved")).tooltip({title:e.textViewResolved,placement:"cursor"}),s.each((function(t,e){o.push($(e).data("bs.tooltip").tip())})),i.tipsArray=o};this.commentsView.on({"item:add":o,"item:remove":o,"item:change":o,"item:click":this._commentsViewOnItemClick.bind(this)})}return this.rendered||this.setupLayout(),this.update(),this.rendered=!0,this},update:function(){this.updateLayout(),this.updateScrolls()},updateScrolls:function(){this.commentsView&&this.commentsView.scroller&&this.commentsView.scroller.update({minScrollbarLength:this.commentsView.minScrollbarLength,alwaysVisibleY:!0})},showEditContainer:function(t){var e=$(".add-link-ct",this.el),i=$(".new-comment-ct",this.el);$(".messages-ct",this.el),$("#comments-box",this.el);this.layout.freezePanels(!t),t?(e.css({display:"none"}),i.css({display:"table-row"}),this.txtComment.val(""),this.txtComment.focus(),this.textBoxAutoSizeLocked=void 0):(e.css({display:"table-row"}),i.css({display:"none"})),this.updateLayout(),this.updateScrolls()},onClickShowBoxDocumentComment:function(){this.fireEvent("comment:closeEditing"),this.showEditContainer(!0)},onClickAddDocumentComment:function(){this.fireEvent("comment:add",[this,this.txtComment.val().trim(),void 0,!1,!0]),this.txtComment.val("")},onClickCancelDocumentComment:function(){this.showEditContainer(!1)},saveText:function(t){this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textVal=void 0,t?this.commentsView.clearTextBoxBind():this.textVal=this.commentsView.getActiveTextBoxVal())},loadText:function(){if(this.textVal&&this.commentsView){var t=this.commentsView.getTextBox();t&&t.val(this.textVal)}},hookTextBox:function(){var t=this.commentsView.getTextBox();t&&t.keydown((function(t){if(!t.ctrlKey&&!t.metaKey||t.altKey||t.keyCode!=Common.UI.Keys.RETURN){if(t.keyCode===Common.UI.Keys.TAB){var e,i,n;n=this.selectionStart,i=this.selectionEnd,(e=$(this)).val(e.val().substring(0,n)+"\t"+e.val().substring(i)),this.selectionStart=this.selectionEnd=n+1,t.stopImmediatePropagation(),t.preventDefault()}}else{var o=$("#id-comments-change");o&&o.length&&o.click(),t.stopImmediatePropagation()}}))},setupLayout:function(){var t=this,e=t.$el,i=$(".new-comment-ct",t.el),n=($(".add-link-ct",t.el),$("#comments-box",t.el)),o=n.find(" > .layout-item");t.layout=new Common.UI.VBoxLayout({box:n,freeze:!0,items:[{el:o[0],rely:!0,resize:{hidden:!1,autohide:!1,fmin:function(){var e=n.height();return"none"!==i.css("display")&&.5*e<t.newCommentHeight?e-t.newCommentHeight:.5*e},fmax:function(){return"none"!==i.css("display")?n.height()-t.newCommentHeight:n.height()-t.addCommentHeight}}},{el:o[1],stretch:!0},{el:o[2],stretch:!0}]}),t.layout.on("layout:resizedrag",(function(){t.updateScrolls(),t.textBoxAutoSizeLocked=!0}),this),$(window).on("resize",(function(){if("none"!==e.css("display")){var i=$("#comments-box",t.el).height(),n=$(".new-comment-ct",t.el),o=$(".add-link-ct",t.el);"none"!==n.css("display")?t.layout.setResizeValue(0,Math.max(-t.newCommentHeight,Math.min(i-(n.height()+4),i-t.newCommentHeight))):t.layout.setResizeValue(0,Math.max(-t.addCommentHeight,Math.min(i-o.height(),i-t.addCommentHeight))),t.updateScrolls()}})),this.autoHeightTextBox()},changeLayout:function(t){var e=this,i=$(".new-comment-ct",this.el),n=$(".add-link-ct",this.el),o=$(".messages-ct",this.el);if(o.toggleClass("stretch",!t.canComments||t.compatibleFeatures),!t.canComments||t.compatibleFeatures)t.compatibleFeatures?(i.remove(),n.remove()):(i.hide(),n.hide()),this.layout.changeLayout([{el:o[0],rely:!1,stretch:!0}]);else{var s=$("#comments-box",this.el),a=s.find(" > .layout-item");n.show(),this.layout.changeLayout([{el:a[0],rely:!0,resize:{hidden:!1,autohide:!1,fmin:function(){var t=s.height();return"none"!==i.css("display")&&.5*t<e.newCommentHeight?t-e.newCommentHeight:.5*t},fmax:function(){return"none"!==i.css("display")?s.height()-e.newCommentHeight:s.height()-e.addCommentHeight}}},{el:a[1],stretch:!0},{el:a[2],stretch:!0}])}},updateLayout:function(){var t=$("#comments-box",this.el);"none"!==$(".new-comment-ct",this.el).css("display")?this.layout.setResizeValue(0,t.height()-this.newCommentHeight):this.layout.setResizeValue(0,t.height()-this.addCommentHeight)},disableTextBoxButton:function(t){var e=$(t.parent().siblings(".add")[0]);t.val().trim().length>0?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},autoHeightTextBox:function(){var t=this,e=0,i=44,n=$("#comment-msg-new",this.el);function o(){var n,o,s;if(n=$("#comment-msg-new",t.el),s=$("#comments-box",t.el).height(),0==n.val().length)return t.layout.setResizeValue(0,Math.max(-t.newCommentHeight,s-t.newCommentHeight)),void(t.textBoxAutoSizeLocked=void 0);_.isUndefined(t.textBoxAutoSizeLocked)&&(n.height(),n.get(0).scrollHeight,n.css({height:i+"px"}),n.height(),o=Math.max(n.get(0).scrollHeight+e,48),n.css({height:"100%"}),s=$("#comments-box",t.el).height(),t.layout.setResizeValue(0,Math.max(-t.newCommentHeight,Math.min(s-o-48,s-t.newCommentHeight))))}n.length<1||(t.disableTextBoxButton(n),e=.25*parseInt(n.css("lineHeight"),10),o(),n.bind("input propertychange",(function(e){o(),t.disableTextBoxButton($(e.target))})),this.textBox=n)},getFixedQuote:function(t){return Common.Utils.String.ellipsis(Common.Utils.String.htmlEncode(t),120,!0)},getUserName:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))},getEncodedName:function(t){return Common.Utils.String.htmlEncode(t)},pickLink:function(t){var e,i,n=[];t.replace(Common.Utils.ipStrongRe,(function(t){var i=/[\.,\?\+;:=!\(\)]+$/.exec(t);return i&&(t=t.substring(0,i.index)),e=arguments[arguments.length-2],n.push({start:e,end:t.length+e,str:'<a href="'+t+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""})),(t.length<1e3||t.search(/\S{255,}/)<0)&&t.replace(Common.Utils.hostnameStrongRe,(function(t){var o=/[\.,\?\+;:=!\(\)]+$/.exec(t);o&&(t=t.substring(0,o.index));var s=/(((^https?)|(^ftp)):\/\/)/i.test(t)?t:"http://"+t;return e=arguments[arguments.length-2],i=t.length,_.find(n,(function(t){return e>=t.start&&e<t.end||e<=t.start&&e+i>t.start}))||n.push({start:e,end:i+e,str:'<a href="'+s+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""})),t.replace(Common.Utils.emailStrongRe,(function(t){var o=/((^mailto:)\/\/)/i.test(t)?t:"mailto:"+t;return e=arguments[arguments.length-2],i=t.length,_.find(n,(function(t){return e>=t.start&&e<t.end||e<=t.start&&e+i>t.start}))||n.push({start:e,end:i+e,str:'<a href="'+o+'">'+t+"</a>"}),""}));for(var o=(n=_.sortBy(n,(function(t){return t.start}))).length>0?Common.Utils.String.htmlEncode(t.substring(0,n[0].start))+n[0].str:Common.Utils.String.htmlEncode(t),s=1;s<n.length;s++)o+=Common.Utils.String.htmlEncode(t.substring(n[s-1].end,n[s].start))+n[s].str;return n.length>0&&(o+=Common.Utils.String.htmlEncode(t.substring(n[s-1].end,t.length))),o},pickEMail:function(t,e,i){var n=[];i&&(n=Common.Utils.String.htmlEncode(i).match(/\B[@+][A-Z0-9._%+-]+@[A-Z0-9._-]+\.[A-Z]+\b/gi),n=_.map(n,(function(t){return t.slice(1,t.length)})));var o=Common.Utils.String.htmlEncode(e).match(/\B[@+][A-Z0-9._%+-]+@[A-Z0-9._-]+\.[A-Z]+\b/gi);o=_.map(o,(function(t){return t.slice(1,t.length)})),(o=_.difference(o,n)).length>0&&Common.Gateway.requestSendNotify({emails:o,actionId:t,actionLink:{action:{type:"comment",data:t}},message:e})},onSortClick:function(t,e,i){i&&this.fireEvent("comment:sort",[e.value])},onFilterGroupsClick:function(t,e,i){i&&this.fireEvent("comment:filtergroups",[e.value])},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")},textComments:"Comments",textAnonym:"Guest",textAddCommentToDoc:"Add Comment to Document",textAddComment:"Add Comment",textCancel:"Cancel",textAddReply:"Add Reply",textReply:"Reply",textClose:"Close",textResolved:"Resolved",textResolve:"Resolve",textEnterCommentHint:"Enter your comment here",textEdit:"Edit",textAdd:"Add",textOpenAgain:"Open Again",textHintAddComment:"Add Comment",textSort:"Sort comments",mniPositionAsc:"From top",mniPositionDesc:"From bottom",mniAuthorAsc:"Author A to Z",mniAuthorDesc:"Author Z to A",mniDateDesc:"Newest",mniDateAsc:"Oldest",textClosePanel:"Close comments",textViewResolved:"You have not permission for reopen comment",mniFilterGroups:"Filter by Group",textAll:"All",txtEmpty:"There are no comments in the document."},Common.Views.Comments||{}))})),define("text!common/main/lib/template/Chat.template",[],(function(){return'<div id="chat-box" class="layout-ct vbox">\r\n    <div id="chat-users" class="layout-item area">\r\n        <div id="chat-user-ct"></div>\r\n    </div>\r\n    <div id="chat-messages" class="layout-item area">\r\n        <div id="chat-message-ct"></div>\r\n    </div>\r\n    <div id="chat-options" class="layout-item">\r\n        <div id="chat-options-ct">\r\n            <textarea id="chat-msg-text" class="user-select textarea-control" maxlength="<%=maxMsgLength%>" data-hint="1" data-hint-direction="left-top"></textarea>\r\n            <button id="chat-msg-btn-add" class="btn normal dlg-btn primary" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%=scope.textSend%></button>\r\n        </div>\r\n    </div>\r\n</div>'})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/Chat",["text!common/main/lib/template/Chat.template","common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],(function(t){"use strict";Common.Views.Chat=Common.UI.BaseView.extend(_.extend({el:"#left-panel-chat",template:_.template(t),storeUsers:void 0,storeMessages:void 0,tplUser:['<li id="<%= user.get("iid") %>"<% if (!user.get("online")) { %> class="offline"<% } %>>','<div class="name"><div class="color" style="background-color: <%= user.get("color") %>;" ></div><%= scope.getUserName(user.get("username")) %>',"</div>","</li>"].join(""),templateUserList:_.template("<ul><% for (originalId in users) { %><%= _.template(usertpl)({user: users[originalId][0], scope: scope}) %><% } %></ul>"),tplMsg:["<li>",'<% if (msg.get("type")==1) { %>','<div class="message service" data-can-copy="true"><%= msg.get("message") %></div>',"<% } else { %>",'<div class="user-name" data-can-copy="true">','<div class="color" style="display: inline-block; background-color: <% if (msg.get("usercolor")!==null) { %><%=msg.get("usercolor")%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getUserName(msg.get("username")) %>',"</div>",'<label class="message user-select" data-can-copy="true" tabindex="-1" oo_editor_input="true"><%= msg.get("message") %></label>',"<% } %>","</li>"].join(""),templateMsgList:_.template("<ul><% _.each(messages, function(item) { %><%= _.template(msgtpl)({msg: item, scope: scope}) %><% }); %></ul>"),events:{},usersBoxHeight:72,messageBoxHeight:70,addMessageBoxHeight:110,initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments),this.storeUsers.bind({add:_.bind(this._onResetUsers,this),change:_.bind(this._onResetUsers,this),reset:_.bind(this._onResetUsers,this)}),this.storeMessages.bind({add:_.bind(this._onAddMessage,this),reset:_.bind(this._onResetMessages,this)})},render:function(t){return t=t||this.el,$(t).html(this.template({scope:this,maxMsgLength:Asc.c_oAscMaxCellOrCommentLength})),this.panelBox=$("#chat-box",this.el),this.panelUsers=$("#chat-users",this.el),this.panelMessages=$("#chat-messages",this.el),this.txtMessage=$("#chat-msg-text",this.el),this.panelOptions=$("#chat-options",this.el),this.panelUsers.scroller=new Common.UI.Scroller({el:$("#chat-users"),useKeyboard:!0,minScrollbarLength:25}),this.panelMessages.scroller=new Common.UI.Scroller({el:$("#chat-messages"),includePadding:!0,useKeyboard:!0,minScrollbarLength:40}),this.panelOptions.scroller=new Common.UI.Scroller({el:$("#chat-options")}),$("#chat-msg-btn-add",this.el).on("click",_.bind(this._onBtnAddMessage,this)),this.txtMessage.on("keydown",_.bind(this._onKeyDown,this)),this.setupLayout(),this.trigger("render:after",this),this},focus:function(){var t=this;_.defer((function(){t.txtMessage.focus()}),100),this.updateLayout(!0),this.setupAutoSizingTextBox()},_onKeyDown:function(t){t.keyCode==Common.UI.Keys.RETURN?!t.ctrlKey&&!t.metaKey||t.altKey||this._onBtnAddMessage(t):t.keyCode!=Common.UI.Keys.ESC||Common.UI.HintManager.isHintVisible()||this.hide()},_onResetUsers:function(t,e){this.panelUsers&&(this.panelUsers.html(this.templateUserList({users:this.storeUsers.chain().filter((function(t){return t.get("online")})).groupBy((function(t){return t.get("idOriginal")})).value(),usertpl:this.tplUser,scope:this})),this.panelUsers.scroller.update({minScrollbarLength:25,alwaysVisibleY:!0}))},_onAddMessage:function(t,e,i){if(this.panelMessages){var n=this.panelMessages.find("ul");n&&n.length&&(this._prepareMessage(t),n.append(_.template(this.tplMsg)({msg:t,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}),this.panelMessages.scroller.scrollTop(n.get(0).getBoundingClientRect().height))}},_onResetMessages:function(t,e){this.panelMessages&&(t.each((function(t){this._prepareMessage(t)}),this),this.panelMessages.html(this.templateMsgList({messages:t.models,msgtpl:this.tplMsg,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},_onBtnAddMessage:function(t){this.txtMessage&&(this.fireEvent("message:add",[this,this.txtMessage.val().trim()]),this.txtMessage.val(""),this.focus())},_prepareMessage:function(t){var e=this.storeUsers.findOriginalUser(t.get("userid"));t.set({usercolor:e?e.get("color"):null,message:this._pickLink(t.get("message"))},{silent:!0})},_pickLink:function(t){var e,i,n=[];t.replace(Common.Utils.ipStrongRe,(function(t){var i=/[\.,\?\+;:=!\(\)]+$/.exec(t);return i&&(t=t.substring(0,i.index)),e=arguments[arguments.length-2],n.push({start:e,end:t.length+e,str:'<a href="'+t+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""})),(t.length<1e3||t.search(/\S{255,}/)<0)&&t.replace(Common.Utils.hostnameStrongRe,(function(t){var o=/[\.,\?\+;:=!\(\)]+$/.exec(t);o&&(t=t.substring(0,o.index));var s=/(((^https?)|(^ftp)):\/\/)/i.test(t)?t:"http://"+t;return e=arguments[arguments.length-2],i=t.length,_.find(n,(function(t){return e>=t.start&&e<t.end||e<=t.start&&e+i>t.start}))||n.push({start:e,end:i+e,str:'<a href="'+s+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""})),t.replace(Common.Utils.emailStrongRe,(function(t){var o=/((^mailto:)\/\/)/i.test(t)?t:"mailto:"+t;return e=arguments[arguments.length-2],i=t.length,_.find(n,(function(t){return e>=t.start&&e<t.end||e<=t.start&&e+i>t.start}))||n.push({start:e,end:i+e,str:'<a href="'+o+'">'+t+"</a>"}),""}));for(var o=(n=_.sortBy(n,(function(t){return t.start}))).length>0?Common.Utils.String.htmlEncode(t.substring(0,n[0].start))+n[0].str:Common.Utils.String.htmlEncode(t),s=1;s<n.length;s++)o+=Common.Utils.String.htmlEncode(t.substring(n[s-1].end,n[s].start))+n[s].str;return n.length>0&&(o+=Common.Utils.String.htmlEncode(t.substring(n[s-1].end,t.length))),o},getUserName:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this),this.textBoxAutoSizeLocked=void 0},setupLayout:function(){var t=this,e=$(t.el),i=this.panelBox.find(" > .layout-item");t.layout=new Common.UI.VBoxLayout({box:this.panelBox,items:[{el:i[0],rely:!0,behaviour:"splitter",resize:{hidden:!1,autohide:!1,fmin:function(){return t.usersBoxHeight},fmax:function(){return.5*t.panelBox.height()-t.messageBoxHeight}}},{el:i[1],rely:!0,behaviour:"splitter",resize:{hidden:!1,autohide:!1,fmin:function(){return Math.max(t.messageBoxHeight+t.usersBoxHeight,.5*t.panelBox.height())},fmax:function(){return t.panelBox.height()-t.addMessageBoxHeight}}},{el:i[2],stretch:!0}]}),t.layout.on("layout:resizedrag",(function(e){t.updateScrolls(),t.usersCachedHeigt=t.panelUsers.height()+8+1,e.index||(t.textBoxAutoSizeLocked=!0)}),this),$(window).on("resize",(function(){"none"!==e.css("display")&&t.updateLayout()})),this.updateLayout();var n=this.panelBox.height();this.layout.setResizeValue(0,this.usersBoxHeight),this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,Math.max(.5*n,n-t.panelOptions.height()-4))),this.setupAutoSizingTextBox(),this.disableTextBoxButton($(this.txtMessage)),this.txtMessage.bind("input propertychange",_.bind(this.onTextareaInput,this))},onTextareaInput:function(t){this.updateHeightTextBox(t),this.disableTextBoxButton($(t.target))},disableTextBoxButton:function(t){var e=$(t.siblings("#chat-msg-btn-add")[0]);t.val().trim().length>0?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},updateLayout:function(t){var e=this,i=this.panelBox.height();if(e.layout.setResizeValue(1,Math.max(e.addMessageBoxHeight,Math.max(.5*i,i-e.panelOptions.height()-4))),t){this.panelUsers.css("height");this.panelUsers.css("height","1px");var n=this.panelUsers.get(0).scrollHeight;e.layout.setResizeValue(0,Math.max(e.usersBoxHeight,Math.min(n+2,Math.floor(.5*i)-e.messageBoxHeight)))}else e.layout.setResizeValue(0,Math.max(e.usersBoxHeight,Math.min(e.usersCachedHeigt+2,Math.floor(.5*i)-e.messageBoxHeight)));e.updateScrolls(),e.updateHeightTextBox(null)},setupAutoSizingTextBox:function(){this.lineHeight=0,this.minHeight=44,this.lineHeight=1.25*parseInt(this.txtMessage.css("lineHeight"),10),this.updateHeightTextBox(!0)},updateHeightTextBox:function(t){var e,i,n=this.txtMessage;if(i=this.panelBox.height(),t&&0==n.val().length)return this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,i-this.addMessageBoxHeight)),this.textBoxAutoSizeLocked=void 0,void this.updateScrolls();_.isUndefined(this.textBoxAutoSizeLocked)&&(n.height(),n.get(0).scrollHeight,n.css({height:this.minHeight+"px"}),n.height(),e=Math.max(n.get(0).scrollHeight+this.lineHeight,1),n.css({height:"100%"}),i=this.panelBox.height(),this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,Math.min(i-e-40,i-this.addMessageBoxHeight)))&&this.updateScrolls())},updateScrolls:function(){this.panelUsers&&this.panelUsers.scroller&&this.panelMessages&&this.panelMessages.scroller&&(this.panelUsers.scroller.update({minScrollbarLength:25,alwaysVisibleY:!0}),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},textSend:"Send"},Common.Views.Chat||{}))})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/Plugins",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],(function(t){"use strict";Common.Views.Plugins=Common.UI.BaseView.extend(_.extend({el:"#left-panel-plugins",storePlugins:void 0,template:_.template(['<div id="plugins-box" class="layout-ct vbox">','<label id="plugins-header"><%= scope.strPlugins %></label>','<div id="plugins-list" class="">',"</div>","</div>",'<div id="current-plugin-box" class="layout-ct vbox hidden">','<div id="current-plugin-frame" class="">',"</div>",'<div id="current-plugin-header">',"<label></label>",'<div id="id-plugin-close" class="close"></div>',"</div>","</div>",'<div id="plugins-mask" style="display: none;">'].join("")),initialize:function(t){_.extend(this,t),this._locked=!1,this._state={DisabledControls:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},this.lockedControls=[],Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t&&(this.$el=$(t)),this.$el.html(this.template({scope:this})),this.pluginName=$("#current-plugin-header label"),this.pluginsPanel=$("#plugins-box"),this.pluginsMask=$("#plugins-mask",this.$el),this.currentPluginPanel=$("#current-plugin-box"),this.currentPluginFrame=$("#current-plugin-frame"),this.pluginClose=new Common.UI.Button({parentEl:$("#id-plugin-close"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.pluginMenu=new Common.UI.Menu({menuAlign:"tr-br",items:[]}),this.trigger("render:after",this),this},getPanel:function(){var t=$('<section id="plugins-panel" class="panel" data-tab="plugins"></section>'),e=$('<div class="group"></div>');return this.storePlugins.isEmpty()||this.storePlugins.each((function(t){})),e.appendTo(t),t},renderTo:function(t){if(!this.storePlugins.isEmpty()){var e=this,i=$('<div class="group"></div>'),n=Common.enumLock;this.storePlugins.each((function(t){if(t.get("visible")){var o=t.get("variations"),s=t.get("guid"),a=o[t.get("currentVariation")].get("icons"),r=t.get("baseUrl")+e.parseIcons(a),l=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconImg:r,caption:t.get("name"),menu:o&&o.length>1,split:o&&o.length>1,value:s,hint:t.get("name"),lock:t.get("isDisplayedInViewer")?[n.viewMode,n.previewReviewMode,n.viewFormMode,n.selRangeEdit,n.editFormula]:[n.viewMode,n.previewReviewMode,n.viewFormMode,n.lostConnect,n.docLockView,n.docLockForms,n.docLockComments,n.selRangeEdit,n.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),c=$('<span class="btn-slot text x-huge"></span>').appendTo(i);l.render(c),t.set("button",l),e.lockedControls.push(l)}}));var o=e._state.docProtection;Common.Utils.lockControls(Common.enumLock.docLockView,o.isReadOnly,{array:e.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,o.isFormsOnly,{array:e.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,o.isCommentsOnly,{array:e.lockedControls}),t.html(i),$('<div class="separator long"></div>').prependTo(t)}},setLocked:function(t){this._locked=t},ChangeSettings:function(t){this.disableControls(this._locked)},disableControls:function(t){this._state.DisabledControls!==t&&(this._state.DisabledControls=t,_.each(this.lockedControls,(function(e){e.setDisabled(t)})),this.pluginsMask&&this.pluginsMask.css("display",t?"block":"none"))},SetDisabled:function(t,e,i){e?Common.Utils.lockControls(Common.enumLock.previewReviewMode,t,{array:this.lockedControls}):i?Common.Utils.lockControls(Common.enumLock.viewFormMode,t,{array:this.lockedControls}):Common.Utils.lockControls(Common.enumLock.viewMode,t,{array:this.lockedControls})},openInsideMode:function(t,e,i,n){return!!this.pluginsPanel&&(this.pluginsPanel.toggleClass("hidden",!0),this.currentPluginPanel.toggleClass("hidden",!1),this.pluginName.text(t),this.iframePlugin||(this.iframePlugin=document.createElement("iframe"),this.iframePlugin.id=void 0===i?"plugin_iframe":i,this.iframePlugin.name="pluginFrameEditor",this.iframePlugin.width="100%",this.iframePlugin.height="100%",this.iframePlugin.align="top",this.iframePlugin.frameBorder=0,this.iframePlugin.scrolling="no",this.iframePlugin.allow="camera; microphone; display-capture",this.iframePlugin.onload=_.bind(this._onLoad,this),this.currentPluginFrame.append(this.iframePlugin),this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:this.currentPluginFrame})),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),this.iframePlugin.src=e),this._state.insidePlugin=n,this.fireEvent("plugin:open",[this,"onboard","open"]),!0)},closeInsideMode:function(){this.pluginsPanel&&(this.iframePlugin&&(this.currentPluginFrame.empty(),this.iframePlugin=null),this.currentPluginPanel.toggleClass("hidden",!0),this._state.insidePlugin=void 0,this.fireEvent("plugin:open",[this,"onboard","close"]))},openedPluginMode:function(t){var e=this.storePlugins.findWhere({guid:t});if(e){var i=e.get("button");i&&(i.toggle(!0),this.updatePluginButton(e),i.menu&&i.menu.items.length>0&&i.menu.items[0].setCaption(this.textStop))}},closedPluginMode:function(t){var e=this.storePlugins.findWhere({guid:t});if(e){var i=e.get("button");i&&(i.toggle(!1),this.updatePluginButton(e),i.menu&&i.menu.items.length>0&&i.menu.items[0].setCaption(this.textStart))}},_onLoad:function(){this.loadMask&&this.loadMask.hide()},parseIcons:function(t){if(t.length&&"string"!=typeof t[0]){for(var e=Common.UI.Themes.currentThemeId().toLowerCase(),i=Common.UI.Themes.isDarkTheme()?"dark":"light",n=-1,o=0;o<t.length;o++)if(t[o].theme&&t[o].theme.toLowerCase()==e){n=o;break}if(n<0)for(o=0;o<t.length;o++)if(t[o].style&&t[o].style.toLowerCase()==i){n=o;break}n<0&&(n=0);var s,a,r=100*Common.Utils.applicationPixelRatio(),l=t[n],c=1e4,d=0;for(var h in l)l.hasOwnProperty(h)&&("default"==h?s=l[h]:isNaN(parseInt(h))||(d=Math.abs(r-parseInt(h)))<c-.01&&(c=d,a=l[h]));return c>.01&&s&&(a=s),{normal:a.normal,hover:a.hover||a.normal,active:a.active||a.normal}}var m=t[(Common.Utils.applicationPixelRatio()>1?1:0)+(t.length>2?2:0)];return{normal:m,hover:m,active:m}},updatePluginIcons:function(t){if(!t.get("visible"))return null;var e=t.get("variations")[t.get("currentVariation")].get("icons");t.set("parsedIcons",this.parseIcons(e)),this.updatePluginButton(t)},updatePluginButton:function(t){if(!t.get("visible"))return null;var e=t.get("button");e&&e.cmpEl&&e.cmpEl.find(".inner-box-icon img").attr("src",t.get("baseUrl")+t.get("parsedIcons")[e.isActive()?"active":"normal"])},createPluginButton:function(t){if(!t.get("visible"))return null;var e=this,i=t.get("variations"),n=t.get("guid"),o=i[t.get("currentVariation")].get("icons"),s=this.parseIcons(o),a=t.get("baseUrl")+s.normal;t.set("parsedIcons",s);var r=[];_.each(t.get("variations"),(function(t,i){t.get("visible")&&r.push({caption:i>0?t.get("description"):e.textStart,value:parseInt(t.get("index"))})}));var l=Common.enumLock,c=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconImg:a,caption:t.get("name"),menu:r.length>1,split:r.length>1,value:n,hint:t.get("name"),lock:t.get("isDisplayedInViewer")?[l.viewMode,l.previewReviewMode,l.viewFormMode,l.selRangeEdit,l.editFormula]:[l.viewMode,l.previewReviewMode,l.viewFormMode,l.docLockView,l.docLockForms,l.docLockComments,l.selRangeEdit,l.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"});return c.split&&(c.setMenu(new Common.UI.Menu({items:r,pluginGuid:t.get("guid")})),c.menu.on("item:click",(function(t,i,n){e.fireEvent("plugin:select",[t.options.pluginGuid,i.value])}))),c.on("click",(function(t,i){e.fireEvent("plugin:select",[t.options.value,0])})),t.set("button",c),e.lockedControls.push(c),c},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},strPlugins:"Plugins",textLoading:"Loading",textStart:"Start",textStop:"Stop",groupCaption:"Plugins",textClosePanel:"Close plugin"},Common.Views.Plugins||{}))})),define("common/main/lib/view/SearchDialog",["common/main/lib/component/Window"],(function(){"use strict";Common.UI.SearchDialog=Common.UI.Window.extend(_.extend({options:{width:550,title:"Search & Replace",modal:!1,cls:"search",toolclose:"hide",alias:"SearchDialog"},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">','<span class="btn-placeholder" id="search-placeholder-btn-options"></span>','<input type="text" id="sd-text-search" class="input-field form-control" maxlength="255" placeholder="'+this.textSearchStart+'" autocomplete="off">',"</div>",'<div class="input-row">','<input type="text" id="sd-text-replace" class="input-field form-control" maxlength="255" placeholder="'+this.textReplaceDef+'" autocomplete="off">',"</div>",'<div class="input-row">','<label class="link" id="search-label-replace" result="replaceshow">'+this.txtBtnReplace+"</label>","</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer right">','<button class="btn normal dlg-btn" result="replace">'+this.txtBtnReplace+"</button>",'<button class="btn normal dlg-btn margin-left-6" result="replaceall" style="width: auto;min-width: 100px;">'+this.txtBtnReplaceAll+"</button>",'<button class="btn normal dlg-btn iconic" result="back"><span class="icon img-commonctrl back"></span></button>','<button class="btn normal dlg-btn iconic margin-left-6" result="next"><span class="icon img-commonctrl next"></span></button>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){return Common.UI.Window.prototype.render.call(this),this.miMatchCase=new Common.UI.MenuItem({caption:this.textMatchCase,checkable:!0}),this.miMatchWord=new Common.UI.MenuItem({caption:this.options.matchwordstr||this.textWholeWords,checkable:!0}),this.miHighlight=new Common.UI.MenuItem({caption:this.textHighlight,checkable:!0}),this.btnOptions=new Common.UI.Button({id:"search-btn-options",cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",menu:new Common.UI.Menu({items:[this.miMatchCase,this.miMatchWord,this.miHighlight]})}),this.options.extraoptions&&(this.btnOptions.menu.addItem({caption:"--"}),this.options.extraoptions.forEach((function(t){this.btnOptions.menu.addItem(t)}),this)),this.btnOptions.render(this.$window.find("#search-placeholder-btn-options")),this.options.matchcase||this.miMatchCase.hide(),this.options.matchword||this.miMatchWord.hide(),this.options.markresult?this.options.markresult.applied&&this.miHighlight.setChecked(!0,!0):this.miHighlight.hide(),"search"===this.options.mode&&$(this.$window.find(".input-row").get(2)).hide(),this.txtSearch=this.$window.find("#sd-text-search"),this.txtReplace=this.$window.find("#sd-text-replace"),this.lblReplace=this.$window.find("#search-label-replace"),this.miHighlight.on("toggle",_.bind(this.onHighlight,this)),this.$window.find(".btn[result=back]").on("click",_.bind(this.onBtnClick,this,"back")),this.$window.find(".btn[result=next]").on("click",_.bind(this.onBtnClick,this,"next")),this.$window.find(".btn[result=replace]").on("click",_.bind(this.onBtnClick,this,"replace")),this.$window.find(".btn[result=replaceall]").on("click",_.bind(this.onBtnClick,this,"replaceall")),this.$window.find("label[result=replaceshow]").on("click",_.bind(this.onShowReplace,this)),this.txtSearch.on("keydown",null,"search",_.bind(this.onKeyPress,this)),this.txtReplace.on("keydown",null,"replace",_.bind(this.onKeyPress,this)),this.on("animate:before",_.bind(this.onAnimateBefore,this)),this},show:function(t,e){Common.UI.Window.prototype.show.call(this),!this.mode&&!t&&(t="search"),t&&this.mode!=t&&this.setMode(t),e&&this.setSearchText(e),this.options.markresult&&this.miHighlight.checked&&this.fireEvent("search:highlight",[this,!0]),this.focus()},focus:function(t){var e="replace"===t?this.txtReplace:this.txtSearch;setTimeout((function(){e.focus(),e.select()}),10)},onAnimateBefore:function(){this.focus()},onKeyPress:function(t){this.isLocked()||(t.keyCode==Common.UI.Keys.RETURN?("search"==t.data?this.onBtnClick("next",t):"replace"==t.data&&"replace"==this.mode&&this.onBtnClick("replace",t),t.preventDefault(),t.stopPropagation()):t.keyCode==Common.UI.Keys.ESC&&$(".asc-loadmask").length<1&&(this.hide(),t.preventDefault(),t.stopPropagation()))},onBtnClick:function(t,e){if(!$(".asc-loadmask").length){var i={textsearch:this.txtSearch.val(),textreplace:this.txtReplace.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked,highlight:this.miHighlight.checked};this.fireEvent("search:"+t,[this,i])}},setMode:function(t){this.mode=t;var e=this.$window.find(".input-row");"no-replace"===t?(this.setTitle(this.textTitle2),e.eq(1).hide(),e.eq(2).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.options.matchcase||this.options.matchword||this.options.markresult||(this.txtSearch.addClass("clear"),this.btnOptions.hide()),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(170)):(this.txtSearch.removeClass("clear"),this.setTitle(this.textTitle),"search"===t?(e.eq(2).show(),this.lblReplace.text(this.txtBtnReplace),e.eq(1).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(200)):(e.eq(2).show(),this.lblReplace.text(this.txtBtnHideReplace),e.eq(1).show(),this.$window.find(".btn[result=replace]").show(),this.$window.find(".btn[result=replaceall]").show(),this.menuLookin&&(this.menuLookin.menu.items[0].setChecked(!0),this.menuLookin.menu.items[1].setDisabled(!0)),this.setHeight(230)))},setSearchText:function(t){this.txtSearch&&this.txtSearch.val(t)},onShowReplace:function(t){this.setMode("replace"==this.mode?"search":"replace");var e=this;_.defer((function(){"replace"==e.mode?e.txtReplace.focus():e.txtSearch.focus()}),300)},onHighlight:function(t,e){this.fireEvent("search:highlight",[this,e])},getSettings:function(){return{textsearch:this.txtSearch.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked}},textTitle:"Search & Replace",textTitle2:"Search",txtBtnReplace:"Replace",txtBtnReplaceAll:"Replace All",textMatchCase:"Case sensitive",textWholeWords:"Whole words only",textHighlight:"Highlight results",textReplaceDef:"Enter the replacement text",textSearchStart:"Enter text for search",txtBtnHideReplace:"Hide Replace"},Common.UI.SearchDialog||{}))})),define("text!pdfeditor/main/app/template/FileMenu.template",[],(function(){return'<div class="panel-menu">\n    <li class="fm-first-item"></li>\n    <li id="fm-btn-return" class="fm-btn" data-layout-name="toolbar-file-close"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-save" class="fm-btn" data-layout-name="toolbar-file-save"></li>\n    <li id="fm-btn-download" class="fm-btn"></li>\n    <li id="fm-btn-save-copy" class="fm-btn"></li>\n    <li id="fm-btn-save-desktop" class="fm-btn"></li>\n    <li id="fm-btn-print" class="fm-btn"></li>\n    <li id="fm-btn-print-with-preview" class="fm-btn"></li>\n    <li id="fm-btn-rename" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-recent" class="fm-btn"></li>\n    <li id="fm-btn-create" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-info" class="fm-btn" data-layout-name="toolbar-file-info"></li>\n    <li id="fm-btn-rights" class="fm-btn"></li>\n    <li class="devider" class="fm-btn"></li>\n    <li id="fm-btn-settings" class="fm-btn" data-layout-name="toolbar-file-settings"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-help" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-back" class="fm-btn"></li>\n</div>\n<div class="panel-context">\n    <div id="panel-saveas" class="content-box"></div>\n    <div id="panel-savecopy" class="content-box"></div>\n    <div id="panel-recentfiles" class="content-box"></div>\n    <div id="panel-createnew" class="content-box"></div>\n    <div id="panel-info" class="content-box"></div>\n    <div id="panel-rights" class="content-box"></div>\n    <div id="panel-settings" class="content-box"></div>\n    <div id="panel-help" class="content-box"></div>\n    <div id="panel-print" class="content-box"></div>\n</div>'})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/RecentFiles",["common/main/lib/component/BaseView"],(function(){"use strict";Common.Views.RecentFiles=Common.UI.BaseView.extend(_.extend({menu:void 0,template:_.template(['<div class="header"><%= scope.txtOpenRecent %></div>','<div id="id-recent-view"></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.recent=t.recent,this.el=t.el,Common.NotificationCenter.on("update:recents",function(t){if(this.viewRecentPicker){const e=this.viewRecentPicker.store;e&&e.reset(this.recent.concat(t))}}.bind(this))},render:function(){return this.$el.html(this.template({scope:this})),this.viewRecentPicker=new Common.UI.DataView({el:$("#id-recent-view"),store:new Common.UI.DataViewStore(this.recent),itemTemplate:_.template(['<div class="recent-wrap">','<div class="recent-icon">',"<div>",'<div class= <% if (typeof format !== "undefined") {%> "img-format-<%=format %>"<% } else {%> "svg-file-recent"<%} %>></div>',"</div>","</div>",'<div class="file-name"><% if (typeof title !== "undefined") {%><%= Common.Utils.String.htmlEncode(title || "") %><% } %></div>','<div class="file-info"><% if (typeof folder !== "undefined") {%><%= Common.Utils.String.htmlEncode(folder || "") %><% } %></div>',"</div>"].join(""))}),this.viewRecentPicker.on("item:click",_.bind(this.onRecentFileClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onRecentFileClick:function(t,e,i){this.menu&&!Common.Controllers.Desktop.openRecent(i)&&this.menu.fireEvent("recent:open",[this.menu,i.get("url")])},txtOpenRecent:"Open Recent"},Common.Views.RecentFiles||{}))})),define("pdfeditor/main/app/view/FileMenu",["text!pdfeditor/main/app/template/FileMenu.template","underscore","common/main/lib/component/BaseView","common/main/lib/view/RecentFiles"],(function(t,e){"use strict";PDFE.Views.FileMenu=Common.UI.BaseView.extend(e.extend({el:"#file-menu-panel",rendered:!1,options:{alias:"FileMenu"},template:e.template(t),events:function(){return{"click .fm-btn":e.bind((function(t){var i=$(t.currentTarget);i.hasClass("active")||($(".fm-btn",this.el).removeClass("active"),i.addClass("active"));var n=e.findWhere(this.items,{el:t.currentTarget});if(n){var o=this.panels[n.options.action];if("help"===n.options.action&&!0===o.noHelpContents&&navigator.onLine){this.fireEvent("item:click",[this,"external-help",!0]);const t=Common.Utils.InternalSettings.get("url-help-center");return void(t&&window.open(t,"_blank"))}this.fireEvent("item:click",[this,n.options.action,!!o]),o&&(this.$el.find(".content-box:visible").hide(),this.active=n.options.action,o.show())}}),this)}},initialize:function(){this._state={infoPreviewMode:!1}},render:function(){var t=$(this.template());if(this.miClose=new Common.UI.MenuItem({el:t.elementById("#fm-btn-return"),action:"back",caption:this.btnCloseMenuCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSave=new Common.UI.MenuItem({el:t.elementById("#fm-btn-save"),action:"save",caption:this.btnSaveCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14],dataHintTitle:"S"}),this.options.miSave&&(this.miSave.setDisabled(this.options.miSave.isDisabled()),delete this.options.miSave),this.miEdit=new Common.UI.MenuItem({el:t.elementById("#fm-btn-edit"),action:"edit",caption:this.btnToEditCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miDownload=new Common.UI.MenuItem({el:t.elementById("#fm-btn-download"),action:"saveas",caption:this.btnDownloadCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSaveCopyAs=new Common.UI.MenuItem({el:t.elementById("#fm-btn-save-copy"),action:"save-copy",caption:this.btnSaveCopyAsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSaveAs=new Common.UI.MenuItem({el:t.elementById("#fm-btn-save-desktop"),action:"save-desktop",caption:this.btnSaveAsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miPrintWithPreview=new Common.UI.MenuItem({el:t.elementById("#fm-btn-print-with-preview"),action:"printpreview",caption:this.btnPrintCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14],dataHintTitle:"P"}),this.miPrint=new Common.UI.MenuItem({el:t.elementById("#fm-btn-print"),action:"print",caption:this.btnPrintCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14],dataHintTitle:"P"}),this.miRename=new Common.UI.MenuItem({el:t.elementById("#fm-btn-rename"),action:"rename",caption:this.btnRenameCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.options.miRename&&(this.miRename.setDisabled(this.options.miRename.isDisabled()),delete this.options.miRename),this.miProtect=new Common.UI.MenuItem({el:t.elementById("#fm-btn-protect"),action:"protect",caption:this.btnProtectCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.options.miProtect&&(this.miProtect.setDisabled(this.options.miProtect.isDisabled()),delete this.options.miProtect),this.miRecent=new Common.UI.MenuItem({el:t.elementById("#fm-btn-recent"),action:"recent",caption:this.btnRecentFilesCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miNew=new Common.UI.MenuItem({el:t.elementById("#fm-btn-create"),action:"new",caption:this.btnCreateNewCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miInfo=new Common.UI.MenuItem({el:t.elementById("#fm-btn-info"),action:"info",caption:this.btnInfoCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miAccess=new Common.UI.MenuItem({el:t.elementById("#fm-btn-rights"),action:"rights",caption:this.btnRightsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSettings=new Common.UI.MenuItem({el:t.elementById("#fm-btn-settings"),action:"opts",caption:this.btnSettingsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miHelp=new Common.UI.MenuItem({el:t.elementById("#fm-btn-help"),action:"help",caption:this.btnHelpCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miBack=new Common.UI.MenuItem({el:t.elementById("#fm-btn-back"),action:"exit",caption:this.btnBackCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.items=[],this.items.push(this.miClose,this.miSave,this.miEdit,this.miDownload,this.miSaveCopyAs,this.miSaveAs,this.miPrint,this.miPrintWithPreview,this.miRename,this.miProtect,this.miRecent,this.miNew,this.miInfo,this.miAccess,this.miSettings,this.miHelp,this.miBack),this.rendered=!0,this.$el.html(t),this.$el.find(".content-box").hide(),e.isUndefined(this.scroller)){var i=this;this.scroller=new Common.UI.Scroller({el:this.$el.find(".panel-menu"),suppressScrollX:!0,alwaysVisibleY:!0}),Common.NotificationCenter.on("window:resize",(function(){i.scroller.update()}))}return this.applyMode(),Common.Controllers.Desktop.isActive()&&Common.NotificationCenter.trigger("update:recents",Common.Controllers.Desktop.recentFiles()),this.api&&(this.panels.info.setApi(this.api),this.panels.opts&&this.panels.opts.setApi(this.api),this.panels.protect&&this.panels.protect.setApi(this.api)),this.fireEvent("render:after",[this]),this},show:function(t,e){if((!this.isVisible()||void 0!==t)&&this.mode){this.rendered||this.render();var i=!this.mode.canDownload||this.mode.isDesktopApp&&this.mode.isOffline?"info":"saveas";t||(t=this.active||i),this.$el.show(),this.scroller.update(),this.selectMenu(t,e,i),this.api&&this.api.asc_enableKeyEvents(!1),this.fireEvent("menu:show",[this])}},hide:function(){this.$el.hide(),this.fireEvent("menu:hide",[this])},applyMode:function(){if(this.rendered&&(this.panels||(this.panels={opts:new PDFE.Views.FileMenuPanels.Settings({menu:this}).render(this.$el.find("#panel-settings")),info:new PDFE.Views.FileMenuPanels.DocumentInfo({menu:this}).render(this.$el.find("#panel-info")),rights:new PDFE.Views.FileMenuPanels.DocumentRights({menu:this}).render(this.$el.find("#panel-rights"))},this._state.infoPreviewMode&&this.panels.info.setPreviewMode(this._state.infoPreviewMode)),this.mode)){var t,e=!1,i=Common.UI.LayoutManager.isElementVisible("toolbar-file-close");this.miClose[i?"show":"hide"](),this.miClose.$el.find("+.devider")[i?"show":"hide"](),i&&(t=this.miClose.$el.find("+.devider")),this.miDownload[!this.mode.canDownload&&!this.mode.canDownloadOrigin||this.mode.isDesktopApp&&this.mode.isOffline?"hide":"show"]();var n=!!Common.Controllers.Desktop.isActive()&&Common.Controllers.Desktop.call("isBlockchainSupport");if(this.miSaveCopyAs[!this.mode.canDownload&&!this.mode.canDownloadOrigin||this.mode.isDesktopApp&&this.mode.isOffline||!this.mode.canRequestSaveAs&&!this.mode.saveAsUrl||n?"hide":"show"](),this.miSaveAs[(this.mode.canDownload||this.mode.canDownloadOrigin)&&this.mode.isDesktopApp&&this.mode.isOffline?"show":"hide"](),this.miSave[this.mode.isEdit&&Common.UI.LayoutManager.isElementVisible("toolbar-file-save")?"show":"hide"](),this.miEdit[!this.mode.isEdit&&this.mode.canEdit&&this.mode.canRequestEditRights?"show":"hide"](),this.miPrint[this.mode.canPrint&&!this.mode.canPreviewPrint?"show":"hide"](),this.miPrintWithPreview[this.mode.canPreviewPrint?"show":"hide"](),this.miRename[this.mode.canRename&&!this.mode.isDesktopApp?"show":"hide"](),this.miProtect[this.mode.isSignatureSupport||this.mode.isPasswordSupport?"show":"hide"](),e=(this.mode.canDownload||this.mode.canDownloadOrigin||this.mode.isEdit&&Common.UI.LayoutManager.isElementVisible("toolbar-file-save")||this.mode.canPrint||this.mode.isSignatureSupport||this.mode.isPasswordSupport||!this.mode.isEdit&&this.mode.canEdit&&this.mode.canRequestEditRights||this.mode.canRename&&!this.mode.isDesktopApp)&&!this.mode.isDisconnected,this.miProtect.$el.find("+.devider")[e?"show":"hide"](),e&&(t=this.miProtect.$el.find("+.devider")),this.miRecent[this.mode.canOpenRecent?"show":"hide"](),this.miNew[this.mode.canCreateNew?"show":"hide"](),e=this.mode.canCreateNew,this.miNew.$el.find("+.devider")[e?"show":"hide"](),e&&(t=this.miNew.$el.find("+.devider")),e=i=Common.UI.LayoutManager.isElementVisible("toolbar-file-info"),this.miInfo[i?"show":"hide"](),i=!this.mode.isOffline&&this.document&&this.document.info&&(this.document.info.sharingSettings&&this.document.info.sharingSettings.length>0||this.mode.sharingSettingsUrl&&this.mode.sharingSettingsUrl.length||this.mode.canRequestSharingSettings),e=e||i,this.miAccess[i?"show":"hide"](),i=Common.UI.LayoutManager.isElementVisible("toolbar-file-settings"),this.miSettings[i?"show":"hide"](),this.miSettings.$el.find("+.devider")[i?"show":"hide"](),i&&(t=this.miSettings.$el.find("+.devider")),i=this.mode.canHelp,this.miHelp[i?"show":"hide"](),this.miHelp.$el.find("+.devider")[i?"show":"hide"](),i&&(t=this.miHelp.$el.find("+.devider")),i=this.mode.canBack,this.miBack[i?"show":"hide"](),t&&!i&&t.hide(),this.customizationDone||(this.customizationDone=!0,Common.Utils.applyCustomization(this.mode.customization,{goback:"#fm-btn-back > a"})),this.panels.opts.setMode(this.mode),this.panels.info.setMode(this.mode),!this.mode.isDisconnected&&this.panels.info.updateInfo(this.document),this.panels.rights.setMode(this.mode),!this.mode.isDisconnected&&this.panels.rights.updateInfo(this.document),this.mode.canCreateNew&&this.mode.templates&&this.mode.templates.length&&!this.panels.new&&(this.panels.new=new PDFE.Views.FileMenuPanels.CreateNew({menu:this,docs:this.mode.templates,blank:this.mode.canRequestCreateNew||!!this.mode.createUrl}).render()),this.mode.canOpenRecent&&this.mode.recent&&!this.panels.recent&&(this.panels.recent=new Common.Views.RecentFiles({el:"#panel-recentfiles",menu:this,recent:this.mode.recent}).render()),this.mode.canDownload?!this.panels.saveas&&(this.panels.saveas=new PDFE.Views.FileMenuPanels.ViewSaveAs({menu:this,fileType:this.document.fileType,mode:this.mode}).render()):this.mode.canDownloadOrigin&&$("a",this.miDownload.$el).text(this.textDownload),this.mode.canDownload&&(this.mode.canRequestSaveAs||this.mode.saveAsUrl)&&!this.panels["save-copy"]&&(this.panels["save-copy"]=new PDFE.Views.FileMenuPanels.ViewSaveCopy({menu:this,fileType:this.document.fileType,mode:this.mode}).render()),this.mode.canHelp&&!this.panels.help&&(this.panels.help=new PDFE.Views.FileMenuPanels.Help({menu:this}).render(),this.panels.help.setLangConfig(this.mode.lang)),this.mode.canPreviewPrint){var o=PDFE.getController("Print").getView("PrintWithPreview");o.menu=this,!this.panels.printpreview&&(this.panels.printpreview=o.render(this.$el.find("#panel-print")))}Common.Controllers.Desktop.isActive()&&($('<li id="fm-btn-local-open" class="fm-btn"/>').insertAfter($("#fm-btn-recent",this.$el)),this.items.push(new Common.UI.MenuItem({el:$("#fm-btn-local-open",this.$el),action:"file:open",caption:this.btnFileOpenCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]})),$('<li class="devider" /><li id="fm-btn-exit" class="fm-btn"/>').insertAfter($("#fm-btn-back",this.$el)),this.items.push(new Common.UI.MenuItem({el:$("#fm-btn-exit",this.$el),action:"file:exit",caption:this.btnExitCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]})))}},setMode:function(t,e){return t.isDisconnected?(this.mode.canEdit=this.mode.isEdit=!1,this.mode.canOpenRecent=this.mode.canCreateNew=!1,this.mode.isDisconnected=t.isDisconnected,this.mode.canRename=!1,t.enableDownload||(this.mode.canPrint=this.mode.canDownload=this.mode.canDownloadOrigin=!1)):this.mode=t,e||this.applyMode(),this},setApi:function(t){return this.api=t,this.rendered&&(this.panels.info.setApi(t),this.panels.opts&&this.panels.opts.setApi(t),this.panels.protect&&this.panels.protect.setApi(t)),this},loadDocument:function(t){this.document=t.doc},selectMenu:function(t,e,i){if(t){var n=this._getMenuItem(t),o=this.panels[t];if(!n.isDisabled()&&n.isVisible()||(n=this._getMenuItem(i),o=this.panels[i]),n&&o){if($(".fm-btn",this.el).removeClass("active"),n.$el.addClass("active"),this.$el.find(".content-box:visible").hide(),o.show(e),this.scroller){var s=n.$el.position().top,a=n.$el.outerHeight(),r=this.$el.outerHeight();if(s<0||s+a>r){var l=this.scroller.$el.scrollTop()+s+(a-r)/2;l=Math.floor(l/a)*a,this.scroller.scrollTop(l)}}this.active=t}}},_getMenuItem:function(t){return e.find(this.items,(function(e){return e.options.action==t}))},SetDisabled:function(t,e){var i=this.getButton("protect");e&&e.protect&&i.setDisabled(t),e&&e.info&&(this.panels?this.panels.info.setPreviewMode(t):this._state.infoPreviewMode=t)},isVisible:function(){return!this.$el.is(":hidden")},getButton:function(t){if(this.rendered){if("save"==t)return this.miSave;if("rename"==t)return this.miRename;if("protect"==t)return this.miProtect}else{if("save"==t)return this.options.miSave?this.options.miSave:this.options.miSave=new Common.UI.MenuItem({});if("rename"==t)return this.options.miRename?this.options.miRename:this.options.miRename=new Common.UI.MenuItem({});if("protect"==t)return this.options.miProtect?this.options.miProtect:this.options.miProtect=new Common.UI.MenuItem({})}},btnSaveCaption:"Save",btnDownloadCaption:"Download as...",btnInfoCaption:"Document Info...",btnRightsCaption:"Access Rights...",btnCreateNewCaption:"Create New",btnRecentFilesCaption:"Open Recent...",btnPrintCaption:"Print",btnHelpCaption:"Help...",btnReturnCaption:"Back to Document",btnToEditCaption:"Edit Document",btnBackCaption:"Go to Documents",btnSettingsCaption:"Advanced Settings...",btnSaveAsCaption:"Save as",textDownload:"Download",btnRenameCaption:"Rename...",btnCloseMenuCaption:"Close Menu",btnProtectCaption:"Protect",btnSaveCopyAsCaption:"Save Copy as...",btnExitCaption:"Exit",btnFileOpenCaption:"Open..."},PDFE.Views.FileMenu||{}))})),void 0===Common)var Common={};function onDropDownKeyDown(t){var e=$(this),i=e.parent(),n=jQuery.Event("keydown.before.bs.dropdown",{keyCode:t.keyCode}),o=jQuery.Event("keydown.after.bs.dropdown",{keyCode:t.keyCode});i.trigger(n),i.hasClass("no-stop-propagate")?(arguments.length>1&&arguments[1]instanceof KeyboardEvent&&(t=arguments[1]),!/^(38|40|27|13|9|37|39)$/.test(t.keyCode)||t.ctrlKey||t.altKey||(patchDropDownKeyDownAdditional.call(this,t),/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()))):e.hasClass("move-focus")?(!/^(13|9|32)/.test(t.keyCode)&&(27!==t.keyCode||i.hasClass("open"))||t.ctrlKey||t.altKey)&&(patchDropDownKeyDown.call(this,t),t.preventDefault(),t.stopPropagation()):(patchDropDownKeyDown.call(this,t),t.preventDefault(),t.stopPropagation()),i.trigger(o)}function checkFocusedItem(t,e){var i=t.innerHeight(),n=(i-t.height())/2,o=e.position().top,s=e.outerHeight();o<0?t.scrollTop(t.scrollTop()+o-n):o+s>i&&t.scrollTop(t.scrollTop()+o+s-i+n)}function patchDropDownKeyDown(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=getParent(e),n=i.hasClass("open")||i.hasClass("over");if(!n||n&&27==t.keyCode){if(27==t.which){if((o=$("[role=menu] li.dropdown-submenu.over:visible",i)).length)return o.eq(o.length-1).removeClass("over"),!1;i.hasClass("dropdown-submenu")&&i.hasClass("over")?(i.removeClass("over"),i.find("> a").focus()):i.find("[data-toggle=dropdown]").focus()}return n?e.click():void 0}var o=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");if(o.length){var s=o.index(o.filter(":focus"));if(39==t.keyCode){if(s<0)return;var a=o.eq(s).parent();a.hasClass("dropdown-submenu")&&!a.hasClass("over")&&(a.mouseenter(),a.addClass("focused-submenu"),_.delay((function(){var t=$("> [role=menu]",a),e=t.find("> li:not(.divider):not(.disabled):visible > a"),i=t.find("> li:not(.divider):not(.disabled):visible .dataview"),n=t.find("> li:not(.divider):not(.disabled):visible .theme-colorpalette.focused"),o=t.find("> li:not(.divider):not(.disabled):visible ul.internal-menu");e.length>0&&i.length<1&&o.length<1&&n.length<1&&e.index(e.filter(":focus"))<0&&e.eq(0).focus()}),250))}else 37==t.keyCode?i.hasClass("dropdown-submenu")&&i.hasClass("over")&&(i.removeClass("over"),i.find("> a").focus()):(38==t.keyCode?s>0?s--:s=e.hasClass("no-cyclic")?0:o.length-1:40==t.keyCode&&(s<o.length-1?s++:s=e.hasClass("no-cyclic")?o.length-1:0),~s||(s=0),i.hasClass("dropdown-submenu")&&i.hasClass("over")&&i.addClass("focused-submenu"),checkFocusedItem(e,o.eq(s)),o.eq(s).focus())}}}}function patchDropDownKeyDownAdditional(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()),!e.is(".disabled, :disabled")){var i=getParent(e),n=i.hasClass("open")||i.hasClass("over");if(!n||n&&(27==t.keyCode||37==t.keyCode||39==t.keyCode))return n?e.click():void 0;var o=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");if(o.length){var s=o.index(o.filter(".focus")),a=s;if(38==t.keyCode?s>0?s--:s=e.hasClass("no-cyclic")?0:o.length-1:40==t.keyCode&&(s<o.length-1?s++:s=e.hasClass("no-cyclic")?o.length-1:0),~s||(s=0),o.removeClass("focus"),o.eq(s).addClass("focus"),a!==s){var r=o.eq(a).parent().data("bs.tooltip");r&&r.hide(),(r=o.eq(s).parent().data("bs.tooltip"))&&r.show()}}}}}function getParent(t){var e=t.attr("data-target");e||(e=(e=t.attr("href"))&&/#/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var i=e&&$(e);return i&&i.length?i:t.parent()}function clearMenus(t){$(".dropdown-toggle").each((function(e){var i=$(this).parent();i.hasClass("open")&&("prevent-canvas-click"!=i.attr("data-value")?(i.trigger(e=$.Event("hide.bs.dropdown")),e.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown",t)):i.attr("data-value",""))}))}function toggle(){$(".dropdown-backdrop").remove()}if(define("common/main/lib/component/TreeView",["common/main/lib/component/DataView"],(function(){"use strict";Common.UI.TreeViewModel=Common.UI.DataViewModel.extend({defaults:function(){return{id:Common.UI.getId(),name:"",isNotHeader:!1,hasSubItems:!1,hasParent:!1,isEmptyItem:!1,isExpanded:!0,isVisible:!0,selected:!1,allowSelected:!0,disabled:!1,level:0,index:0}}}),Common.UI.TreeViewStore=Backbone.Collection.extend({model:Common.UI.TreeViewModel,expandSubItems:function(t){var e=this,i=function(t,n,o){for(var s=t+1;s<e.length;s++){var a=e.at(s),r=a.get("level");if(!(r>o))return s-1;n&&a.set("isVisible",!0),a.get("hasSubItems")&&(s=i(s,a.get("isExpanded"),r))}};t.set("isExpanded",!0),i(t.get("index"),!0,t.get("level"))},collapseSubItems:function(t){for(var e=t.get("level"),i=t.get("index")+1;i<this.length;i++){var n=this.at(i);if(!(n.get("level")>e))break;n.set("isVisible",!1)}return i-1},expandAll:function(){this.each((function(t){t.set("isExpanded",!0),t.set("isVisible",!0)}))},collapseAll:function(){for(var t=0;t<this.length;t++){var e=this.at(t);e.get("isNotHeader")||(e.set("isExpanded",!1),t=this.collapseSubItems(e))}},expandToLevel:function(t){for(var e=this,i=function(n,o){var s=e.at(n);s.set("isExpanded",!1);for(var a=n+1;a<e.length;a++){var r=e.at(a),l=r.get("level");if(!(l>o))return a-1;l<=t&&s.set("isExpanded",!0),r.set("isVisible",l<=t),r.get("hasSubItems")&&(a=i(a,l))}},n=0;n<this.length;n++){var o=this.at(n);(o.get("level")<=t||!o.get("hasParent"))&&(o.set("isVisible",!0),o.get("isNotHeader")||(n=i(n,o.get("level"))))}}}),Common.UI.TreeView=Common.UI.DataView.extend({options:{handleSelect:!0,showLast:!0,allowScrollbar:!0,scrollAlwaysVisible:!0,emptyItemText:"",keyMoveDirection:"both"},template:_.template(['<div class="treeview inner" style="<%= style %>"></div>'].join("")),initialize:function(t){t.store=t.store||new Common.UI.TreeViewStore,t.emptyItemText=t.emptyItemText||"",t.itemTemplate=t.itemTemplate||(Common.UI.isRTL()?_.template(['<div id="<%= id %>" class="tree-item <% if (!isVisible) { %>hidden<% } %>" style="display: block;padding-right: <%= level*16 + 24 %>px;">',"<% if (hasSubItems) { %>",'<div class="tree-caret img-commonctrl <% if (!isExpanded) { %>up<% } %>" style="margin-right: <%= level*16 %>px;"></div>',"<% } %>","<% if (isNotHeader) { %>",'<div class="name not-header"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } else if (isEmptyItem) { %>",'<div class="name empty">'+t.emptyItemText+"</div>","<% } else { %>",'<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } %>","</div>"].join("")):_.template(['<div id="<%= id %>" class="tree-item <% if (!isVisible) { %>hidden<% } %>" style="display: block;padding-left: <%= level*16 + 24 %>px;">',"<% if (hasSubItems) { %>",'<div class="tree-caret img-commonctrl <% if (!isExpanded) { %>up<% } %>" style="margin-left: <%= level*16 %>px;"></div>',"<% } %>","<% if (isNotHeader) { %>",'<div class="name not-header"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } else if (isEmptyItem) { %>",'<div class="name empty">'+t.emptyItemText+"</div>","<% } else { %>",'<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } %>","</div>"].join(""))),Common.UI.DataView.prototype.initialize.call(this,t)},onAddItem:function(t,e,i){var n=new Common.UI.DataViewItem({template:this.itemTemplate,model:t});if(n){var o=(this.$el||$(this.el)).find(".inner").addBack().filter(".inner");if(o){if(this.dataViewItems.length<1&&o.find(".empty-text").remove(),i&&"number"==typeof i.at){var s=i.at,a=o.find("> div");s>0?$(a.get(s-1)).after(n.render().el):a.length>0?$(a[s]).before(n.render().el):o.append(n.render().el),this.dataViewItems=this.dataViewItems.slice(0,s).concat(n).concat(this.dataViewItems.slice(s))}else o.append(n.render().el),this.dataViewItems.push(n);this.updateTip(n),this.listenTo(n,"change",this.onChangeItem),this.listenTo(n,"remove",this.onRemoveItem),this.listenTo(n,"click",this.onClickItem),this.listenTo(n,"dblclick",this.onDblClickItem),this.listenTo(n,"select",this.onSelectItem),this.listenTo(n,"contextmenu",this.onContextMenuItem),this.isSuspendEvents||this.trigger("item:add",this,n,t)}}},onClickItem:function(t,e,i){var n=$(i.target);if(n&&(n.hasClass("tree-caret")||n.hasClass("btn-tree-caret"))){var o=t.$el.data("bs.tooltip");o&&o.tip().remove();var s=!e.get("isExpanded");e.set("isExpanded",s),this.store[s?"expandSubItems":"collapseSubItems"](e),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})}else Common.UI.DataView.prototype.onClickItem.call(this,t,e,i)},expandAll:function(){this.store.expandAll(),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},collapseAll:function(){this.store.collapseAll(),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},expandToLevel:function(t){this.store.expandToLevel(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},expandRecord:function(t){t&&(t.set("isExpanded",!0),this.store.expandSubItems(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible}))},collapseRecord:function(t){t&&(t.set("isExpanded",!1),this.store.collapseSubItems(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible}))},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),_.indexOf(this.moveKeys,e.keyCode)>-1||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.getSelectedRec();if(null===this.lastSelectedRec&&(this.lastSelectedRec=i),e.keyCode==Common.UI.Keys.RETURN)this.lastSelectedRec=null,this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.trigger("item:click",this,this,i,t),this.trigger("item:select",this,this,i,t),this.trigger("entervalue",this,i,t),this.parentMenu&&this.parentMenu.hide();else{var n=_.indexOf(this.store.models,i);if(n<0)if(e.keyCode==Common.UI.Keys.LEFT){var o=$(t.target).closest(".dropdown-submenu.over");o.length>0?(o.removeClass("over"),o.find("> a").focus()):n=0}else n=0;else if("both"==this.options.keyMoveDirection){var s=i.get("hasSubItems"),a=(i.get("hasParent"),i.get("isExpanded"));if(e.keyCode==Common.UI.Keys.LEFT)s&&a&&this.collapseRecord(i);else if(e.keyCode==Common.UI.Keys.RIGHT)s&&!a&&this.expandRecord(i);else if(e.keyCode==Common.UI.Keys.DOWN){for(var r=n+1;r<this.store.length;r++)if(this.store.at(r).get("isVisible")){n=r;break}}else if(e.keyCode==Common.UI.Keys.UP)for(r=n-1;r>=0;r--)if(this.store.at(r).get("isVisible")){n=r;break}}else n=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,n-1):Math.min(this.store.length-1,n+1);void 0!==n&&n>=0&&(i=this.store.at(n)),i&&(this._fromKeyDown=!0,this.selectRecord(i),this._fromKeyDown=!1,this.scrollToRecord(i))}}else this.trigger("item:keydown",this,i,t)},focus:function(){this.cmpEl&&this.cmpEl.find(".treeview").focus()},updateTip:function(t){var e=t.model,i=e.get("name"),n=this;i.length>37-2*e.get("level")?e.set("tip",i):e.set("tip","");var o=t.$el||$(t.el),s=o.data("bs.tooltip");s&&(void 0===s.dontShow&&(s.dontShow=!0),o.removeData("bs.tooltip"),s.tip().remove()),e.get("tip")&&(o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:this.tipZIndex}),this.delayRenderTips?o.one("mouseenter",(function(){o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:n.tipZIndex}),o.mouseenter()})):(o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:n.tipZIndex})))}})})),define("pdfeditor/main/app/view/Navigation",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/TreeView"],(function(t){"use strict";PDFE.Views.Navigation=Common.UI.BaseView.extend(_.extend({el:"#left-panel-navigation",storeNavigation:void 0,template:_.template(['<div id="navigation-box" class="layout-ct vbox">','<div id="navigation-header" className="">',"<label><%= scope.strNavigate%></label>",'<div id="navigation-btn-close" class="float-right margin-left-4"></div>','<div id="navigation-btn-settings" class="float-right"></div>',"</div>",'<div id="navigation-list" class="">',"</div>","</div>"].join("")),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){t=t||this.el,$(t).html(this.template({scope:this}));var e=Common.localStorage.getBool("de-outline-wrap",!0),i=Common.localStorage.getItem("de-outline-fontsize");return i||(i="medium"),this.$el=$(t),this.btnClose=new Common.UI.Button({parentEl:$("#navigation-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.txtClosePanel}),this.btnSettings=new Common.UI.Button({parentEl:$("#navigation-btn-settings",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",hint:this.txtSettings,menu:new Common.UI.Menu({menuAlign:"tr-br",style:"min-width: auto;",cls:"shifted-right",items:[{caption:this.txtExpand,value:"expand",iconCls:"menu__icon btn-expand-all"},{caption:this.txtCollapse,value:"collapse",iconCls:"menu__icon btn-collapse-all"},{caption:this.txtExpandToLevel,value:"expand-level",menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[{caption:"1",value:1},{caption:"2",value:2},{caption:"3",value:3},{caption:"4",value:4},{caption:"5",value:5},{caption:"6",value:6},{caption:"7",value:7},{caption:"8",value:8},{caption:"9",value:9}]})},{caption:"--",visible:!0},{caption:this.txtFontSize,value:"font-size",menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[{caption:this.txtSmall,checkable:!0,value:"small",checked:"small"==i,toggleGroup:"fontsize"},{caption:this.txtMedium,checkable:!0,value:"medium",checked:"medium"==i,toggleGroup:"fontsize"},{caption:this.txtLarge,checkable:!0,checked:"large"==i,value:"large",toggleGroup:"fontsize"}]})},{caption:"--",visible:!0},{caption:this.txtWrapHeadings,checkable:!0,checked:e,value:"wrap"}]})}),this.btnSettingsMenu=this.btnSettings.menu,this.viewNavigationList=new Common.UI.TreeView({el:$("#navigation-list"),store:this.storeNavigation,enableKeyEvents:!0,emptyText:this.txtEmptyViewer,emptyItemText:this.txtEmptyItem,style:"border: none;",delayRenderTips:!0,minScrollbarLength:25}),this.viewNavigationList.cmpEl.off("click"),this.viewNavigationList.$el.addClass(i),e&&this.viewNavigationList.$el.addClass("wrap"),this.navigationMenu=new Common.UI.Menu({cls:"shifted-right",items:[{iconCls:"menu__icon btn-expand-all",caption:this.txtExpand,value:"expand"},{iconCls:"menu__icon btn-collapse-all",caption:this.txtCollapse,value:"collapse"},{caption:this.txtExpandToLevel,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: 60px;",items:[{caption:"1",value:1},{caption:"2",value:2},{caption:"3",value:3},{caption:"4",value:4},{caption:"5",value:5},{caption:"6",value:6},{caption:"7",value:7},{caption:"8",value:8},{caption:"9",value:9}]})}]}),this.trigger("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this)},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},changeWrapHeadings:function(){Common.localStorage.setBool("de-outline-wrap",this.btnSettingsMenu.items[6].checked),this.btnSettingsMenu.items[6].checked?this.viewNavigationList.$el.addClass("wrap"):this.viewNavigationList.$el.removeClass("wrap")},changeFontSize:function(t){Common.localStorage.setItem("de-outline-fontsize",t),this.viewNavigationList.$el.removeClass(),this.viewNavigationList.$el.addClass(t),this.changeWrapHeadings()},ChangeSettings:function(t){},txtExpand:"Expand all",txtCollapse:"Collapse all",txtExpandToLevel:"Expand to level...",txtEmptyItem:"Empty Heading",txtEmptyViewer:"There are no headings in the document.",strNavigate:"Headings",txtWrapHeadings:"Wrap long headings",txtFontSize:"Font size",txtSmall:"Small",txtMedium:"Medium",txtLarge:"Large",txtClosePanel:"Close headings",txtSettings:"Headings settings"},PDFE.Views.Navigation||{}))})),define("pdfeditor/main/app/view/LeftMenu",["text!pdfeditor/main/app/template/LeftMenu.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/view/About","common/main/lib/view/Comments","common/main/lib/view/Chat","common/main/lib/view/Plugins","common/main/lib/view/About","common/main/lib/view/SearchDialog","pdfeditor/main/app/view/FileMenu","pdfeditor/main/app/view/Navigation"],(function(t,e,i,n){"use strict";PDFE.Views.LeftMenu=n.View.extend(i.extend({el:"#left-menu",template:i.template(t),events:function(){return{"click #left-btn-support":function(){var t=this.mode.customization;t&&t.feedback&&t.feedback.url?window.open(t.feedback.url):window.open("https://support.onlyoffice.com")}}},initialize:function(){this.minimizedMode=!0,this._state={disabled:!1}},render:function(){var t=e(this.template({}));return this.btnSearchBar=new Common.UI.Button({action:"advancedsearch",el:t.elementById("#left-btn-searchbar"),hint:this.tipSearch,disabled:!0,iconCls:"btn-menu-search",enableToggle:!0,toggleGroup:"leftMenuGroup"}),this.btnSearchBar.on("click",this.onBtnMenuClick.bind(this)),this.btnAbout=new Common.UI.Button({action:"about",el:t.elementById("#left-btn-about"),hint:this.tipAbout,enableToggle:!0,disabled:!0,iconCls:"btn-menu-about",toggleGroup:"leftMenuGroup"}),this.btnAbout.on("toggle",this.onBtnMenuToggle.bind(this)),this.btnSupport=new Common.UI.Button({action:"support",el:t.elementById("#left-btn-support"),hint:this.tipSupport,iconCls:"btn-menu-support",disabled:!0}),this.btnComments=new Common.UI.Button({el:t.elementById("#left-btn-comments"),hint:this.tipComments+Common.Utils.String.platformKey("Ctrl+Shift+H"),enableToggle:!0,disabled:!0,iconCls:"btn-menu-comments",toggleGroup:"leftMenuGroup"}),this.btnComments.on("click",this.onBtnMenuClick.bind(this)),this.btnComments.on("toggle",this.onBtnCommentsToggle.bind(this)),this.btnChat=new Common.UI.Button({el:t.elementById("#left-btn-chat"),hint:this.tipChat+Common.Utils.String.platformKey("Alt+Q"," ("+(Common.Utils.isMac?Common.Utils.String.textCtrl+"+":"")+"{0})"),enableToggle:!0,disabled:!0,iconCls:"btn-menu-chat",toggleGroup:"leftMenuGroup"}),this.btnChat.on("click",this.onBtnMenuClick.bind(this)),this.btnComments.hide(),this.btnChat.hide(),this.btnPlugins=new Common.UI.Button({el:t.elementById("#left-btn-plugins"),hint:this.tipPlugins,enableToggle:!0,disabled:!0,iconCls:"btn-menu-plugin",toggleGroup:"leftMenuGroup"}),this.btnPlugins.hide(),this.btnPlugins.on("click",this.onBtnMenuClick.bind(this)),this.btnNavigation=new Common.UI.Button({el:t.elementById("#left-btn-navigation"),hint:this.tipOutline,enableToggle:!0,disabled:!0,iconCls:"btn-menu-navigation",toggleGroup:"leftMenuGroup"}),this.btnNavigation.on("click",this.onBtnMenuClick.bind(this)),this.menuFile=new PDFE.Views.FileMenu,this.btnAbout.panel=new Common.Views.About({el:"#about-menu-panel",appName:this.txtEditor}),this.btnThumbnails=new Common.UI.Button({el:t.elementById("#left-btn-thumbnails"),hint:this.tipPageThumbnails,enableToggle:!0,disabled:!0,iconCls:"btn-menu-thumbs",toggleGroup:"leftMenuGroup"}),this.btnThumbnails.hide(),this.btnThumbnails.on("click",this.onBtnMenuClick.bind(this)),this.$el.html(t),this},onBtnMenuToggle:function(t,e){e?(t.panel.show(),this._state.pluginIsRunning||this.$el.width(40)):t.panel.hide(),PDFE.getController("Toolbar").DisableToolbar(1==e),this.supressEvents||Common.NotificationCenter.trigger("layout:changed","leftmenu")},onBtnCommentsToggle:function(t,e){e||this.fireEvent("comments:hide",this)},onBtnMenuClick:function(t,e){if(this.supressEvents=!0,this.btnAbout.toggle(!1),t.pressed)this.$el.width()>40||this.$el.width(parseInt(Common.localStorage.getItem("pdfe-mainmenu-width"))||300);else if(!this._state.pluginIsRunning){var i=this.$el.width();this.isVisible()&&i>40&&Common.localStorage.setItem("pdfe-mainmenu-width",i),this.$el.width(40)}this.supressEvents=!1,this.onCoauthOptions(),t.pressed&&"advancedsearch"==t.options.action&&this.fireEvent("search:aftershow",this),Common.NotificationCenter.trigger("layout:changed","leftmenu")},onCoauthOptions:function(t){this.mode.canCoAuthoring&&(this.mode.canViewComments&&(this.btnComments.pressed&&this.btnComments.$el.hasClass("notify")&&this.btnComments.$el.removeClass("notify"),this.panelComments[this.btnComments.pressed?"show":"hide"](),this.fireEvent(this.btnComments.pressed?"comments:show":"comments:hide",this)),this.mode.canChat&&(this.btnChat.pressed?(this.btnChat.$el.hasClass("notify")&&this.btnChat.$el.removeClass("notify"),this.panelChat.show(),this.panelChat.focus()):this.panelChat.hide())),this.panelNavigation&&(this.btnNavigation.pressed?this.panelNavigation.show():this.panelNavigation.hide()),this.panelThumbnails&&(this.btnThumbnails.pressed?this.panelThumbnails.show():this.panelThumbnails.hide()),this.panelSearch&&(this.btnSearchBar.pressed?(this.panelSearch.show(),this.panelSearch.focus()):this.panelSearch.hide())},setOptionsPanel:function(t,e){"chat"==t?this.panelChat=e.render("#left-panel-chat"):"comment"==t?this.panelComments=e:"plugins"!=t||this.panelPlugins?"navigation"!=t||this.panelNavigation?"thumbnails"==t?this.panelThumbnails=e.render("#left-panel-thumbnails"):"advancedsearch"==t&&(this.panelSearch=e.render("#left-panel-search")):this.panelNavigation=e.render("#left-panel-navigation"):this.panelPlugins=e.render()},markCoauthOptions:function(t,e){"chat"!=t||!this.btnChat.isVisible()||this.btnChat.isDisabled()||this.btnChat.pressed||this.btnChat.$el.addClass("notify"),"comments"!=t||!this.btnComments.isVisible()||this.btnComments.pressed||this.btnComments.isDisabled()&&!e||this.btnComments.$el.addClass("notify")},close:function(t){this.menuFile.isVisible()?this.menuFile.hide():(this.btnAbout.toggle(!1),this._state.pluginIsRunning||this.$el.width(40),this.mode.canCoAuthoring&&(this.mode.canViewComments&&(this.panelComments.hide(),this.btnComments.pressed&&this.fireEvent("comments:hide",this),this.btnComments.toggle(!1,!0)),this.mode.canChat&&(this.panelChat.hide(),this.btnChat.toggle(!1))),this.mode.canPlugins&&this.panelPlugins&&!this._state.pluginIsRunning&&(this.panelPlugins.hide(),this.btnPlugins.toggle(!1,!0)),this.panelNavigation&&(this.panelNavigation.hide(),this.btnNavigation.toggle(!1)),this.panelSearch&&(this.panelSearch.hide(),this.btnSearchBar.toggle(!1,!0)),this.panelThumbnails&&(this.panelThumbnails.hide(),this.btnThumbnails.toggle(!1,!0)))},isOpened:function(){var t=this.btnSearchBar.pressed;return!t&&(t=this.btnComments.pressed||this.btnChat.pressed),t},disableMenu:function(t,e){this.btnSearchBar.setDisabled(!1),this.btnAbout.setDisabled(!1),this.btnSupport.setDisabled(!1),this.btnComments.setDisabled(!1),this.btnChat.setDisabled(!1),this.btnPlugins.setDisabled(!1),this.btnNavigation.setDisabled(!1),this.btnThumbnails.setDisabled(!1)},showMenu:function(t,e,i){var n=/^(\w+):?(\w*)$/.exec(t);"file"==n[1]?(this.menuFile.isVisible(),this.menuFile.show(n[2].length?n[2]:void 0,e)):"chat"==t?!this.btnChat.isVisible()||this.btnChat.isDisabled()||this.btnChat.pressed||(this.btnChat.toggle(!0),this.onBtnMenuClick(this.btnChat),this.panelChat.focus()):"comments"==t?!this.btnComments.isVisible()||this.btnComments.isDisabled()||this.btnComments.pressed||(this.btnComments.toggle(!0),this.onBtnMenuClick(this.btnComments)):"navigation"==t?!this.btnNavigation.isVisible()||this.btnNavigation.isDisabled()||this.btnNavigation.pressed||(this.btnNavigation.toggle(!0),this.onBtnMenuClick(this.btnNavigation)):"advancedsearch"==t&&(!this.btnSearchBar.isVisible()||this.btnSearchBar.isDisabled()||this.btnSearchBar.pressed||(this.btnSearchBar.toggle(!0),this.onBtnMenuClick(this.btnSearchBar),this.panelSearch.focus(),!i&&this.fireEvent("search:aftershow",this)))},getMenu:function(t){switch(t){default:return null;case"file":return this.menuFile;case"about":return this.btnAbout.panel}},setMode:function(t){return this.mode=t,this.btnAbout.panel.setMode(t),t.canUseThumbnails&&this.btnThumbnails.show(),this},setDeveloperMode:function(t,n,o){if(this.$el.is(":visible")){if((t&Asc.c_oLicenseMode.Trial||t&Asc.c_oLicenseMode.Developer)&&!this.developerHint){var s="";t&Asc.c_oLicenseMode.Trial&&t&Asc.c_oLicenseMode.Developer?s=this.txtTrialDev:0!=(t&Asc.c_oLicenseMode.Trial)?s=this.txtTrial:0!=(t&Asc.c_oLicenseMode.Developer)&&(s=this.txtDeveloper),s=s.toUpperCase(),this.developerHint=e('<div id="developer-hint">'+s+"</div>").appendTo(this.$el),this.devHeight=this.developerHint.outerHeight(),!this.devHintInited&&e(window).on("resize",i.bind(this.onWindowResize,this)),this.devHintInited=!0}if(this.developerHint&&this.developerHint.toggleClass("hidden",!(t&Asc.c_oLicenseMode.Trial||t&Asc.c_oLicenseMode.Developer)),n&&!this.betaHint){var a=t?'style="margin-top: 4px;"':"",r=(o||"").split("."),l="";r.length>0&&(l+="v. "+r[0]),r.length>1&&(l+="."+r[1]),this.betaHint=e('<div id="beta-hint"'+a+">"+l+" (beta)</div>").appendTo(this.$el),this.betaHeight=this.betaHint.outerHeight(),!this.devHintInited&&e(window).on("resize",i.bind(this.onWindowResize,this)),this.devHintInited=!0}this.betaHint&&this.betaHint.toggleClass("hidden",!n);var c=this.$el.find("button.btn-category:visible"),d=c.length>0?e(c[c.length-1]):null;this.minDevPosition=d?d.offset().top-d.offsetParent().offset().top+d.height()+20:20,this.onWindowResize()}},setLimitMode:function(){if(this.$el.is(":visible")){if(!this.limitHint){var t=this.txtLimit.toUpperCase();this.limitHint=e('<div id="limit-hint" style="margin-top: 4px;">'+t+"</div>").appendTo(this.$el),this.limitHeight=this.limitHint.outerHeight(),!this.devHintInited&&e(window).on("resize",i.bind(this.onWindowResize,this)),this.devHintInited=!0}this.limitHint&&this.limitHint.toggleClass("hidden",!1);var n=this.$el.find("button.btn-category:visible"),o=n.length>0?e(n[n.length-1]):null;this.minDevPosition=o?o.offset().top-o.offsetParent().offset().top+o.height()+20:20,this.onWindowResize()}},onWindowResize:function(){var t=(this.devHeight||0)+(this.betaHeight||0)+(this.limitHeight||0),e=Math.max((this.$el.height()-t)/2,this.minDevPosition);this.developerHint&&(this.developerHint.css("top",e),e+=this.devHeight),this.betaHint&&(this.betaHint.css("top",e),e+=this.betaHeight+4),this.limitHint&&this.limitHint.css("top",e)},isVisible:function(){return this.$el&&this.$el.is(":visible")},tipComments:"Comments",tipChat:"Chat",tipAbout:"About",tipSupport:"Feedback & Support",tipSearch:"Search",tipPlugins:"Plugins",tipPageThumbnails:"Page Thumbnails",txtDeveloper:"DEVELOPER MODE",txtTrial:"TRIAL MODE",txtTrialDev:"Trial Developer Mode",tipNavigation:"Navigation",tipOutline:"Headings",txtLimit:"Limit Access",txtEditor:"PDF Editor"},PDFE.Views.LeftMenu||{}))})),define("pdfeditor/main/app/controller/Viewport",["core","common/main/lib/view/Header","common/main/lib/view/SearchBar","pdfeditor/main/app/view/Viewport","pdfeditor/main/app/view/LeftMenu"],(function(t){"use strict";PDFE.Controllers.Viewport=Backbone.Controller.extend(_.assign({models:[],collections:[],views:["Viewport","Common.Views.Header"],initialize:function(){var t=this;this.addListeners({FileMenu:{"menu:hide":t.onFileMenu.bind(t,"hide"),"menu:show":t.onFileMenu.bind(t,"show"),"settings:apply":t.applySettings.bind(t)},Toolbar:{"render:before":function(e){var i=PDFE.getController("Main").appOptions;e.setExtra("right",t.header.getPanel("right",i)),(!i.isEdit||i.customization&&i.customization.compactHeader)&&e.setExtra("left",t.header.getPanel("left",i));var n=Common.localStorage.getBool("pdfe-settings-quick-print-button",!0);Common.Utils.InternalSettings.set("pdfe-settings-quick-print-button",n),t.header&&t.header.btnPrintQuick&&t.header.btnPrintQuick[n?"show":"hide"]()},"view:compact":function(e,i){t.viewport.vlayout.getItem("toolbar").height=i?Common.Utils.InternalSettings.get("toolbar-height-compact"):Common.Utils.InternalSettings.get("toolbar-height-normal")},"undo:disabled":function(e){t.header.btnUndo&&(t.header.btnUndo.keepState?t.header.btnUndo.keepState.disabled=e:t.header.btnUndo.setDisabled(e))},"redo:disabled":function(e){t.header.btnRedo&&(t.header.btnRedo.keepState?t.header.btnRedo.keepState.disabled=e:t.header.btnRedo.setDisabled(e))},"print:disabled":function(e){t.header.btnPrint&&t.header.btnPrint.setDisabled(e),t.header.btnPrintQuick&&t.header.btnPrintQuick.setDisabled(e)},"save:disabled":function(e){t.header.btnSave&&t.header.btnSave.setDisabled(e)}}})},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",this.onApiCoAuthoringDisconnect.bind(this)),Common.NotificationCenter.on("api:disconnect",this.onApiCoAuthoringDisconnect.bind(this))},getApi:function(){return this.api},onLaunch:function(){this.viewport=this.createView("Viewport").render(),this.api=new Asc.PDFEditorApi({"id-view":"editor_sdk",translate:this.getApplication().getController("Main").translationTable}),this.header=this.createView("Common.Views.Header",{headerCaption:"Document Editor",storeUsers:PDFE.getCollection("Common.Collections.Users")}),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this)),$(window).on("resize",_.bind(this.onWindowResize,this));var t=$("#left-menu");this.viewport.hlayout.on("layout:resizedrag",(function(){this.api.Resize(),Common.localStorage.setItem("pdfe-mainmenu-width",t.width())}),this),this.boxSdk=$("#editor_sdk"),this.boxSdk.css("border-left","none"),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("search:show",_.bind(this.onSearchShow,this))},onAppShowed:function(t){var e=this;e.appConfig=t;var i=Common.Utils.InternalSettings,n=$(".toolbar-fullview-panel");if(n.css("top",Common.UI.LayoutManager.isElementVisible("toolbar")?i.get("toolbar-height-tabs"):0),e.viewport.$el.attr("applang",e.appConfig.lang.split(/[\-_]/)[0]),!t.isEdit||!Common.localStorage.itemExists("pdfe-compact-toolbar")&&t.customization&&t.customization.compactToolbar){var o=e.viewport.vlayout.getItem("toolbar");o&&(o.height=i.get("toolbar-height-tabs"))}if(t.customization&&(t.customization.toolbarNoTabs&&e.viewport.vlayout.getItem("toolbar").el.addClass("style-off-tabs"),t.customization.toolbarHideFileName&&e.viewport.vlayout.getItem("toolbar").el.addClass("style-skip-docname")),t.isEdit&&(!t.customization||!t.customization.compactHeader)){var s=e.viewport.vlayout.getItem("title").el;s.html(e.header.getPanel("title",t)).show(),s.find(".extra").html(e.header.getPanel("left",t));var a=e.viewport.vlayout.getItem("toolbar");a.el.addClass("top-title"),a.height-=i.get("toolbar-height-tabs")-i.get("toolbar-height-tabs-top-title");var r=i.get("toolbar-height-tabs-top-title");i.set("toolbar-height-tabs",r),i.set("toolbar-height-compact",r),i.set("toolbar-height-normal",r+i.get("toolbar-height-controls")),n.css("top",(Common.UI.LayoutManager.isElementVisible("toolbar")?r:0)+i.get("document-title-height")),(a=e.getApplication().getController("Toolbar").getView()).btnCollabChanges=e.header.btnSave}e.header.btnSearch.on("toggle",e.onSearchToggle.bind(this))},onAppReady:function(t){},onLayoutChanged:function(t){switch(t){default:this.viewport.vlayout.doLayout();case"leftmenu":var e=this.viewport.hlayout.getItem("left");e.resize.el&&(e.el.width()>40?(this.boxSdk.css("border-left",""),e.resize.el.show()):(e.resize.el.hide(),this.boxSdk.css("border-left","0 none"))),this.viewport.hlayout.doLayout();break;case"header":case"toolbar":case"status":this.viewport.vlayout.doLayout()}this.api.Resize()},onWindowResize:function(t){this.onLayoutChanged("window"),Common.NotificationCenter.trigger("window:resize")},onFileMenu:function(t){var e=this,i="show"==t;e.header.lockHeaderBtns("undo",i),e.header.lockHeaderBtns("redo",i),e.header.lockHeaderBtns("users",i)},applySettings:function(){var t=Common.localStorage.getBool("pdfe-settings-quick-print-button",!0);Common.Utils.InternalSettings.set("pdfe-settings-quick-print-button",t),this.header&&this.header.btnPrintQuick&&this.header.btnPrintQuick[t?"show":"hide"]()},onApiCoAuthoringDisconnect:function(t){this.header&&(this.header.btnDownload&&!t&&this.header.btnDownload.hide(),this.header.btnPrint&&!t&&this.header.btnPrint.hide(),this.header.btnPrintQuick&&!t&&this.header.btnPrintQuick.hide(),this.header.btnEdit&&this.header.btnEdit.hide(),this.header.lockHeaderBtns("rename-user",!0))},SetDisabled:function(t){this.header&&this.header.lockHeaderBtns("rename-user",t)},onSearchShow:function(){this.header.btnSearch&&this.header.btnSearch.toggle(!0)},onSearchToggle:function(){var t=this.getApplication().getController("LeftMenu");if(t.isSearchPanelVisible())return this.header.btnSearch.toggle(!1,!0),void t.getView("LeftMenu").panelSearch.focus();if(!this.searchBar){var e=this.appConfig.canBrandingExt&&(!Common.UI.LayoutManager.isElementVisible("leftMenu")||this.appConfig.customization&&!1===this.appConfig.customization.leftMenu);this.searchBar=new Common.UI.SearchBar(e?{showOpenPanel:!1,width:303}:{}),this.searchBar.on("hide",_.bind((function(){this.header.btnSearch.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete")}),this))}if(this.header.btnSearch.pressed){var i=this.api.asc_GetSelectedText(),n=this.getApplication().getController("Search"),o=n.getResultsNumber();this.searchBar.show(i&&i.trim()||n.getSearchText()),this.searchBar.updateResultsNumber(o[0],o[1])}else this.searchBar.hide()},isSearchBarVisible:function(){return this.searchBar&&this.searchBar.isVisible()},textFitPage:"Fit to Page",textFitWidth:"Fit to Width",txtDarkMode:"Dark mode"},PDFE.Controllers.Viewport))})),$(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.dropdown.data-api","[data-toggle=dropdown], [role=menu]",onDropDownKeyDown),"ontouchstart"in document.documentElement&&$(document).on("click.bs.dropdown.data-api","[data-toggle=dropdown]",toggle),function(){var t,e=$._data($(document).get(0),"events");e&&e.click&&e.click.every((function(e,i,n){return/click/.test(e.type)&&!e.selector&&/bs\..+\.dropdown/.test(e.namespace)&&(t=e.handler),!t})),t&&$(document).off("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",(function(t){1!=t.which&&null!=t.which||clearMenus(/form-control/.test(t.target.className))}))}(),define("common/main/lib/extend/Bootstrap",(function(){})),void 0===Common)var Common={};if(define("common/main/lib/component/MenuItem",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],(function(){"use strict";Common.UI.MenuItem=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,checkable:!1,checked:!1,allowDepress:!1,disabled:!1,visible:!0,value:null,toggleGroup:null,iconCls:"",menu:null,canFocused:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"",dataHintTitle:"",scaling:!0},tagName:"li",template:_.template(['<a id="<%= id %>" class="menu-item" style="<%= style %>" <% if(options.canFocused) { %> tabindex="-1" type="menuitem" <% }; if(!_.isUndefined(options.stopPropagation)) { %> data-stopPropagation="true" <% }; if(!_.isUndefined(options.dataHint)) { %> data-hint="<%= options.dataHint %>" <% }; if(!_.isUndefined(options.dataHintDirection)) { %> data-hint-direction="<%= options.dataHintDirection %>" <% }; if(!_.isUndefined(options.dataHintOffset)) { %> data-hint-offset="<%= options.dataHintOffset %>" <% }; if(options.dataHintTitle) { %> data-hint-title="<%= options.dataHintTitle %>" <% }; %> >',"<% if (!_.isEmpty(iconCls)) { %>",'<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.caption=e.options.caption,this.menu=e.options.menu||null,this.checkable=e.options.checkable,this.checked=e.options.checked,e.allowDepress=e.options.allowDepress,this.disabled=e.options.disabled,this.visible=e.options.visible,this.value=e.options.value,this.toggleGroup=e.options.toggleGroup,this.template=e.options.template||this.template,this.iconCls=e.options.iconCls,this.hint=e.options.hint,this.rendered=!1,null===this.menu||this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple||(this.menu=new Common.UI.Menu(_.extend({},e.options.menu))),e.options.el&&this.render()},render:function(){var t=this,e=t.$el||$(this.el);if(t.cmpEl=e,t.trigger("render:before",t),"--"===t.caption)e.addClass("divider");else if(!this.rendered){e.off("click"),Common.UI.ToggleManager.unregister(t),e.html(this.template({id:t.id,caption:t.caption,iconCls:t.iconCls,style:t.style,options:t.options})),t.menu&&(e.addClass("dropdown-submenu"),t.menu.render(e),e.mouseenter(_.bind(t.menu.alignPosition,t.menu)),e.focusout(_.bind(t.onBlurItem,t)),e.hover(_.bind(t.onHoverItem,t),_.bind(t.onUnHoverItem,t)));var i=e.children(":first");this.checkable&&i&&(i.toggleClass("checkable",this.checkable),i.toggleClass("no-checkmark",!1===this.options.checkmark),i.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||i.css("background-image","none")),t.options.hint&&(e.attr("data-toggle","tooltip"),e.tooltip({title:t.options.hint,placement:t.options.hintAnchor||function(t,e){var i=this.getPosition(),n=t.offsetWidth,o=t.offsetHeight,s=Common.Utils.innerWidth(),a=Common.Utils.innerHeight(),r=i.top,l=i.left+i.width+2;r+o>a&&(r=a-o-2),l+n>s&&(l=i.left-n-2),$(t).offset({top:r,left:l}).addClass("in")}})),this.cls&&e.addClass(this.cls),this.disabled&&e.toggleClass("disabled",this.disabled),e.on("click",_.bind(this.onItemClick,this)),e.on("mousedown",_.bind(this.onItemMouseDown,this)),Common.UI.ToggleManager.register(t),!1!==t.options.scaling&&t.iconCls&&(e.attr("ratio","ratio"),t.applyScaling(Common.UI.Scaling.currentRatio()),e.on("app:scaling",(function(e,i){t.options.scaling!=i.ratio&&t.applyScaling(i.ratio)})))}return this.visible||this.setVisible(this.visible),t.rendered=!0,t.trigger("render:after",t),this},setCaption:function(t,e){this.caption=t,this.rendered&&(this.cmpEl.find("> a").contents().last()[0].textContent=e?t:Common.Utils.String.htmlEncode(t))},setIconCls:function(t){if(this.rendered&&!_.isEmpty(this.iconCls)){var e=this.cmpEl.children(":first");if(e){e.find(".menu-item-icon").removeClass(this.iconCls).addClass(t);var i=e.find("use.zoom-int");if(i.length){var n=/btn-[^\s]+/.exec(t),o=n?n[0]:"null";i.attr("href","#"+o)}}}this.iconCls=t},setChecked:function(t,e){this.toggle(t,e)},isChecked:function(){return this.checked},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},toggle:function(t,e){var i=void 0===t?!this.checked:!!t;if(this.checkable){if(this.checked=i,this.rendered){var n=this.cmpEl.children(":first");n&&(n.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||n.css("background-image","none"))}e||this.trigger("toggle",this,i)}},onItemMouseDown:function(t){if(Common.UI.HintManager&&Common.UI.HintManager.clearHints(),1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},onItemClick:function(t){return(1==t.which||void 0===t.which&&!this.menu)&&(this.disabled||!this.allowDepress&&this.checked&&this.toggleGroup||this.menu||this.setChecked(!this.checked),this.menu?t.target.id!=this.id&&void(this.menu.isOver||this.cmpEl.removeClass("over")):!this.disabled&&void this.trigger("click",this,t))},onHoverItem:function(t){this._doHover(t)},onUnHoverItem:function(t){this._doUnHover(t)},onBlurItem:function(t){this._doUnHover(t)},_doHover:function(t){var e=this;e.menu&&!e.disabled&&(clearTimeout(e.hideMenuTimer),e.cmpEl.trigger("show.bs.dropdown"),e.expandMenuTimer=_.delay((function(){e.cmpEl.addClass("over"),e.cmpEl.trigger("shown.bs.dropdown")}),200))},_doUnHover:function(t){var e=this;if(e.cmpEl.hasClass("dropdown-submenu")&&e.cmpEl.hasClass("over")&&(t&&t.relatedTarget&&e.cmpEl.find(t.relatedTarget).length>0||e.cmpEl.hasClass("focused-submenu")))e.cmpEl.removeClass("focused-submenu");else if(e.menu&&!e.disabled&&(clearTimeout(e.expandMenuTimer),e.hideMenuTimer=_.delay((function(){e.menu.isOver||e.cmpEl.removeClass("over")}),200),t&&"focusout"!==t.type)){var i=e.cmpEl.children(":focus");i.length>0&&(i.blur(),e.cmpEl.closest("ul").focus())}},setMenu:function(t){if(t&&_.isObject(t)&&_.isFunction(t.render))if(this.rendered){this.menu&&(this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple)&&(Common.UI.Menu.Manager.unregister(this.menu),this.menu.cmpEl&&this.menu.cmpEl.remove()),this.menu=t;var e=this.cmpEl;e.addClass("dropdown-submenu"),this.menu.render(e),e.mouseenter(_.bind(this.menu.alignPosition,this.menu)),e.focusout(_.bind(this.onBlurItem,this)),e.hover(_.bind(this.onHoverItem,this),_.bind(this.onUnHoverItem,this))}else this.menu=t},applyScaling:function(t){var e=this;if(e.options.scaling!=t){e.options.scaling=t;var i=this.cmpEl.children(":first");if(t>2&&!i.find("svg.menu-item-icon").length){var n=e.iconCls,o=/btn-[^\s]+/.exec(n),s=o?o[0]:"null",a='<svg class="menu-item-icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",s);i.find("span.menu-item-icon").after(a)}}}}),Common.UI.MenuItemSeparator=function(t){return(t=t||{}).caption="--",new Common.UI.MenuItem(t)}})),void 0===Common)var Common={};if(define("common/main/lib/component/Menu",["common/main/lib/extend/Bootstrap","common/main/lib/component/BaseView","common/main/lib/component/MenuItem","common/main/lib/component/Scroller"],(function(){"use strict";var t,e,i;Common.UI.Menu=(t=[],e={},i={register:function(i){e[i.id]=i,i.on("show:after",(function(e){t.push(e)})).on("hide:after",(function(e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}))},unregister:function(i){var n=t.indexOf(i);delete e[i.id],n>-1&&t.splice(n,1),i.off("show:after").off("hide:after")},hideAll:function(){return Common.NotificationCenter.trigger("menumanager:hideall"),!!(t&&t.length>0)&&(_.each(t,(function(t){t&&t.hide()})),!0)}},_.extend(Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0,scrollToCheckedItem:!0,focusToCheckedItem:!1},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu"></ul>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||Common.UI.MenuItem.prototype.template,this.rendered=!1,this.items=[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,this.outerMenu=this.options.outerMenu,Common.UI.isRTL()&&("tl-tr"===this.menuAlign?this.menuAlign="tr-tl":"tl-bl"===this.menuAlign?this.menuAlign="tr-br":"tr-br"===this.menuAlign?this.menuAlign="tl-bl":"bl-tl"===this.menuAlign&&(this.menuAlign="br-tr")),this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight?this.options.maxHeight:1e5,!this.options.maxHeight&&(this.options.maxHeight=this.options.restoreHeight)),Common.Utils.isIE&&(this.options.restoreHeightAndTop=!1),this.options.cyclic||(this.options.cls+=" no-cyclic"),_.each(this.options.items,(function(t){t instanceof Common.UI.MenuItem?e.items.push(t):e.items.push(new Common.UI.MenuItem(_.extend({tagName:"li",template:e.itemTemplate},t)))})),this.options.el&&this.render(),i.register(this)},remove:function(){i.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this;this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t?(this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({options:e.options})),t.append(this.cmpEl))):e.rendered||(this.cmpEl=this.template({options:e.options}),this.$el.append(this.cmpEl));var i=this.cmpEl.parent(),n="menu"===i.attr("role")?i:i.find("[role=menu]");return this.menuRoot=n,n&&(e.rendered||(_.each(e.items||[],(function(t){n.append(t.render().el),t.on("click",_.bind(e.onItemClick,e)),t.on("toggle",_.bind(e.onItemToggle,e))})),n.on("click",(function(t){e.trigger("menu:click",this,t)}))),this.options.maxHeight&&(n.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),n.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=n.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),this.parentEl.on("keydown.before.bs.dropdown",_.bind(e.onBeforeKeydownMenu,e)),this.options.innerMenus&&this.on("keydown:before",_.bind(e.onBeforeKeyDown,e)),n.hover((function(t){e.isOver=!0}),(function(t){e.isOver=!1}))),this.rendered=!0,this.trigger("render:after",this),this},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},insertItem:function(t,e){var i=this;if(this.cmpEl,e instanceof Common.UI.MenuItem||(e=new Common.UI.MenuItem(_.extend({tagName:"li",template:i.itemTemplate},e))),t<0||t>=i.items.length?i.items.push(e):i.items.splice(t,0,e),this.rendered){var n=this.menuRoot;n&&(t<0?n.append(e.render().el):0===t?n.prepend(e.render().el):n.children("li:nth-child("+(t+1)+")").before(e.render().el),e.on("click",_.bind(i.onItemClick,i)),e.on("toggle",_.bind(i.onItemToggle,i)))}},addItem:function(t){this.insertItem(-1,t)},removeItem:function(t){var e=this.items.indexOf(t);e>-1&&(this.items.splice(e,1),t.off("click").off("toggle"),t.remove())},removeItems:function(t,e){if(!(t>this.items.length-1)){t+e>this.items.length&&(e=this.items.length-t);for(var i=t;i<t+e;i++)this.items[i].off("click").off("toggle"),this.items[i].remove();this.items.splice(t,e)}},removeAll:function(){_.each(this.items,(function(t){t.off("click").off("toggle"),t.remove()})),this.items=[]},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){if(this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget){var e=this.menuRoot;if(void 0===this.wheelSpeed){var i=e.find("> li:first"),n=i.length?i.outerHeight():1;this.wheelSpeed=Math.min(Math.floor(e.height()/n)*n/10,20)}this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed});var o=e.find("> li .checked");if(o.length){var s=o.position().top,a=(n=o.outerHeight(),e.outerHeight());if(this.options.scrollToCheckedItem&&(s<0||s+n>a)){var r=e.scrollTop()+s+(n-a)/2;r=Math.floor(r/n)*n,e.scrollTop(r)}this.options.focusToCheckedItem&&setTimeout((function(){o.focus()}),1)}}this._search={}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(this.trigger("keydown:before",this,t),!t.isDefaultPrevented())if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(e.length<=0&&(e=$(t.target).parent().find("li .dataview")),e.length>0&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else if(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)this.fromKeyDown=!0;else if(t.keyCode==Common.UI.Keys.ESC);else if(this.search&&t.keyCode>64&&t.keyCode<91&&t.key){var i=this;if(clearTimeout(this._search.timer),this._search.timer=setTimeout((function(){i._search={}}),1e3),!this._search.text&&(this._search.text=""),!this._search.char&&(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index){var n=this.menuRoot.find("> li").find("> a");this._search.index=n.index(n.filter(":focus"))}this.selectCandidate()}},onBeforeKeydownMenu:function(t){if(!t.isDefaultPrevented()&&this.outerMenu&&this.outerMenu.menu&&(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)){var e=this.menuRoot.find("> li").find("> a"),i=e.index(e.filter(":focus"));(t.keyCode==Common.UI.Keys.UP&&0==i||t.keyCode==Common.UI.Keys.DOWN&&i==e.length-1)&&(this.outerMenu.menu.focusOuter(t,this.outerMenu.index),t.preventDefault(),t.stopPropagation())}},selectCandidate:function(){for(var t,e,i=this._search.index&&-1!=this._search.index?this._search.index:0,n=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),o=n.test(this.items[i].caption),s=0;s<this.items.length;s++){var a=this.items[s];if(n.test(a.caption)){if(!t&&(t=a,e=s,!o))break;if(this._search.full&&s==i||s>i){t=a,e=s;break}}}if(t){if(this._search.index=e,a=t.cmpEl.find("a"),this.scroller){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed});var r=a.position().top,l=a.outerHeight(),c=this.menuRoot.outerHeight();if(r<0||r+l>c){var d=this.menuRoot.scrollTop()+r;d=Math.floor(d/l)*l,this.menuRoot.scrollTop(d)}}a.focus()}},onBeforeKeyDown:function(t,e){if(e.keyCode==Common.UI.Keys.RETURN){var i=$(e.target).closest("li");i.length>0&&(e.preventDefault(),e.stopPropagation(),i.click()),Common.UI.Menu.Manager.hideAll()}else if("after.bs.dropdown"!==e.namespace&&(e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.UP)){if(this.menuRoot.length<1||$(e.target).closest("ul[role=menu]").get(0)!==this.menuRoot.get(0))return;var n=this.findInnerMenu(e.keyCode);n&&n.focusInner&&(e.preventDefault(),e.stopPropagation(),_.delay((function(){n.focusInner(e)}),10))}},setInnerMenu:function(t){!this.options.innerMenus&&t&&(this.options.innerMenus=t,this.rendered&&this.on("keydown:before",_.bind(this.onBeforeKeyDown,this)))},findInnerMenu:function(t,e,i){if(this.options.innerMenus){var n=$("> li",this.menuRoot),o=$("> li:not(.divider):not(.disabled):visible",this.menuRoot),s=o.length;if(s)for(var a=0;a<s;){var r=void 0!==e?o.index(n.eq(e)):o.index(o.find("> a").filter(":focus").parent()),l=t==Common.UI.Keys.DOWN?r<s-1?r+1:0:r>0?r-1:s-1,c=o.eq(l);e=n.index(c);for(var d=0;d<this.options.innerMenus.length;d++){var h=this.options.innerMenus[d];if(h&&h.menu&&h.index==e)return h.menu}if(c.find("> a").length>0)return i?c:void 0;a++}}},focusInner:function(t){t.keyCode==Common.UI.Keys.UP?this.items[this.items.length-1].cmpEl.find("> a").focus():this.items[0].cmpEl.find("> a").focus()},focusOuter:function(t,e){var i=this.findInnerMenu(t.keyCode,e,!0);if(i&&i.focusInner)_.delay((function(){i.focusInner(t)}),10);else if(i)i.find("> a").focus();else{var n=$("> li:not(.divider):not(.disabled):visible",this.menuRoot).find("> a"),o=n.length;o&&n.eq(t.keyCode==Common.UI.Keys.UP?e<0?o-1:e:e>=o-1?0:e+1).focus()}},onItemClick:function(t,e){if(t.menu||(this.isOver=!1),t.options.stopPropagation){e.stopPropagation();var i=this;_.delay((function(){i.$el.parent().parent().find("[data-toggle=dropdown]").focus()}),10)}else this.trigger("item:click",this,t,e)},onItemToggle:function(t,e,i){this.trigger("item:toggle",this,t,e,i)},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i=this.menuRoot,n=this.menuAlignEl||i.parent(),o=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),s=n.offset(),a=Common.Utils.innerWidth()-10,r=Common.Utils.innerHeight()-10,l=i.outerWidth(),c=i.outerHeight(),d=n.outerWidth(),h=n.outerHeight(),m={tl:[0,0],bl:[0,c],tr:[l,0],br:[l,c]},u={tl:[0,0],tr:[d,0],bl:[0,h],br:[d,h]},p=s.left-m[o[1]][0]+u[o[2]][0]+this.offset[0],f=s.top-m[o[1]][1]+u[o[2]][1]+this.offset[1];if(p+l>a?p=n.is("li.dropdown-submenu")?s.left-l+2:a-l:p<0&&(p=n.is("li.dropdown-submenu")?s.left+d-2:0),p<0&&(p=0),this.options.restoreHeightAndTop)r=(g=Common.Utils.croppedGeometry()).height-10,i.css("max-height","none"),f+(c=i.outerHeight())>r+g.top&&(f=r-c),f<g.top&&(f=g.top),f+c>r+g.top&&(i.css("max-height",r-f+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find("> .dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0),this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});else if(this.options.restoreHeight)"number"==typeof this.options.restoreHeight&&(f+c>r?(i.css("max-height",r-f+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0):f+c<r&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(r-f,this.options.restoreHeight)+"px"),this.wheelSpeed=void 0));else{var g;f+c>(r=(g=Common.Utils.croppedGeometry()).height-10)+g.top&&(t&&"string"==typeof t?(o=t.match(/^([a-z]+)-([a-z]+)/),f=s.top-m[o[1]][1]+u[o[2]][1]+this.offset[1]+(e||0)):f=r-c),f<g.top&&(f=g.top)}if(this.options.additionalAlign)this.options.additionalAlign.call(this,i,p,f);else{var b={left:p,top:f};c<r||(b["margin-top"]=0),i.css(b)}},getChecked:function(){for(var t=0;t<this.items.length;t++){var e=this.items[t];if(e.isChecked&&e.isChecked())return e}},clearAll:function(){_.each(this.items,(function(t){t.setChecked&&t.setChecked(!1,!0)}))}}),{Manager:i})),Common.UI.MenuSimple=Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0,scrollToCheckedItem:!0,focusToCheckedItem:!1},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>","</ul>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||_.template(['<a id="<%= id %>" <% if(typeof style !== "undefined") { %> style="<%= style %>" <% } %>','<% if(typeof canFocused !== "undefined") { %> tabindex="-1" type="menuitem" <% } %>','<% if(typeof stopPropagation !== "undefined") { %> data-stopPropagation="true" <% } %>','class="<% if (checked) { %> checked <% } %>" >','<% if (typeof iconCls !== "undefined") { %>','<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),this.rendered=!1,this.items=this.options.items||[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,Common.UI.isRTL()&&("tl-tr"===this.menuAlign?this.menuAlign="tr-tl":"tl-bl"===this.menuAlign?this.menuAlign="tr-br":"tr-br"===this.menuAlign?this.menuAlign="tl-bl":"bl-tl"===this.menuAlign&&(this.menuAlign="br-tr")),this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight?this.options.maxHeight:1e5,!this.options.maxHeight&&(this.options.maxHeight=this.options.restoreHeight)),this.options.cyclic||(this.options.cls+=" no-cyclic"),this.options.el&&this.render(),Common.UI.Menu.Manager.register(this)},remove:function(){Common.UI.Menu.Manager.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this;this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t&&this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({items:e.items,itemTemplate:e.itemTemplate,options:e.options})),t?t.append(this.cmpEl):this.$el.append(this.cmpEl));var i=this.cmpEl.parent(),n="menu"===i.attr("role")?i:i.find("[role=menu]");return this.menuRoot=n,n&&(e.rendered||(n.on("click","li",_.bind(e.onItemClick,e)),n.on("mousedown","li",_.bind(e.onItemMouseDown,e))),this.options.maxHeight&&(n.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),n.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=n.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),n.hover((function(t){e.isOver=!0}),(function(t){e.isOver=!1}))),this.rendered=!0,this.trigger("render:after",this),this},resetItems:function(t){this.items=t||[],this.$items=null;var e=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>"].join(""));this.cmpEl&&this.cmpEl.html(e({items:this.items,itemTemplate:this.itemTemplate,options:this.options}))},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},onItemClick:function(t){if(1!=t.which&&void 0!==t.which)return!1;var e=$(t.currentTarget).closest("li").index(),i=e>=0?this.items[e]:null;if(i){if(i.disabled)return!1;if(i.checkable&&!i.checked&&this.setChecked(e,!i.checked),this.isOver=!1,i.stopPropagation){t.stopPropagation();var n=this;_.delay((function(){n.$el.parent().parent().find("[data-toggle=dropdown]").focus()}),10)}else this.trigger("item:click",this,i,t)}},onItemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},setChecked:function(t,e,i){this.toggle(t,e,i)},toggle:function(t,e,i){var n=!!e,o=this.items[t];if(this.clearAll(),o&&o.checkable){if(o.checked=n,this.rendered){var s=o.el||this.cmpEl.find("#"+o.id);s&&(s.toggleClass("checked",o.checked),_.isEmpty(o.iconCls)||s.css("background-image","none"))}i||this.trigger("item:toggle",this,o,n)}},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){if(this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});var e=this.menuRoot,i=e.find("> li .checked");if(i.length){var n=i.position().top,o=i.outerHeight(),s=e.outerHeight();if(this.options.scrollToCheckedItem&&(n<0||n+o>s)){var a=e.scrollTop()+n+(o-s)/2;a=Math.floor(a/o)*o,e.scrollTop(a)}this.options.focusToCheckedItem&&setTimeout((function(){i.focus()}),1)}}if(this._search={},this.search&&!this.$items){var r=this;this.$items=this.menuRoot.find("> li").find("> a"),_.each(this.$items,(function(t,e){r.items[e].el=$(t)}))}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(e.length<=0&&(e=$(t.target).parent().find("li .dataview")),e.length>0&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else if(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)this.fromKeyDown=!0;else if(t.keyCode==Common.UI.Keys.ESC);else if(this.search&&t.keyCode>64&&t.keyCode<91&&t.key){var i=this;clearTimeout(this._search.timer),this._search.timer=setTimeout((function(){i._search={}}),1e3),!this._search.text&&(this._search.text=""),!this._search.char&&(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(this._search.index=this.$items.index(this.$items.filter(":focus"))),this.selectCandidate()}},selectCandidate:function(){for(var t,e,i=this._search.index&&-1!=this._search.index?this._search.index:0,n=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),o=n.test(this.items[i].caption),s=0;s<this.items.length;s++){var a=this.items[s];if(n.test(a.caption)){if(!t&&(t=a,e=s,!o))break;if(this._search.full&&s==i||s>i){t=a,e=s;break}}}if(t){this._search.index=e;a=t.el;if(this.scroller){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});var r=a.position().top,l=a.outerHeight(),c=this.menuRoot.outerHeight();if(r<0||r+l>c){var d=this.menuRoot.scrollTop()+r;d=Math.floor(d/l)*l,this.menuRoot.scrollTop(d)}}a.focus()}},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i=this.menuRoot,n=this.menuAlignEl||i.parent(),o=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),s=n.offset(),a=Common.Utils.innerWidth(),r=Common.Utils.innerHeight()-10,l=i.outerWidth(),c=i.outerHeight(),d=n.outerWidth(),h=n.outerHeight(),m={tl:[0,0],bl:[0,c],tr:[l,0],br:[l,c]},u={tl:[0,0],tr:[d,0],bl:[0,h],br:[d,h]},p=s.left-m[o[1]][0]+u[o[2]][0]+this.offset[0],f=s.top-m[o[1]][1]+u[o[2]][1]+this.offset[1];p+l>a?p=n.is("li.dropdown-submenu")?s.left-l+2:a-l:p<0&&(p=n.is("li.dropdown-submenu")?s.left+d-2:0),p<0&&(p=0),this.options.restoreHeight?"number"==typeof this.options.restoreHeight&&(f+c>r?(i.css("max-height",r-f+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible}))):f+c<r&&i.height()<this.options.restoreHeight&&i.css("max-height",Math.min(r-f,this.options.restoreHeight)+"px")):(f+c>r&&(t&&"string"==typeof t?(o=t.match(/^([a-z]+)-([a-z]+)/),f=s.top-m[o[1]][1]+u[o[2]][1]+this.offset[1]+(e||0)):f=r-c),f<0&&(f=0)),this.options.additionalAlign?this.options.additionalAlign.call(this,i,p,f):i.css({left:Math.ceil(p),top:Math.ceil(f)})},clearAll:function(){this.cmpEl&&this.cmpEl.find("li > a.checked").removeClass("checked"),_.each(this.items,(function(t){t.checked=!1}))}})})),void 0===Common)var Common={};if(define("common/main/lib/component/Calendar",["common/main/lib/component/BaseView","common/main/lib/util/utils"],(function(){"use strict";Common.UI.Calendar=Common.UI.BaseView.extend(_.extend({template:_.template(['<div id="calendar" class="calendar-box">','<div class="calendar-header">','<div class="top-row">','<div id="prev-arrow"><button type="button"><i class="arrow-prev img-commonctrl"></i></button></div>','<div class="title"></div>','<div id="next-arrow"><button type="button"><i class="arrow-next img-commonctrl" /></button></div>',"</div>",'<div class="bottom-row"></div>',"</div>",'<div class="calendar-content"></div>',"</div>"].join("")),options:{date:void 0,firstday:0},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.monthNames=[this.textJanuary,this.textFebruary,this.textMarch,this.textApril,this.textMay,this.textJune,this.textJuly,this.textAugust,this.textSeptember,this.textOctober,this.textNovember,this.textDecember],this.dayNamesShort=[this.textShortSunday,this.textShortMonday,this.textShortTuesday,this.textShortWednesday,this.textShortThursday,this.textShortFriday,this.textShortSaturday],this.monthShortNames=[this.textShortJanuary,this.textShortFebruary,this.textShortMarch,this.textShortApril,this.textShortMay,this.textShortJune,this.textShortJuly,this.textShortAugust,this.textShortSeptember,this.textShortOctober,this.textShortNovember,this.textShortDecember],e.options.date=t.date,_.isUndefined(t.firstday)||0!==t.firstday&&1!==t.firstday||(e.options.firstday=t.firstday),e.enableKeyEvents=e.options.enableKeyEvents,e._state=void 0,e.render()},render:function(){var t=this;return t.cmpEl=t.$el||$(this.el),t.cmpEl.html(this.template()),t.currentDate=t.options.date||new Date,t.btnPrev=new Common.UI.Button({parentEl:t.cmpEl.find("#prev-arrow"),cls:"",iconCls:"arrow-prev img-commonctrl"}),t.btnPrev.on("click",_.bind(t.onClickPrev,t)),t.btnNext=new Common.UI.Button({parentEl:t.cmpEl.find("#next-arrow"),cls:"",iconCls:"arrow-next img-commonctrl"}),t.btnNext.on("click",_.bind(t.onClickNext,t)),t.cmpEl.on("keydown",(function(e){t.trigger("calendar:keydown",t,e)})),t.renderMonth(t.currentDate),this.trigger("render:after",this),this},onClickPrev:function(){var t=this;if(0===t._state)(e=new Date(t.currentDate)).setMonth(e.getMonth()-1),e.getFullYear()>0&&t.renderMonth(e);else if(1===t._state){var e;(e=new Date(t.currentDate)).setFullYear(e.getFullYear()-1),e.getFullYear()>0&&t.renderMonths(e)}else if(2===t._state){var i,n=t.currentDate.getFullYear();n%10!=0?(i=String(n),i=Number(i.slice(0,-1)+"0")-1):i=n-1,i>0&&(t.currentDate.setFullYear(i),t.renderYears(i))}},onClickNext:function(){var t=this;if(0===t._state)(e=new Date(t.currentDate)).setMonth(e.getMonth()+1),e.getFullYear()>0&&t.renderMonth(e);else if(1===t._state){var e;(e=new Date(t.currentDate)).setFullYear(e.getFullYear()+1),e.getFullYear()>0&&t.renderMonths(e)}else if(2===t._state){var i,n=t.currentDate.getFullYear();n%10!=9?(i=String(n),i=Number(i.slice(0,-1)+"9")+1):i=n+1,i>0&&(t.currentDate.setFullYear(i),t.renderYears(i))}},renderYears:function(t){var e=this;t=_.isNumber(t)?t:e.currentDate?e.currentDate.getFullYear():(new Date).getFullYear();e._state=2,e.$el.removeClass("view-days view-months").addClass("view-years");var i=t,n=t;if(i%10!=0){var o=String(t);i=Number(o.slice(0,-1)+"0")}if(n%10!=9){o=String(t);n=Number(o.slice(0,-1)+"9")}e.topTitle=_.template(["<label>"+i+"-"+n+"</label>"].join("")),e.cmpEl.find(".calendar-header .title").html(e.topTitle),e.bottomTitle=_.template(["<label>"+e.textYears+"</label>"].join("")),e.cmpEl.find(".calendar-header .bottom-row").html(e.bottomTitle);for(var s=[],a=i-3,r=0;r<16;r++)s.push({year:a>0?a:"",isCurrentDecade:a>=i&&a<=n,disabled:!(a>0),selected:_.isDate(e.selectedDate)?a===e.selectedDate.getFullYear():a===(new Date).getFullYear()}),a++;e.yearPicker?e.yearPicker.store.reset(s):(e.yearPicker=new Common.UI.DataView({el:e.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(s),itemTemplate:_.template('<div class="name-year <% if (!isCurrentDecade) { %> no-current-decade <% } %>" data-year="<%= year %>"><%= year %></div>')}),e.yearPicker.on("item:click",(function(t,i,n,o){var s=n.get("year"),a=new Date;a.setFullYear(s),e.renderMonths(a)})),e.enableKeyEvents&&this.yearPicker.on("item:keydown",(function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")}))),e.enableKeyEvents&&_.delay((function(){e.monthPicker.focus()}),10)},renderMonths:function(t){var e=this,i=_.isDate(t)?t:e.currentDate?e.currentDate:new Date,n=i.getFullYear();e._state=1,e.currentDate=i,e.$el.removeClass("view-years view-days").addClass("view-months"),e.topTitle=_.template(['<div class="button"><label>'+n+"</label></div>"].join("")),e.cmpEl.find(".calendar-header .title").html(e.topTitle),e.cmpEl.find(".calendar-header .title").off(),e.cmpEl.find(".calendar-header .title").on("click",_.bind(e.renderYears,e)),e.bottomTitle=_.template(["<label>"+e.textMonths+"</label>"].join("")),e.cmpEl.find(".calendar-header .bottom-row").html(e.bottomTitle);for(var o=[],s=new Date,a=0;a<12;a++)o.push({indexMonth:a,nameMonth:e.monthShortNames[a],year:n,curYear:!0,isCurrentMonth:a===i.getMonth(),selected:_.isDate(e.selectedDate)?a===e.selectedDate.getMonth()&&n===e.selectedDate.getFullYear():a===s.getMonth()&&n===s.getFullYear()});n+=1;for(a=0;a<4;a++)o.push({indexMonth:a,nameMonth:e.monthShortNames[a],year:n,curYear:!1,selected:_.isDate(e.selectedDate)?a===e.selectedDate.getMonth()&&n===e.selectedDate.getFullYear():a===s.getMonth()&&n===s.getFullYear()});e.monthsPicker?e.monthsPicker.store.reset(o):(e.monthsPicker=new Common.UI.DataView({el:e.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(o),itemTemplate:_.template('<div class="name-month <% if (!curYear) { %> no-cur-year <% } %>" data-month="<%= indexMonth %>" data-year="<%= year %>"><%= nameMonth %></div>')}),e.monthsPicker.on("item:click",(function(t,i,n,o){var s=n.get("indexMonth"),a=n.get("year"),r=new Date;r.setFullYear(a,s),e.renderMonth(r)})),e.enableKeyEvents&&this.monthsPicker.on("item:keydown",(function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")}))),e.enableKeyEvents&&_.delay((function(){e.monthPicker.focus()}),10)},renderMonth:function(t){var e=this;e._state=0;var i=e.options.firstday,n=t||new Date,o=n.getMonth(),s=(n.getDay(),n.getDate(),n.getFullYear());e.currentDate=n,e.$el.removeClass("view-years view-months").addClass("view-days"),e.topTitle=_.template(['<div class="button">',"<label>"+e.monthNames[o]+" "+s+"</label>","</div>"].join("")),e.cmpEl.find(".calendar-header .title").html(e.topTitle),e.cmpEl.find(".calendar-header .title").off(),e.cmpEl.find(".calendar-header .title").on("click",_.bind(e.renderMonths,e));for(var a="",r=i;r<7;r++)a+="<label>"+e.dayNamesShort[r]+"</label>";i>0&&(a+="<label>"+e.dayNamesShort[0]+"</label>"),e.cmpEl.find(".calendar-header .bottom-row").html(_.template(a));var l=[],c=new Date(n);c.setDate(1);var d,h,m,u=c.getDay(),p=e.daysInMonth(c.getTime()-864e6);d=0===i?u>0?p-(u-1):1:0===u?p-5:p-(u-2),u>0&&0===i||1===i?o-1>=0?(h=o-1,m=s):(h=11,m=s-1):(h=o,m=s);var f=new Date;f.setFullYear(m,h,d);for(var g=new Date,b=0;b<6;b++)for(var v=0;v<7;v++){var C=f.getDay(),y=f.getDate(),w=f.getMonth(),x=f.getFullYear();l.push({indexInWeek:C,dayNumber:y,month:w,year:x,isCurrentMonth:w===o,selected:_.isDate(e.selectedDate)?y===e.selectedDate.getDate()&&w===e.selectedDate.getMonth()&&x===e.selectedDate.getFullYear():y===g.getDate()&&w===g.getMonth()&&x===g.getFullYear()}),f.setDate(y+1)}e.monthPicker?e.monthPicker.store.reset(l):(e.monthPicker=new Common.UI.DataView({el:e.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(l),itemTemplate:_.template('<div class="number-day<% if (indexInWeek === 6 || indexInWeek === 0) { %> weekend<% } %><% if (!isCurrentMonth) { %> no-current-month<% } %>" data-number="<%= dayNumber %>" data-month="<%= month %>" data-year="<%= year %>"><%= dayNumber %></div>')}),e.monthPicker.on("item:click",(function(t,i,n,o){var s=n.get("dayNumber"),a=n.get("month"),r=n.get("year");_.isUndefined(e.selectedDate)&&(e.selectedDate=new Date),e.selectedDate.setFullYear(r,a,s),e.trigger("date:click",e,e.selectedDate)})),e.enableKeyEvents&&this.monthPicker.on("item:keydown",(function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")}))),e.enableKeyEvents&&_.delay((function(){e.monthPicker.focus()}),10)},daysInMonth:function(t){var e;e=t?new Date(t):new Date;var i=new Date;return i.setFullYear(e.getFullYear(),e.getMonth()+1,0),i.getDate()},setDate:function(t){_.isDate(t)&&(this.selectedDate=new Date(t),this.renderMonth(this.selectedDate))},focus:function(){var t=this;t.enableKeyEvents&&t.monthPicker&&_.delay((function(){t.monthPicker.focus()}),10)},textJanuary:"January",textFebruary:"February",textMarch:"March",textApril:"April",textMay:"May",textJune:"June",textJuly:"July",textAugust:"August",textSeptember:"September",textOctober:"October",textNovember:"November",textDecember:"December",textShortJanuary:"Jan",textShortFebruary:"Feb",textShortMarch:"Mar",textShortApril:"Apr",textShortMay:"May",textShortJune:"Jun",textShortJuly:"Jul",textShortAugust:"Aug",textShortSeptember:"Sep",textShortOctober:"Oct",textShortNovember:"Nov",textShortDecember:"Dec",textShortSunday:"Su",textShortMonday:"Mo",textShortTuesday:"Tu",textShortWednesday:"We",textShortThursday:"Th",textShortFriday:"Fr",textShortSaturday:"Sa",textMonths:"Months",textYears:"Years"},Common.UI.Calendar||{}))})),void 0===Common)var Common={};if(define("common/main/lib/view/InsertTableDialog",["common/main/lib/component/Window"],(function(){"use strict";Common.Views.InsertTableDialog=Common.UI.Window.extend(_.extend({options:{width:230,height:157,style:"min-width: 230px;",cls:"modal-dlg",id:"window-insert-table",split:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:t.split?this.txtTitleSplit:this.txtTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<label class="text columns-text" style="width: 130px;">'+this.txtColumns+'</label><div class="columns-val float-right"></div>',"</div>",'<div class="input-row" style="margin-top: 10px;">','<label class="text rows-text" style="width: 130px;">'+this.txtRows+'</label><div class="rows-val float-right"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.udColumns=new Common.UI.MetricSpinner({el:t.find(".columns-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:63,minValue:1,allowDecimal:!1}),this.udRows=new Common.UI.MetricSpinner({el:t.find(".rows-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1})},getFocusedComponents:function(){return[this.udColumns,this.udRows]},getDefaultFocusableComponent:function(){return this.udColumns},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close()},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close(),!1},txtTitle:"Table Size",txtTitleSplit:"Split Cell",txtColumns:"Number of Columns",txtRows:"Number of Rows",textInvalidRowsCols:"You need to specify valid rows and columns count.",txtMinText:"The minimum value for this field is {0}",txtMaxText:"The maximum value for this field is {0}"},Common.Views.InsertTableDialog||{}))})),void 0===Common)var Common={};if(define("common/main/lib/view/CopyWarningDialog",["common/main/lib/component/Window"],(function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,height:325,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="margin-top: 20px;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.autoSize()},autoSize:function(){var t=this.getChild(".box"),e=this.getChild(".footer"),i=this.getChild(".header"),n=this.getChild(".body");n.height(parseInt(t.height())+parseInt(e.css("height"))),this.setHeight(parseInt(n.css("height"))+parseInt(i.css("height")))},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()},textTitle:"Copy, Cut and Paste Actions",textMsg:"Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",textToCopy:"for Copy",textToPaste:"for Paste",textToCut:"for Cut",textDontShow:"Don't show this message again"},Common.Views.CopyWarningDialog||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/RadioBox",["common/main/lib/component/BaseView","underscore"],(function(t,e){"use strict";Common.UI.RadioBox=Common.UI.BaseView.extend({options:{labelText:""},disabled:!1,rendered:!1,template:e.template('<div class="radiobox" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"><input type="radio" name="<%= name %>" id="<%= id %>" class="button__radiobox"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><circle class="rb-circle" cx="8" cy="8" r="6.5" /><circle class="rb-check-mark" cx="8" cy="8" r="4" /></svg><span></span></div>'),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.dataHint=t.dataHint,this.dataHintDirection=t.dataHintDirection,this.dataHintOffset=t.dataHintOffset;this.name=this.options.name||Common.UI.getId(),this.render(),this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.checked&&this.setValue(this.options.checked,!0),this.setCaption(this.options.labelText)},render:function(){var t=this.$el||$(this.el);return t.html(this.template({labelText:this.options.labelText,name:this.name,id:Common.UI.getId("rdb-"),dataHint:this.dataHint,dataHintDirection:this.dataHintDirection,dataHintOffset:this.dataHintOffset})),this.$radio=t.find("input[type=radio]"),this.$label=t.find("div.radiobox"),this.$span=this.$label.find("span"),this.$label.on({keydown:this.onKeyDown.bind(this),click:function(t){this.disabled||this.setValue(!0)}.bind(this)}),this.rendered=!0,this},setDisabled:function(t){this.rendered&&((t=!!t)!==this.disabled&&(this.$label.toggleClass("disabled",t),this.$radio.toggleClass("disabled",t),t?this.$radio.attr({disabled:t}):this.$radio.removeAttr("disabled"),void 0!==this.tabindex&&(t&&(this.tabindex=this.$label.attr("tabindex")),this.$label.attr("tabindex",t?"-1":this.tabindex))),this.disabled=t)},isDisabled:function(){return this.disabled},onItemCheck:function(t){this.disabled||this.setValue(!0)},setRawValue:function(t){(t=!0===t||"true"===t||"1"===t||1===t)&&$("input[type=radio][name="+this.name+"]").removeClass("checked"),this.$radio.toggleClass("checked",t),this.$radio.prop("checked",t)},setValue:function(t,e){if(this.rendered){var i=this.$radio.hasClass("checked");this.setRawValue(t),!0!==e&&i!==t&&this.trigger("change",this,this.$radio.is(":checked"))}else this.options.checked=t},getValue:function(){return this.$radio.is(":checked")},setCaption:function(t){this.$span.text(t),this.$span.css("visibility",t?"visible":"hidden")},onKeyDown:function(t){t.isDefaultPrevented()||t.keyCode===Common.UI.Keys.SPACE&&this.onItemCheck(t)},focus:function(){this.$label&&this.$label.focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),!this.disabled&&this.$label.attr("tabindex",this.tabindex))}})})),define("common/main/lib/view/OptionsDialog",["common/main/lib/component/Window","common/main/lib/component/RadioBox"],(function(){"use strict";Common.Views.OptionsDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",items:[],buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<% if (typeof label !== "undefined" && label !=="") { %>','<label style="margin-bottom: 10px;"><%= label %></label>',"<% } %>","<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div id="<%= item.id %>" style="margin-bottom: 10px;"></div>',"<% }) %>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.radio=[],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=t.getChild(),i=this.options.items,n=!0;if(this.checkedIndex=-1,i){for(var o=0;o<i.length;o++){var s=i[o];this.radio.push(new Common.UI.RadioBox({el:e.find("#"+s.id),labelText:s.caption||"",name:"asc-radio-opt-dlg",value:s.value,disabled:!!s.disabled,checked:n&&!s.disabled}).on("change",(function(e,i,n){i&&(t.currentCell=e.options.value)}))),!n&&!s.checked||s.disabled||(n=!1,this.checkedIndex=o)}this.checkedIndex>=0&&(this.radio[this.checkedIndex].setValue(!0),this.currentCell=this.radio[this.checkedIndex].options.value)}e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return this.radio},getDefaultFocusableComponent:function(){return this.checkedIndex>=0?this.radio[this.checkedIndex]:null},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return this.currentCell},onPrimary:function(){return this._handleInput("ok"),!1}},Common.Views.OptionsDialog||{}))})),define("pdfeditor/main/app/view/DocumentHolder",["jquery","underscore","backbone","gateway","common/main/lib/util/utils","common/main/lib/component/Menu","common/main/lib/component/Calendar","common/main/lib/view/InsertTableDialog","common/main/lib/view/CopyWarningDialog","common/main/lib/view/OptionsDialog"],(function(t,e,i,n){"use strict";PDFE.Views.DocumentHolder=i.View.extend(e.extend({el:"#editor_sdk",template:null,events:{},initialize:function(){this._isDisabled=!1,this._preventCustomClick=null,this._hasCustomItems=!1},render:function(){return this.fireEvent("render:before",this),this.cmpEl=t(this.el),this.fireEvent("render:after",this),this},setApi:function(t){return this.api=t,this},setMode:function(t){return this.mode=t,this},createDelayedElementsPDFViewer:function(){var t=this;t.menuPDFViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-comments",caption:t.addCommentText}),this.viewPDFModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){t.menuPDFViewCopy.setDisabled(!(t.api&&t.api.can_CopyCut())),t.menuAddComment.setVisible(t.mode&&t.mode.canComments)},items:[t.menuPDFViewCopy,t.menuAddComment]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"pdf"])},updateCustomItems:function(e,i){if(e&&i&&!(i.length<1)){var n=this,o=n.mode&&n.mode.lang?n.mode.lang.split(/[\-_]/)[0]:"en";n._preventCustomClick&&clearTimeout(n._preventCustomClick),n._hasCustomItems&&(n._preventCustomClick=setTimeout((function(){n._preventCustomClick=null}),500)),n._hasCustomItems=!0;var s,a=function(t,i){if(e&&e.items.length>0)for(var n=e.items.length-1;n>=0;n--)if(e.items[n].options.isCustomItem&&(void 0===i&&e.items[n].options.guid===t||e.items[n].options.guid===t&&e.items[n].value===i))return e.items[n]},r=function(t,e,i){return i?i.removeAll():((i=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})).on("item:click",(function(t,e,i){!n._preventCustomClick&&n.api&&n.api.onPluginContextMenuItemClick&&n.api.onPluginContextMenuItemClick(e.options.guid,e.value)})),i.on("menu:click",(function(t,e){n._preventCustomClick&&e.stopPropagation()}))),t.forEach((function(t){t.separator&&i.addItem({caption:"--",isCustomItem:!0,guid:e}),t.text&&i.addItem({caption:("object"==typeof t.text?t.text[o]||t.text.en:t.text)||"",isCustomItem:!0,value:t.id,guid:e,menu:!!t.items&&r(t.items,e),disabled:!!t.disabled})})),i};if(i.forEach((function(t){var i=!a(t.guid);t&&t.items&&t.items.length>0&&t.items.forEach((function(l){if(l.separator&&i)e.addItem({caption:"--",isCustomItem:!0,guid:t.guid});else if(l.text){var c=a(t.guid,l.id),d=("object"==typeof l.text?l.text[o]||l.text.en:l.text)||"";if(c)c.setCaption(d),c.setDisabled(!!l.disabled),l.items&&(c.menu?(c.menu.isVisible()&&c.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length>0&&(c.menu.isOver=!0,s=c.cmpEl),r(l.items,t.guid,c.menu)):c.setMenu(r(l.items,t.guid)));else{c=new Common.UI.MenuItem({caption:d,isCustomItem:!0,value:l.id,guid:t.guid,menu:!!(l.items&&l.items.length>=0)&&r(l.items,t.guid),disabled:!!l.disabled}).on("click",(function(t,e){!n._preventCustomClick&&n.api&&n.api.onPluginContextMenuItemClick&&n.api.onPluginContextMenuItemClick(t.options.guid,t.value)}));e.addItem(c)}}}))})),s){var l=t("> [role=menu]",s).find("> li:not(.divider):not(.disabled):visible > a");l.length>0&&l.eq(0).focus()}e.alignPosition()}},clearCustomItems:function(t){if(t&&t.items.length>0)for(var e=0;e<t.items.length;e++)t.items[e].options.isCustomItem&&(t.removeItem(t.items[e]),e--);this._hasCustomItems=!1},focus:function(){var t=this;e.defer((function(){t.cmpEl.focus()}),50)},SetDisabled:function(t,e,i){this._isDisabled=t},textCopy:"Copy",addCommentText:"Add Comment",txtWarnUrl:"Clicking this link can be harmful to your device and data.<br>Are you sure you want to continue?"},PDFE.Views.DocumentHolder||{}))})),define("pdfeditor/main/app/controller/DocumentHolder",["core","pdfeditor/main/app/view/DocumentHolder"],(function(){"use strict";PDFE.Controllers.DocumentHolder=Backbone.Controller.extend({models:[],collections:[],views:["DocumentHolder"],initialize:function(){this.addListeners({DocumentHolder:{createdelayedelements:this.createDelayedElements,"equation:callback":this.equationCallback}});var t=this;t._TtHeight=20,t.usertips=[],t.fastcoauthtips=[],t._isDisabled=!1,t._state={},t.mode={},t.mouseMoveData=null,t.isTooltipHiding=!1,t.lastMathTrackBounds=[],t.screenTip={toolTip:new Common.UI.Tooltip({owner:this,html:!0,title:"<br><b>Press Ctrl and click link</b>",cls:"link-tooltip"}),strTip:"",isHidden:!0,isVisible:!1},t.eyedropperTip={toolTip:new Common.UI.Tooltip({owner:this,html:!0,cls:"eyedropper-tooltip"}),isHidden:!0,isVisible:!1,eyedropperColor:null,tipInterval:null,isTipVisible:!1},t.userTooltip=!0,t.wrapEvents={userTipMousover:_.bind(t.userTipMousover,t),userTipMousout:_.bind(t.userTipMousout,t)};var e={};t.hkComments=Common.Utils.isMac?"command+alt+a":"alt+h",e[t.hkComments]=function(){return!1!==t.api.can_AddQuotedComment()&&t.addComment(),!1},Common.util.Shortcuts.delegateShortcuts({shortcuts:e})},onLaunch:function(){this.documentHolder=this.createView("DocumentHolder").render(),this.documentHolder.el.tabIndex=-1,this.onAfterRender();var t=this;Common.NotificationCenter.on({"window:show":function(e){t.screenTip.toolTip.hide(),t.screenTip.isVisible=!1,t.userTipHide(),t.hideEyedropper(),t.mode&&t.mode.isDesktopApp&&t.api&&t.api.asc_onShowPopupWindow()},"modal:show":function(e){t.hideTips()},"layout:changed":function(e){t.screenTip.toolTip.hide(),t.screenTip.isVisible=!1,t.userTipHide(),t.hideTips(),t.hideEyedropper(),t.onDocumentHolderResize()}})},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),this.api.asc_registerCallback("asc_onMouseMoveStart",_.bind(this.onMouseMoveStart,this)),this.api.asc_registerCallback("asc_onMouseMoveEnd",_.bind(this.onMouseMoveEnd,this)),this.api.asc_registerCallback("asc_onHyperlinkClick",_.bind(this.onHyperlinkClick,this)),this.api.asc_registerCallback("asc_onMouseMove",_.bind(this.onMouseMove,this)),!0===this.mode.isEdit&&(this.api.asc_registerCallback("asc_onHideEyedropper",_.bind(this.hideEyedropper,this)),this.api.asc_registerCallback("asc_onShowPDFFormsActions",_.bind(this.onShowFormsPDFActions,this))),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onShowForeignCursorLabel",_.bind(this.onShowForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onHideForeignCursorLabel",_.bind(this.onHideForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onFocusObject,this)),this.api.asc_registerCallback("onPluginContextMenu",_.bind(this.onPluginContextMenu,this)),this.documentHolder.setApi(this.api)),this},setMode:function(t){this.mode=t,this.mode.canCoAuthoring&&this.mode.canComments?Common.util.Shortcuts.resumeEvents(this.hkComments):Common.util.Shortcuts.suspendEvents(this.hkComments),this.documentHolder.setMode(t)},createDelayedElements:function(t,e){var i=this;i.documentHolder.menuPDFViewCopy.on("click",_.bind(i.onCutCopyPaste,i)),i.documentHolder.menuAddComment.on("click",_.bind(i.addComment,i))},getView:function(t){return t?Backbone.Controller.prototype.getView.call():this.documentHolder},showPopupMenu:function(t,e,i,n,o){var s=this;if(!_.isUndefined(t)&&null!==t){Common.UI.Menu.Manager.hideAll();var a=[i.get_X(),i.get_Y()],r=$(s.documentHolder.el).find(Common.Utils.String.format("#menu-container-{0}",t.id));t.rendered||(r.length<1&&(r=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',t.id)),$(s.documentHolder.el).append(r)),t.render(r),t.cmpEl.attr({tabindex:"-1"})),r.css({left:a[0],top:a[1]}),t.show(),_.isFunction(t.options.initMenu)&&(t.options.initMenu(e),t.alignPosition()),_.delay((function(){t.cmpEl.focus()}),10),s.documentHolder.currentMenu=t,s.api.onPluginContextMenuShow&&s.api.onPluginContextMenuShow()}},fillViewMenuProps:function(t){var e=this.documentHolder;return e.viewPDFModeMenu||e.createDelayedElementsPDFViewer(),{menu_to_show:e.viewPDFModeMenu,menu_props:{}}},showObjectMenu:function(t,e,i){var n=this;if(n.api){var o=n.fillViewMenuProps();o&&n.showPopupMenu(o.menu_to_show,o.menu_props,t,e,i)}},onContextMenu:function(t){if(Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(),t){var e=this;_.delay((function(){e.showObjectMenu.call(e,t)}),10)}else Common.UI.Menu.Manager.hideAll()},onFocusObject:function(t){var e=this.documentHolder.currentMenu;if(e&&e.isVisible()){var i=this.fillViewMenuProps(t);i&&i.menu_to_show===e&&(e.options.initMenu(i.menu_props),e.alignPosition())}},handleDocumentWheel:function(t){var e=this;if(e.api){var i=_.isUndefined(t.originalEvent)?t.wheelDelta:t.originalEvent.wheelDelta;_.isUndefined(i)&&(i=t.deltaY),t.ctrlKey&&!t.altKey&&(i<0?e.api.zoomOut():i>0&&e.api.zoomIn(),t.preventDefault(),t.stopPropagation())}},handleDocumentKeyDown:function(t){var e=this;if(e.api){var i=t.keyCode;if((t.ctrlKey||t.metaKey)&&!t.shiftKey&&!t.altKey){if(i===Common.UI.Keys.NUM_PLUS||i===Common.UI.Keys.EQUALITY||Common.Utils.isGecko&&i===Common.UI.Keys.EQUALITY_FF||Common.Utils.isOpera&&43==i)return e.api.zoomIn(),t.preventDefault(),t.stopPropagation(),!1;if(i===Common.UI.Keys.NUM_MINUS||i===Common.UI.Keys.MINUS||Common.Utils.isGecko&&i===Common.UI.Keys.MINUS_FF||Common.Utils.isOpera&&45==i)return e.api.zoomOut(),t.preventDefault(),t.stopPropagation(),!1;if(i===Common.UI.Keys.ZERO||i===Common.UI.Keys.NUM_ZERO)return e.api.zoom(100),t.preventDefault(),t.stopPropagation(),!1}e.documentHolder.currentMenu&&e.documentHolder.currentMenu.isVisible()&&(i!=Common.UI.Keys.UP&&i!=Common.UI.Keys.DOWN||$("ul.dropdown-menu",e.documentHolder.currentMenu.el).focus()),i==Common.UI.Keys.ESC&&(Common.UI.Menu.Manager.hideAll(),Common.UI.HintManager.isHintVisible()||Common.NotificationCenter.trigger("leftmenu:change","hide"))}},onDocumentHolderResize:function(t){var e=this;e._XY=[e.documentHolder.cmpEl.offset().left-$(window).scrollLeft(),e.documentHolder.cmpEl.offset().top-$(window).scrollTop()],e._Height=e.documentHolder.cmpEl.height(),e._Width=e.documentHolder.cmpEl.width(),e._BodyWidth=$("body").width()},onAfterRender:function(t){var e,i,n,o=this,s=o.documentHolder.cmpEl;if(s){s.on("contextmenu",(function(t){return t.preventDefault(),t.stopPropagation(),!1})),s.on("click",(function(t){"canvas"==t.target.localName&&(o._preventClick?o._preventClick=!1:s.focus())})),s.on("mousedown",(function(t){"canvas"==t.target.localName&&Common.UI.Menu.Manager.hideAll()}));var a=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";e=o.documentHolder.el,i=a,n=_.bind(o.handleDocumentWheel,o),e.addEventListener?e.addEventListener(i,n,!1):e.attachEvent("on"+i,n)}Common.Utils.isChrome?document.addEventListener("mousewheel",_.bind(o.handleDocumentWheel,o),{passive:!1}):$(document).on("mousewheel",_.bind(o.handleDocumentWheel,o)),$(document).on("keydown",_.bind(o.handleDocumentKeyDown,o)),$(window).on("resize",_.bind(o.onDocumentHolderResize,o)),o.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind(o.onDocumentHolderResize,o))},getUserName:function(t){var e=PDFE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return AscCommon.UserInfoParser.getParsedName(i.get("username"))}return this.documentHolder.guestText},isUserVisible:function(t){var e=PDFE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return!i.get("hidden")}return!0},userTipMousover:function(t,e,i){var n=this;!0===n.userTooltip&&(n.userTooltip=new Common.UI.Tooltip({owner:t.currentTarget,title:n.documentHolder.tipIsLocked}),n.userTooltip.show())},userTipHide:function(){var t=this;if("object"==typeof t.userTooltip){t.userTooltip.hide(),t.userTooltip=void 0;for(var e=0;e<t.usertips.length;e++)t.usertips[e].off("mouseover",t.wrapEvents.userTipMousover),t.usertips[e].off("mouseout",t.wrapEvents.userTipMousout)}},userTipMousout:function(t,e,i){var n=this;"object"==typeof n.userTooltip&&n.userTooltip.$element&&t.currentTarget===n.userTooltip.$element[0]&&n.userTipHide()},hideTips:function(){var t=this;"object"==typeof t.userTooltip&&(t.userTooltip.hide(),t.userTooltip=!0),_.each(t.usertips,(function(t){t.remove()})),t.usertips=[],t.usertipcount=0},onHyperlinkClick:function(t){if(t){var e=this.api.asc_getUrlType(t);e===AscCommon.c_oAscUrlType.Http||e===AscCommon.c_oAscUrlType.Email?window.open(t):Common.UI.warning({msg:this.documentHolder.txtWarnUrl,buttons:["yes","no"],primary:"yes",callback:function(e){"yes"==e&&window.open(t)}})}},onShowForeignCursorLabel:function(t,e,i,n){if(this.isUserVisible(t)){for(var o,s=this,a=0;a<s.fastcoauthtips.length;a++)if(s.fastcoauthtips[a].attr("userid")==t){o=s.fastcoauthtips[a];break}o||((o=$(document.createElement("div"))).addClass("username-tip"),o.attr("userid",t),o.css({height:s._TtHeight+"px",position:"absolute",zIndex:"900",display:"none","pointer-events":"none","background-color":"#"+Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b())}),o.text(s.getUserName(t)),$("#id_main_view").append(o),s.fastcoauthtips.push(o),o.fadeIn(150)),o.css({top:i-s._TtHeight+"px",left:e+"px"})}},onHideForeignCursorLabel:function(t){for(var e=this,i=0;i<e.fastcoauthtips.length;i++)if(e.fastcoauthtips[i].attr("userid")==t){var n=e.fastcoauthtips[i];e.fastcoauthtips[i].fadeOut(150,(function(){n.remove()})),e.fastcoauthtips.splice(i,1);break}},hideEyedropper:function(){this.eyedropperTip.isVisible&&(this.eyedropperTip.isVisible=!1,this.eyedropperTip.eyedropperColor.css({left:"-1000px",top:"-1000px"})),this.eyedropperTip.isTipVisible&&(this.eyedropperTip.isTipVisible=!1,this.eyedropperTip.toolTip.hide())},onMouseMoveStart:function(){var t=this;t.screenTip.isHidden=!0,t.usertips.length>0&&("object"==typeof t.userTooltip&&(t.userTooltip.hide(),t.userTooltip=!0),_.each(t.usertips,(function(t){t.remove()}))),t.usertips=[],t.usertipcount=0},onMouseMoveEnd:function(){var t=this;t.screenTip.isHidden&&t.screenTip.isVisible&&(t.screenTip.isVisible=!1,t.isTooltipHiding=!0,t.screenTip.toolTip.hide((function(){t.isTooltipHiding=!1,t.mouseMoveData&&t.onMouseMove(t.mouseMoveData),t.mouseMoveData=null}))),t.eyedropperTip.isHidden&&t.hideEyedropper()},onMouseMove:function(t){var e=this,i=e.documentHolder.cmpEl,n=e.screenTip;if(void 0===e._XY&&(e._XY=[i.offset().left-$(window).scrollLeft(),i.offset().top-$(window).scrollTop()],e._Height=i.height(),e._Width=i.width(),e._BodyWidth=$("body").width()),t){var o,s,a=t.get_Type();if(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink||a==Asc.c_oAscMouseMoveDataTypes.Eyedropper){if(e.isTooltipHiding)return void(e.mouseMoveData=t);if(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink){var r=t.get_Hyperlink();if(!r)return;(s=_.isEmpty(r.get_ToolTip())?r.get_Value():r.get_ToolTip()).length>256&&(s=s.substr(0,256)+"...")}else if(a==Asc.c_oAscMouseMoveDataTypes.Eyedropper){e.eyedropperTip.isTipVisible&&(e.eyedropperTip.isTipVisible=!1,e.eyedropperTip.toolTip.hide());var l=t.get_EyedropperColor().asc_getColor(),c=l.get_r(),d=l.get_g(),h=l.get_b(),m=Common.Utils.ThemeColor.getHexColor(c,d,h);if(!e.eyedropperTip.eyedropperColor){var u=$(document.createElement("div"));u.addClass("eyedropper-color"),u.appendTo(document.body),e.eyedropperTip.eyedropperColor=u,$("#id_main_view").on("mouseleave",_.bind(e.hideEyedropper,e))}return e.eyedropperTip.eyedropperColor.css({backgroundColor:"#"+m,left:t.get_X()+e._XY[0]+23+"px",top:t.get_Y()+e._XY[1]-53+"px"}),e.eyedropperTip.isVisible=!0,e.eyedropperTip.tipInterval&&clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.tipInterval=setInterval((function(){clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.isVisible&&(s="<div>RGB("+c+","+d+","+h+")</div><div>"+t.get_EyedropperColor().asc_getName()+"</div>",e.eyedropperTip.toolTip.setTitle(s),e.eyedropperTip.isTipVisible=!0,e.eyedropperTip.toolTip.show([-1e4,-1e4]),e.eyedropperTip.tipWidth=e.eyedropperTip.toolTip.getBSTip().$tip.width(),(o=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-57,o[0]+=e._XY[0]+58,o[0]+e.eyedropperTip.tipWidth>e._BodyWidth&&(o[0]=o[0]-e.eyedropperTip.tipWidth-40),e.eyedropperTip.toolTip.getBSTip().$tip.css({top:o[1]+"px",left:o[0]+"px"}))}),800),void(e.eyedropperTip.isHidden=!1)}var p=!1;n.isHidden=!1,s=Common.Utils.String.htmlEncode(s),(n.tipType!==a||n.tipLength!==s.length||n.strTip.indexOf(s)<0)&&(n.toolTip.setTitle(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink?s+"<br><b>"+Common.Utils.String.platformKey("Ctrl",e.documentHolder.txtPressLink)+"</b>":s),n.tipLength=s.length,n.strTip=s,n.tipType=a,p=!0),(o=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-15,o[0]+=e._XY[0]+5,n.isVisible&&!p||(n.isVisible=!0,n.toolTip.show([-1e4,-1e4])),p&&(n.tipHeight=n.toolTip.getBSTip().$tip.height(),n.tipWidth=n.toolTip.getBSTip().$tip.width()),p=!1,o[0]+n.tipWidth>e._BodyWidth&&(o[0]=e._BodyWidth-n.tipWidth,p=!0),o[1]-n.tipHeight<0?o[1]=p?o[1]+30:0:o[1]-=n.tipHeight,n.toolTip.getBSTip().$tip.css({top:o[1]+"px",left:o[0]+"px"})}else if(t.get_Type()==Asc.c_oAscMouseMoveDataTypes.LockedObject&&e.mode.isEdit&&e.isUserVisible(t.get_UserId())){var f;e.usertipcount>=e.usertips.length&&((f=$(document.createElement("div"))).addClass("username-tip"),f.css({height:e._TtHeight+"px",position:"absolute",zIndex:"900",visibility:"visible"}),$(document.body).append(f),e.userTooltip&&(f.on("mouseover",e.wrapEvents.userTipMousover),f.on("mouseout",e.wrapEvents.userTipMousout)),e.usertips.push(f)),f=e.usertips[e.usertipcount],e.usertipcount++,s=e.getUserName(t.get_UserId());var g=(o=[t.get_X()+e._XY[0],t.get_Y()+e._XY[1]])[0];o[0]=e._BodyWidth-o[0],o[1]-=2==t.get_LockedObjectType()?e._TtHeight:0,o[1]>e._XY[1]&&o[1]+e._TtHeight<e._XY[1]+e._Height?(f.text(s),f.css({visibility:"visible",top:o[1]+"px",right:o[0]+"px","max-width":g+"px"})):f.css({visibility:"hidden"})}}},onCoAuthoringDisconnect:function(){this.mode.isEdit=!1},SetDisabled:function(t,e,i){this._isDisabled=t,this.documentHolder.SetDisabled(t,e,i)},changePosition:function(){var t=this,e=t.documentHolder.cmpEl;t._XY=[e.offset().left-$(window).scrollLeft(),e.offset().top-$(window).scrollTop()],t._Height=e.height(),t._Width=e.width(),t._BodyWidth=$("body").width(),t.onMouseMoveStart()},addComment:function(t,e,i){if(this.api&&this.mode.canCoAuthoring&&this.mode.canComments){this.documentHolder.suppressEditComplete=!0;var n=PDFE.getController("Common.Controllers.Comments");n&&n.addDummyComment()}},onCutCopyPaste:function(t,e){var i=this;i.api&&(("cut"==t.value?i.api.Cut():"copy"==t.value?i.api.Copy():i.api.Paste())||Common.localStorage.getBool("pdfe-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("pdfe-hide-copywarning",1),i.editComplete()}}).show());i.editComplete()},onUndo:function(){this.api.Undo()},onPrintSelection:function(t){if(this.api){var e=new Asc.asc_CAdjustPrint;e.asc_setPrintType(Asc.c_oAscPrintType.Selection);var i=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86);i.asc_setAdvancedOptions(e),this.api.asc_Print(i),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Print Selection")}},onSignatureClick:function(t){var e=t.cmpEl.attr("data-value");switch(t.value){case 0:Common.NotificationCenter.trigger("protect:sign",e);break;case 1:this.api.asc_ViewCertificate(e);break;case 2:var i=this.documentHolder._docProtection;Common.NotificationCenter.trigger("protect:signature","visible",this._isDisabled||i.isReadOnly||i.isFormsOnly||i.isCommentsOnly,e);break;case 3:var n=this;Common.UI.warning({title:this.documentHolder.notcriticalErrorTitle,msg:this.documentHolder.txtRemoveWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&n.api.asc_RemoveSignature(e)}})}},saveAsPicture:function(){this.api&&this.api.asc_SaveDrawingAsPicture()},onPluginContextMenu:function(t){t&&t.length>0&&this.documentHolder&&this.documentHolder.currentMenu&&this.documentHolder.currentMenu.isVisible()&&this.documentHolder.updateCustomItems(this.documentHolder.currentMenu,t)},onShowFormsPDFActions:function(t,e,i){if(t.type===AscPDF.FIELD_TYPES.combobox)this.onShowListActionsPDF(t,e,i)},onShowListActionsPDF:function(t){var e=this.documentHolder.cmpEl,i=this.listControlMenu,n=i?e.find(Common.Utils.String.format("#menu-container-{0}",i.id)):null,o=this;o._listObj=t,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),i||(this.listControlMenu=i=new Common.UI.Menu({maxHeight:207,menuAlign:"tr-bl",items:[]}),i.on("item:click",(function(t,e){setTimeout((function(){-1!==e.value&&o.api.asc_SelectPDFFormListItem(e.value)}),1)})),(!n||n.length<1)&&(n=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',i.id)),e.append(n)),i.render(n),i.cmpEl.attr({tabindex:"-1"}),i.on("hide:after",(function(){o.listControlMenu.removeAll(),o._fromShowContentControls||o.api.asc_UncheckContentControlButtons()})));for(var s=t.getOptions(),a=s.length,r=0;r<a;r++)i.addItem(new Common.UI.MenuItem({caption:Array.isArray(s[r])?s[r][0]:s[r],value:r,template:_.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}));var l=t.getPagePos(),c=AscPDF.GetGlobalCoordsByPageCoords(l.x+l.w,l.y+l.h,t.getPage(),!0);n.css({left:c.X,top:c.Y}),n.attr("data-value","prevent-canvas-click"),this._preventClick=!0,i.show(),_.delay((function(){i.cmpEl.focus()}),10),this._fromShowContentControls=!1},editComplete:function(){this.documentHolder&&this.documentHolder.fireEvent("editcomplete",this.documentHolder)}})})),void 0===Common)var Common={};if(void 0===Common.define&&(Common.define={}),define("common/main/lib/util/define",[],(function(){"use strict";Common.define.c_oAscMathMainType={Symbol:0,Fraction:1,Script:2,Radical:3,Integral:4,LargeOperator:5,Bracket:6,Function:7,Accent:8,LimitLog:9,Operator:10,Matrix:11},Common.define.c_oAscMathType={Symbol_pm:0,Symbol_infinity:1,Symbol_equals:2,Symbol_neq:3,Symbol_about:4,Symbol_times:5,Symbol_div:6,Symbol_factorial:7,Symbol_propto:8,Symbol_less:9,Symbol_ll:10,Symbol_greater:11,Symbol_gg:12,Symbol_leq:13,Symbol_geq:14,Symbol_mp:15,Symbol_cong:16,Symbol_approx:17,Symbol_equiv:18,Symbol_forall:19,Symbol_additional:20,Symbol_partial:21,Symbol_sqrt:22,Symbol_cbrt:23,Symbol_qdrt:24,Symbol_cup:25,Symbol_cap:26,Symbol_emptyset:27,Symbol_percent:28,Symbol_degree:29,Symbol_fahrenheit:30,Symbol_celsius:31,Symbol_inc:32,Symbol_nabla:33,Symbol_exists:34,Symbol_notexists:35,Symbol_in:36,Symbol_ni:37,Symbol_leftarrow:38,Symbol_uparrow:39,Symbol_rightarrow:40,Symbol_downarrow:41,Symbol_leftrightarrow:42,Symbol_therefore:43,Symbol_plus:44,Symbol_minus:45,Symbol_not:46,Symbol_ast:47,Symbol_bullet:48,Symbol_vdots:49,Symbol_cdots:50,Symbol_rddots:51,Symbol_ddots:52,Symbol_aleph:53,Symbol_beth:54,Symbol_QED:55,Symbol_alpha:65536,Symbol_beta:65537,Symbol_gamma:65538,Symbol_delta:65539,Symbol_varepsilon:65540,Symbol_epsilon:65541,Symbol_zeta:65542,Symbol_eta:65543,Symbol_theta:65544,Symbol_vartheta:65545,Symbol_iota:65546,Symbol_kappa:65547,Symbol_lambda:65548,Symbol_mu:65549,Symbol_nu:65550,Symbol_xsi:65551,Symbol_o:65552,Symbol_pi:65553,Symbol_varpi:65554,Symbol_rho:65555,Symbol_varrho:65556,Symbol_sigma:65557,Symbol_varsigma:65558,Symbol_tau:65559,Symbol_upsilon:65560,Symbol_varphi:65561,Symbol_phi:65562,Symbol_chi:65563,Symbol_psi:65564,Symbol_omega:65565,Symbol_Alpha:131072,Symbol_Beta:131073,Symbol_Gamma:131074,Symbol_Delta:131075,Symbol_Epsilon:131076,Symbol_Zeta:131077,Symbol_Eta:131078,Symbol_Theta:131079,Symbol_Iota:131080,Symbol_Kappa:131081,Symbol_Lambda:131082,Symbol_Mu:131083,Symbol_Nu:131084,Symbol_Xsi:131085,Symbol_O:131086,Symbol_Pi:131087,Symbol_Rho:131088,Symbol_Sigma:131089,Symbol_Tau:131090,Symbol_Upsilon:131091,Symbol_Phi:131092,Symbol_Chi:131093,Symbol_Psi:131094,Symbol_Omega:131095,FractionVertical:16777216,FractionDiagonal:16777217,FractionHorizontal:16777218,FractionSmall:16777219,FractionDifferential_1:16842752,FractionDifferential_2:16842753,FractionDifferential_3:16842754,FractionDifferential_4:16842755,FractionPi_2:16842756,ScriptSup:33554432,ScriptSub:33554433,ScriptSubSup:33554434,ScriptSubSupLeft:33554435,ScriptCustom_1:33619968,ScriptCustom_2:33619969,ScriptCustom_3:33619970,ScriptCustom_4:33619971,RadicalSqrt:50331648,RadicalRoot_n:50331649,RadicalRoot_2:50331650,RadicalRoot_3:50331651,RadicalCustom_1:50397184,RadicalCustom_2:50397185,Integral:67108864,IntegralSubSup:67108865,IntegralCenterSubSup:67108866,IntegralDouble:67108867,IntegralDoubleSubSup:67108868,IntegralDoubleCenterSubSup:67108869,IntegralTriple:67108870,IntegralTripleSubSup:67108871,IntegralTripleCenterSubSup:67108872,IntegralOriented:67174400,IntegralOrientedSubSup:67174401,IntegralOrientedCenterSubSup:67174402,IntegralOrientedDouble:67174403,IntegralOrientedDoubleSubSup:67174404,IntegralOrientedDoubleCenterSubSup:67174405,IntegralOrientedTriple:67174406,IntegralOrientedTripleSubSup:67174407,IntegralOrientedTripleCenterSubSup:67174408,Integral_dx:67239936,Integral_dy:67239937,Integral_dtheta:67239938,LargeOperator_Sum:83886080,LargeOperator_Sum_CenterSubSup:83886081,LargeOperator_Sum_SubSup:83886082,LargeOperator_Sum_CenterSub:83886083,LargeOperator_Sum_Sub:83886084,LargeOperator_Prod:83951616,LargeOperator_Prod_CenterSubSup:83951617,LargeOperator_Prod_SubSup:83951618,LargeOperator_Prod_CenterSub:83951619,LargeOperator_Prod_Sub:83951620,LargeOperator_CoProd:83951621,LargeOperator_CoProd_CenterSubSup:83951622,LargeOperator_CoProd_SubSup:83951623,LargeOperator_CoProd_CenterSub:83951624,LargeOperator_CoProd_Sub:83951625,LargeOperator_Union:84017152,LargeOperator_Union_CenterSubSup:84017153,LargeOperator_Union_SubSup:84017154,LargeOperator_Union_CenterSub:84017155,LargeOperator_Union_Sub:84017156,LargeOperator_Intersection:84017157,LargeOperator_Intersection_CenterSubSup:84017158,LargeOperator_Intersection_SubSup:84017159,LargeOperator_Intersection_CenterSub:84017160,LargeOperator_Intersection_Sub:84017161,LargeOperator_Disjunction:84082688,LargeOperator_Disjunction_CenterSubSup:84082689,LargeOperator_Disjunction_SubSup:84082690,LargeOperator_Disjunction_CenterSub:84082691,LargeOperator_Disjunction_Sub:84082692,LargeOperator_Conjunction:84082693,LargeOperator_Conjunction_CenterSubSup:84082694,LargeOperator_Conjunction_SubSup:84082695,LargeOperator_Conjunction_CenterSub:84082696,LargeOperator_Conjunction_Sub:84082697,LargeOperator_Custom_1:84148224,LargeOperator_Custom_2:84148225,LargeOperator_Custom_3:84148226,LargeOperator_Custom_4:84148227,LargeOperator_Custom_5:84148228,Bracket_Round:100663296,Bracket_Square:100663297,Bracket_Curve:100663298,Bracket_Angle:100663299,Bracket_LowLim:100663300,Bracket_UppLim:100663301,Bracket_Line:100663302,Bracket_LineDouble:100663303,Bracket_Square_OpenOpen:100663304,Bracket_Square_CloseClose:100663305,Bracket_Square_CloseOpen:100663306,Bracket_SquareDouble:100663307,Bracket_Round_Delimiter_2:100728832,Bracket_Curve_Delimiter_2:100728833,Bracket_Angle_Delimiter_2:100728834,Bracket_Angle_Delimiter_3:100728835,Bracket_Round_OpenNone:100794368,Bracket_Round_NoneOpen:100794369,Bracket_Square_OpenNone:100794370,Bracket_Square_NoneOpen:100794371,Bracket_Curve_OpenNone:100794372,Bracket_Curve_NoneOpen:100794373,Bracket_Angle_OpenNone:100794374,Bracket_Angle_NoneOpen:100794375,Bracket_LowLim_OpenNone:100794376,Bracket_LowLim_NoneNone:100794377,Bracket_UppLim_OpenNone:100794378,Bracket_UppLim_NoneOpen:100794379,Bracket_Line_OpenNone:100794380,Bracket_Line_NoneOpen:100794381,Bracket_LineDouble_OpenNone:100794382,Bracket_LineDouble_NoneOpen:100794383,Bracket_SquareDouble_OpenNone:100794384,Bracket_SquareDouble_NoneOpen:100794385,Bracket_Custom_1:100859904,Bracket_Custom_2:100859905,Bracket_Custom_3:100859906,Bracket_Custom_4:100859907,Bracket_Custom_5:100925440,Bracket_Custom_6:100925441,Bracket_Custom_7:100925442,Function_Sin:117440512,Function_Cos:117440513,Function_Tan:117440514,Function_Csc:117440515,Function_Sec:117440516,Function_Cot:117440517,Function_1_Sin:117506048,Function_1_Cos:117506049,Function_1_Tan:117506050,Function_1_Csc:117506051,Function_1_Sec:117506052,Function_1_Cot:117506053,Function_Sinh:117571584,Function_Cosh:117571585,Function_Tanh:117571586,Function_Csch:117571587,Function_Sech:117571588,Function_Coth:117571589,Function_1_Sinh:117637120,Function_1_Cosh:117637121,Function_1_Tanh:117637122,Function_1_Csch:117637123,Function_1_Sech:117637124,Function_1_Coth:117637125,Function_Custom_1:117702656,Function_Custom_2:117702657,Function_Custom_3:117702658,Accent_Dot:134217728,Accent_DDot:134217729,Accent_DDDot:134217730,Accent_Hat:134217731,Accent_Check:134217732,Accent_Accent:134217733,Accent_Grave:134217734,Accent_Smile:134217735,Accent_Tilde:134217736,Accent_Bar:134217737,Accent_DoubleBar:134217738,Accent_CurveBracketTop:134217739,Accent_CurveBracketBot:134217740,Accent_GroupTop:134217741,Accent_GroupBot:134217742,Accent_ArrowL:134217743,Accent_ArrowR:134217744,Accent_ArrowD:134217745,Accent_HarpoonL:134217746,Accent_HarpoonR:134217747,Accent_BorderBox:134283264,Accent_BorderBoxCustom:134283265,Accent_BarTop:134348800,Accent_BarBot:134348801,Accent_Custom_1:134414336,Accent_Custom_2:134414337,Accent_Custom_3:134414338,LimitLog_LogBase:150994944,LimitLog_Log:150994945,LimitLog_Lim:150994946,LimitLog_Min:150994947,LimitLog_Max:150994948,LimitLog_Ln:150994949,LimitLog_Custom_1:151060480,LimitLog_Custom_2:151060481,Operator_ColonEquals:167772160,Operator_EqualsEquals:167772161,Operator_PlusEquals:167772162,Operator_MinusEquals:167772163,Operator_Definition:167772164,Operator_UnitOfMeasure:167772165,Operator_DeltaEquals:167772166,Operator_ArrowL_Top:167837696,Operator_ArrowR_Top:167837697,Operator_ArrowL_Bot:167837698,Operator_ArrowR_Bot:167837699,Operator_DoubleArrowL_Top:167837700,Operator_DoubleArrowR_Top:167837701,Operator_DoubleArrowL_Bot:167837702,Operator_DoubleArrowR_Bot:167837703,Operator_ArrowD_Top:167837704,Operator_ArrowD_Bot:167837705,Operator_DoubleArrowD_Top:167837706,Operator_DoubleArrowD_Bot:167837707,Operator_Custom_1:167903232,Operator_Custom_2:167903233,Matrix_1_2:184549376,Matrix_2_1:184549377,Matrix_1_3:184549378,Matrix_3_1:184549379,Matrix_2_2:184549380,Matrix_2_3:184549381,Matrix_3_2:184549382,Matrix_3_3:184549383,Matrix_Dots_Center:184614912,Matrix_Dots_Baseline:184614913,Matrix_Dots_Vertical:184614914,Matrix_Dots_Diagonal:184614915,Matrix_Identity_2:184680448,Matrix_Identity_2_NoZeros:184680449,Matrix_Identity_3:184680450,Matrix_Identity_3_NoZeros:184680451,Matrix_2_2_RoundBracket:184745984,Matrix_2_2_SquareBracket:184745985,Matrix_2_2_LineBracket:184745986,Matrix_2_2_DLineBracket:184745987,Matrix_Flat_Round:184811520,Matrix_Flat_Square:184811521},Common.define.chartData=_.extend(new function(){return{textLine:"Line",textColumn:"Column",textBar:"Bar",textArea:"Area",textPie:"Pie",textPoint:"XY (Scatter)",textStock:"Stock",textSurface:"Surface",textCharts:"Charts",textSparks:"Sparklines",textLineSpark:"Line",textColumnSpark:"Column",textWinLossSpark:"Win/Loss",textCombo:"Combo",textBarNormal:"Clustered column",textBarStacked:"Stacked column",textBarStackedPer:"100% Stacked column",textBarNormal3d:"3-D Clustered column",textBarStacked3d:"3-D Stacked column",textBarStackedPer3d:"3-D 100% Stacked column",textBarNormal3dPerspective:"3-D column",textLineStacked:"Stacked line",textLineStackedPer:"100% Stacked line",textLineMarker:"Line with markers",textLineStackedMarker:"Stacked line with markers",textLineStackedPerMarker:"100% Stacked line with markers",textLine3d:"3-D line",textDoughnut:"Doughnut",textPie3d:"3-D pie",textHBarNormal:"Clustered bar",textHBarStacked:"Stacked bar",textHBarStackedPer:"100% Stacked bar",textHBarNormal3d:"3-D Clustered bar",textHBarStacked3d:"3-D Stacked bar",textHBarStackedPer3d:"3-D 100% Stacked bar",textAreaStacked:"Stacked area",textAreaStackedPer:"100% Stacked area",textScatter:"Scatter",textScatterSmoothMarker:"Scatter with smooth lines and markers",textScatterSmooth:"Scatter with smooth lines",textScatterLineMarker:"Scatter with straight lines and markers",textScatterLine:"Scatter with straight lines",textComboBarLine:"Clustered column - line",textComboBarLineSecondary:"Clustered column - line on secondary axis",textComboAreaBar:"Stacked area - clustered column",textComboCustom:"Custom combination",textRadar:"Radar",textRadarMarker:"Radar with markers",textRadarFilled:"Filled radar",getChartGroupData:function(t){return[{id:"menu-chart-group-bar",caption:this.textColumn,headername:t?this.textCharts:void 0},{id:"menu-chart-group-line",caption:this.textLine},{id:"menu-chart-group-pie",caption:this.textPie},{id:"menu-chart-group-hbar",caption:this.textBar},{id:"menu-chart-group-area",caption:this.textArea,inline:!0},{id:"menu-chart-group-stock",caption:this.textStock,inline:!0},{id:"menu-chart-group-scatter",caption:this.textPoint},{id:"menu-chart-group-radar",caption:this.textRadar},{id:"menu-chart-group-combo",caption:this.textCombo}]},getChartData:function(){return[{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal,iconCls:"column-normal",tip:this.textBarNormal},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked,iconCls:"column-stack",tip:this.textBarStacked},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer,iconCls:"column-pstack",tip:this.textBarStackedPer},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3d,iconCls:"column-3d-normal",tip:this.textBarNormal3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked3d,iconCls:"column-3d-stack",tip:this.textBarStacked3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer3d,iconCls:"column-3d-pstack",tip:this.textBarStackedPer3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3dPerspective,iconCls:"column-3d-normal-per",tip:this.textBarNormal3dPerspective,is3d:!0},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormal,iconCls:"line-normal",tip:this.textLine},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStacked,iconCls:"line-stack",tip:this.textLineStacked},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPer,iconCls:"line-pstack",tip:this.textLineStackedPer},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormalMarker,iconCls:"line-normal-marker",tip:this.textLineMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedMarker,iconCls:"line-stack-marker",tip:this.textLineStackedMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPerMarker,iconCls:"line-pstack-marker",tip:this.textLineStackedPerMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.line3d,iconCls:"line-3d",tip:this.textLine3d,is3d:!0},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie,iconCls:"pie-normal",tip:this.textPie},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.doughnut,iconCls:"pie-doughnut",tip:this.textDoughnut},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie3d,iconCls:"pie-3d-normal",tip:this.textPie3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal,iconCls:"bar-normal",tip:this.textHBarNormal},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked,iconCls:"bar-stack",tip:this.textHBarStacked},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer,iconCls:"bar-pstack",tip:this.textHBarStackedPer},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal3d,iconCls:"bar-3d-normal",tip:this.textHBarNormal3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked3d,iconCls:"bar-3d-stack",tip:this.textHBarStacked3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer3d,iconCls:"bar-3d-pstack",tip:this.textHBarStackedPer3d,is3d:!0},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaNormal,iconCls:"area-normal",tip:this.textArea},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStacked,iconCls:"area-stack",tip:this.textAreaStacked},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStackedPer,iconCls:"area-pstack",tip:this.textAreaStackedPer},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatter,iconCls:"point-normal",tip:this.textScatter},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmoothMarker,iconCls:"point-smooth-marker",tip:this.textScatterSmoothMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmooth,iconCls:"point-smooth",tip:this.textScatterSmooth},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLineMarker,iconCls:"point-line-marker",tip:this.textScatterLineMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLine,iconCls:"point-line",tip:this.textScatterLine},{group:"menu-chart-group-stock",type:Asc.c_oAscChartTypeSettings.stock,iconCls:"stock-normal",tip:this.textStock},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radar,iconCls:"radar",tip:this.textRadar},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarMarker,iconCls:"radar-with-markers",tip:this.textRadarMarker},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarFilled,iconCls:"filled-radar",tip:this.textRadarFilled},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLine,iconCls:"combo-bar-line",tip:this.textComboBarLine},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLineSecondary,iconCls:"combo-bar-line-sec",tip:this.textComboBarLineSecondary},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboAreaBar,iconCls:"combo-area-bar",tip:this.textComboAreaBar},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboCustom,iconCls:"combo-custom",tip:this.textComboCustom}]},getSparkGroupData:function(t){return[{id:"menu-chart-group-sparkcolumn",inline:!0,headername:t?this.textSparks:void 0},{id:"menu-chart-group-sparkline",inline:!0},{id:"menu-chart-group-sparkwin",inline:!0}]},getSparkData:function(){return[{group:"menu-chart-group-sparkcolumn",type:Asc.c_oAscSparklineType.Column,allowSelected:!0,iconCls:"spark-column",tip:this.textColumnSpark},{group:"menu-chart-group-sparkline",type:Asc.c_oAscSparklineType.Line,allowSelected:!0,iconCls:"spark-line",tip:this.textLineSpark},{group:"menu-chart-group-sparkwin",type:Asc.c_oAscSparklineType.Stacked,allowSelected:!0,iconCls:"spark-win",tip:this.textWinLossSpark}]}}},Common.define.chartData||{}),Common.define.conditionalData=_.extend(new function(){return{textDate:"Date",textYesterday:"Yesterday",textToday:"Today",textTomorrow:"Tomorrow",textLast7days:"In the last 7 days",textLastWeek:"Last week",textThisWeek:"This week",textNextWeek:"Next week",textLastMonth:"Last month",textThisMonth:"This month",textNextMonth:"Next month",textText:"Text",textContains:"Contains",textNotContains:"Does not contain",textBegins:"Begins with",textEnds:"Ends with",textAverage:"Average",textAbove:"Above",textBelow:"Below",textEqAbove:"Equal to or above",textEqBelow:"Equal to or below",text1Above:"1 std dev above",text1Below:"1 std dev below",text2Above:"2 std dev above",text2Below:"2 std dev below",text3Above:"3 std dev above",text3Below:"3 std dev below",textGreater:"Greater than",textGreaterEq:"Greater than or equal to",textLess:"Less than",textLessEq:"Less than or equal to",textEqual:"Equal to",textNotEqual:"Not equal to",textBetween:"Between",textNotBetween:"Not between",textTop:"Top",textBottom:"Bottom",textBlank:"Blank",textError:"Error",textBlanks:"Contains blanks",textNotBlanks:"Does not contain blanks",textErrors:"Contains errors",textNotErrors:"Does not contain errors",textDuplicate:"Duplicate",textUnique:"Unique",textDataBar:"Data bar",textIconSets:"Icon sets",textFormula:"Formula",exampleText:"AaBbCcYyZz",noFormatText:"No format set",textValue:"Value is"}},Common.define.conditionalData||{}),Common.define.smartArt=_.extend(new function(){return{textList:"List",textProcess:"Process",textCycle:"Cycle",textHierarchy:"Hierarchy",textRelationship:"Relationship",textMatrix:"Matrix",textPyramid:"Pyramid",textPicture:"Picture",textBasicBlockList:"Basic Block List",textAlternatingHexagons:"Alternating Hexagons",textPictureCaptionList:"Picture Caption List",textLinedList:"Lined List",textVerticalBulletList:"Vertical Bullet List",textVerticalBoxList:"Vertical Box List",textHorizontalBulletList:"Horizontal Bullet List",textSquareAccentList:"Square Accent List",textPictureAccentList:"Picture Accent List",textBendingPictureAccentList:"Bending Picture Accent List",textStackedList:"Stacked List",textIncreasingCircleProcess:"Increasing Circle Process",textPieProcess:"Pie Process",textDetailedProcess:"Detailed Process",textGroupedList:"Grouped List",textHorizontalPictureList:"Horizontal Picture List",textContinuousPictureList:"Continuous Picture List",textPictureStrips:"Picture Strips",textVerticalPictureList:"Vertical Picture List",textAlternatingPictureBlocks:"Alternating Picture Blocks",textVerticalPictureAccentList:"Vertical Picture Accent List",textTitledPictureAccentList:"Titled Picture Accent List",textVerticalBlockList:"Vertical Block List",textVerticalChevronList:"Vertical Chevron List",textVerticalAccentList:"Vertical Accent List",textVerticalArrowList:"Vertical Arrow List",textTrapezoidList:"Trapezoid List",textDescendingBlockList:"Descending Block List",textTableList:"Table List",textSegmentedProcess:"Segmented Process",textVerticalCurvedList:"Vertical Curved List",textPyramidList:"Pyramid List",textTargetList:"Target List",textHierarchyList:"Hierarchy List",textVerticalCircleList:"Vertical Circle List",textTableHierarchy:"Table Hierarchy",textBasicProcess:"Basic Process",textStepUpProcess:"Step Up Process",textStepDownProcess:"Step Down Process",textAccentProcess:"Accent Process",textPictureAccentProcess:"Picture Accent Process",textAlternatingFlow:"Alternating Flow",textContinuousBlockProcess:"Continuous Block Process",textIncreasingArrowProcess:"Increasing Arrow Process",textContinuousArrowProcess:"Continuous Arrow Process",textProcessArrows:"Process Arrows",textCircleAccentTimeline:"Circle Accent Timeline",textBasicTimeline:"Basic Timeline",textBasicChevronProcess:"Basic Chevron Process",textClosedChevronProcess:"Closed Chevron Process",textChevronList:"Chevron List",textSubStepProcess:"Sub-Step Process",textPhasedProcess:"Phased Process",textRandomToResultProcess:"Random to Result Process",textVerticalProcess:"Vertical Process",textStaggeredProcess:"Staggered Process",textProcessList:"Process List",textCircleArrowProcess:"Circle Arrow Process",textBasicBendingProcess:"Basic Bending Process",textRepeatingBendingProcess:"Repeating Bending Process",textVerticalBendingProcess:"Vertical Bending Process",textAscendingPictureAccentProcess:"Ascending Picture Accent Process",textUpwardArrow:"Upward Arrow",textDescendingProcess:"Descending Process",textCircularBendingProcess:"Circular Bending Process",textEquation:"Equation",textVerticalEquation:"Vertical Equation",textFunnel:"Funnel",textGear:"Gear",textArrowRibbon:"Arrow Ribbon",textOpposingArrows:"Opposing Arrows",textConvergingArrows:"Converging Arrows",textDivergingArrows:"Diverging Arrows",textBasicCycle:"Basic Cycle",textTextCycle:"Text Cycle",textBlockCycle:"Block Cycle",textNondirectionalCycle:"Nondirectional Cycle",textContinuousCycle:"Continuous Cycle",textMultidirectionalCycle:"Multidirectional Cycle",textSegmentedCycle:"Segmented Cycle",textBasicPie:"Basic Pie",textRadialCycle:"Radial Cycle",textBasicRadial:"Basic Radial",textDivergingRadial:"Diverging Radial",textRadialVenn:"Radial Venn",textCycleMatrix:"Cycle Matrix",textRadialCluster:"Radial Cluster",textOrganizationChart:"Organization Chart",textNameAndTitleOrganizationChart:"Name and Title Organization Chart",textHalfCircleOrganizationChart:"Half Circle Organization Chart",textCirclePictureHierarchy:"Circle Picture Hierarchy",textLabeledHierarchy:"Labeled Hierarchy",textHorizontalOrganizationChart:"Horizontal Organization Chart",textHorizontalMultiLevelHierarchy:"Horizontal Multi-Level Hierarchy",textHorizontalHierarchy:"Horizontal Hierarchy",textHorizontalLabeledHierarchy:"Horizontal Labeled Hierarchy",textBalance:"Balance",textCircleRelationship:"Circle Relationship",textHexagonCluster:"Hexagon Cluster",textOpposingIdeas:"Opposing Ideas",textPlusAndMinus:"Plus and Minus",textReverseList:"Reverse List",textCounterbalanceArrows:"Counterbalance Arrows",textSegmentedPyramid:"Segmented Pyramid",textNestedTarget:"Nested Target",textConvergingRadial:"Converging Radial",textRadialList:"Radial List",textBasicTarget:"Basic Target",textBasicVenn:"Basic Venn",textLinearVenn:"Linear Venn",textStackedVenn:"Stacked Venn",textBasicMatrix:"Basic Matrix",textTitledMatrix:"Titled Matrix",textGridMatrix:"Grid Matrix",textBasicPyramid:"Basic Pyramid",textInvertedPyramid:"Inverted Pyramid",textAccentedPicture:"Accented Picture",textCircularPictureCallout:"Circular Picture Callout",textSnapshotPictureList:"Snapshot Picture List",textSpiralPicture:"Spiral Picture",textCaptionedPictures:"Captioned Pictures",textBendingPictureCaption:"Bending Picture Caption",textBendingPictureSemiTranparentText:"Bending Picture Semi-Tranparent Text",textBendingPictureBlocks:"Bending Picture Blocks",textBendingPictureCaptionList:"Bending Picture Caption List",textTitledPictureBlocks:"Titled Picture Blocks",textPictureGrid:"Picture Grid",textPictureAccentBlocks:"Picture Accent Blocks",textAlternatingPictureCircles:"Alternating Picture Circles",textTitlePictureLineup:"Title Picture Lineup",textPictureLineup:"Picture Lineup",textFramedTextPicture:"Framed Text Picture",textBubblePictureList:"Bubble Picture List",textOther:"Other",textPictureOrganizationChart:"Picture Organization Chart",textChevronAccentProcess:"Chevron Accent Process",textRadialPictureList:"Radial Picture List",textVerticalBracketList:"Vertical Bracket List",textInterconnectedBlockProcess:"Interconnected Block Process",textTabbedArc:"Tabbed Arc",textThemePictureAccent:"Theme Picture Accent",textVaryingWidthList:"Varying Width List",textConvergingText:"Converging Text",textInterconnectedRings:"Interconnected Rings",textArchitectureLayout:"Architecture Layout",textThemePictureAlternatingAccent:"Theme Picture Alternating Accent",textThemePictureGrid:"Theme Picture Grid",textCircleProcess:"Circle Process",textHexagonRadial:"Hexagon Radial",textPictureFrame:"PictureFrame",textTabList:"Tab List",getSmartArtData:function(){return[{id:"menu-smart-art-group-list",sectionId:Asc.c_oAscSmartArtSectionNames.List,caption:this.textList,icon:"btn-smart-list",items:[{type:Asc.c_oAscSmartArtTypes.BasicBlockList,tip:this.textBasicBlockList},{type:Asc.c_oAscSmartArtTypes.AlternatingHexagonList,tip:this.textAlternatingHexagons},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList},{type:Asc.c_oAscSmartArtTypes.VerticalBulletList,tip:this.textVerticalBulletList},{type:Asc.c_oAscSmartArtTypes.VerticalBoxList,tip:this.textVerticalBoxList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList},{type:Asc.c_oAscSmartArtTypes.HorizontalBulletList,tip:this.textHorizontalBulletList},{type:Asc.c_oAscSmartArtTypes.SquareAccentList,tip:this.textSquareAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.StackedList,tip:this.textStackedList},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalBlockList,tip:this.textVerticalBlockList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalAccentList,tip:this.textVerticalAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.TrapezoidList,tip:this.textTrapezoidList},{type:Asc.c_oAscSmartArtTypes.DescendingBlockList,tip:this.textDescendingBlockList},{type:Asc.c_oAscSmartArtTypes.TableList,tip:this.textTableList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalCurvedList,tip:this.textVerticalCurvedList},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.VerticalCircleList,tip:this.textVerticalCircleList},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout}]},{id:"menu-smart-art-group-process",sectionId:Asc.c_oAscSmartArtSectionNames.Process,caption:this.textProcess,icon:"btn-smart-process",items:[{type:Asc.c_oAscSmartArtTypes.BasicProcess,tip:this.textBasicProcess},{type:Asc.c_oAscSmartArtTypes.StepUpProcess,tip:this.textStepUpProcess},{type:Asc.c_oAscSmartArtTypes.StepDownProcess,tip:this.textStepDownProcess},{type:Asc.c_oAscSmartArtTypes.AccentProcess,tip:this.textAccentProcess},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingFlow,tip:this.textAlternatingFlow},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousBlockProcess,tip:this.textContinuousBlockProcess},{type:Asc.c_oAscSmartArtTypes.IncreasingArrowsProcess,tip:this.textIncreasingArrowProcess},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousArrowProcess,tip:this.textContinuousArrowProcess},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.ProcessArrows,tip:this.textProcessArrows},{type:Asc.c_oAscSmartArtTypes.CircleAccentTimeline,tip:this.textCircleAccentTimeline},{type:Asc.c_oAscSmartArtTypes.BasicTimeline,tip:this.textBasicTimeline},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.BasicChevronProcess,tip:this.textBasicChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.ClosedChevronProcess,tip:this.textClosedChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronList,tip:this.textChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.SubStepProcess,tip:this.textSubStepProcess},{type:Asc.c_oAscSmartArtTypes.PhasedProcess,tip:this.textPhasedProcess},{type:Asc.c_oAscSmartArtTypes.RandomToResultProcess,tip:this.textRandomToResultProcess},{type:Asc.c_oAscSmartArtTypes.VerticalProcess,tip:this.textVerticalProcess},{type:Asc.c_oAscSmartArtTypes.StaggeredProcess,tip:this.textStaggeredProcess},{type:Asc.c_oAscSmartArtTypes.ProcessList,tip:this.textProcessList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess},{type:Asc.c_oAscSmartArtTypes.BasicBendingProcess,tip:this.textBasicBendingProcess},{type:Asc.c_oAscSmartArtTypes.RepeatingBendingProcess,tip:this.textRepeatingBendingProcess},{type:Asc.c_oAscSmartArtTypes.VerticalBendingProcess,tip:this.textVerticalBendingProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.UpwardArrow,tip:this.textUpwardArrow},{type:Asc.c_oAscSmartArtTypes.DescendingProcess,tip:this.textDescendingProcess},{type:Asc.c_oAscSmartArtTypes.CircularBendingProcess,tip:this.textCircularBendingProcess},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows}]},{id:"menu-smart-art-group-cycle",sectionId:Asc.c_oAscSmartArtSectionNames.Cycle,caption:this.textCycle,icon:"btn-smart-cycle",items:[{type:Asc.c_oAscSmartArtTypes.BasicCycle,tip:this.textBasicCycle},{type:Asc.c_oAscSmartArtTypes.TextCycle,tip:this.textTextCycle},{type:Asc.c_oAscSmartArtTypes.BlockCycle,tip:this.textBlockCycle},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.ContinuousCycle,tip:this.textContinuousCycle},{type:Asc.c_oAscSmartArtTypes.MultiDirectionalCycle,tip:this.textMultidirectionalCycle},{type:Asc.c_oAscSmartArtTypes.SegmentedCycle,tip:this.textSegmentedCycle},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess}]},{id:"menu-smart-art-group-hierarchy",sectionId:Asc.c_oAscSmartArtSectionNames.Hierarchy,caption:this.textHierarchy,icon:"btn-smart-hierarchy",items:[{type:Asc.c_oAscSmartArtTypes.OrganizationChart,tip:this.textOrganizationChart},{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.NameAndTitleOrganizationChart,tip:this.textNameAndTitleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.HalfCircleOrganizationChart,tip:this.textHalfCircleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.Hierarchy,tip:this.textHierarchy},{type:Asc.c_oAscSmartArtTypes.LabeledHierarchy,tip:this.textLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalOrganizationChart,tip:this.textHorizontalOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.HorizontalMultiLevelHierarchy,tip:this.textHorizontalMultiLevelHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalHierarchy,tip:this.textHorizontalHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalLabeledHierarchy,tip:this.textHorizontalLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList}]},{id:"menu-smart-art-group-relationship",sectionId:Asc.c_oAscSmartArtSectionNames.Relationship,caption:this.textRelationship,icon:"btn-smart-relationship",items:[{type:Asc.c_oAscSmartArtTypes.Balance,tip:this.textBalance},{type:Asc.c_oAscSmartArtTypes.CircleRelationship,tip:this.textCircleRelationship},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.OpposingIdeas,tip:this.textOpposingIdeas},{type:Asc.c_oAscSmartArtTypes.PlusAndMinus,tip:this.textPlusAndMinus},{type:Asc.c_oAscSmartArtTypes.ReverseList,tip:this.textReverseList},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.CounterbalanceArrows,tip:this.textCounterbalanceArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.NestedTarget,tip:this.textNestedTarget},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.ConvergingRadial,tip:this.textConvergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.RadialList,tip:this.textRadialList},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.BasicTarget,tip:this.textBasicTarget},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.BasicVenn,tip:this.textBasicVenn},{type:Asc.c_oAscSmartArtTypes.LinearVenn,tip:this.textLinearVenn},{type:Asc.c_oAscSmartArtTypes.StackedVenn,tip:this.textStackedVenn},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings}]},{id:"menu-smart-art-group-matrix",sectionId:Asc.c_oAscSmartArtSectionNames.Matrix,caption:this.textMatrix,icon:"btn-smart-matrix",items:[{type:Asc.c_oAscSmartArtTypes.BasicMatrix,tip:this.textBasicMatrix},{type:Asc.c_oAscSmartArtTypes.TitledMatrix,tip:this.textTitledMatrix},{type:Asc.c_oAscSmartArtTypes.GridMatrix,tip:this.textGridMatrix},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix}]},{id:"menu-smart-art-group-pyramid",sectionId:Asc.c_oAscSmartArtSectionNames.Pyramid,caption:this.textPyramid,icon:"btn-smart-pyramid",items:[{type:Asc.c_oAscSmartArtTypes.BasicPyramid,tip:this.textBasicPyramid},{type:Asc.c_oAscSmartArtTypes.InvertedPyramid,tip:this.textInvertedPyramid},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid}]},{id:"menu-smart-art-group-picture",sectionId:Asc.c_oAscSmartArtSectionNames.Picture,caption:this.textPicture,icon:"btn-menu-image",items:[{type:Asc.c_oAscSmartArtTypes.AccentedPicture,tip:this.textAccentedPicture},{type:Asc.c_oAscSmartArtTypes.CircularPictureCallout,tip:this.textCircularPictureCallout},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.SnapshotPictureList,tip:this.textSnapshotPictureList},{type:Asc.c_oAscSmartArtTypes.SpiralPicture,tip:this.textSpiralPicture},{type:Asc.c_oAscSmartArtTypes.CaptionedPictures,tip:this.textCaptionedPictures},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaption,tip:this.textBendingPictureCaption},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.BendingPictureSemiTransparentText,tip:this.textBendingPictureSemiTranparentText},{type:Asc.c_oAscSmartArtTypes.BendingPictureBlocks,tip:this.textBendingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaptionList,tip:this.textBendingPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.TitledPictureBlocks,tip:this.textTitledPictureBlocks},{type:Asc.c_oAscSmartArtTypes.PictureGrid,tip:this.textPictureGrid},{type:Asc.c_oAscSmartArtTypes.PictureAccentBlocks,tip:this.textPictureAccentBlocks},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureCircles,tip:this.textAlternatingPictureCircles},{type:Asc.c_oAscSmartArtTypes.TitlePictureLineup,tip:this.textTitlePictureLineup},{type:Asc.c_oAscSmartArtTypes.PictureLineup,tip:this.textPictureLineup},{type:Asc.c_oAscSmartArtTypes.FramedTextPicture,tip:this.textFramedTextPicture},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.BubblePictureList,tip:this.textBubblePictureList},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess}]},{id:"menu-smart-art-group-other",sectionId:Asc.c_oAscSmartArtSectionNames.OfficeCom,caption:this.textOther,items:[{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList}]}]}}},Common.define.smartArt||{})})),define("text!pdfeditor/main/app/template/Toolbar.template",[],(function(){return'<div class="toolbar">\n    <div class="box-tabs">\n        <div class="extra left"></div>\n        <%= tabsmarkup %>\n        <div class="extra right"></div>\n    </div>\n    <section class="box-controls">\n        <section class="panel static">\n            <div class="group no-mask small">\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-save" data-layout-name="toolbar-save"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-print"></span>\n                </div>\n            </div>\n            <div class="separator long"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-copy"></span>\n                    <span class="btn-slot" id="slot-btn-paste"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-undo"></span>\n                    <span class="btn-slot" id="slot-btn-redo"></span>\n                </div>\n            </div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-cut"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-select-all"></span>\n                </div>\n            </div>\n            <div class="separator long"></div>\n            <div class="group" data-layout-name="toolbar-view-navigation">\n                <span class="btn-slot text x-huge" id="slot-btn-hand-tool"></span>\n                <span class="btn-slot text x-huge" id="slot-btn-select-tool"></span>\n            </div>\n            <div class="separator long"></div>\n        </section>\n        <section class="box-panels">\n            <section class="panel" data-tab="home">\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot" id="slot-btn-pages" style="width: 95px"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot" id="slot-btn-first-page"></span>\n                        <span class="btn-slot margin-left-5" id="slot-btn-prev-page"></span>\n                        <span class="btn-slot margin-left-5" id="slot-btn-next-page"></span>\n                        <span class="btn-slot margin-left-5" id="slot-btn-last-page"></span>\n                    </div>\n                </div>\n\x3c!--                <div class="separator long"></div>--\x3e\n\x3c!--                <div class="group">--\x3e\n\x3c!--                    <span class="btn-slot text x-huge" id="slot-btn-rotate"></span>--\x3e\n\x3c!--                </div>--\x3e\n                <div class="separator long"></div>\n                <div class="group small">\n                <div class="elset" style="display: flex;">\n                    <span class="btn-slot slot-field-zoom" style="flex-grow: 1;"></span>\n                    </div>\n                <div class="elset" style="text-align: center;">\n                    <span class="btn-slot text font-size-normal slot-lbl-zoom" style="text-align: center;margin-top: 4px;"></span>\n                    </div>\n                </div>\n                <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot text slot-btn-ftp" style="text-align: center;"></span>\n                    </div>\n                <div class="elset">\n                    <span class="btn-slot text slot-btn-ftw" style="text-align: center;"></span>\n                    </div>\n                </div>\n            </section>\n            <section class="panel" data-tab="comment">\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-comment"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-highlight"></span>\n                    </div>\n                    <div class="elset">\n                    </div>\n                </div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-strikeout"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-underline"></span>\n                    </div>\n                </div>\n                <div class="separator long draw-groups"></div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-chk-showcomment"></span>\n                    </div>\n                    <div class="elset">\n                    </div>\n                </div>\n            </section>\n        </section>\n    </section>\n</div>'})),define("text!documenteditor/main/app/template/ToolbarView.template",[],(function(){return'<div class="toolbar toolbar-view">\n    <div class="box-tabs">\n        <div class="extra left"></div>\n        <%= tabsmarkup %>\n        <div class="extra right">\n        </div>\n    </div>\n    <section class="box-controls">\n        <section class="box-panels">\n        </section>\n    </section>\n</div>'})),void 0===Common)var Common={};if(Common.Models=Common.Models||{},define("common/main/lib/model/Font",["backbone"],(function(t){"use strict";Common.Models.Font=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:null,cloneid:null,imgidx:0,type:0}}})})),void 0===Common)var Common={};if(Common.Collections=Common.Collections||{},define("common/main/lib/collection/Fonts",["backbone","common/main/lib/model/Font"],(function(t){"use strict";Common.Collections.Fonts=t.Collection.extend({model:Common.Models.Font})})),define("text!common/main/lib/template/ExtendedColorDialog.template",[],(function(){return'<div class="color-box">\r\n    <div id="id-hsb-colorpicker" style="vertical-align:top;">\r\n    </div>\r\n    <div class="color-info" style="">\r\n        <div class="margin-left-15">\r\n            <label class="color-label"><%= txtNew %></label>\r\n            <div id="field-new-color" class="color-cnt top"></div>\r\n            <div id="field-start-color" class="color-cnt bottom"></div>\r\n            <label class="color-label"><%= txtCurrent %></label>\r\n        </div>\r\n        <div style="padding:13px 0 2px 0;">\r\n            <label class="input-label">R:</label>\r\n            <div id="extended-spin-r" class="color-spin"></div>\r\n        </div>\r\n        <div style="padding:2px 0;">\r\n            <label class="input-label">G:</label>\r\n            <div id="extended-spin-g" class="color-spin"></div>\r\n        </div>\r\n        <div style="padding:2px 0;">\r\n            <label class="input-label">B:</label>\r\n            <div id="extended-spin-b" class="color-spin"></div>\r\n        </div>\r\n        <div style="padding:11px 0 0 0;">\r\n            <label class="input-label" style="width:12px;">#:</label>\r\n            <input id="extended-text-color" type="text" role="textbox" style="width:62px; height: 22px;">\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="footer center">\r\n    <button class="btn normal dlg-btn primary" result="1"><%= txtAdd %></button>\r\n    <button class="btn normal dlg-btn" result="0"><%= txtCancel %></button>\r\n</div>\r\n'})),void 0===Common)var Common={};if(define("common/main/lib/component/HSBColorPicker",["common/main/lib/component/BaseView","common/main/lib/util/utils"],(function(){"use strict";Common.UI.HSBColorPicker=Common.UI.BaseView.extend({template:_.template('<div class="hsb-colorpicker"><% if (this.showCurrentColor) { %><div class="top-panel"><span class="color-value"><span class="transparent-color img-colorpicker"></span></span><div class="color-text"></div></div><% } %><div><div class="cnt-hb img-colorpicker"><div class="cnt-hb-arrow"></div></div><% if (this.changeSaturation) { %><div class="cnt-root"><div class="cnt-sat img-colorpicker"><div class="cnt-sat-arrow img-colorpicker"></div></div></div><% } %></div><% if (this.allowEmptyColor) { %><div class="empty-color"><%= this.textNoColor %></div><% } %></div>'),color:"#ff0000",options:{allowEmptyColor:!1,changeSaturation:!0,showCurrentColor:!0},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e,i,n,o,s,a,r,l,c=this,d=(c.$el||$(this.el),0),h=100,m=100;c.allowEmptyColor=c.options.allowEmptyColor,c.changeSaturation=c.options.changeSaturation,c.showCurrentColor=c.options.showCurrentColor;var u=function(t,e){var i=new Common.Utils.RGBColor("hsb("+t.h+","+t.s+","+t.b+")").toHex();c.color=e?"transparent":i,p(),c.trigger("changecolor",c,c.color)},p=function(){if(s.length>0&&a.length>0&&("transparent"==c.color?a.show():(s.css("background-color",c.color),a.hide())),n.length>0){var t=new Common.Utils.RGBColor("hsb("+d+", 100, 100)"),o="linear-gradient(rgba(255,255,255,0), #000), linear-gradient(-90deg,"+t.toRGB()+","+t.toRGBA(0)+"), #fff";n.css("background",o)}r.length>0&&(r[0].innerHTML="transparent"==c.color?c.textNoColor:c.color.toUpperCase()),e.length>0&&i.length>0&&(e.css({left:h+"%",top:100-m+"%","background-color":c.color}),i.css("top",parseInt(100*d/360)+"%"))},f=function(t,i,o){if(e.length>0&&n.length>0){var s=[Math.max(0,Math.min(100,parseInt((t.pageX*Common.Utils.zoom()-n.offset().left)/n.width()*100))),Math.max(0,Math.min(100,parseInt((t.pageY*Common.Utils.zoom()-n.offset().top)/n.height()*100)))];e.css("left",s[0]+"%"),e.css("top",s[1]+"%"),u({h:d,s:h=s[0],b:m=100-s[1]})}},g=function(t,e,n){if(i&&o){var s=Math.max(0,Math.min(100,parseInt((t.pageY*Common.Utils.zoom()-o.offset().top)/o.height()*100)));i.css("top",s+"%"),d=parseInt(360*s/100),u({h:d,s:h,b:m})}},b=function(t,e,i){$(document).on("mouseup",v),$(document).on("mousemove",f)},v=function(t,e,i){$(document).off("mouseup",v),$(document).off("mousemove",f),f(t)},C=function(t,e,i){$(document).on("mouseup",y),$(document).on("mousemove",g),g(t)},y=function(t,e,i){$(document).off("mouseup",y),$(document).off("mousemove",g)},w=function(t){var e=new Common.util.RGBColor(c.color).toHSB();u(e,!0)};c.setColor=function(t){var e;c.color!=t&&(e="transparent"==t?{h:0,s:100,b:100}:new Common.Utils.RGBColor(t).toHSB(),d=e.h,h=e.s,m=e.b,d==h&&d==m&&0==d&&(h=100),c.color=t,p())},c.getColor=function(){return c.color},c.on("render:after",(function(t){var u,f=$(c.el);f&&(e=f.find(".cnt-hb-arrow"),i=f.find(".cnt-sat-arrow"),n=f.find(".cnt-hb"),o=f.find(".cnt-sat"),s=f.find(".color-value"),r=f.find(".color-text"),l=f.find(".empty-color"),s.length>0&&(a=s.find(".transparent-color")),n.length>0&&(n.off("mousedown"),n.on("mousedown",b)),o.length>0&&(o.off("mousedown"),o.on("mousedown",C)),l.length>0&&(l.off("click"),l.on("click",w)),u="transparent"==c.color?{h:0,s:100,b:100}:new Common.Utils.RGBColor(c.color).toHSB(),d=u.h,h=u.s,m=u.b,d==h&&d==m&&0==d&&(h=100),p())})),c.render()},render:function(){return(this.$el||$(this.el)).html(this.template()),this.trigger("render:after",this),this},textNoColor:"No Color"})})),void 0===Common)var Common={};if(define("common/main/lib/component/MetricSpinner",["common/main/lib/component/BaseView"],(function(){"use strict";Common.UI.MetricSpinner=Common.UI.BaseView.extend({options:{minValue:0,maxValue:100,step:1,defaultUnit:"px",allowAuto:!1,autoText:"Auto",hold:!0,speed:"medium",width:90,allowDecimal:!0,allowBlank:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},disabled:!1,value:"0 px",rendered:!1,template:'<input type="text" class="form-control" spellcheck="false" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"><div class="spinner-buttons"><button type="button" class="spinner-up"><i class="arrow"></i></button><button type="button" class="spinner-down"><i class="arrow"></i></button></div>',initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this,i=e.$el||$(this.el);i.addClass("spinner"),i.on("mousedown",".spinner-up",_.bind(this.onMouseDown,this,!0)),i.on("mousedown",".spinner-down",_.bind(this.onMouseDown,this,!1)),i.on("mouseup",".spinner-up",_.bind(this.onMouseUp,this,!0)),i.on("mouseup",".spinner-down",_.bind(this.onMouseUp,this,!1)),i.on("mouseover",".spinner-up, .spinner-down",_.bind(this.onMouseOver,this)),i.on("mouseout",".spinner-up, .spinner-down",_.bind(this.onMouseOut,this)),i.on("keydown",".form-control",_.bind(this.onKeyDown,this)),i.on("keyup",".form-control",_.bind(this.onKeyUp,this)),i.on("blur",".form-control",_.bind(this.onBlur,this)),i.on("input",".form-control",_.bind(this.onInput,this)),this.options.allowDecimal||i.on("keypress",".form-control",_.bind(this.onKeyPress,this)),i.on("focus","input.form-control",(function(t){setTimeout((function(){e.$input&&(e.$input[0].selectionStart=0,e.$input[0].selectionEnd=e.$input.val().length)}),1)})),Common.Utils.isGecko&&i.on("blur","input.form-control",(function(){setTimeout((function(){e.$input&&(e.$input[0].selectionStart=e.$input[0].selectionEnd=0)}),1)})),this.switches={count:1,enabled:!0,fromKeyDown:!1},"medium"===this.options.speed?this.switches.speed=300:"fast"===this.options.speed?this.switches.speed=100:this.switches.speed=500,this.render(),this.options.disabled&&this.setDisabled(this.options.disabled),this.options.allowBlank&&(this.allowBlank=this.options.allowBlank),void 0!==this.options.value&&(this.value=this.options.value),this.setRawValue(this.value),this.options.width&&i.width(this.options.width),void 0===this.options.defaultValue&&(this.options.defaultValue=this.options.minValue),this.oldValue=this.options.minValue,this.lastValue=null},render:function(){var t=this.$el||$(this.el),e=_.template(this.template);return t.html($(e({dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}))),this.$input=t.find(".form-control"),this.rendered=!0,null!=this.options.tabindex&&this.$input.attr("tabindex",this.options.tabindex),this},setDisabled:function(t){t=!!t;var e=this.$el||$(this.el);t!==this.disabled&&(e.find("button").toggleClass("disabled",t),e.toggleClass("disabled",t),t?this.$input.attr({disabled:t}):this.$input.removeAttr("disabled")),this.disabled=t},isDisabled:function(){return this.disabled},setDefaultUnit:function(t){if(this.options.defaultUnit!=t){var e=this.options.defaultUnit;this.options.defaultUnit=t,this.setMinValue(this._recalcUnits(this.options.minValue,e)),this.setMaxValue(this._recalcUnits(this.options.maxValue,e)),this.setValue(this._recalcUnits(this.getNumberValue(),e),!0)}},setMinValue:function(t){this.options.minValue=t},setMaxValue:function(t){this.options.maxValue=t},setStep:function(t){this.options.step=t},getMinValue:function(){return this.options.minValue},getMaxValue:function(){return this.options.maxValue},getNumberValue:function(){return this.checkAutoText(this.value)?-1:parseFloat(this.value)},getUnitValue:function(){return this.options.defaultUnit},getValue:function(){return this.value},setRawValue:function(t){this.$input&&this.$input.val(t)},getRawValue:function(){return this.$input.val()},setValue:function(t,e){var i=!1;if(this._fromKeyDown=!1,this.lastValue=this.value,void 0===t||""===t)this.value="";else if(this.options.allowAuto&&(Math.abs(Common.Utils.String.parseFloat(t)+1)<1e-4||this.checkAutoText(t)))this.value=this.options.autoText;else{var n=this._add(Common.Utils.String.parseFloat(t),0,this.options.allowDecimal?3:0);(void 0===t||isNaN(n))&&(n=this.oldValue,i=!0);var o=this.options.defaultUnit;if(void 0!==t.match){var s=t.match(/(px|em|%|en|ex|pt|"|cm|mm|pc|s|ms|ÑÐ¼|Ð¼Ð¼|Ð¿Ñ|ÑÐµÐº|Ð¼Ñ)$/i);null!==s&&"undefined"!==s[0]&&(o=s[0].toLowerCase())}this.options.defaultUnit===o||i||(n=this._recalcUnits(n,o)),n>this.options.maxValue&&(n=this.options.maxValue,i=!0),n<this.options.minValue&&(n=this.options.minValue,i=!0),this.value=(n+" "+this.options.defaultUnit).trim(),this.oldValue=n}!0!==e&&this.lastValue!==this.value&&this.trigger("change",this,this.value,this.lastValue),!0!==e&&i&&this.trigger("inputerror",this,this.value),this.rendered?this.setRawValue(this.value):this.options.value=this.value},setMask:function(t){this.options.maskExp=t},onMouseDown:function(t,e){this.disabled||(e&&$(e.currentTarget).addClass("active"),this.options.hold&&(this.switches.fromKeyDown=!1,this._startSpin(t,e)))},onMouseUp:function(t,e){this.disabled||($(e.currentTarget).removeClass("active"),this.options.hold?this._stopSpin():this._step(t))},onMouseOver:function(t){this.disabled||$(t.currentTarget).addClass("over")},onMouseOut:function(t){this.disabled||($(t.currentTarget).removeClass("active over"),this.options.hold&&this._stopSpin())},onKeyDown:function(t){if(!this.disabled){if(!this.options.hold||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN)if(t.keyCode==Common.UI.Keys.RETURN)if(this.options.defaultUnit&&this.options.defaultUnit.length){var e=this.getRawValue();if(this.value!=e)return this.onEnterValue(),this.trigger("inputleave",this),this.value==e}else this.onEnterValue();else this._fromKeyDown=!0;else t.preventDefault(),t.stopPropagation(),void 0===this.switches.timeout&&(this.switches.fromKeyDown=!0,this._startSpin(t.keyCode==Common.UI.Keys.UP,t));t.keyCode==Common.UI.Keys.ESC&&this.setRawValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this)}},onKeyUp:function(t){this.disabled||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN||(t.stopPropagation(),t.preventDefault(),this.options.hold?this._stopSpin():this._step(t.keyCode==Common.UI.Keys.UP))},onKeyPress:function(t){if(!this.disabled){var e=String.fromCharCode(t.charCode);"."==e||","==e?(t.preventDefault(),t.stopPropagation()):!this.options.maskExp||this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN||(t.preventDefault(),t.stopPropagation())}},onInput:function(t,e){this.disabled||t.isDefaultPrevented()||this.trigger("changing",this,$(t.target).val(),t)},onEnterValue:function(){if(this.$input){var t=this.getRawValue();this.setValue(""!==t||this.allowBlank?t:this.value),this.trigger("entervalue",this)}},onBlur:function(t){if(this.$input){var e=this.getRawValue();this.setValue(""!==e||this.allowBlank?e:this.value),this.options.hold&&this.switches.fromKeyDown&&this._stopSpin()}},_startSpin:function(t,e){if(!this.disabled){var i=this.switches.count;1===i?(this._step(t,!0),i=1):i=i<3?1.5:i<8?2.5:6,this.switches.timeout=setTimeout($.proxy((function(){this._step(t,!0),this._startSpin(t)}),this),this.switches.speed/i),this.switches.count++}},_stopSpin:function(t){void 0!==this.switches.timeout&&(clearTimeout(this.switches.timeout),this.switches.timeout=void 0,this.switches.count=1,this.trigger("change",this,this.value,this.lastValue))},_increase:function(t){var e=this;if(!e.readOnly){var i=e.options.step;e._fromKeyDown?(i=this.getRawValue(),i=_.isEmpty(i)?e.oldValue:Common.Utils.String.parseFloat(i)):""!==e.getValue()?(i=e.checkAutoText(e.getValue())?e.options.defaultValue-e.options.step:Common.Utils.String.parseFloat(e.getValue()),isNaN(i)&&(i=this.oldValue)):i=e.options.defaultValue-e.options.step,e.setValue((this._add(i,e.options.step,e.options.allowDecimal?3:0)+" "+this.options.defaultUnit).trim(),t)}},_decrease:function(t){var e=this;if(!e.readOnly){var i=e.options.step;if(e._fromKeyDown)i=this.getRawValue(),i=_.isEmpty(i)?e.oldValue:Common.Utils.String.parseFloat(i);else if(""!==e.getValue()){if(i=e.checkAutoText(e.getValue())?e.options.minValue:Common.Utils.String.parseFloat(e.getValue()),isNaN(i)&&(i=this.oldValue),e.options.allowAuto&&this._add(i,-e.options.step,e.options.allowDecimal?3:0)<e.options.minValue)return void e.setValue(e.options.autoText,!0)}else i=e.options.defaultValue;e.setValue((this._add(i,-e.options.step,e.options.allowDecimal?3:0)+" "+this.options.defaultUnit).trim(),t)}},_step:function(t,e){t?this._increase(e):this._decrease(e),this.options.hold&&this.switches.fromKeyDown&&this.$input&&this.$input.select()},_add:function(t,e,i){var n=Math.pow(10,i||this.options.allowDecimal?2:0);return(Math.round(t*n)+Math.round(e*n))/n},_recalcUnits:function(t,e){if(e.match(/(s|ms|ÑÐµÐº|Ð¼Ñ)$/i)&&this.options.defaultUnit.match(/(s|ms|ÑÐµÐº|Ð¼Ñ)$/i)){var i=t;return"ms"!=e&&"Ð¼Ñ"!=e||(i=parseFloat((i/1e3).toFixed(6))),"ms"!=this.options.defaultUnit&&"Ð¼Ñ"!=this.options.defaultUnit||(i=parseFloat((1e3*i).toFixed(6))),i}if(null===e.match(/(pt|"|cm|mm|pc|ÑÐ¼|Ð¼Ð¼|Ð¿Ñ)$/i)||null===this.options.defaultUnit.match(/(pt|"|cm|mm|pc|ÑÐ¼|Ð¼Ð¼|Ð¿Ñ)$/i))return t;i=t;return"cm"==e||"ÑÐ¼"==e?i*=10:"pt"==e||"Ð¿Ñ"==e?i=25.4*i/72:'"'==e?i*=25.4:"pc"==e&&(i=25.4*i/6),"cm"==this.options.defaultUnit||"ÑÐ¼"==this.options.defaultUnit?i=parseFloat((i/10).toFixed(6)):"pt"==this.options.defaultUnit||"Ð¿Ñ"==this.options.defaultUnit?i=parseFloat((72*i/25.4).toFixed(3)):'"'==this.options.defaultUnit?i=parseFloat((i/25.4).toFixed(3)):"pc"==this.options.defaultUnit&&(i=parseFloat((6*i/25.4).toFixed(6))),i},focus:function(){this.$input&&this.$input.focus()},setDefaultValue:function(t){this.options.defaultValue=t},checkAutoText:function(t){if(this.options.allowAuto&&"string"==typeof t){var e=t.toLowerCase();return e==this.options.autoText.toLowerCase()||"auto"==e}return!1}}),Common.UI.CustomSpinner=Common.UI.MetricSpinner.extend(_.extend({initialize:function(t){this.options.toCustomFormat=t.toCustomFormat?t.toCustomFormat:function(t){return t},this.options.fromCustomFormat=t.fromCustomFormat?t.fromCustomFormat:function(t){return t},Common.UI.MetricSpinner.prototype.initialize.call(this,t)},setRawValue:function(t){this.$input&&this.$input.val(this.options.toCustomFormat(t))},getRawValue:function(){return this.options.fromCustomFormat(this.$input.val())}},Common.UI.CustomSpinner||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/MaskedField",["common/main/lib/component/BaseView"],(function(){"use strict";Common.UI.MaskedField=Common.UI.BaseView.extend({options:{maskExp:"",maxLength:999},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this,i=e.$el||$(this.el);i.addClass("masked-field user-select"),i.attr("maxlength",e.options.maxLength),i.on("keypress",(function(t){var n=String.fromCharCode(t.which);e.options.maskExp.test(n)||t.ctrlKey||(t.keyCode==Common.UI.Keys.RETURN&&e.trigger("changed",e,i.val()),t.preventDefault(),t.stopPropagation())})),i.on("input",(function(t){e.trigger("change",e,i.val())})),i.on("blur",(function(t){e.trigger("changed",e,i.val())}))},render:function(){return this},setValue:function(t){this.options.maskExp.test(t)&&t.length<=this.options.maxLength&&this.$el.val(t)},getValue:function(){this.$el.val()}})})),void 0===Common)var Common={};if(define("common/main/lib/view/ExtendedColorDialog",["text!common/main/lib/template/ExtendedColorDialog.template","common/main/lib/component/HSBColorPicker","common/main/lib/component/MetricSpinner","common/main/lib/component/MaskedField","common/main/lib/component/Window"],(function(t){"use strict";Common.UI.ExtendedColorDialog=Common.UI.Window.extend(_.extend({tpl:_.template(t),options:{},rendered:!1,initialize:function(t){Common.UI.Window.prototype.initialize.call(this,{cls:"extended-color-dlg",tpl:this.tpl({txtNew:this.textNew,txtCurrent:this.textCurrent,txtAdd:this.addButtonText,txtCancel:this.cancelButtonText}),header:!1,width:340,height:272}),this.hexRe=/\s*#?([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)\s*/},render:function(){var t=this;return Common.UI.Window.prototype.render.call(this),this.colorsPicker=new Common.UI.HSBColorPicker({el:$("#id-hsb-colorpicker"),showCurrentColor:!1}),this.colorsPicker.on("changecolor",_.bind(this.onChangeColor,this)),this.colorNew=$("#field-new-color"),this.colorSaved=$("#field-start-color"),this.spinR=new Common.UI.MetricSpinner({el:$("#extended-spin-r"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.spinG=new Common.UI.MetricSpinner({el:$("#extended-spin-g"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.spinB=new Common.UI.MetricSpinner({el:$("#extended-spin-b"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.textColor=new Common.UI.MaskedField({el:$("#extended-text-color"),width:55,maskExp:/[a-fA-F0-9]/,maxLength:6}),this.spinR.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,1)),this.spinG.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,2)),this.spinB.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,3)),this.textColor.on("change",_.bind(this.onChangeMaskedField,this)),this.textColor.on("changed",_.bind(this.onChangedMaskedField,this)),this.textColor.$el.on("focus",(function(){setTimeout((function(){t.textColor.$el&&t.textColor.$el.select()}),1)})),this.spinR.$el.find("input").attr("maxlength",3),this.spinG.$el.find("input").attr("maxlength",3),this.spinB.$el.find("input").attr("maxlength",3),this.on("close",(function(){t.trigger("onmodalresult",0)})),$(this)[0].getChild(".footer .dlg-btn").on("click",(function(e){t.trigger("onmodalresult",parseInt(e.currentTarget.attributes.result.value)),t.close(!0)})),this.rendered=!0,void 0!==this.color&&this.setColor(this.color),this},getFocusedComponents:function(){return[this.spinR,this.spinG,this.spinB,{cmp:this.textColor,selector:"input"}]},getDefaultFocusableComponent:function(){return this.getChild("#extended-text-color")},onChangeColor:function(t,e){this.colorNew.css({"background-color":e}),this.stopevents=!0;var i=e.match(this.hexRe);this.spinR.setValue(parseInt(i[1],16)),this.spinG.setValue(parseInt(i[2],16)),this.spinB.setValue(parseInt(i[3],16)),this.textColor.setValue((i[1]+i[2]+i[3]).toUpperCase()),this.stopevents=!1},showColor:function(t,e){if(!this.stopevents){var i=this.spinR.getNumberValue(),n=null==i||i<0?0:i>255?255:i;e&&this.spinR.setValue(n,!0),n=n.toString(16);var o=null==(i=this.spinG.getNumberValue())||i<0?0:i>255?255:i;e&&this.spinG.setValue(o,!0),o=o.toString(16);var s=null==(i=this.spinB.getNumberValue())||i<0?0:i>255?255:i;e&&this.spinB.setValue(s,!0),s=s.toString(16);var a=(1==n.length?"0"+n:n)+(1==o.length?"0"+o:o)+(1==s.length?"0"+s:s);this.colorsPicker.setColor("#"+a),"hex"!=t&&this.textColor.setValue(a.toUpperCase()),this.colorNew.css("background-color","#"+a)}},onChangingRGB:function(t,e,i,n){if(!this.stopevents){var o,s,a,r;switch(i=_.isEmpty(i)||isNaN(parseInt(i))?parseInt(e.getValue()):parseInt(i),t){case 1:o=(null==i||isNaN(i)||i<0?0:i>255?255:i).toString(16),s=(null==(r=this.spinG.getNumberValue())||r<0?0:r>255?255:r).toString(16),a=(null==(r=this.spinB.getNumberValue())||r<0?0:r>255?255:r).toString(16);break;case 2:o=(null==(r=this.spinR.getNumberValue())||r<0?0:r>255?255:r).toString(16),s=(null==i||isNaN(i)||i<0?0:i>255?255:i).toString(16),a=(null==(r=this.spinB.getNumberValue())||r<0?0:r>255?255:r).toString(16);break;case 3:o=(null==(r=this.spinR.getNumberValue())||r<0?0:r>255?255:r).toString(16),s=(null==(r=this.spinG.getNumberValue())||r<0?0:r>255?255:r).toString(16),a=(null==i||isNaN(i)||i<0?0:i>255?255:i).toString(16)}var l=(1==o.length?"0"+o:o)+(1==s.length?"0"+s:s)+(1==a.length?"0"+a:a);this.colorsPicker.setColor("#"+l),this.textColor.setValue(l.toUpperCase()),this.colorNew.css("background-color","#"+l)}},onChangeMaskedField:function(t,e){var i=(e="000000"+(e=/^[a-fA-F0-9]{0,6}$/.test(e)?e:"000000")).match(/([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/i);this.stopevents=!0,this.spinR.setValue(parseInt(i[1],16)),this.spinG.setValue(parseInt(i[2],16)),this.spinB.setValue(parseInt(i[3],16)),this.stopevents=!1,this.rendered&&this.showColor("hex")},onChangedMaskedField:function(t,e){/^[a-fA-F0-9]{0,6}$/.test(e)&&!_.isEmpty(e)||t.setValue("000000"),this.rendered&&this.showColor("",!0)},getColor:function(){var t=/#?([a-fA-F0-9]{6})/.exec(this.colorsPicker.getColor());return t?t[1]:null},setColor:function(t){var e=this;if(!0===this.rendered){var i=/#?([a-fA-F0-9]{6})/.test(t)?t:"ff0000";e.colorsPicker.setColor("#"+i),"transparent"==t?e.colorSaved.addClass("color-transparent"):(e.colorSaved.removeClass("color-transparent"),e.colorSaved.css("background-color","#"+t)),e.colorNew.css("background-color","#"+i),e.stopevents=!0;var n=e.hexRe.exec(i);e.spinR.setValue(parseInt(n[1],16)),e.spinG.setValue(parseInt(n[2],16)),e.spinB.setValue(parseInt(n[3],16)),e.textColor.setValue((n[1]+n[2]+n[3]).toUpperCase()),e.stopevents=!1}else this.color=t},onPrimary:function(){return this.trigger("onmodalresult",1),this.close(!0),!1},addButtonText:"Add",textNew:"New",textCurrent:"Current",textRGBErr:"The entered value is incorrect.<br>Please enter a numeric value between 0 and 255.",textHexErr:"The entered value is incorrect.<br>Please enter a value between 000000 and FFFFFF."},Common.UI.ExtendedColorDialog||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/ThemeColorPalette",["common/main/lib/component/BaseView","common/main/lib/view/ExtendedColorDialog"],(function(){"use strict";Common.UI.ThemeColorPalette=Common.UI.BaseView.extend(_.extend({options:{dynamiccolors:10,standardcolors:10,themecolors:10,columns:10,effects:5,hideEmptyColors:!0,allowReselect:!0,transparent:!1,value:"000000",enableKeyEvents:!0,colorHints:!0,keyMoveDirection:"both",storageSuffix:""},template:_.template('<div class="palette-inner"><% var me = this; var idx = 0; %><% $(colors).each(function(num, item) { %><% if (me.isBlankSeparator(item)) { %> <div class="palette-color-spacer"></div><% } else if (me.isSeparator(item)) { %> </div><div class="divider"></div><div style="padding: 12px;"><% } else if (me.isColor(item)) { %> <a class="palette-color color-<%=item%>" data-toggle="tooltip" style="background:#<%=item%>" idx="<%=idx++%>"><em><span style="background:#<%=item%>;" unselectable="on">&#160;</span></em></a><% } else if (me.isTransparent(item)) { %><a class="color-<%=item%>" data-toggle="tooltip" idx="<%=idx++%>"><em><span unselectable="on">&#160;</span></em></a><% } else if (me.isEffect(item)) { %><% if (idx>0 && me.columns>0 && idx%me.columns===0) { %> <div class="color-divider"></div><% } %><a effectid="<%=item.effectId%>" effectvalue="<%=item.effectValue%>" data-toggle="tooltip" class="palette-color-effect color-<%=item.color%>" style="background:#<%=item.color%>" idx="<%=idx++%>"><em><span style="background:#<%=item.color%>;" unselectable="on">&#160;</span></em></a><% } else if (me.isCaption(item)) { %><div class="palette-color-caption"><%=item%></div><% } %><% }); %></div><% if (me.options.dynamiccolors!==undefined) { %><div class="palette-color-dynamiccolors"><div class="palette-color-spacer"></div><div class="palette-color-caption"><%=me.textRecentColors%></div><% for (var i=0; i<me.options.dynamiccolors; i++) { %><a class="color-dynamic-<%=i%> dynamic-empty-color <%= me.emptyColorsClass %>" data-toggle="tooltip" color="" idx="<%=idx++%>"><em><span unselectable="on">&#160;</span></em></a><% } %><% } %></div>'),colorRe:/(?:^|\s)color-(.{6})(?:\s|$)/,selectedCls:"selected",initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this,i=e.$el||$(this.el);this.colors=e.options.colors||this.generateColorData(e.options.themecolors,e.options.effects,e.options.standardcolors,e.options.transparent),this.columns=e.options.columns||0,this.enableKeyEvents=e.options.enableKeyEvents,this.tabindex=e.options.tabindex||0,this.outerMenu=e.options.outerMenu,this.lastSelectedIdx=-1,this.emptyColorsClass=e.options.hideEmptyColors?"hidden":"",this.colorHints=e.options.colorHints,e.colorItems=[],"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],i.addClass("theme-colorpalette"),this.render(),this.options.updateColorsArr&&this.updateColors(this.options.updateColorsArr[0],this.options.updateColorsArr[1]),this.options.value&&this.select(this.options.value,!0),this.options.outerMenu&&this.options.outerMenu.focusOnShow&&this.options.outerMenu.menu&&(i.addClass("focused"),this.options.outerMenu.menu.on("show:after",(function(t){_.delay((function(){e.showLastSelected(),e.focus()}),10)}))),this.updateCustomColors(),i.closest(".btn-group").on("show.bs.dropdown",_.bind(this.updateCustomColors,this)),i.closest(".dropdown-submenu").on("show.bs.dropdown",_.bind(this.updateCustomColors,this)),i.on("click",_.bind(this.handleClick,this))},render:function(){this.$el.html(this.template({colors:this.colors}));var t=this;this.moveKeys&&this.$el.find("a").each((function(e,i){t.colorItems.push({el:i,index:e})})),this.attachKeyEvents();var e=this.$el.closest(".asc-window");return e.length>0&&(this.tipZIndex=parseInt(e.css("z-index"))+10),this.colorHints&&(this.options.transparent&&this.createTip(this.$el.find("a.color-transparent"),this.textTransparent),!this.options.themecolors&&!this.options.effects&&this.updateHints("object"==typeof this.colorHints?this.colorHints:void 0),this.colorHints=!!this.colorHints),this},isBlankSeparator:function(t){return"string"==typeof t&&"-"==t},isSeparator:function(t){return"string"==typeof t&&"--"==t},isColor:function(t){return"string"==typeof t&&/[0-9A-F]{6}/.test(t)},isTransparent:function(t){return"string"==typeof t&&"transparent"==t},isCaption:function(t){return"string"==typeof t&&"-"!=t&&"--"!=t&&!/[0-9A-F]{6}|transparent/.test(t)},isEffect:function(t){return"object"==typeof t&&void 0!==t.effectId},getColor:function(){return this.value},updateCustomColors:function(){var t=this.$el||$(this.el);if(t){var e=this.lastSelectedIdx>=0?$(this.colorItems[this.lastSelectedIdx].el):t.find("a."+this.selectedCls),i=e.length>0&&/color-dynamic/.test(e[0].className)?e.attr("color"):void 0;i&&(i=i.toUpperCase(),e.removeClass(this.selectedCls),this.lastSelectedIdx=-1);var n,o=Common.localStorage.getItem("asc."+Common.localStorage.getId()+".colors.custom"+this.options.storageSuffix),s=-1,a=(o=o?o.split(","):[]).length<this.options.dynamiccolors?o.length:this.options.dynamiccolors;for(this.options.hideEmptyColors&&this._layoutParams&&t.find(".dynamic-empty-color").length!==this.options.dynamiccolors-a&&(this._layoutParams=void 0);++s<a;)(n=t.find(".color-dynamic-"+s)).removeClass("dynamic-empty-color").removeClass(this.emptyColorsClass).attr("color",o[s]),n.find("span").css({"background-color":"#"+o[s]}),o[s]==i&&(n.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(n.attr("idx")),i=void 0),this.colorHints&&this.createTip(n,Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(o[s]).asc_getName()));for(;s<this.options.dynamiccolors;)(n=t.find(".color-dynamic-"+s)).removeAttr("color"),n.addClass("dynamic-empty-color").addClass(this.emptyColorsClass),n.find("span").css({"background-color":"transparent"}),s++;t.find(".palette-color-dynamiccolors").toggleClass(this.emptyColorsClass,0===a)}},handleClick:function(t){var e,i=this,n=$(t.target).closest("a");if(0==n.length)return!1;if(n.hasClass("color-transparent"))i.clearSelection(!0),n.addClass(i.selectedCls),t.suppressEvent||(i.lastSelectedIdx=parseInt(n.attr("idx")),i.value="transparent",i.trigger("select",i,"transparent"));else if(n[0].className.search("color-dynamic")<0)if((!/^[a-fA-F0-9]{6}$/.test(i.value)||_.indexOf(i.colors,i.value)<0)&&(i.value=!1),i.clearSelection(!0),n.addClass(i.selectedCls),e=n[0].className.match(i.colorRe)[1],n.hasClass("palette-color-effect")){var o=parseInt(n.attr("effectid"));e&&!t.suppressEvent&&(i.value=e.toUpperCase(),i.trigger("select",i,{color:e,effectId:o}),i.lastSelectedIdx=parseInt(n.attr("idx")))}else/#?[a-fA-F0-9]{6}/.test(e)&&(e=/#?([a-fA-F0-9]{6})/.exec(e)[1].toUpperCase())&&!t.suppressEvent&&(i.value=e,i.trigger("select",i,e),i.lastSelectedIdx=parseInt(n.attr("idx")));else/dynamic-empty-color/.test(n[0].className)?t.suppressEvent?(i.clearSelection(!0),n.addClass(i.selectedCls)):setTimeout((function(){i.addNewColor()}),10):(i.clearSelection(!0),n.addClass(i.selectedCls),t.suppressEvent||(i.lastSelectedIdx=parseInt(n.attr("idx")),e=n.attr("color"),i.trigger("select",i,e),i.value=e.toUpperCase()))},setCustomColor:function(t){var e=this.$el||$(this.el);if(t=/#?([a-fA-F0-9]{6})/.exec(t)){var i=this.saveCustomColor(t[1]);this.clearSelection(!0);var n=e.find(".dynamic-empty-color");0==n.length?(this.updateCustomColors(),n=e.find(".color-dynamic-"+(this.options.dynamiccolors-1))):i&&this.options.hideEmptyColors&&this._layoutParams&&(this._layoutParams=void 0),i&&(n.first().removeClass("dynamic-empty-color").removeClass(this.emptyColorsClass).addClass(this.selectedCls).attr("color",t[1]),n.first().find("span").css({"background-color":"#"+t[1]})),e.find(".palette-color-dynamiccolors").removeClass(this.emptyColorsClass),this.select(t[1],!0)}},saveCustomColor:function(t){var e="asc."+Common.localStorage.getId()+".colors.custom"+this.options.storageSuffix,i=Common.localStorage.getItem(e);i=i?i.split(","):[];var n=_.indexOf(i,t.toUpperCase());return n<0&&(i.push(t)>this.options.dynamiccolors&&i.shift(),Common.localStorage.setItem(e,i.join().toUpperCase())),n<0},addNewColor:function(t){var e=this,i=new Common.UI.ExtendedColorDialog({});i.on("onmodalresult",(function(t){e._isdlgopen=!1,1==t&&(e.setCustomColor(i.getColor()),e.fireEvent("select",e,i.getColor())),e.fireEvent("close:extended",e,1==t)})),e._isdlgopen=!0,i.setColor(void 0!==e.value&&!1!==e.value?e.value:void 0!==t?t:"000000"),i.show()},isDialogOpen:function(){return 1==this._isdlgopen},select:function(t,e){var i,n=this.$el||$(this.el);if(this.clearSelection(),"object"==typeof t)void 0!==t.effectId?(i=n.find('a[effectid="'+t.effectId+'"]').first()).length>0?(i.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(i.attr("idx")),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1:void 0!==t.effectValue&&((i=n.find('a[effectvalue="'+t.effectValue+'"].color-'+t.color.toUpperCase()).first()).length>0?(i.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(i.attr("idx")),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1);else if(/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase(),this.value=t),/^[a-fA-F0-9]{6}|transparent$/.test(t)&&_.indexOf(this.colors,t)>=0){if(_.indexOf(this.colors,this.value)<0&&(this.value=!1),t!=this.value||this.options.allowReselect){var o="transparent"==t?n.find("a.color-transparent").addClass(this.selectedCls):n.find("a.palette-color.color-"+t).first().addClass(this.selectedCls);this.value=t,this.lastSelectedIdx=parseInt(o.attr("idx")),!0!==e&&this.fireEvent("select",this,t)}}else 0==(o=n.find("#"+t).first()).length&&(o=n.find('a[color="'+t+'"]').first()),o.length>0&&(o.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(o.attr("idx")),this.value=t.toUpperCase())},selectByRGB:function(t,e){var i=this.$el||$(this.el);this.clearSelection(!0);var n="object"==typeof t?t.color:t;if(/#?[a-fA-F0-9]{6}/.test(n)&&(n=/#?([a-fA-F0-9]{6})/.exec(n)[1].toUpperCase()),/^[a-fA-F0-9]{6}|transparent$/.test(n)&&(n!=this.value||this.options.allowReselect)){var o="transparent"==n?i.find("a.color-transparent"):i.find("a.color-"+n).first();0==o.length&&(o=i.find("#"+n).first()),0==o.length&&(o=i.find('a[color="'+n+'"]').first()),o.length>0&&(o.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(o.attr("idx")),this.value=n),!0!==e&&this.fireEvent("select",this,n)}},updateColors:function(t,e,i){if(void 0!==t&&void 0!==e){var n,o=this,s=o.$el||$(this.el);void 0===o.aColorElements&&(o.aColorElements=s.find("a.palette-color")),void 0===o.aEffectElements&&(o.aEffectElements=s.find("a.palette-color-effect"));for(var a=0,r=0,l=0;l<o.colors.length;l++)if("string"==typeof o.colors[l]&&/[0-9A-F]{6}/.test(o.colors[l])){if(a>=e.length)continue;(n=$(o.aColorElements[a])).removeClass("color-"+o.colors[l]),o.colors[l]=e[a].color=e[a].color.toUpperCase(),n.addClass("color-"+o.colors[l]),n.css({background:"#"+o.colors[l]}),n.find("span").first().css({background:"#"+o.colors[l]}),o.colorHints&&o.createTip(n,e[a].tip),a++}else if("object"==typeof o.colors[l]&&void 0!==o.colors[l].effectId){if(r>=t.length)continue;n=$(o.aEffectElements[r]),t[r].color=t[r].color.toUpperCase(),o.colors[l].color!==t[r].color&&(n.removeClass("color-"+o.colors[l].color),n.addClass("color-"+t[r].color),n.css({background:"#"+t[r].color}),n.find("span").first().css({background:"#"+t[r].color})),o.colors[l].effectId!==t[r].effectId&&n.attr("effectid",""+t[r].effectId),o.colors[l].effectValue!==t[r].effectValue&&n.attr("effectvalue",""+t[r].effectValue),o.colors[l]=t[r],o.colorHints&&o.createTip(n,t[r].tip),r++}if(i)this.select(i,!0);else{var c=s.find("a."+this.selectedCls);c.length&&c.hasClass("palette-color-effect")&&(this.value=c[0].className.match(this.colorRe)[1].toUpperCase())}this.options.updateColorsArr=void 0}},createTip:function(t,e){var i=this.tipZIndex;void 0===t.attr("color-name")&&t.one("mouseenter",(function(t){var e=$(t.currentTarget);e.tooltip({title:e.attr("color-name"),placement:"cursor",zIndex:i}),e.mouseenter()}));var n=t.data("bs.tooltip");n&&n.updateTitle(e),t.attr("color-name",e||"")},clearSelection:function(t){this.$el.find("a."+this.selectedCls).removeClass(this.selectedCls),t||(this.value=void 0,this.lastSelectedIdx=-1)},showLastSelected:function(){this.selectByIndex(this.lastSelectedIdx,!0)},getSelectedColor:function(){var t=(this.$el||$(this.el)).find("a."+this.selectedCls).attr("idx");return void 0!==t?this.colorItems[parseInt(t)]:null},selectByIndex:function(t,e){this.clearSelection(!0),t>=0&&t<this.colorItems.length&&this.handleClick({target:this.colorItems[t].el,suppressEvent:e})},generateColorData:function(t,e,i,n){var o=[],s=t>0&&e>0?t*e:0;if(t>0){o=[this.textThemeColors];for(var a=0;a<t;a++)o.push({color:"FFFFFF",effectId:1});e>0&&o.push("-");for(a=0;a<s;a++)o.push({color:"FFFFFF",effectId:1});i&&o.push("-")}if(i){o.push(this.textStandartColors),n&&(o.push("transparent"),i--);for(a=0;a<i;a++)o.push("FFFFFF")}return o},onKeyDown:function(t,e){if(void 0===e&&(e=t),_.indexOf(this.moveKeys,e.keyCode)>-1||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.getSelectedColor();if(e.keyCode==Common.UI.Keys.RETURN)i&&this.selectByIndex(i.index),this.outerMenu&&this.outerMenu.menu&&this.outerMenu.menu.hide();else{var n=i?i.index:-1;if(n<0)n=0;else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o=this.colorItems[n].topIdx,s=this.colorItems[n].leftIdx;if(n=void 0,e.keyCode==Common.UI.Keys.LEFT)for(;void 0===n;)--s<0&&(s=this._layoutParams.columns-1),n=this._layoutParams.itemsIndexes[o][s];else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===n;)++s>this._layoutParams.columns-1&&(s=0),n=this._layoutParams.itemsIndexes[o][s];else if(e.keyCode==Common.UI.Keys.UP)if(0==o&&this.outerMenu&&this.outerMenu.menu)this.clearSelection(!0),this.outerMenu.menu.focusOuter(e,this.outerMenu.index);else for(;void 0===n;)--o<0&&(o=this._layoutParams.rows-1),n=this._layoutParams.itemsIndexes[o][s];else if(o==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)this.clearSelection(!0),this.outerMenu.menu.focusOuter(e,this.outerMenu.index);else for(;void 0===n;)++o>this._layoutParams.rows-1&&(o=0),n=this._layoutParams.itemsIndexes[o][s]}else n=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,n-1):Math.min(this.colorItems.length-1,n+1);void 0!==n&&n>=0&&(this._fromKeyDown=!0,this.selectByIndex(n,!0),this._fromKeyDown=!1)}}},fillIndexesArray:function(){if(!(this.colorItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=$(this.colorItems[0].el),e=t.outerWidth()+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right")),i=this.$el.offset().left,n=t.offset().top,o=-1,s=0,a=0,r=0;r<this.colorItems.length;r++){var l=$(this.colorItems[r].el).offset().top-n;a=Math.floor(($(this.colorItems[r].el).offset().left-i)/e),l>o&&(o=l,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][a]=r,this.colorItems[r].topIdx=s,this.colorItems[r].leftIdx=a,this._layoutParams.columns<a&&(this._layoutParams.columns=a)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},attachKeyEvents:function(){if(this.enableKeyEvents){var t=this.$el||$(this.el);t.addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on("keydown",_.bind(this.onKeyDown,this))}},focus:function(t){var e=this.$el||$(this.el);e&&e.focus(),"string"==typeof t?"first"==t?this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&this.selectByIndex(t,!0)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")},updateHints:function(t){if(this.colorHints){var e=this;(e.$el||$(e.el)).find("a.palette-color").each((function(i,n){if(t&&t[i])e.createTip($(n),t[i]);else{var o=n.className.match(e.colorRe)[1];e.createTip($(n),Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(o).asc_getName()))}}))}},textThemeColors:"Theme Colors",textStandartColors:"Standard Colors",textRecentColors:"Recent Colors",textTransparent:"Transparent"},Common.UI.ThemeColorPalette||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/ColorButton",["common/main/lib/component/Button","common/main/lib/component/ThemeColorPalette"],(function(){"use strict";Common.UI.ButtonColored=Common.UI.Button.extend(_.extend({render:function(t){if(Common.UI.Button.prototype.render.call(this,t),/huge/.test(this.options.cls)&&!0===this.options.split){var e=$("button",this.cmpEl),i=$(e[1]);i&&i.append($('<div class="btn-color-value-line"></div>'))}else $("button:first-child",this.cmpEl).append($('<div class="btn-color-value-line"></div>'));this.colorEl=this.cmpEl.find(".btn-color-value-line"),this.options.auto&&(this.autocolor="object"==typeof this.options.auto&&this.options.auto.color||"000000"),void 0!==this.options.color&&this.setColor(this.options.color)},getPicker:function(t,e){if(!this.colorPicker){var i={el:this.cmpEl.find("#"+this.menu.id+"-color-menu"),value:t,colors:e};void 0!==this.options.transparent&&(i.transparent=this.options.transparent),void 0!==this.options.hideEmptyColors&&(i.hideEmptyColors=this.options.hideEmptyColors),void 0!==this.options.themecolors&&(i.themecolors=this.options.themecolors),void 0!==this.options.effects&&(i.effects=this.options.effects),void 0!==this.options.colorHints&&(i.colorHints=this.options.colorHints),this.colorPicker=new Common.UI.ThemeColorPalette(i),this.colorPicker.on("select",_.bind(this.onColorSelect,this)),this.colorPicker.on("close:extended",_.bind(this.onCloseExtentedColor,this)),this.cmpEl.find("#"+this.menu.id+"-color-new").on("click",_.bind(this.addNewColor,this)),this.options.auto&&(this.cmpEl.find("#"+this.menu.id+"-color-auto").on("click",_.bind(this.onAutoColorSelect,this)),this.colorAuto=this.cmpEl.find("#"+this.menu.id+"-color-auto > a"),"auto"==t&&this.setAutoColor(!0)),this.options.eyeDropper&&this.cmpEl.find("#"+this.menu.id+"-eyedropper").on("click",_.bind(this.onEyedropperStart,this)),this.initInnerMenu()}return this.colorPicker},setPicker:function(t){this.colorPicker=t},getMenu:function(t){if("object"!=typeof this.menu){var e=(t=t||this.options).paletteHeight?t.paletteHeight+"px":"auto",i=Common.UI.getId(),n=[],o=[];t.auto&&(this.autocolor="object"==typeof t.auto&&t.auto.color||"000000",n.push({id:i+"-color-auto",caption:"object"==typeof t.auto&&t.auto.caption||this.textAutoColor,template:_.template('<a tabindex="-1" type="menuitem"><span class="menu-item-icon color-auto" style="background-color: #'+this.autocolor+';"></span><%= caption %></a>')}),n.push({caption:"--"})),t.eyeDropper&&o.push({id:i+"-eyedropper",caption:this.textEyedropper,iconCls:"menu__icon btn-eyedropper"});var s=new Common.UI.Menu({id:i,cls:"color-menu "+(t.eyeDropper?"shifted-right":"shifted-left"),additionalAlign:t.additionalAlign,items:(t.additionalItems?t.additionalItems:[]).concat(n).concat([{template:_.template('<div id="'+i+'-color-menu" style="width: 164px; height:'+e+'; display: inline-block;"></div>')},{caption:"--"}]).concat(o).concat([{id:i+"-color-new",template:_.template('<a tabindex="-1" type="menuitem" style="">'+this.textNewColor+"</a>")}])});this.initInnerMenu();var a=this;return s.on("keydown:before",_.bind(this.onBeforeKeyDown,this)),s.on("show:after",(function(e){a.colorPicker&&_.delay((function(){a.colorPicker.showLastSelected(),!t.additionalItems&&!t.auto&&a.colorPicker.focus()}),10)})).on("hide:after",(function(){a.options.takeFocusOnClose&&setTimeout((function(){a.focus()}),1)})),s}return this.menu},initInnerMenu:function(){if(this.colorPicker&&"object"==typeof this.menu){var t=(this.options.additionalItems||[]).length+(this.options.auto?2:0);this.colorPicker.outerMenu={menu:this.menu,index:t},this.menu.setInnerMenu([{menu:this.colorPicker,index:t}])}},setMenu:function(t,e){t=t||this.getMenu(),Common.UI.Button.prototype.setMenu.call(this,t),!e&&this.getPicker(this.options.color,this.options.colors)},onColorSelect:function(t,e){this.setColor(e),this.setAutoColor(!1),this.trigger("color:select",this,e)},onCloseExtentedColor:function(t,e){if(this.options.takeFocusOnClose){var i=this;setTimeout((function(){i.focus()}),1)}},setColor:function(t){"auto"==t&&this.options.auto&&(t=this.autocolor),this.color=t,this.colorEl&&(this.colorEl.css({"background-color":"transparent"==t?t:"object"==typeof t?"#"+t.color:"#"+t}),this.colorEl.toggleClass("bordered","transparent"==t))},setAutoColor:function(t){this.colorAuto&&(t&&!this.colorAuto.hasClass("selected")?this.colorAuto.addClass("selected"):!t&&this.colorAuto.hasClass("selected")&&this.colorAuto.removeClass("selected"))},isAutoColor:function(){return this.colorAuto&&this.colorAuto.hasClass("selected")},onAutoColorSelect:function(){this.setColor("auto"),this.setAutoColor(!0),this.colorPicker&&this.colorPicker.clearSelection(),this.trigger("auto:select",this,this.autocolor)},addNewColor:function(){this.colorPicker&&this.colorPicker.addNewColor("object"==typeof this.color?this.color.color:this.color)},onEyedropperStart:function(){Common.NotificationCenter.trigger("eyedropper:start"),this.trigger("eyedropper:start",this)},eyedropperEnd:function(t,e,i){if(void 0!==t){var n=Common.Utils.ThemeColor.getHexColor(t,e,i);this.colorPicker.setCustomColor("#"+n),this.onColorSelect(this.colorPicker,n),this.trigger("eyedropper:end",this)}},onBeforeKeyDown:function(t,e){if((e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.SPACE)&&!this.isMenuOpen())return $("button",this.cmpEl).click(),!1},isMenuOpen:function(){return this.cmpEl.hasClass("open")},focus:function(){$("button",this.cmpEl).focus()},textNewColor:"Add New Custom Color",textAutoColor:"Automatic",textEyedropper:"Eyedropper"},Common.UI.ButtonColored||{})),Common.UI.ColorButton=Common.UI.ButtonColored.extend(_.extend({options:{id:null,hint:!1,enableToggle:!1,allowDepress:!1,toggleGroup:null,cls:"",iconCls:"",caption:"",menu:null,disabled:!1,pressed:!1,split:!1,visible:!0},template:_.template(['<div class="btn-group" id="<%= id %>">','<button type="button" class="btn btn-color dropdown-toggle <%= cls %>" data-toggle="dropdown" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">',"<span>&nbsp;</span>",'<span class="inner-box-caret">','<i class="caret"></i>',"</span>","</button>","</div>"].join("")),initialize:function(t){if(!t.menu&&!1!==t.menu){var e=this;t.menu=e.getMenu(t),e.on("render:after",(function(i){e.getPicker(t.color,t.colors)}))}Common.UI.Button.prototype.initialize.call(this,t)},render:function(t){Common.UI.Button.prototype.render.call(this,t),this.options.auto&&(this.autocolor="object"==typeof this.options.auto&&this.options.auto.color||"000000"),void 0!==this.options.color&&this.setColor(this.options.color)},setColor:function(t){"auto"==t&&this.options.auto&&(t=this.autocolor);var e=$(this.cmpEl).find("button span:nth-child(1)");this.color=t,e.toggleClass("color-transparent","transparent"==t),e.css({"background-color":"transparent"==t?t:"object"==typeof t?"#"+t.color:"#"+t})},focus:function(){$("button",this.cmpEl).focus()}},Common.UI.ColorButton||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/ColorPalette",["common/main/lib/component/BaseView"],(function(){"use strict";Common.UI.ColorPalette=Common.UI.BaseView.extend({options:{allowReselect:!0,cls:"",style:""},template:_.template(['<div class="palette-color">',"<% _.each(colors, function(color, index) { %>",'<span class="color-item" data-color="<%= color %>" style="background-color: #<%= color %>;"></span>',"<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id,this.cls=e.options.cls,this.style=e.options.style,this.colors=e.options.colors||[],this.value=e.options.value,e.options.el&&e.render()},render:function(t){var e=this;return e.rendered?this.cmpEl=e.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,colors:this.colors})),t?(this.setElement(t,!1),t.html(this.cmpEl)):e.$el.html(this.cmpEl)),e.rendered||e.cmpEl.on("click","span.color-item",e.itemClick.bind(e)),e.rendered=!0,this},itemClick:function(t){var e=$(t.target);this.select(e.attr("data-color"))},select:function(t,e){if(this.value!=t){$("span.color-item",this.cmpEl).removeClass("selected"),this.value=t,t&&/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase(),$("span[data-color="+t+"]",this.cmpEl).addClass("selected"),e||this.trigger("select",this,this.value))}}})})),void 0===Common)var Common={};var FONT_TYPE_RECENT=4,reqerr;if(define("common/main/lib/component/ComboBoxFonts",["common/main/lib/component/ComboBox"],(function(){"use strict";Common.UI.ComboBoxFonts=Common.UI.ComboBox.extend(function(){var t=300,e=Asc.FONT_THUMBNAIL_HEIGHT||28,i=document.createElement("canvas"),n=i.getContext("2d"),o=/^(zh|ja|ko)$/i.test(Common.Locale.getCurrentLanguage())?"_ea":"",s=[{ratio:1,path:"../../../../sdkjs/common/Images/fonts_thumbnail"+o+".png",width:t,height:e},{ratio:1.25,path:"../../../../sdkjs/common/Images/fonts_thumbnail"+o+"@1.25x.png",width:375,height:1.25*e},{ratio:1.5,path:"../../../../sdkjs/common/Images/fonts_thumbnail"+o+"@1.5x.png",width:450,height:1.5*e},{ratio:1.75,path:"../../../../sdkjs/common/Images/fonts_thumbnail"+o+"@1.75x.png",width:525,height:1.75*e},{ratio:2,path:"../../../../sdkjs/common/Images/fonts_thumbnail"+o+"@2x.png",width:600,height:2*e}],a=0,r=1,l=Common.Utils.applicationPixelRatio();Common.Controllers.Desktop.isActive()&&(s[0].path=Common.Controllers.Desktop.call("getFontsSprite"),s[1].path=Common.Controllers.Desktop.call("getFontsSprite","@1.25x"),s[2].path=Common.Controllers.Desktop.call("getFontsSprite","@1.5x"),s[3].path=Common.Controllers.Desktop.call("getFontsSprite","@1.75x"),s[4].path=Common.Controllers.Desktop.call("getFontsSprite","@2x"));for(var c=Math.abs(l-s[0].ratio),d=0,h=1;h<s.length;h++)(d=Math.abs(l-s[h].ratio))<c-1e-4&&(c=d,a=h);function m(){this.supportBinaryFormat=!(Common.Controllers.Desktop.isActive()&&!Common.Controllers.Desktop.isFeatureAvailable("isSupportBinaryFontsSprite")),this.image=null,this.binaryFormat=null,this.data=null,this.width=0,this.height=0,this.heightOne=0,this.count=0,this.offsets=null,this.load=function(t,e){if(e)if(this.supportBinaryFormat){var i=this,n=new XMLHttpRequest;n.open("GET",t+".bin",!0),n.responseType="arraybuffer",n.overrideMimeType?n.overrideMimeType("text/plain; charset=x-user-defined"):n.setRequestHeader("Accept-Charset","x-user-defined"),n.onload=function(){i.binaryFormat=new Uint8Array(this.response),e()},n.send(null)}else this.width=s[a].width,this.heightOne=s[a].height,this.image=new Image,this.image.onload=e,this.image.src=s[a].path},this.openBinary=function(t){var e=this.binaryFormat;this.width=e[0]<<24|e[1]<<16|e[2]<<8|e[3]<<0,this.heightOne=e[4]<<24|e[5]<<16|e[6]<<8|e[7]<<0,this.count=e[8]<<24|e[9]<<16|e[10]<<8|e[11]<<0,this.height=this.count*this.heightOne;var i=4*this.width*this.height,n=i>5e7;n?this.offsets=new Array(this.count):this.data=new Uint8ClampedArray(i);var o=12,s=e.length,a=0,r=0,l=0;if(n)for(var c=this.width*this.heightOne,d=c-1;o<s;)if(0==(l=e[o++]))for(r=e[o++];r>0;)r--,++d===c&&(this.offsets[a++]={pos:o,len:r+1},d=0);else++d===c&&(this.offsets[a++]={pos:o-1,len:-1},d=0);else for(var h=this.data;o<s;)if(0==(l=e[o++]))for(r=e[o++];r>0;)r--,h[a]=h[a+1]=h[a+2]=255,h[a+3]=0,a+=4;else h[a]=h[a+1]=h[a+2]=255-l,h[a+3]=l,a+=4;this.offsets||delete this.binaryFormat},this.getImage=function(i,n,o){if(this.supportBinaryFormat){this.data||this.offsets||this.openBinary(this.binaryFormat),n||((n=document.createElement("canvas")).width=this.width,n.height=this.heightOne,n.style.width=t+"px",n.style.height=e+"px",o=n.getContext("2d"));var s=o.createImageData(this.width,this.heightOne),a=4*this.width*this.heightOne;if(this.offsets){var r=this.binaryFormat,l=this.offsets[i].pos,c=0,d=this.width*this.heightOne,h=0,m=0,u=s.data;for(-1!=this.offsets[i].len&&(c+=4*this.offsets[i].len);d>0;)if(0==(h=r[l++]))for((m=r[l++])>d&&(m=d);m>0;)m--,u[c]=u[c+1]=u[c+2]=255,u[c+3]=0,c+=4,d--;else u[c]=u[c+1]=u[c+2]=255-h,u[c+3]=h,c+=4,d--}else s.data.set(new Uint8ClampedArray(this.data.buffer,i*a,a));o.putImageData(s,0,0)}else n||((n=document.createElement("canvas")).width=this.width,n.height=this.heightOne,n.style.width=t+"px",n.style.height=e+"px",o=n.getContext("2d")),o.clearRect(0,0,this.width,this.heightOne),o.drawImage(this.image,0,-this.heightOne*i);return n}}return i.height=s[a].height,i.width=s[a].width,{template:_.template(['<div class="input-group combobox fonts <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control" spellcheck="false" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>"> ','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">','<li class="divider">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>">','<a class="font-item" tabindex="-1" type="menuitem" style="height:<%=scope.getListItemHeight()%>px;"></a>',"</li>","<% }); %>","</ul>","</div>"].join("")),initialize:function(t){Common.UI.ComboBox.prototype.initialize.call(this,_.extend(t,{displayField:"name",scroller:{wheelSpeed:20,alwaysVisibleY:!0,onChange:this.updateVisibleFontsTiles.bind(this)}})),this.recent=_.isNumber(t.recent)?t.recent:5;var e=Common.localStorage.getKeysFilter();this.appPrefix=e&&e.length?e.split(",")[0]:"",Common.NotificationCenter.on("fonts:load",_.bind(this.fillFonts,this))},render:function(t){var e=null,i="";return _.isUndefined(this._input)||(e=this._input.val(),i=this._input.attr("tabindex")),Common.UI.ComboBox.prototype.render.call(this,t),this.setRawValue(e),this._input.attr("tabindex",i),this._input.on("keyup",_.bind(this.onInputKeyUp,this)),this._input.on("keydown",_.bind(this.onInputKeyDown,this)),this._input.on("focus",_.bind((function(){this.inFormControl=!0}),this)),this._input.on("blur",_.bind((function(){this.inFormControl=!1}),this)),this},onAfterKeydownMenu:function(t){var e=this;if(t.keyCode==Common.UI.Keys.RETURN){if($(t.target).closest("input").length){if(this.lastValue===this._input.val())return!0;this._input.trigger("change")}else $(t.target).click(),this.rendered&&(Common.Utils.isIE?this._input.trigger("change",{onkeydown:!0}):this._input.blur());return!1}if(t.keyCode==Common.UI.Keys.ESC&&this.isMenuOpen())return this._input.val(this.lastValue),setTimeout((function(){e.closeMenu(),e.onAfterHideMenu(t)}),10),!1;(t.keyCode==Common.UI.Keys.HOME&&!t.shiftKey||t.keyCode==Common.UI.Keys.END&&!t.shiftKey||t.keyCode==Common.UI.Keys.BACKSPACE&&!e._input.is(":focus"))&&this.isMenuOpen()&&(e._input.focus(),setTimeout((function(){e._input[0].selectionStart=e._input[0].selectionEnd=t.keyCode==Common.UI.Keys.HOME?0:e._input[0].value.length}),10)),this.updateVisibleFontsTiles()},onInputKeyUp:function(t){if(this._isKeyDown){if(t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!==Common.UI.Keys.SHIFT&&t.keyCode!==Common.UI.Keys.CTRL&&t.keyCode!==Common.UI.Keys.ALT&&t.keyCode!==Common.UI.Keys.LEFT&&t.keyCode!==Common.UI.Keys.RIGHT&&t.keyCode!==Common.UI.Keys.HOME&&t.keyCode!==Common.UI.Keys.END&&t.keyCode!==Common.UI.Keys.ESC&&t.keyCode!==Common.UI.Keys.INSERT&&t.keyCode!==Common.UI.Keys.TAB&&(t.stopPropagation(),this.selectCandidate(t.keyCode==Common.UI.Keys.DELETE||t.keyCode==Common.UI.Keys.BACKSPACE),this._selectedItem)){var e=this;void 0===e._timerSelection&&(e._timerSelection=setInterval((function(){if(!(new Date-e._inInputKeyDown<100)&&e._selectedItem){clearInterval(e._timerSelection),e._timerSelection=void 0;var t=e._input[0],i=e._selectedItem.get(e.displayField),n=t.value;e.rendered&&(document.selection?document.selection.createRange().text=i:(t.selectionStart||"0"==t.selectionStart)&&(t.value=i,t.selectionStart=n.length,t.selectionEnd=i.length))}}),10))}this._isKeyDown=!1}},onInputKeyDown:function(t){this._isKeyDown=!0,this._inInputKeyDown=new Date;var e=this;t.keyCode==Common.UI.Keys.ESC?(this._input.val(this.lastValue),setTimeout((function(){e.closeMenu(),e.onAfterHideMenu(t)}),10)):t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.CTRL&&t.keyCode!=Common.UI.Keys.SHIFT&&t.keyCode!=Common.UI.Keys.ALT&&t.keyCode!=Common.UI.Keys.TAB?(this.isMenuOpen()||t.ctrlKey||(this.openMenu(),this.recent>0&&this.flushVisibleFontsTiles()),t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?_.delay((function(){var i=t.keyCode==Common.UI.Keys.DOWN?e.cmpEl.find("ul li.selected").nextAll("li:not(.divider)"):e.cmpEl.find("ul li.selected").prevAll("li:not(.divider)");i=(i=i.length>0?i.eq(0):t.keyCode==Common.UI.Keys.DOWN?e.cmpEl.find("ul li:not(.divider):first"):e.cmpEl.find("ul li:not(.divider):last")).find("a"),e._skipInputChange=!0,i.focus(),e.updateVisibleFontsTiles()}),10):e._skipInputChange=!1):t.keyCode==Common.UI.Keys.RETURN&&this._input.val()===e.lastValue&&this._input.trigger("change",{reapply:!0})},onInputChanged:function(t,e){if(!e||!e.synthetic)if(this._skipInputChange)this._skipInputChange=!1;else if(this._isMouseDownMenu)this._isMouseDownMenu=!1;else{var i=$(t.target).val(),n={};this.lastValue!==i||e&&e.reapply?(n[this.valueField]=i,n[this.displayField]=i,this.trigger("changed:before",this,n,t),t.isDefaultPrevented()||(this._selectedItem?(n[this.valueField]=this._selectedItem.get(this.displayField),this.setRawValue(n[this.valueField]),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),this.addItemToRecent(this._selectedItem),this.closeMenu()):(this.setRawValue(n[this.valueField]),n.isNewFont=!0,this.trigger("selected",this,n,t),this.closeMenu()),this.trigger("changed:after",this,n,t))):e&&e.onkeydown&&this.trigger("combo:blur",this,t)}},getImageUri:function(t){if(t.cloneid){var e=$(this.el).find("ul > li#"+t.cloneid+" img");return null!=e?e[0].src:void 0}var o=Math.floor(t.imgidx/r);return this.spriteThumbs.getImage(o,i,n).toDataURL()},getImageWidth:function(){return t},getImageHeight:function(){return e},getListItemHeight:function(){return 28},loadSprite:function(t){this.spriteThumbs=new m,this.spriteThumbs.load(s[a].path,t)},fillFonts:function(t,e){var i=this;this.loadSprite((function(){if(r=Math.floor(i.spriteThumbs.width/s[a].width)||1,i.store.set(t.toJSON()),i.rendered=!1,_.isUndefined(i.scroller)||(i.scroller.destroy(),delete i.scroller),i._scrollerIsInited=!1,i.render($(i.el)),i._fontsArray=i.store.toJSON(),i.recent>0){i.store.on("add",i.onInsertItem,i),i.store.on("remove",i.onRemoveItem,i),Common.Utils.InternalSettings.set(i.appPrefix+"-settings-recent-fonts",Common.localStorage.getItem(i.appPrefix+"-settings-recent-fonts"));var e=Common.Utils.InternalSettings.get(i.appPrefix+"-settings-recent-fonts");(e=e?e.split(";"):[]).reverse().forEach((function(t){t&&i.addItemToRecent(i.store.findWhere({name:t}),!0)}))}}))},onApiChangeFont:function(t){var e=this,i=_.isFunction(t.get_Name)?t.get_Name():t.asc_getFontName();this.__name!==i&&(this.__name=i,this.__nameId||(this.__nameId=setTimeout((function(){e.onApiChangeFontInternal(e.__name),e.__nameId=null}),100)))},onApiChangeFontInternal:function(t){if(!this.inFormControl&&this.getRawValue()!==t){var e=this.store.findWhere({name:t});if($(".selected",$(this.el)).removeClass("selected"),e){this.setRawValue(e.get(this.displayField));var i=$("#"+e.get("id"),$(this.el)),n=$("ul.dropdown-menu",this.cmpEl);i&&n&&(i.addClass("selected"),this.recent<=0&&n.scrollTop(i.offset().top-n.offset().top))}else this.setRawValue(t)}},itemClicked:function(t){this.__name=void 0,this.__nameId&&(clearTimeout(this.__nameId),this.__nameId=void 0),Common.UI.ComboBox.prototype.itemClicked.apply(this,arguments);var e=$(t.target).closest("li"),i=this.store.findWhere({id:e.attr("id")});this.addItemToRecent(i)},onInsertItem:function(t){$(this.el).find("ul").prepend(_.template(['<li id="<%= item.id %>">','<a class="font-item" tabindex="-1" type="menuitem" style="height:<%=scope.getListItemHeight()%>px;"></a>',"</li>"].join(""))({item:t.attributes,scope:this}))},onRemoveItem:function(t,e,i){$(this.el).find("ul > li#"+t.id).remove()},onBeforeShowMenu:function(t){if(this.store.length<1)t.preventDefault();else if(Common.UI.ComboBox.prototype.onBeforeShowMenu.apply(this,arguments),!this.getSelectedRecord()&&this.getRawValue()){var e=this.store.where({name:this.getRawValue()});e&&e.length&&this.selectRecord(e[e.length-1])}},onAfterShowMenu:function(t){this.alignMenuPosition(),this.recent>0?(this.scroller&&!this._scrollerIsInited&&(this.scroller.update(),this._scrollerIsInited=!0),$(this.el).find("ul").scrollTop(0),this.trigger("show:after",this,t),this.flushVisibleFontsTiles(),this.updateVisibleFontsTiles(null,0),Common.Utils.isGecko&&this.scroller&&this.scroller.update()):Common.UI.ComboBox.prototype.onAfterShowMenu.apply(this,arguments)},onAfterHideMenu:function(t){this.lastValue!==this._input.val()&&this._input.val(this.lastValue),Common.UI.ComboBox.prototype.onAfterHideMenu.apply(this,arguments)},addItemToRecent:function(t,e){if(t&&!(this.recent<1)){var i=this.store.findWhere({name:t.get("name"),type:FONT_TYPE_RECENT});i&&this.store.remove(i);var n=this.store.where({type:FONT_TYPE_RECENT});n.length<this.recent||this.store.remove(n[this.recent-1]);var o=t.clone();if(o.set({type:FONT_TYPE_RECENT,id:Common.UI.getId(),cloneid:t.id}),this.store.add(o,{at:0}),!e){var s=[];this.store.where({type:FONT_TYPE_RECENT}).forEach((function(t){s.push(t.get("name"))})),s=s.join(";"),Common.localStorage.setItem(this.appPrefix+"-settings-recent-fonts",s),Common.Utils.InternalSettings.set(this.appPrefix+"-settings-recent-fonts",s)}}},selectCandidate:function(t){var e=this,i=this._input.val().toLowerCase();this._fontsArray||(this._fontsArray=this.store.toJSON());var n=_.find(this._fontsArray,(function(n){return t?n[e.displayField].toLowerCase()==i:0==n[e.displayField].toLowerCase().indexOf(i)}));if(this._selectedItem=n?this.store.findWhere({id:n.id}):null,$(".selected",$(this.el)).removeClass("selected"),this._selectedItem){var o=$("#"+this._selectedItem.get("id"),$(this.el)),s=$("ul[role=menu]",$(this.el));if(o.length>0&&s.length>0){o.addClass("selected");var a=o.position().top,r=s.scrollTop();0!=a&&s.scrollTop(r+a)}}},updateVisibleFontsTiles:function(t,e){var i=this,n=0,o=i.store.length,s=0;if(i.tiles||(i.tiles=[]),o!==i.tiles.length)for(n=i.tiles.length;n<o;++n)i.tiles.unshift(null);_.isUndefined(e)&&(e=parseInt($(i.el).find(".ps-scrollbar-x-rail").css("bottom")));var a=$(i.el).find(".dropdown-menu").height(),l=Math.max(Math.floor(a/28)+3,0),c=Math.max(Math.floor(-e/28)-1,0),d=c+l,h=$(i.el).find("a");for(n=0;n<o;++n)if(c<=n&&n<d){if(null===i.tiles[n]){s=Math.floor(i.store.at(n).get("imgidx")/r);var m=i.spriteThumbs.getImage(s);i.tiles[n]=m,$(h[n]).get(0).appendChild(m)}}else i.tiles[n]&&(i.tiles[n].parentNode.removeChild(i.tiles[n]),i.tiles[n]=null)},flushVisibleFontsTiles:function(){for(var t=this.tiles.length-1;t>=0;--t)this.tiles[t]&&(this.tiles[t].parentNode.removeChild(this.tiles[t]),this.tiles[t]=null)}}}())})),void 0===Common)var Common={};if(define("common/main/lib/component/ComboDataView",["common/main/lib/component/BaseView","common/main/lib/component/DataView"],(function(){"use strict";Common.UI.ComboDataView=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,itemWidth:80,itemHeight:40,menuMaxHeight:300,autoWidth:!1,enableKeyEvents:!1,beforeOpenHandler:null,additionalMenuItems:null,showLast:!0,minWidth:-1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<div id="<%= id %>" class="combo-dataview <%= cls %>" style="<%= style %>">','<div class="view"></div> ','<div class="button"></div> ',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.id=this.options.id||Common.UI.getId(),this.cls=this.options.cls,this.style=this.options.style,this.hint=this.options.hint,this.store=this.options.store||new Common.UI.DataViewStore,this.groups=this.options.groups,this.itemWidth=this.options.itemWidth,this.itemHeight=this.options.itemHeight,this.menuMaxHeight=this.options.menuMaxHeight,this.beforeOpenHandler=this.options.beforeOpenHandler,this.showLast=this.options.showLast,this.wrapWidth=0,this.rootWidth=0,this.rootHeight=0,this.rendered=!1,this.needFillComboView=!1,this.minWidth=this.options.minWidth,this.autoWidth=this.initAutoWidth=!Common.Utils.isIE10&&!Common.Utils.isIE11&&this.options.autoWidth,this.delayRenderTips=this.options.delayRenderTips||!1,this.itemTemplate=this.options.itemTemplate||_.template(['<div class="style" id="<%= id %>">','<img src="<%= imageUrl %>" width="'+this.itemWidth+'" height="'+this.itemHeight+'" + <% if(typeof imageUrl === "undefined" || imageUrl===null || imageUrl==="") { %> style="visibility: hidden;" <% } %>/>','<% if (typeof title !== "undefined") {%>','<span class="title"><%= title %></span>',"<% } %>","</div>"].join("")),this.fieldPicker=new Common.UI.DataView({cls:"field-picker",allowScrollbar:!1,itemTemplate:this.itemTemplate,delayRenderTips:this.delayRenderTips}),this.openButton=new Common.UI.Button({cls:"open-menu",menu:new Common.UI.Menu({menuAlign:Common.UI.isRTL()?"tr-tr":"tl-tl",offset:[0,3],items:[{template:_.template('<div class="menu-picker-container"></div>')}].concat(null!=this.options.additionalMenuItems?this.options.additionalMenuItems:[])}),dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}),this.menuPicker=new Common.UI.DataView({cls:"menu-picker",parentMenu:this.openButton.menu,outerMenu:this.options.additionalMenuItems?{menu:this.openButton.menu,index:0}:void 0,restoreHeight:this.menuMaxHeight,style:"max-height: "+this.menuMaxHeight+"px;",enableKeyEvents:this.options.enableKeyEvents,groups:this.groups,store:this.store,itemTemplate:this.itemTemplate,delayRenderTips:this.delayRenderTips}),null!=this.options.additionalMenuItems&&this.openButton.menu.setInnerMenu([{menu:this.menuPicker,index:0}]),setInterval(_.bind(this.checkSize,this),500),this.options.el&&this.render()},render:function(t){if(!this.rendered){var e=this;e.trigger("render:before",e),e.cmpEl=e.$el||$(e.el);var i=e.template({id:e.id,cls:e.cls,style:e.style});t?(e.setElement(t,!1),e.cmpEl=$(i),t.html(e.cmpEl)):e.cmpEl.html(i),e.rootWidth=e.cmpEl.width(),e.rootHeight=e.cmpEl.height(),e.fieldPicker.render($(".view",e.cmpEl)),e.openButton.render($(".button",e.cmpEl)),e.menuPicker.render($(".menu-picker-container",e.cmpEl)),e.openButton.menu.cmpEl&&e.openButton.menu.cmpEl&&(e.openButton.menu.menuAlignEl=e.cmpEl,e.openButton.menu.cmpEl.css("min-width",e.itemWidth),e.openButton.menu.on("show:before",_.bind(e.onBeforeShowMenu,e)),e.openButton.menu.on("show:after",_.bind(e.onAfterShowMenu,e)),e.openButton.cmpEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),e.openButton.cmpEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e))),e.options.hint&&(e.cmpEl.attr("data-toggle","tooltip"),e.cmpEl.tooltip({title:e.options.hint,placement:e.options.hintAnchor||"cursor"})),e.fieldPicker.on("item:select",_.bind(e.onFieldPickerSelect,e)),e.menuPicker.on("item:select",_.bind(e.onMenuPickerSelect,e)),e.fieldPicker.on("item:click",_.bind(e.onFieldPickerClick,e)),e.menuPicker.on("item:click",_.bind(e.onMenuPickerClick,e)),e.fieldPicker.on("item:contextmenu",_.bind(e.onPickerItemContextMenu,e)),e.menuPicker.on("item:contextmenu",_.bind(e.onPickerItemContextMenu,e)),e.fieldPicker.el.addEventListener("contextmenu",_.bind(e.onPickerComboContextMenu,e),!1),e.menuPicker.el.addEventListener("contextmenu",_.bind(e.onPickerComboContextMenu,e),!1),Common.NotificationCenter.on("more:toggle",_.bind(this.onMoreToggle,this)),e.onResize(),e.rendered=!0,e.trigger("render:after",e)}return this.disabled&&this.setDisabled(!!this.disabled),this},onMoreToggle:function(t,e){e&&this.checkSize()},checkSize:function(){if(this.cmpEl&&this.cmpEl.is(":visible")){if(this.autoWidth&&this.menuPicker.store.length>0){var t=this.$el.width();if(t!=this.wrapWidth||this.needFillComboView){this.wrapWidth=t,this.autoChangeWidth();var e=this.menuPicker,i=e.getSelectedRec();this.fillComboView(i||e.store.at(0),!!i,!0)}}var n=this,o=this.cmpEl.width(),s=this.cmpEl.height();if(o<this.minWidth)return;this.rootWidth==o&&this.rootHeight==s||(this.rootWidth=o,this.rootHeight=s,setTimeout((function(){n.openButton.menu.cmpEl.outerWidth(),n.rootWidth=n.cmpEl.width()}),10),this.onResize())}},onResize:function(){if(this.openButton){var t=$("button",this.openButton.cmpEl),e=$(".button",this.cmpEl);t&&e.width()>0&&t.css({width:e.width(),height:e.height()}),this.openButton.menu.hide();var i=this.menuPicker;if(i){var n=i.getSelectedRec();this.itemMarginLeft=void 0,this.fillComboView(n||i.store.at(0),!!n,!0),i.onResize()}}this.isSuspendEvents||this.trigger("resize",this)},autoChangeWidth:function(){if(this.menuPicker.dataViewItems[0]){var t=this.$el.width(),e=this.menuPicker.dataViewItems[0].$el,i=this.itemWidth+parseFloat(e.css("padding-left"))+parseFloat(e.css("padding-right"))+2*parseFloat(e.css("border-width")),n=parseFloat(e.css("margin-left"))+parseFloat(e.css("margin-right")),o=this.fieldPicker.$el,s=parseFloat(o.css(Common.UI.isRTL()?"padding-left":"padding-right")),a=parseFloat(o.css("border-width")),r=parseFloat(this.fieldPicker.$el.find(".dataview").css("padding-left"))+parseFloat(this.fieldPicker.$el.find(".dataview").css("padding-right")),l=this.cmpEl,c=parseFloat(l.css("padding-left"))+parseFloat(l.css("padding-right")),d=Math.floor((t-s-r-2*a-c)/(i+n));d>this.store.length&&(d=this.store.length);var h=Math.ceil(10*(d*(i+n)+s+r+2*a+c))/10,m=parseFloat(l.css("max-width"));h>m&&(h=m),l.css("width",h),this.initAutoWidth&&(this.initAutoWidth=!1,l.css("position","absolute"),l.css("top","50%"),l.css("bottom","50%"),l.css("margin","auto 0"))}},onBeforeShowMenu:function(t){var e=this;if(_.isFunction(e.beforeOpenHandler))e.beforeOpenHandler(e,t);else if(e.openButton.menu.cmpEl){var i=0;try{var n=$($(".dropdown-menu .dataview.inner .style",e.cmpEl)[0]);i=n?parseInt(n.css("margin-left"))+parseInt(n.css("margin-right")):0}catch(t){}e.openButton.menu.cmpEl.css({width:Math.round((e.cmpEl.width()+i*e.fieldPicker.store.length)/e.itemWidth-.2)*(e.itemWidth+i),"min-height":this.cmpEl.height()})}if(e.options.hint){var o=e.cmpEl.data("bs.tooltip");o&&(void 0===o.dontShow&&(o.dontShow=!0),o.hide())}this.menuPicker.selectedBeforeHideRec=null},onBeforeHideMenu:function(t){if(this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault(),this.isStylesNotClosable)return!1},onAfterShowMenu:function(t){this.menuPicker.scroller&&this.menuPicker.scroller.update({includePadding:!0,suppressScrollX:!0,alwaysVisibleY:!0})},onAfterHideMenu:function(t,e){this.menuPicker.selectedBeforeHideRec=this.menuPicker.getSelectedRec(),this.showLast?this.menuPicker.showLastSelected():this.menuPicker.deselectAll(),this.trigger("hide:after",this,t,e)},onFieldPickerSelect:function(t,e,i){},onMenuPickerSelect:function(t,e,i,n){this.needFillComboView=this.disabled,this.disabled||!0===n||(this.fillComboView(i,!1),i&&!this.isSuspendEvents&&this.trigger("select",this,i))},onFieldPickerClick:function(t,e,i){if(!this.disabled){if(this.isSuspendEvents||this.trigger("click",this,i),this.options.hint){var n=this.cmpEl.data("bs.tooltip");n&&(void 0===n.dontShow&&(n.dontShow=!0),n.hide())}this.showLast||this.fieldPicker.deselectAll()}},onMenuPickerClick:function(t,e,i){this.disabled||this.isSuspendEvents||this.trigger("click",this,i)},onPickerItemContextMenu:function(t,e,i,n){if(!this.disabled)return this.isSuspendEvents||this.trigger("contextmenu",this,i,n),n.preventDefault(),n.stopPropagation(),!1},onPickerComboContextMenu:function(t){this.disabled||this.isSuspendEvents||this.trigger("contextmenu",this,void 0,t)},setDisabled:function(t){if(t=!!t,this.disabled=t,this.rendered&&(this.cmpEl.toggleClass("disabled",t),$("button",this.openButton.cmpEl).toggleClass("disabled",t),this.fieldPicker.setDisabled(t),this.needFillComboView&&!t)){var e=this.menuPicker;if(e){var i=e.getSelectedRec();this.fillComboView(i||e.store.at(0),!1)}}},isDisabled:function(){return this.disabled},fillComboView:function(t,e,i){if(!_.isUndefined(t)&&t instanceof Backbone.Model){this.needFillComboView=!this.isVisible();var n=this,o=n.menuPicker.store,s=$(n.fieldPicker.el);if(o){if(i||!n.fieldPicker.store.findWhere({id:t.get("id")})){if(void 0===n.itemMarginLeft){var a=$($(this.menuPicker.el).find(".inner > div:not(.grouped-data):not(.ps-scrollbar-x-rail):not(.ps-scrollbar-y-rail)")[0]);(!a||a.length<1)&&(a=$($(this.menuPicker.el).find(".inner .group-items-container > div:not(.grouped-data):not(.ps-scrollbar-x-rail):not(.ps-scrollbar-y-rail)")[0])),a.length>0&&(n.itemMarginLeft=parseInt(a.css("margin-left")),n.itemMarginRight=parseInt(a.css("margin-right")),n.itemPaddingLeft=parseInt(a.css("padding-left")),n.itemPaddingRight=parseInt(a.css("padding-right")),n.itemBorderLeft=parseInt(a.css("border-left-width")),n.itemBorderRight=parseInt(a.css("border-right-width")))}var r=o.indexOf(t);if(r<0)return;var l=o.length,c=Math.floor(Math.max(s.width(),n.minWidth)/(n.itemWidth+(n.itemMarginLeft||0)+(n.itemMarginRight||0)+(n.itemPaddingLeft||0)+(n.itemPaddingRight||0)+(n.itemBorderLeft||0)+(n.itemBorderRight||0))),d=[];s.height()/n.itemHeight>2&&(c*=Math.floor(s.height()/n.itemHeight)),l-(r=Math.floor(r/c)*c)<c&&(r=Math.max(l-c,0));for(var h=r,m=0;h<l&&m<c;h++,m++)d.push(o.at(h));n.fieldPicker.store.reset(d)}if(e){var u=n.fieldPicker.store.findWhere({id:t.get("id")});u&&(n.suspendEvents(),n.fieldPicker.selectRecord(u,!0),n.resumeEvents())}return n.fieldPicker.store.models}}},clearComboView:function(){this.fieldPicker.store.reset([])},selectByIndex:function(t){t<0&&this.fieldPicker.deselectAll(),this.menuPicker.selectByIndex(t)},selectRecord:function(t){t||this.fieldPicker.deselectAll(),this.menuPicker.selectRecord(t)},setItemWidth:function(t){this.itemWidth!=t&&(this.itemWidth=Common.Utils.applicationPixelRatio()>1?t/2:t)},setItemHeight:function(t){this.itemHeight!=t&&(this.itemHeight=Common.Utils.applicationPixelRatio()>1?t/2:t)},removeTips:function(){var t=this.menuPicker;_.each(t.dataViewItems,(function(t){var e=t.$el.data("bs.tooltip");e&&e.tip().remove()}),t)}})})),void 0===Common)var Common={};if(define("common/main/lib/component/SynchronizeTip",["common/main/lib/component/BaseView"],(function(){"use strict";Common.UI.SynchronizeTip=Common.UI.BaseView.extend(_.extend({options:{target:$(document.body),text:"",placement:"right-bottom",showLink:!0,showButton:!1,closable:!0},template:_.template(['<div class="synch-tip-root <% if (!!scope.options.extCls) {print(scope.options.extCls + " ");} %><%= scope.placement %>" style="<%= scope.style %>">','<div class="asc-synchronizetip">','<div class="tip-arrow <%= scope.placement %>"></div>',"<div>",'<div class="tip-text"><%= scope.text %></div>',"<% if ( scope.closable ) { %>",'<div class="close"></div>',"<% } %>","</div>","<% if ( scope.showLink ) { %>",'<div class="show-link"><label><%= scope.textLink %></label></div>',"<% } %>","<% if ( scope.showButton ) { %>",'<div class="btn-div"><%= scope.textButton %></div>',"<% } %>","</div>","</div>"].join("")),initialize:function(t){this.textSynchronize+=Common.Utils.String.platformKey("Ctrl+S"),Common.UI.BaseView.prototype.initialize.call(this,t),this.target=this.options.target,this.text=_.isEmpty(this.options.text)?this.textSynchronize:this.options.text,this.textLink=_.isEmpty(this.options.textLink)?this.textDontShow:this.options.textLink,this.placement=this.options.placement,this.showLink=this.options.showLink,this.showButton=this.options.showButton,this.closable=this.options.closable,this.textButton=this.options.textButton||"",this.position=this.options.position,this.style=this.options.style||""},render:function(){return this.cmpEl||(this.cmpEl=$(this.template({scope:this})),$(document.body).append(this.cmpEl),this.cmpEl.find(".close").on("click",_.bind((function(){this.trigger("closeclick")}),this)),this.cmpEl.find(".show-link label").on("click",_.bind((function(){this.trigger("dontshowclick")}),this)),this.cmpEl.find(".btn-div").on("click",_.bind((function(){this.trigger("buttonclick")}),this)),this.closable&&this.cmpEl.addClass("closable")),this.applyPlacement(),this},show:function(){this.cmpEl?(this.applyPlacement(),this.cmpEl.show()):this.render()},hide:function(){this.cmpEl&&this.cmpEl.hide(),this.trigger("hide")},close:function(){this.cmpEl&&this.cmpEl.remove()},applyPlacement:function(){var t=this.target&&this.target.length>0?this.target:$(document.body),e=t.offset();if("target"!=this.placement||this.position){if(this.position&&"object"==typeof this.position){var i=this.position.top,n=this.position.left,o=this.position.bottom,s=this.position.right;return void 0!==o||void 0!==i?n=e.left+(t.width()-this.cmpEl.width())/2:i=e.top+(t.height()-this.cmpEl.height())/2,i=void 0!==i?i+"px":"auto",o=void 0!==o?o+"px":"auto",s=void 0!==s?s+"px":"auto",n=void 0!==n?n+"px":"auto",void this.cmpEl.css({top:i,left:n,right:s,bottom:o})}var a=this.placement.split("-");if(a.length>0){var r=a[0];if("top"==r?o=Common.Utils.innerHeight()-e.top:"bottom"==r?i=e.top+t.height():"left"==r?s=Common.Utils.innerWidth()-e.left:"right"==r&&(n=e.left+t.width()),"top"==(r=a[1]))o=Common.Utils.innerHeight()-e.top-t.height()/2;else if("bottom"==r){i=e.top+t.height()/2;var l=this.cmpEl.height();i+l>Common.Utils.innerHeight()&&(i=Common.Utils.innerHeight()-l-10)}else"left"==r?s=Common.Utils.innerWidth()-e.left-t.width()/2:"right"==r?n=e.left+t.width()/2:void 0!==o||void 0!==i?n=e.left+(t.width()-this.cmpEl.width())/2:i=e.top+(t.height()-this.cmpEl.height())/2;if(i=void 0!==i?i+"px":"auto",o=void 0!==o?o+"px":"auto",s=void 0!==s?s+"px":"auto",void 0!==n){var c=this.cmpEl.width();n+c>Common.Utils.innerWidth()&&(n=Common.Utils.innerWidth()-c-10),n+="px"}else n="auto";this.cmpEl.css({top:i,left:n,right:s,bottom:o})}}else this.cmpEl.css({top:e.top+5+"px",left:e.left+5+"px"})},isVisible:function(){return this.cmpEl&&this.cmpEl.is(":visible")},textDontShow:"Don't show this message again",textSynchronize:"The document has been changed by another user.<br>Please click to save your changes and reload the updates."},Common.UI.SynchronizeTip||{}))})),define("common/main/lib/component/Mixtbar",["backbone","common/main/lib/component/BaseView"],(function(t){"use strict";Common.UI.Mixtbar=Common.UI.BaseView.extend(function(){var t,e,i,n={timeout:2e3},o={},s=[];function a(){var n=t.scrollLeft();e.toggleClass("disabled",0==n),i.toggleClass("disabled",Math.round(n)==t[0].scrollWidth-t[0].clientWidth)}var r=function(e,i){if(!$(i.target).hasClass("disabled")){var n=t.scrollLeft();(n||"right"==e||Common.UI.isRTL()&&"left"==e)&&t.animate({scrollLeft:"left"==e?n-100:n+100},200,a)}},l=function(e){e.preventDefault();var i=e.deltaX||e.detail||e.deltaY;t.scrollLeft(t.scrollLeft()+60*i),a()};function c(t){var e=$(t.currentTarget).find("> a[data-tab]").data("tab");this.dblclick_el==e&&(this.fireEvent("change:compact",[e]),this.dblclick_el=void 0)}function d(t){this.isFolded&&($(t.target).parents(".toolbar, #file-menu-panel").length||n.$bar&&n.$bar.hasClass("expanded")&&this.collapse())}return{$tabs:void 0,$panels:void 0,isFolded:!1,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=Common.UI.isRTL()?'<section class="tabs"><a class="scroll right" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="R"></a><ul><% for(var i in items) { %><% if (typeof items[i] == "object") { %><li class="ribtab<% if (items[i].haspanel===false) print(" x-lone") %><% if (items[i].extcls) print(\' \' + items[i].extcls) %>"<% if (typeof items[i].layoutname == "string") print(" data-layout-name=" + \' \' +  items[i].layoutname) + \' \' %>><a data-tab="<%= items[i].action %>" data-title="<%= items[i].caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof items[i].dataHintTitle !== "undefined") { %> data-hint-title="<%= items[i].dataHintTitle %>" <% } %>><%= items[i].caption %></a></li><% } %><% } %></ul><a class="scroll left" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="V"></a></section>':'<section class="tabs"><a class="scroll left" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="V"></a><ul><% for(var i in items) { %><% if (typeof items[i] == "object") { %><li class="ribtab<% if (items[i].haspanel===false) print(" x-lone") %><% if (items[i].extcls) print(\' \' + items[i].extcls) %>"<% if (typeof items[i].layoutname == "string") print(" data-layout-name=" + \' \' +  items[i].layoutname) + \' \' %>><a data-tab="<%= items[i].action %>" data-title="<%= items[i].caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof items[i].dataHintTitle !== "undefined") { %> data-hint-title="<%= items[i].dataHintTitle %>" <% } %>><%= items[i].caption %></a></li><% } %><% } %></ul><a class="scroll right" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="R"></a></section>';this.$layout=$(t.template({tabsmarkup:_.template(e)({items:t.tabs}),isRTL:Common.UI.isRTL()})),o.tabs=t.tabs,$(document.body).on("click",d.bind(this)),Common.NotificationCenter.on("tab:visible",_.bind((function(t,e){this.setVisible(t,e)}),this)),Common.NotificationCenter.on("tab:resize",_.bind(this.onResizeTabs,this))},afterRender:function(){var o=this;t=o.$(".tabs > ul"),o.$tabs=t.find("> li"),o.$boxpanels=o.$(".box-panels"),o.$panels=o.$boxpanels.find("> .panel"),n.$bar=o.$(".toolbar"),i=o.$(".tabs .scroll.right"),(e=o.$(".tabs .scroll.left")).on("click",r.bind(this,"left")),i.on("click",r.bind(this,"right")),t.on("dblclick","> .ribtab",c.bind(this)),t.on("click","> .ribtab",o.onTabClick.bind(this)),t.on("mousewheel",l)},isTabActive:function(t){var e=this.$tabs.filter(".active").find("> a");return e.length&&e.data("tab")==t},setFolded:function(t){this.isFolded=t;var e=this;if(this.isFolded)n.$box||(n.$box=e.$el.find(".box-controls")),n.$bar.addClass("folded z-clear").toggleClass("expanded",!1),n.$bar.find(".tabs .ribtab").removeClass("active"),n.$bar.on($.support.transition.end,(function(t){n.$bar.hasClass("folded")&&!n.$bar.hasClass("expanded")&&n.$bar.toggleClass("z-clear",!0)})),n.$box.on({mouseleave:function(t){},mouseenter:function(t){}});else{n.$bar.removeClass("folded z-clear"),n.$box.off();var i=n.$box.find(".panel.active");if(i.length){var o=i.data("tab");e.$tabs.find("> a[data-tab="+o+"]").parent().toggleClass("active",!0)}else o=e.$tabs.siblings(":not(.x-lone):visible").first().find("> a[data-tab]").data("tab"),e.setTab(o)}},collapse:function(){Common.UI.Menu.Manager.hideAll(),this.isFolded&&n.$bar&&(n.$bar.removeClass("expanded"),n.$bar.find(".tabs .ribtab").removeClass("active"))},expand:function(){n.$bar.removeClass("z-clear"),n.$bar.addClass("expanded")},onResizeTabs:function(e){this.hasTabInvisible()?t.parent().hasClass("short")||(t.parent().addClass("short"),a()):t.parent().hasClass("short")&&t.parent().removeClass("short")},onResize:function(t){this.onResizeTabs(),this.hideMoreBtns(),this.processPanelVisible()},onTabClick:function(t){var e=this,i=$(t.currentTarget),n=i.find("> a[data-tab]").data("tab");i.hasClass("x-lone")?e.isFolded&&e.collapse():i.hasClass("active")?e._timerSetTab||(e.dblclick_el=n,e.isFolded&&(e.collapse(),setTimeout((function(){e.dblclick_el=void 0}),500))):(e._timerSetTab=!0,setTimeout((function(){e._timerSetTab=!1}),500),e.setTab(n),e.isFolded?e.dblclick_el=n:(e.dblclick_timer&&clearTimeout(e.dblclick_timer),e.dblclick_timer=setTimeout((function(){e.dblclick_el=n,delete e.dblclick_timer}),500)))},setTab:function(t){var e=this;if(t||(this.isFolded?this.collapse():t=this.lastPanel),t){e.$tabs.removeClass("active"),e.$panels.removeClass("active"),e.hideMoreBtns();var i=this.$panels.filter("[data-tab="+t+"]");i.length&&(this.lastPanel=t,i.addClass("active"),e.setMoreButton(t,i),e.processPanelVisible(null,!0,!0)),i.length?e.isFolded&&e.expand():e.isFolded&&e.collapse();var n=this.$tabs.find("> a[data-tab="+t+"]").parent();n.length&&n.addClass("active"),this.fireEvent("tab:active",[t])}},addTab:function(e,i,n){var s=_.template('<li class="ribtab" style="display: none;" <% if (typeof layoutname == "string") print(" data-layout-name=" + \' \' +  layoutname) + \' \' %>><a data-tab="<%= action %>" data-title="<%= caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof dataHintTitle !== "undefined") { %> data-hint-title="<%= dataHintTitle %>" <% } %> ><%= caption %></a></li>');o.tabs[n+1]=e;var a=function t(e){return o.tabs[e]?o.tabs[e].action:t(--e)}(n),r=this.$tabs||this.$layout.find(".tabs"),l=r.find("a[data-tab="+a+"]");l.length&&(l.parent().after(s(e)),i&&((l=(r=this.$panels||this.$layout.find(".box-panels > .panel")).filter("[data-tab="+a+"]")).length?l.after(i):i.appendTo(this.$layout.find(".box-panels"))),this.$tabs&&(this.$tabs=t.find("> li")),this.$panels&&(this.$panels=this.$el.find(".box-panels > .panel")))},isCompact:function(){return this.isFolded},hasTabInvisible:function(){if(t.length<1)return!1;var e=Math.round(t.offset().left),i=Math.round(e+t.width()),n=this.$tabs.filter(Common.UI.isRTL()?":visible:last":":visible:first").get(0);if(!n)return!1;var o=n.getBoundingClientRect();return Math.round(o.left)<e||(o=(n=this.$tabs.filter(Common.UI.isRTL()?":visible:first":":visible:last").get(0)).getBoundingClientRect(),Math.round(o.right)>i)},processPanelVisible:function(t,e,i){var n=this;function o(){var e=t||n.$panels.filter(".active");if(e&&e.length){var o=e.parents(".box-controls").width(),s=e.parents(".box-controls").find(".panel.static").outerWidth();s||(s=0);var a=e.data(),r=a.rightedge,l=a.buttons,c=a.flex,d=e.find(".more-box");if(0===d.length&&n.setMoreButton(e.attr("data-tab"),e),r||(r=e.outerWidth()+s),l||(l=[],_.each(e.find(".btn-slot .x-huge"),(function(t){l.push($(t).closest(".btn-slot"))})),a.buttons=l),c||(c=[],_.each(e.find(".group.flex"),(function(t){var e=$(t);c.push({el:e,width:e.attr("data-group-width")||e.attr("max-width")})})),a.flex=c),r>o){if(!d.is(":visible")){if(c.length>0)for(var h=0;h<c.length;h++){var m=c[h].el;if(r=e.outerWidth()+s,Math.floor(m.outerWidth())>parseInt(m.css("min-width")))return void(a.rightedge=r);m.css("width",m.css("min-width"))}for(h=l.length-1;h>=0;h--){if(!(u=l[h]).hasClass("compactwidth")&&!u.hasClass("slot-btn-more")&&(u.addClass("compactwidth"),(r=e.outerWidth()+s)<=o))break}a.rightedge=r}n.resizeToolbar(i)}else if(d.is(":visible")&&n.resizeToolbar(i),!d.is(":visible")){for(h=0;h<l.length;h++){var u;if((u=l[h]).hasClass("compactwidth")&&(u.removeClass("compactwidth"),(r=e.outerWidth()+s)>o)){u.addClass("compactwidth"),r=e.outerWidth()+s;break}}if(a.rightedge=r,c.length>0&&e.find(".btn-slot.compactwidth").length<1)for(h=0;h<c.length;h++){(m=c[h]).el.css("width",m.width),a.rightedge=e.get(0).getBoundingClientRect().right}}}}n._timer_id&&clearTimeout(n._timer_id),!0===e?o():n._timer_id=setTimeout((function(){delete n._timer_id,o()}),100)},setExtra:function(t,e){e&&(this.$tabs||("right"==t?this.$layout.find(".extra.right").html(e):"left"==t&&this.$layout.find(".extra.left").html(e)))},setVisible:function(t,e){t&&this.$tabs&&(this.$tabs.find("> a[data-tab="+t+"]").parent().css("display",e?"":"none"),this.onResize())},setMoreButton:function(t,e){var i=this;if(!s[t]){var o=e.position().top,a=$('<div class="more-box" style="top:'+o+'px;"><div class="separator long" style="position: relative;display: table-cell;"></div><div class="group" style=""><span class="btn-slot text x-huge slot-btn-more"></span></div></div>');e.append(a),s[t]=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top dropdown-manual",caption:Common.Locale.get("textMoreButton",{name:"Common.Translation",default:"More"}),iconCls:"toolbar__icon btn-more",enableToggle:!0}),s[t].render(a.find(".slot-btn-more")),s[t].on("toggle",(function(t,e,n){e?i.onMoreShow(t,n):i.onMoreHide(t,n),Common.NotificationCenter.trigger("more:toggle",t,e)}));var r=$('<div class="dropdown-menu more-container" data-tab="'+t+'"><div style="display: inline;"></div></div>');n.$bar.append(r),s[t].panel=r.find("div")}this.$moreBar=s[t].panel},clearMoreButton:function(t){var e=this.$panels.filter("[data-tab="+t+"]");if(e.length){var i=e.data();i.buttons=i.flex=i.rightedge=i.leftedge=void 0,e.find(".more-box").remove()}s[t]&&(n.$bar.find('.more-container[data-tab="'+t+'"]').remove(),s[t].remove(),delete s[t])},resizeToolbar:function(t){var e=this.$panels.filter(".active"),i=e.find(".more-box");0===i.length&&this.setMoreButton(e.attr("data-tab"),e);var n=parseInt(i.css("width"))||0,o=e.parents(".box-controls").width(),s=e.parents(".box-controls").find(".panel.static").outerWidth(),a=o;s||(s=0);var r=e.outerWidth()+s,l=this._prevBoxWidth?a-this._prevBoxWidth:-1,c=!1;if(this._prevBoxWidth=a,i.is(":visible")&&(a-=n),this.$moreBar&&this.$moreBar.parent().is(":visible")&&this.$moreBar.parent().css("max-width",Common.Utils.innerWidth()),(t||l<0)&&r>a){i.is(":visible")||(i.css("display","block"),a-=parseInt(i.css("width")));var d=null,h=null;(x=this.$moreBar.children().filter("[data-hidden-tb-item!=true]")).length>0&&((x=$(x[0])).hasClass("separator")&&(d=x),x.hasClass("group")&&"open"==x.attr("group-state")&&(h=x));for(var m=!1,u=(_=e.find("> div:not(.more-box)")).length-1;u>=0;u--){if((k=$(_[u])).is(":visible")||k.attr("hidden-on-resize"))if(k.hasClass("group")){if((r=e.outerWidth()+s)<=a)break;var p=k.get(0).getBoundingClientRect(),f=k.outerWidth(),g=k.children();if(!k.attr("inner-width")&&"open"!==k.attr("group-state")){k.attr("inner-width",f);for(var b=g.length-1;b>=0;b--){(A=$(g[b])).attr("inner-width",A.outerWidth())}}if((p.left>a||Common.UI.isRTL()&&o-p.right>a||1==g.length)&&"open"!=k.attr("group-state"))this.$moreBar.prepend(k),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),c=!0;else{if(!((Common.UI.isRTL()?o-p.right:p.left)+f>a))break;for(b=g.length-1;b>=0;b--){if((A=$(g[b])).hasClass("elset")){this.$moreBar.prepend(k),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),c=!0;break}var v=A.get(0).getBoundingClientRect(),C=A.outerWidth();if(!((Common.UI.isRTL()?o-v.right:v.left)+C>a)){m=!0;break}if(!h){(h=$("<div></div>")).addClass(_[u].className);for(var y=_[u].attributes,w=0;w<y.length;w++)h.attr(y[w].name,y[w].value);this.$moreBar.prepend(h),d&&(d.css("display",""),d.removeAttr("hidden-on-resize"))}h.prepend(A),c=!0}if(k.children().length<1?(k.remove(),h&&h.removeAttr("group-state").attr("inner-width",k.attr("inner-width")),h=null):h&&h.attr("group-state","open")&&k.attr("group-state","open"),m)break}d=null}else k.hasClass("separator")&&(this.$moreBar.prepend(k),k.css("display","none"),k.attr("hidden-on-resize",!0),d=k,c=!0);else k.attr("data-hidden-tb-item",!0),this.$moreBar.prepend(k),c=!0}}else if((t||l>0)&&i.is(":visible")){d=null,h=null;var x,_,S=0;if((x=e.find("> div:not(.more-box)")).length>0&&((x=$(x[x.length-1])).hasClass("separator")&&(d=x,S=parseInt(d.css("margin-left"))+parseInt(d.css("margin-right"))+1),x.hasClass("group")&&"open"==x.attr("group-state")&&(h=x)),(_=this.$moreBar.children()).length>0)for(u=0;u<_.length;u++){var k=$(_[u]);if(r=e.outerWidth()+s,!k.is(":visible")&&k.attr("data-hidden-tb-item"))k.removeAttr("data-hidden-tb-item"),i.before(k),0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none"));else if(k.hasClass("group")){var T=!1;if(1==this.$moreBar.children().filter(".group").length&&(a=o,T=!0),r+S+(f=parseInt(k.attr("inner-width")||0))<a&&"open"!=k.attr("group-state"))i.before(k),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none")),c=!0;else{if(!(r+S<a))break;g=k.children();a=o-n;for(b=0;b<g.length;b++){var A;if(T&&b==g.length-1&&(a=o),r=e.outerWidth()+s,(A=$(g[b])).hasClass("elset")){m=!0;break}if(!(r+S+(C=parseInt(A.attr("inner-width")||0)+(h?0:parseInt(k.css("padding-left"))))<a)){m=!0;break}if(!h){(h=$("<div></div>")).addClass(_[u].className);for(y=_[u].attributes,w=0;w<y.length;w++)h.attr(y[w].name,y[w].value);h.hasClass("flex")&&(e.data().flex=null),i.before(h),d&&(d.css("display",""),d.removeAttr("hidden-on-resize"))}h.append(A),c=!0}if(k.children().length<1?(k.remove(),h&&h.removeAttr("group-state").attr("inner-width",k.attr("inner-width")),h=null,0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none"))):h&&h.attr("group-state","open")&&k.attr("group-state","open"),m)break}d=null,S=0}else k.hasClass("separator")&&(i.before(k),k.css("display","none"),k.attr("hidden-on-resize",!0),d=k,S=parseInt(d.css("margin-left"))+parseInt(d.css("margin-right"))+1,c=!0)}else this.hideMoreBtns(),i.css("display","none")}c&&Common.UI.Menu.Manager.hideAll()},onMoreHide:function(t,e){var i=t.panel.parent();t.pressed&&t.toggle(!1,!0),i.is(":visible")&&(i.hide(),Common.NotificationCenter.trigger("edit:complete",this.toolbar,t))},onMoreShow:function(t,e){var i=t.panel.parent(),n=i.parent().offset(),o=t.$el,s=o.offset(),a=Common.Utils.innerWidth()-(s.left-n.left+o.width()),r=s.top-n.top+o.height()+10,l=Common.UI.isRTL()?{left:"6px",right:"auto",top:r,"max-width":Common.Utils.innerWidth()+"px"}:{right:a,left:"auto",top:r,"max-width":Common.Utils.innerWidth()+"px"};i.css(l),i.show()},hideMoreBtns:function(){for(var t in s)s[t]&&s[t].isActive()&&s[t].toggle(!1)}}}())})),void 0===Common)var Common={};if(define("pdfeditor/main/app/view/Toolbar",["jquery","underscore","backbone","text!pdfeditor/main/app/template/Toolbar.template","text!documenteditor/main/app/template/ToolbarView.template","common/main/lib/collection/Fonts","common/main/lib/component/Button","common/main/lib/component/ColorButton","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/ColorPalette","common/main/lib/component/ThemeColorPalette","common/main/lib/component/Menu","common/main/lib/component/Window","common/main/lib/component/ComboBoxFonts","common/main/lib/component/ComboDataView","common/main/lib/component/SynchronizeTip","common/main/lib/component/Mixtbar"],(function(t,e,i,n,o){"use strict";Common.enumLock||(Common.enumLock={});var s={undoLock:"can-undo",redoLock:"can-redo",copyLock:"can-copy",inLightTheme:"light-theme",noParagraphSelected:"no-paragraph",cantPrint:"cant-print",lostConnect:"disconnect",disableOnStart:"on-start",firstPage:"first-page",lastPage:"last-page"};for(var a in s)s.hasOwnProperty(a)&&(Common.enumLock[a]=s[a]);PDFE.Views.Toolbar=Common.UI.Mixtbar.extend(e.extend({el:"#toolbar",events:{},initialize:function(){return this.paragraphControls=[],this.toolbarControls=[],this._state={hasCollaborativeChanges:void 0},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),this},applyLayout:function(t){var i=this;i.lockControls=[];var s=Common.enumLock;return t.isEdit?(Common.UI.Mixtbar.prototype.initialize.call(this,{template:e.template(n),tabs:[{caption:i.textTabFile,action:"file",extcls:"canedit",layoutname:"toolbar-file",haspanel:!1,dataHintTitle:"F"},{caption:i.textTabHome,action:"home",extcls:"canedit",dataHintTitle:"H"},{caption:i.textTabComment,action:"comment",extcls:"canedit",dataHintTitle:"C"}]}),this.btnSaveCls="btn-save",this.btnSaveTip=this.tipSave,this.btnPrint=new Common.UI.Button({id:"id-toolbar-btn-print",cls:"btn-toolbar",iconCls:"toolbar__icon btn-print no-mask",lock:[s.cantPrint,s.disableOnStart],signals:["disabled"],split:t.canQuickPrint,menu:t.canQuickPrint,dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"P",printType:"print"}),this.toolbarControls.push(this.btnPrint),this.btnSave=new Common.UI.Button({id:"id-toolbar-btn-save",cls:"btn-toolbar",iconCls:"toolbar__icon no-mask "+this.btnSaveCls,lock:[s.lostConnect,s.disableOnStart],signals:["disabled"],dataHint:"1",dataHintDirection:"top",dataHintTitle:"S"}),this.toolbarControls.push(this.btnSave),this.btnCollabChanges=this.btnSave,this.btnUndo=new Common.UI.Button({id:"id-toolbar-btn-undo",cls:"btn-toolbar",iconCls:"toolbar__icon btn-undo",lock:[s.undoLock,s.previewReviewMode,s.lostConnect,s.disableOnStart,s.docLockView],signals:["disabled"],dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"Z"}),this.toolbarControls.push(this.btnUndo),this.btnRedo=new Common.UI.Button({id:"id-toolbar-btn-redo",cls:"btn-toolbar",iconCls:"toolbar__icon btn-redo",lock:[s.redoLock,s.previewReviewMode,s.lostConnect,s.disableOnStart,s.docLockView],signals:["disabled"],dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"Y"}),this.toolbarControls.push(this.btnRedo),this.btnCopy=new Common.UI.Button({id:"id-toolbar-btn-copy",cls:"btn-toolbar",iconCls:"toolbar__icon btn-copy",lock:[s.copyLock,s.previewReviewMode,s.viewFormMode,s.lostConnect,s.disableOnStart],dataHint:"1",dataHintDirection:"top",dataHintTitle:"C"}),this.toolbarControls.push(this.btnCopy),this.btnPaste=new Common.UI.Button({id:"id-toolbar-btn-paste",cls:"btn-toolbar",iconCls:"toolbar__icon btn-paste",lock:[s.paragraphLock,s.headerLock,s.richEditLock,s.plainEditLock,s.previewReviewMode,s.viewFormMode,s.lostConnect,s.disableOnStart,s.docLockView,s.docLockComments],dataHint:"1",dataHintDirection:"top",dataHintTitle:"V"}),this.paragraphControls.push(this.btnPaste),this.btnCut=new Common.UI.Button({id:"id-toolbar-btn-cut",cls:"btn-toolbar",iconCls:"toolbar__icon btn-cut",lock:[s.copyLock,s.paragraphLock,s.headerLock,s.richEditLock,s.plainEditLock,s.imageLock,s.previewReviewMode,s.viewFormMode,s.lostConnect,s.disableOnStart,s.docLockView,s.docLockComments],dataHint:"1",dataHintDirection:"top",dataHintTitle:"X"}),this.paragraphControls.push(this.btnCut),this.btnSelectAll=new Common.UI.Button({id:"id-toolbar-btn-select-all",cls:"btn-toolbar",iconCls:"toolbar__icon btn-select-all",lock:[s.viewFormMode,s.disableOnStart],dataHint:"1",dataHintDirection:"bottom"}),this.toolbarControls.push(this.btnSelectAll),this.btnSelectTool=new Common.UI.Button({id:"tlbtn-selecttool",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-select",lock:[s.disableOnStart],caption:i.capBtnSelect,toggleGroup:"select-tools-tb",enableToggle:!0,allowDepress:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnSelectTool),this.btnHandTool=new Common.UI.Button({id:"tlbtn-handtool",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-hand-tool",lock:[s.disableOnStart],caption:i.capBtnHand,toggleGroup:"select-tools-tb",enableToggle:!0,allowDepress:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnHandTool),this.btnAddComment=new Common.UI.Button({id:"tlbtn-addcomment",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-menu-comments",lock:[s.disableOnStart],caption:this.capBtnComment,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnAddComment),this.chShowComments=new Common.UI.CheckBox({lock:[s.disableOnStart],labelText:this.capBtnShowComments,value:Common.localStorage.getBool("pdfe-settings-livecomment",!0),dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.toolbarControls.push(this.chShowComments),this.btnStrikeout=new Common.UI.ButtonColored({id:"id-toolbar-btn-strikeout",cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",lock:[s.paragraphLock,s.headerLock,s.richEditLock,s.plainEditLock,s.previewReviewMode,s.viewFormMode,s.lostConnect,s.disableOnStart,s.docLockView,s.docLockComments],enableToggle:!0,allowDepress:!0,split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16",penOptions:{color:"000000"},type:AscPDF.ANNOTATIONS_TYPES.Strikeout}),this.paragraphControls.push(this.btnStrikeout),this.btnUnderline=new Common.UI.ButtonColored({id:"id-toolbar-btn-underline",cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",lock:[s.paragraphLock,s.headerLock,s.richEditLock,s.plainEditLock,s.previewReviewMode,s.viewFormMode,s.lostConnect,s.disableOnStart,s.docLockView,s.docLockComments],enableToggle:!0,allowDepress:!0,split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16",penOptions:{color:"000000"},type:AscPDF.ANNOTATIONS_TYPES.Underline}),this.paragraphControls.push(this.btnUnderline),this.btnHighlight=new Common.UI.ButtonColored({id:"id-toolbar-btn-highlight",cls:"btn-toolbar",iconCls:"toolbar__icon btn-highlight",lock:[s.paragraphLock,s.headerLock,s.richEditLock,s.plainEditLock,s.previewReviewMode,s.viewFormMode,s.lostConnect,s.disableOnStart,s.docLockView,s.docLockComments],enableToggle:!0,allowDepress:!0,split:!0,menu:!0,type:AscPDF.ANNOTATIONS_TYPES.Highlight,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16",penOptions:{color:"FFFC54",colors:["FFFC54","72F54A","74F9FD","EB51F7","A900F9","EF8B3A","7272FF","FF63A4","1DFF92","03DA18","249B01","C504D2","0633D1","FFF7A0","FF0303","FFFFFF","D3D3D4","969696","606060","000000"]}}),this.paragraphControls.push(this.btnHighlight),this.fieldPages=new Common.UI.InputFieldFixed({id:"id-toolbar-txt-pages",style:"width: 100%;",maskExp:/[0-9]/,allowBlank:!0,validateOnChange:!1,fixedValue:"/ 1",value:1,lock:[s.disableOnStart],validation:function(t){return/(^[0-9]+$)/.test(t)?(null==(t=parseInt(t))||t<1)&&i.fieldPages.setValue(i.api.getCurrentPage()+1):i.fieldPages.setValue(i.api.getCurrentPage()+1),!0}}),this.toolbarControls.push(this.fieldPages),this.btnFirstPage=new Common.UI.Button({id:"id-toolbar-btn-first-page",cls:"btn-toolbar",iconCls:"toolbar__icon btn-firstitem",lock:[s.disableOnStart,s.firstPage],dataHint:"1",dataHintDirection:"bottom"}),this.toolbarControls.push(this.btnFirstPage),this.btnLastPage=new Common.UI.Button({id:"id-toolbar-btn-last-page",cls:"btn-toolbar",iconCls:"toolbar__icon btn-lastitem",lock:[s.disableOnStart,s.lastPage],dataHint:"1",dataHintDirection:"bottom"}),this.toolbarControls.push(this.btnLastPage),this.btnPrevPage=new Common.UI.Button({id:"id-toolbar-btn-prev-page",cls:"btn-toolbar",iconCls:"toolbar__icon btn-previtem",lock:[s.disableOnStart,s.firstPage],dataHint:"1",dataHintDirection:"bottom"}),this.toolbarControls.push(this.btnPrevPage),this.btnNextPage=new Common.UI.Button({id:"id-toolbar-btn-next-page",cls:"btn-toolbar",iconCls:"toolbar__icon btn-nextitem",lock:[s.disableOnStart,s.lastPage],dataHint:"1",dataHintDirection:"bottom"}),this.toolbarControls.push(this.btnNextPage),this.lockControls=i.toolbarControls.concat(i.paragraphControls),this.lockToolbar(Common.enumLock.disableOnStart,!0,{array:this.lockControls}),this.on("render:after",e.bind(this.onToolbarAfterRender,this))):Common.UI.Mixtbar.prototype.initialize.call(this,{template:e.template(o),tabs:[{caption:i.textTabFile,action:"file",layoutname:"toolbar-file",haspanel:!1,dataHintTitle:"F"}]}),this},render:function(t){var e=this;return this.fireEvent("render:before",[this]),e.isCompactView=t.isCompactView,t.isEdit?e.$el.html(e.rendererComponents(e.$layout)):(e.$layout.find(".canedit").hide(),e.isCompactView&&e.$layout.addClass("folded"),e.$el.html(e.$layout)),this.fireEvent("render:after",[this]),Common.UI.Mixtbar.prototype.afterRender.call(this),Common.NotificationCenter.on({"window:resize":function(){Common.UI.Mixtbar.prototype.onResize.apply(e,arguments)}}),t.isEdit&&(this.showSynchTip=!Common.localStorage.getBool("de-hide-synch"),this.needShowSynchTip=!1,e.setTab("home")),e.isCompactView&&e.setFolded(!0),this},onTabClick:function(e){var i=this,n=t(e.currentTarget).find("> a[data-tab]").data("tab"),o=i.isTabActive("file");Common.UI.Mixtbar.prototype.onTabClick.apply(i,arguments),o?i.fireEvent("file:close"):"file"==n&&(i.fireEvent("file:open"),i.setTab(n)),i.isTabActive("home")&&i.fireEvent("home:open")},rendererComponents:function(e){var i=t(e),n=function(t,e){Common.Utils.injectComponent(i.findById(t),e)};return n("#slot-btn-print",this.btnPrint),n("#slot-btn-save",this.btnSave),n("#slot-btn-undo",this.btnUndo),n("#slot-btn-redo",this.btnRedo),n("#slot-btn-copy",this.btnCopy),n("#slot-btn-paste",this.btnPaste),n("#slot-btn-cut",this.btnCut),n("#slot-btn-select-all",this.btnSelectAll),n("#slot-btn-select-tool",this.btnSelectTool),n("#slot-btn-hand-tool",this.btnHandTool),n("#slot-btn-comment",this.btnAddComment),n("#slot-btn-strikeout",this.btnStrikeout),n("#slot-btn-underline",this.btnUnderline),n("#slot-btn-highlight",this.btnHighlight),n("#slot-btn-pages",this.fieldPages),n("#slot-btn-first-page",this.btnFirstPage),n("#slot-btn-last-page",this.btnLastPage),n("#slot-btn-prev-page",this.btnPrevPage),n("#slot-btn-next-page",this.btnNextPage),n("#slot-chk-showcomment",this.chShowComments),this.btnPrint.menu&&this.btnPrint.$el.addClass("split"),i},createPen:function(i,n){var o;i.setMenu(new Common.UI.Menu({cls:"shifted-left",style:"min-width: 100px;",items:[{template:e.template('<div id="id-toolbar-menu-'+n+'" style="width: 174px; display: inline-block;" class="palette-large"></div>')},{id:"id-toolbar-menu-"+n+"-color-new",template:e.template('<a tabindex="-1" type="menuitem" style="">'+i.textNewColor+"</a>")},{caption:"--"},o=new Common.UI.MenuItem({caption:this.strMenuNoFill,checkable:!0,style:"padding-left:20px;padding-right:20px;"})]}),!0),i.currentColor=i.options.penOptions.color,i.setColor(i.currentColor);var s=new Common.UI.ThemeColorPalette({el:t("#id-toolbar-menu-"+n),colors:i.options.penOptions.colors||["1755A0","D43230","F5C346","EA3368","12A489","552F8B","9D1F87","BB2765","479ED2","67C9FA","3D8A44","80CA3D","1C19B4","7F4B0F","FF7E07","FFFFFF","D3D3D4","879397","575757","000000"],value:i.currentColor,dynamiccolors:5,themecolors:0,effects:0,columns:5,outerMenu:{menu:i.menu,index:0,focusOnShow:!0},storageSuffix:"-draw"});return i.setPicker(s),s.on("select",e.bind(i.onColorSelect,i)),i.menu.setInnerMenu([{menu:s,index:0}]),i.menu.cmpEl.find("#id-toolbar-menu-"+n+"-color-new").on("click",(function(){s.addNewColor(i.currentColor)})),[s,o]},onAppReady:function(t){var e=this;new Promise((function(t,e){t()})).then((function(){if(t.isEdit){if(e.btnPrint.menu&&e.btnPrint.setMenu(new Common.UI.Menu({items:[{caption:e.tipPrint,iconCls:"menu__icon btn-print",toggleGroup:"viewPrint",value:"print",iconClsForMainBtn:"btn-print",platformKey:Common.Utils.String.platformKey("Ctrl+P")},{caption:e.tipPrintQuick,iconCls:"menu__icon btn-quick-print",toggleGroup:"viewPrint",value:"print-quick",iconClsForMainBtn:"btn-quick-print",platformKey:""}]})),e.btnStrikeout.menu){var i=e.createPen(e.btnStrikeout,"strikeout");e.mnuStrikeoutColorPicker=i[0],e.mnuStrikeoutTransparent=i[1]}e.btnUnderline.menu&&(i=e.createPen(e.btnUnderline,"underline"),e.mnuUnderlineColorPicker=i[0],e.mnuUnderlineTransparent=i[1]),e.btnHighlight.menu&&(i=e.createPen(e.btnHighlight,"highlight"),e.mnuHighlightColorPicker=i[0],e.mnuHighlightTransparent=i[1])}}))},createDelayedElements:function(){this.api&&this.updateMetricUnit(),this.btnPrint.updateHint(this.tipPrint+Common.Utils.String.platformKey("Ctrl+P")),this.btnSave.updateHint(this.btnSaveTip),this.btnUndo.updateHint(this.tipUndo+Common.Utils.String.platformKey("Ctrl+Z")),this.btnRedo.updateHint(this.tipRedo+Common.Utils.String.platformKey("Ctrl+Y")),this.btnCopy.updateHint(this.tipCopy+Common.Utils.String.platformKey("Ctrl+C")),this.btnPaste.updateHint(this.tipPaste+Common.Utils.String.platformKey("Ctrl+V")),this.btnCut.updateHint(this.tipCut+Common.Utils.String.platformKey("Ctrl+X")),this.btnSelectAll.updateHint(this.tipSelectAll+Common.Utils.String.platformKey("Ctrl+A")),this.btnSelectTool.updateHint(this.tipSelectTool),this.btnHandTool.updateHint(this.tipHandTool),this.btnAddComment.updateHint(this.tipAddComment),this.btnStrikeout.updateHint(this.textStrikeout),this.btnUnderline.updateHint(this.textUnderline),this.btnHighlight.updateHint(this.textHighlight),this.btnFirstPage.updateHint(this.tipFirstPage),this.btnLastPage.updateHint(this.tipLastPage),this.btnPrevPage.updateHint(this.tipPrevPage),this.btnNextPage.updateHint(this.tipNextPage)},onToolbarAfterRender:function(t){},updateMetricUnit:function(){},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onCollaborativeChanges",e.bind(this.onCollaborativeChanges,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",e.bind(this.onApiUsersChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",e.bind(this.onApiUsersChanged,this)),this},setMode:function(t){t.isDisconnected?(this.lockToolbar(Common.enumLock.lostConnect,!0),this.synchTooltip&&this.synchTooltip.hide(),t.enableDownload||this.lockToolbar(Common.enumLock.cantPrint,!0,{array:[this.btnPrint]})):(this.lockToolbar(Common.enumLock.cantPrint,!t.canPrint,{array:[this.btnPrint]}),!t.canPrint&&this.btnPrint.hide()),this.mode=t},onCollaborativeChanges:function(){this._state.hasCollaborativeChanges||(this.btnCollabChanges.rendered&&!this._state.previewmode?(this._state.hasCollaborativeChanges=!0,this.btnCollabChanges.cmpEl.addClass("notify"),this.showSynchTip?(this.btnCollabChanges.updateHint(""),void 0===this.synchTooltip&&this.createSynchTip(),this.synchTooltip.show()):this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S")),this.btnSave.setDisabled(!this.mode.isPDFEdit&&!this.mode.isPDFAnnotate&&!this.mode.saveAlwaysEnabled),Common.Gateway.collaborativeChanges()):this.needShowSynchTip=!0)},createSynchTip:function(){this.synchTooltip=new Common.UI.SynchronizeTip({extCls:this.mode.customization&&this.mode.customization.compactHeader?void 0:"inc-index",placement:"right-bottom",target:this.btnCollabChanges.$el}),this.synchTooltip.on("dontshowclick",(function(){this.showSynchTip=!1,this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S")),Common.localStorage.setItem("de-hide-synch",1)}),this),this.synchTooltip.on("closeclick",(function(){this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S"))}),this)},synchronizeChanges:function(){if(!this._state.previewmode&&this.btnCollabChanges.rendered){var t=this;t.btnCollabChanges.cmpEl.hasClass("notify")&&(t.btnCollabChanges.cmpEl.removeClass("notify"),this.synchTooltip&&this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.btnSaveTip),this.btnSave.setDisabled(!t.mode.forcesave||!t.mode.isPDFEdit&&!t.mode.isPDFAnnotate&&!t.mode.saveAlwaysEnabled),this._state.hasCollaborativeChanges=!1)}},onApiUsersChanged:function(t){var i=[];e.each(t,(function(t){t.asc_getView()||i.push(t)}));var n=this,o=e.size(i),s=o>1?"btn-save-coauth":"btn-save";s!==n.btnSaveCls&&n.btnCollabChanges.rendered&&(n.btnSaveTip=(o>1?n.tipSaveCoauth:n.tipSave)+Common.Utils.String.platformKey("Ctrl+S"),n.btnCollabChanges.updateHint(n.btnSaveTip),n.btnCollabChanges.$icon.removeClass(n.btnSaveCls).addClass(s),n.btnSaveCls=s)},lockToolbar:function(t,e,i){Common.Utils.lockControls(t,e,i,this.lockControls)},tipCopy:"Copy",tipPaste:"Paste",tipUndo:"Undo",tipRedo:"Redo",tipPrint:"Print",tipPrintQuick:"Quick print",tipSave:"Save",tipSelectTool:"Select tool",tipHandTool:"Hand tool",tipSynchronize:"The document has been changed by another user. Please click to save your changes and reload the updates.",tipSaveCoauth:"Save your changes for the other users to see them.",textTabFile:"File",textTabHome:"Home",capBtnSelect:"Select",capBtnHand:"Hand",textTabView:"View",tipSelectAll:"Select all",tipCut:"Cut",textTabComment:"Comment",capBtnComment:"Comment",tipAddComment:"Add comment",strMenuNoFill:"No Fill",textStrikeout:"Strikeout",textUnderline:"Underline",textHighlight:"Highlight",capBtnRotate:"Rotate",tipRotate:"Rotate pages",tipFirstPage:"Go to the first page",tipLastPage:"Go to the last page",tipPrevPage:"Go to the previous page",tipNextPage:"Go to the next page",capBtnShowComments:"Show Comments"},PDFE.Views.Toolbar||{}))})),define("pdfeditor/main/app/controller/Toolbar",["core","common/main/lib/component/Window","common/main/lib/view/CopyWarningDialog","common/main/lib/util/define","pdfeditor/main/app/view/Toolbar"],(function(){"use strict";PDFE.Controllers.Toolbar=Backbone.Controller.extend(_.extend({models:[],collections:[],controllers:[],views:["Toolbar"],initialize:function(){this._state={activated:!1,prcontrolsdisable:void 0,can_undo:void 0,can_redo:void 0,lock_doc:void 0,can_copycut:void 0,clrstrike:void 0,clrunderline:void 0,clrhighlight:void 0,pageCount:1},this.editMode=!0,this.binding={},this.addListeners({Toolbar:{"change:compact":this.onClickChangeCompact,"home:open":this.onHomeOpen},FileMenu:{"menu:hide":this.onFileMenu.bind(this,"hide"),"menu:show":this.onFileMenu.bind(this,"show"),"settings:apply":this.applySettings.bind(this)},"Common.Views.Header":{print:function(t){this.getApplication().getController("Main").onPrint()},"print-quick":function(t){this.getApplication().getController("Main").onPrintQuick()},save:function(t){this.tryToSave()},undo:this.onUndo,redo:this.onRedo,downloadas:function(t){var e,i=this.getApplication().getController("Main"),n=i.document.fileType;if(n){if(/^pdf|xps|oxps|djvu/i.test(n))return void i.api.asc_DownloadOrigin();e=Asc.c_oAscFileType[n.toUpperCase()]}var o=[Asc.c_oAscFileType.TXT,Asc.c_oAscFileType.RTF,Asc.c_oAscFileType.ODT,Asc.c_oAscFileType.DOCX,Asc.c_oAscFileType.HTML,Asc.c_oAscFileType.PDFA,Asc.c_oAscFileType.DOTX,Asc.c_oAscFileType.OTT,Asc.c_oAscFileType.FB2,Asc.c_oAscFileType.EPUB,Asc.c_oAscFileType.DOCM];(!e||o.indexOf(e)<0)&&(e=Asc.c_oAscFileType.PDF),i.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(e))},"go:editor":function(){Common.Gateway.requestEditRights()}},ViewTab:{"toolbar:setcompact":this.onChangeCompactView.bind(this)}});Common.NotificationCenter.on("toolbar:collapse",_.bind((function(){this.toolbar.collapse()}),this))},onLaunch:function(){this.toolbar=this.createView("Toolbar"),this.toolbar.on("render:before",(function(t){})),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this))},setMode:function(t){this.mode=t,this.toolbar.applyLayout(t)},attachUIEvents:function(t){var e=this;t.btnPrint.on("click",_.bind(this.onPrint,this)),t.btnPrint.on("disabled",_.bind(this.onBtnChangeState,this,"print:disabled")),t.btnSave.on("click",_.bind(this.tryToSave,this)),t.btnUndo.on("click",_.bind(this.onUndo,this)),t.btnUndo.on("disabled",_.bind(this.onBtnChangeState,this,"undo:disabled")),t.btnRedo.on("click",_.bind(this.onRedo,this)),t.btnRedo.on("disabled",_.bind(this.onBtnChangeState,this,"redo:disabled")),t.btnCopy.on("click",_.bind(this.onCopyPaste,this,"copy")),t.btnPaste.on("click",_.bind(this.onCopyPaste,this,"paste")),t.btnCut.on("click",_.bind(this.onCopyPaste,this,"cut")),t.btnSelectAll.on("click",_.bind(this.onSelectAll,this)),t.btnSelectTool.on("toggle",_.bind(this.onSelectTool,this,"select")),t.btnHandTool.on("toggle",_.bind(this.onSelectTool,this,"hand")),t.btnAddComment.on("click",(function(t,e){Common.NotificationCenter.trigger("app:comment:add","toolbar")})),t.btnStrikeout.on("click",_.bind(this.onBtnStrikeout,this)),t.mnuStrikeoutColorPicker.on("select",_.bind(this.onSelectStrikeoutColor,this)),t.mnuStrikeoutTransparent.on("click",_.bind(this.onStrikeoutTransparentClick,this)),t.btnUnderline.on("click",_.bind(this.onBtnUnderline,this)),t.mnuUnderlineColorPicker.on("select",_.bind(this.onSelectUnderlineColor,this)),t.mnuUnderlineTransparent.on("click",_.bind(this.onUnderlineTransparentClick,this)),t.btnHighlight.on("click",_.bind(this.onBtnHighlight,this)),t.mnuHighlightColorPicker.on("select",_.bind(this.onSelectHighlightColor,this)),t.mnuHighlightTransparent.on("click",_.bind(this.onHighlightTransparentClick,this)),t.chShowComments.on("change",_.bind(this.onShowCommentsChange,this)),t.fieldPages.on("changed:after",_.bind(this.onPagesChanged,this)),t.fieldPages.on("inputleave",(function(){Common.NotificationCenter.trigger("edit:complete",e.toolbar)})),t.fieldPages.cmpEl&&t.fieldPages.cmpEl.on("focus","input.form-control",(function(){setTimeout((function(){t.fieldPages._input&&t.fieldPages._input.select()}),1)})),t.btnFirstPage.on("click",_.bind(this.onGotoPage,this,"first")),t.btnLastPage.on("click",_.bind(this.onGotoPage,this,"last")),t.btnPrevPage.on("click",_.bind(this.onGotoPage,this,"prev")),t.btnNextPage.on("click",_.bind(this.onGotoPage,this,"next")),this.onBtnChangeState("undo:disabled",t.btnUndo,t.btnUndo.isDisabled()),this.onBtnChangeState("redo:disabled",t.btnRedo,t.btnRedo.isDisabled()),Common.NotificationCenter.on("leftmenu:save",_.bind(this.tryToSave,this)),Common.NotificationCenter.on("draw:start",_.bind(this.onDrawStart,this))},setApi:function(t){this.api=t,this.mode.isEdit&&(this.toolbar.setApi(t),this.api.asc_registerCallback("asc_onCanUndo",_.bind(this.onApiCanRevert,this,"undo")),this.api.asc_registerCallback("asc_onCanRedo",_.bind(this.onApiCanRevert,this,"redo")),this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onApiFocusObject,this)),this.api.asc_registerCallback("asc_onZoomChange",_.bind(this.onApiZoomChange,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onCanCopyCut",_.bind(this.onApiCanCopyCut,this)),this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),this.api.asc_registerCallback("asc_onMarkerFormatChanged",_.bind(this.onApiStartHighlight,this))),this.api.asc_registerCallback("asc_onCountPages",_.bind(this.onCountPages,this)),this.api.asc_registerCallback("asc_onCurrentPage",_.bind(this.onCurrentPage,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this))},onChangeCompactView:function(t,e){this.toolbar.setFolded(e),this.toolbar.fireEvent("view:compact",[this,e]),Common.localStorage.setBool("pdfe-compact-toolbar",e),Common.NotificationCenter.trigger("layout:changed","toolbar"),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onClickChangeCompact:function(t){if("file"!=t){var e=this;setTimeout((function(){e.onChangeCompactView(null,!e.toolbar.isCompact())}),0)}},onContextMenu:function(){this.toolbar.collapse()},onCountPages:function(t){this._state.pageCount=t,this.toolbar&&this.toolbar.fieldPages&&this.toolbar.fieldPages.setFixedValue("/ "+t)},onCurrentPage:function(t){this.toolbar&&(this.toolbar.fieldPages&&this.toolbar.fieldPages.setValue(t+1),this.toolbar.lockToolbar(Common.enumLock.firstPage,t<1,{array:[this.toolbar.btnFirstPage,this.toolbar.btnPrevPage]}),this.toolbar.lockToolbar(Common.enumLock.lastPage,t>=this._state.pageCount-1,{array:[this.toolbar.btnLastPage,this.toolbar.btnNextPage]}))},onPagesChanged:function(){var t=parseInt(this.toolbar.fieldPages.getValue());t>this._state.pageCount&&(t=this._state.pageCount),this.api&&this.api.goToPage(t-1)},onGotoPage:function(t,e,i){this.api&&("first"===t?this.api.goToPage(0):"last"===t?this.api.goToPage(this._state.pageCount-1):this.api.goToPage(this.api.getCurrentPage()+("next"===t?1:-1)))},onApiCanRevert:function(t,e){"undo"==t?this._state.can_undo!==e&&(this.toolbar.lockToolbar(Common.enumLock.undoLock,!e,{array:[this.toolbar.btnUndo]}),this._state.can_undo=e):this._state.can_redo!==e&&(this.toolbar.lockToolbar(Common.enumLock.redoLock,!e,{array:[this.toolbar.btnRedo]}),this._state.can_redo=e)},onApiCanCopyCut:function(t){this._state.can_copycut!==t&&(this.toolbar.lockToolbar(Common.enumLock.copyLock,!t,{array:[this.toolbar.btnCopy,this.toolbar.btnCut]}),this._state.can_copycut=t)},onApiFocusObject:function(t){if(this.editMode){var e,i,n=-1,o=!1;for(this.toolbar;++n<t.length;)i=t[n].get_ObjectType(),e=t[n].get_ObjectValue(),i===Asc.c_oAscTypeSelectElement.Paragraph?(o=e.get_Locked(),e.get_Shade(),!0):i===Asc.c_oAscTypeSelectElement.Image&&(!0,e.get_Locked(),e&&e.get_ShapeProperties()&&e.get_ShapeProperties());this.toolbar.lockToolbar(Common.enumLock.paragraphLock,o,{array:this.toolbar.paragraphControls})}},onApiZoomChange:function(t,e){},onNewDocument:function(t,e){this.api&&this.api.OpenNewDocument(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","New Document")},onOpenDocument:function(t,e){this.api&&this.api.LoadDocumentFromDisk(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Open Document")},onPrint:function(t){"print"==this.toolbar.btnPrint.options.printType?(Common.NotificationCenter.trigger("file:print",this.toolbar),Common.NotificationCenter.trigger("edit:complete",this.toolbar)):this.getApplication().getController("Main").onPrintQuick();Common.component.Analytics.trackEvent("Print"),Common.component.Analytics.trackEvent("ToolBar","Print")},onPrintMenu:function(t,e){var i=this.toolbar.btnPrint.options.printType,n=e.value;n!=i&&(this.toolbar.btnPrint.changeIcon({next:e.options.iconClsForMainBtn,curr:this.toolbar.btnPrint.menu.items.filter((function(t){return t.value==i}))[0].options.iconClsForMainBtn}),this.toolbar.btnPrint.updateHint([e.caption+e.options.platformKey]),this.toolbar.btnPrint.options.printType=n),this.onPrint(e)},tryToSave:function(){var t=this.toolbar,e=t.mode,i=this;if(e.isPDFAnnotate||e.isPDFEdit){if(this.api){var n=this.api.asc_isDocumentCanSave(),o=t.btnCollabChanges&&t.btnCollabChanges.cmpEl.hasClass("notify");if(!n&&!o&&!t.mode.forcesave)return;this.api.asc_Save(),t.btnSave.setDisabled(!t.mode.forcesave&&!t.mode.saveAlwaysEnabled),Common.component.Analytics.trackEvent("Save"),Common.component.Analytics.trackEvent("ToolBar","Save")}}else{var s=e.canDownload&&(!e.isDesktopApp||!e.isOffline),a=e.canDownload&&(!e.isDesktopApp||!e.isOffline)&&(e.canRequestSaveAs||e.saveAsUrl),r=e.canDownload&&e.isDesktopApp&&e.isOffline,l=(a||r?[{value:"copy",caption:this.txtSaveCopy}]:[]).concat(s?[{value:"download",caption:this.txtDownload}]:[]),c=a||r?"copy":s?"download":"ok";Common.UI.info({maxwidth:500,buttons:e.canPDFAnnotate||e.canPDFEdit||!e.canDownload?["ok"]:l.concat(["cancel"]),primary:e.canPDFAnnotate||e.canPDFEdit||!e.canDownload?"ok":c,msg:e.canPDFAnnotate||e.canPDFEdit?this.txtNeedCommentMode:e.canDownload?this.txtNeedDownload:this.errorAccessDeny,callback:function(e){r&&"copy"===e?i.api.asc_DownloadAs():"copy"!==e&&"download"!==e||(i._state.isFromToolbarDownloadAs="copy"===e,i.api.asc_DownloadOrigin("copy"===e)),Common.NotificationCenter.trigger("edit:complete",t)}})}Common.NotificationCenter.trigger("edit:complete",t)},onDownloadUrl:function(t,e){if(this._state.isFromToolbarDownloadAs){var i=this,n=this.getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption();!n&&(n=i.txtUntitled),i.toolbar.mode.canRequestSaveAs?Common.Gateway.requestSaveAs(t,n,e):(i._saveCopyDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.toolbar.mode.saveAsUrl,saveFileUrl:t,defFileName:n}),i._saveCopyDlg.on("saveaserror",(function(t,e){var n={closable:!1,title:i.notcriticalErrorTitle,msg:e,iconCls:"warn",buttons:["ok"],callback:function(t){Common.NotificationCenter.trigger("edit:complete",i)}};Common.UI.alert(n)})).on("close",(function(t){i._saveCopyDlg=void 0})),i._saveCopyDlg.show())}this._state.isFromToolbarDownloadAs=!1},onBtnChangeState:function(t){if(/\:disabled$/.test(t)){var e=arguments[2];this.toolbar.fireEvent(t,[e])}},onUndo:function(t,e){this.api&&this.api.Undo(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Undo")},onRedo:function(t,e){this.api&&this.api.Redo(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Redo")},onCopyPaste:function(t,e){var i=this;i.api&&(("cut"===t?i.api.Cut():"copy"===t?i.api.Copy():i.api.Paste())?Common.component.Analytics.trackEvent("ToolBar","Copy Warning"):Common.localStorage.getBool("pdfe-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("pdfe-hide-copywarning",1),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show());Common.NotificationCenter.trigger("edit:complete",i.toolbar)},onSelectAll:function(t){this.api&&this.api.asc_EditSelectAll(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Select All")},onSelectTool:function(t,e,i,n){this.api&&i&&(this.api.asc_setViewerTargetType(t),this.mode.isEdit&&this.api.asc_StopInkDrawer(),Common.NotificationCenter.trigger("edit:complete",this.toolbar))},onBtnStrikeout:function(t){t.pressed?this._setStrikeoutColor(t.currentColor):this.api.SetMarkerFormat(t.options.type,!1)},onStrikeoutTransparentClick:function(t,e){this._setStrikeoutColor("transparent","menu")},onSelectStrikeoutColor:function(t,e){this._setStrikeoutColor(e,"menu")},_setStrikeoutColor:function(t,e){var i=this;if("menu"===e&&(i._state.clrstrike=void 0,i.toolbar.btnStrikeout.currentColor=t,i.toolbar.btnStrikeout.setColor(i.toolbar.btnStrikeout.currentColor),i.toolbar.btnStrikeout.toggle(!0,!0)),"transparent"==(t=t||"transparent"))i.api.SetMarkerFormat(i.toolbar.btnStrikeout.options.type,!0,0),i.toolbar.mnuStrikeoutColorPicker&&i.toolbar.mnuStrikeoutColorPicker.clearSelection(),i.toolbar.mnuStrikeoutTransparent.setChecked(!0,!0);else{var n=t[0]+t[1],o=t[2]+t[3],s=t[4]+t[5];i.api.SetMarkerFormat(i.toolbar.btnStrikeout.options.type,!0,100,parseInt(n,16),parseInt(o,16),parseInt(s,16)),i.toolbar.mnuStrikeoutTransparent.setChecked(!1,!0)}i.api.asc_StopInkDrawer(),Common.NotificationCenter.trigger("edit:complete",i.toolbar,i.toolbar.btnStrikeout)},onBtnUnderline:function(t){t.pressed?this._setUnderlineColor(t.currentColor):this.api.SetMarkerFormat(t.options.type,!1)},onUnderlineTransparentClick:function(t,e){this._setUnderlineColor("transparent","menu")},onSelectUnderlineColor:function(t,e){this._setUnderlineColor(e,"menu")},_setUnderlineColor:function(t,e){var i=this;if("menu"===e&&(i._state.clrunderline=void 0,i.toolbar.btnUnderline.currentColor=t,i.toolbar.btnUnderline.setColor(i.toolbar.btnUnderline.currentColor),i.toolbar.btnUnderline.toggle(!0,!0)),"transparent"==(t=t||"transparent"))i.api.SetMarkerFormat(i.toolbar.btnUnderline.options.type,!0,0),i.toolbar.mnuUnderlineColorPicker&&i.toolbar.mnuUnderlineColorPicker.clearSelection(),i.toolbar.mnuUnderlineTransparent.setChecked(!0,!0);else{var n=t[0]+t[1],o=t[2]+t[3],s=t[4]+t[5];i.api.SetMarkerFormat(i.toolbar.btnUnderline.options.type,!0,100,parseInt(n,16),parseInt(o,16),parseInt(s,16)),i.toolbar.mnuUnderlineTransparent.setChecked(!1,!0)}i.api.asc_StopInkDrawer(),Common.NotificationCenter.trigger("edit:complete",i.toolbar,i.toolbar.btnUnderline)},onBtnHighlight:function(t){t.pressed?this._setHighlightColor(t.currentColor):this.api.SetMarkerFormat(t.options.type,!1)},onHighlightTransparentClick:function(t,e){this._setHighlightColor("transparent","menu")},onSelectHighlightColor:function(t,e){this._setHighlightColor(e,"menu")},_setHighlightColor:function(t,e){var i=this;if("menu"===e&&(i._state.clrhighlight=void 0,i.toolbar.btnHighlight.currentColor=t,i.toolbar.btnHighlight.setColor(i.toolbar.btnHighlight.currentColor),i.toolbar.btnHighlight.toggle(!0,!0)),"transparent"==(t=t||"transparent"))i.api.SetMarkerFormat(i.toolbar.btnHighlight.options.type,!0,0),i.toolbar.mnuHighlightColorPicker&&i.toolbar.mnuHighlightColorPicker.clearSelection(),i.toolbar.mnuHighlightTransparent.setChecked(!0,!0);else{var n=t[0]+t[1],o=t[2]+t[3],s=t[4]+t[5];i.api.SetMarkerFormat(i.toolbar.btnHighlight.options.type,!0,100,parseInt(n,16),parseInt(o,16),parseInt(s,16)),i.toolbar.mnuHighlightTransparent.setChecked(!1,!0)}i.api.asc_StopInkDrawer(),Common.NotificationCenter.trigger("edit:complete",i.toolbar,i.toolbar.btnHighlight)},onApiStartHighlight:function(t,e){t===this.toolbar.btnHighlight.options.type?this.toolbar.btnHighlight.toggle(e,!0):t===this.toolbar.btnStrikeout.options.type?this.toolbar.btnStrikeout.toggle(e,!0):t===this.toolbar.btnUnderline.options.type?this.toolbar.btnUnderline.toggle(e,!0):(this.toolbar.btnHighlight.toggle(!1,!0),this.toolbar.btnStrikeout.toggle(!1,!0),this.toolbar.btnUnderline.toggle(!1,!0))},onDrawStart:function(){this.api&&this.api.SetMarkerFormat(void 0,!1),this.onApiStartHighlight()},onShowCommentsChange:function(t,e){var i="checked"===e;Common.localStorage.setItem("pdfe-settings-livecomment",i?1:0),Common.Utils.InternalSettings.set("pdfe-settings-livecomment",i),i?this.api.asc_showComments(Common.Utils.InternalSettings.get("pdfe-settings-resolvedcomment")):this.api.asc_hideComments()},onRotateClick:function(t,e){},activateControls:function(){this.toolbar.lockToolbar(Common.enumLock.disableOnStart,!1),this.toolbar.lockToolbar(Common.enumLock.undoLock,!0!==this._state.can_undo,{array:[this.toolbar.btnUndo]}),this.toolbar.lockToolbar(Common.enumLock.redoLock,!0!==this._state.can_redo,{array:[this.toolbar.btnRedo]}),this.toolbar.lockToolbar(Common.enumLock.copyLock,!0!==this._state.can_copycut,{array:[this.toolbar.btnCopy,this.toolbar.btnCut]}),this.toolbar.btnSave.setDisabled(!this.mode.isPDFEdit&&!this.mode.isPDFAnnotate&&!this.mode.saveAlwaysEnabled),this._state.activated=!0},onHomeOpen:function(){},onHideMenus:function(t){Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onApiCoAuthoringDisconnect:function(t){this.mode.isEdit&&this.toolbar.setMode({isDisconnected:!0,enableDownload:!!t}),this.editMode=!1,this.DisableToolbar(!0,!0)},DisableToolbar:function(t,e){void 0!==e&&(this.editMode=!e),t=t||!this.editMode;var i=$(".toolbar-mask");if(!(t&&i.length>0||!t&&0==i.length)){var n=this.toolbar;n.hideMoreBtns(),t?i=$("<div class='toolbar-mask'>").appendTo(n.$el.find(".toolbar")):i.remove(),n.$el.find(".toolbar").toggleClass("masked",$(".toolbar-mask").length>0),n.synchTooltip&&n.synchTooltip.hide();var o=Common.Utils.isMac?"command+alt+a":"alt+h";t?Common.util.Shortcuts.suspendEvents(o):Common.util.Shortcuts.resumeEvents(o)}},createDelayedElements:function(){this.toolbar.createDelayedElements(),this.attachUIEvents(this.toolbar),Common.Utils.injectSvgIcons()},onAppShowed:function(t){var e=this,i=!t.isEdit;if(t.isEdit&&(Common.localStorage.itemExists("pdfe-compact-toolbar")?i=Common.localStorage.getBool("pdfe-compact-toolbar"):t.customization&&t.customization.compactToolbar&&(i=!0)),e.toolbar.render(_.extend({isCompactView:i},t)),t.isEdit){if(e.toolbar.setMode(t),e.toolbar.btnSave.on("disabled",_.bind(e.onBtnChangeState,e,"save:disabled")),!t.customization||!t.customization.compactHeader){e.toolbar.btnPrint.$el.parents(".group").hide().next().hide();var n=e.toolbar.btnUndo.$el.hide().next().hide().parent();e.toolbar.btnPaste.$el.detach().appendTo(n),e.toolbar.btnPaste.$el.find("button").attr("data-hint-direction","bottom"),e.toolbar.btnCopy.$el.removeClass("split"),e.toolbar.processPanelVisible(null,!0,!0)}var o=e.getApplication().getController("Common.Controllers.Draw");o.setApi(e.api).setMode(t),(r=o.createToolbarPanel(!0))&&(e.toolbar.$el.find(".draw-groups").after(r),Array.prototype.push.apply(e.toolbar.lockControls,o.getView().getButtons()),Array.prototype.push.apply(e.toolbar.paragraphControls,o.getView().getButtons()))}var s={caption:e.toolbar.textTabView,action:"view",extcls:t.isEdit?"canedit":"",layoutname:"toolbar-view",dataHintTitle:"W"},a=e.getApplication().getController("ViewTab");a.setApi(e.api).setConfig({toolbar:e,mode:t});var r=a.createToolbarPanel();r&&(e.toolbar.addTab(s,r,8),e.toolbar.setVisible("view",Common.UI.LayoutManager.isElementVisible("toolbar-view")))},onAppReady:function(t){var e=this;e.appOptions=t,this.btnsComment=[],new Promise((function(t){t()})).then((function(){t.isEdit&&e.toolbar&&e.toolbar.btnHandTool.toggle(!0,!0),e.api&&e.api.asc_setViewerTargetType("hand")}))},getView:function(t){return t?Backbone.Controller.prototype.getView.apply(this,arguments):this.toolbar},onFileMenu:function(t){"show"==t?this.toolbar.isTabActive("file")||this.toolbar.setTab("file"):this.toolbar.isTabActive("file")&&this.toolbar.setTab()},applySettings:function(){this.toolbar&&this.toolbar.chShowComments.setValue(Common.localStorage.getBool("pdfe-settings-livecomment",!0),!0)},textWarning:"Warning",notcriticalErrorTitle:"Warning",txtNeedCommentMode:"To save changes to the file, switch to Ð¡ommenting mode. Or you can download a copy of the modified file.",txtNeedDownload:"At the moment, PDF viewer can only save new changes in separate file copies. It doesn't support co-editing and other users won't see your changes unless you share a new file version.",txtDownload:"Download",txtSaveCopy:"Save copy",errorAccessDeny:"You are trying to perform an action you do not have rights for.<br>Please contact your Document Server administrator.",txtUntitled:"Untitled"},PDFE.Controllers.Toolbar||{}))})),define("text!pdfeditor/main/app/template/StatusBar.template",[],(function(){return'\n<div class="statusbar" style="display:table;">\n    <div class="status-group dropup">\n        <label id="label-pages" class="status-label dropdown-toggle margin-top-large" data-toggle="dropdown" data-hint="0" data-hint-direction="top"><%= textPageNumber %></label>\n        <div id="status-goto-box" class="dropdown-menu">\n            <label class="float-left"><%= textGotoPage %></label>\n            <div id="status-goto-page" style="display:inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator short space"></div>\n    <div class="status-group">\n        <span id="slot-status-btn-prev" style="display: inline-block;" class="margin-top-small"></span>\n        <span id="slot-status-btn-next" style="display: inline-block;" class="margin-top-small"></span>\n    </div>\n    <div class="status-group" style="width:100%; text-align:center;">\n        <label id="label-action" class="status-label margin-top-large" data-layout-name="statusBar-actionStatus"></label>\n    </div>\n    <div class="status-group" style="">\n        <div class="separator short hide-select-tools"></div>\n        <button id="status-btn-select-tool" type="button" class="btn small btn-toolbar hide-select-tools margin-top-small" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-select-tool">&nbsp;</i></button>\n        <button id="status-btn-hand-tool" type="button" class="btn small btn-toolbar hide-select-tools margin-top-small" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-hand-tool">&nbsp;</i></button>\n        <div class="separator short hide-select-tools"></div>\n        <button id="btn-zoom-topage" type="button" class="btn small btn-toolbar margin-top-small" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-ic-zoomtopage">&nbsp;</i></button>\n        <button id="btn-zoom-towidth" type="button" class="btn small btn-toolbar margin-top-small" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-ic-zoomtowidth">&nbsp;</i></button>\n        <button id="btn-zoom-down" type="button" class="btn small btn-toolbar margin-top-small"><i class="icon toolbar__icon btn-zoomdown">&nbsp;</i></button>\n        <div class="cnt-zoom">\n            <div class="dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="top">\n                <label id="label-zoom" class="status-label">Zoom 100%</label>\n            </div>\n        </div>\n        <button id="btn-zoom-up" type="button" class="btn small btn-toolbar margin-top-small"><i class="icon toolbar__icon btn-zoomup">&nbsp;</i></button>\n    </div>\n</div>\n'})),function(t){var e=t.fn.tooltip;e.prototype=t.fn.tooltip.Constructor.prototype,t.extend(t.fn.tooltip.Constructor.DEFAULTS,{container:"body",delay:{show:500},arrow:!1});var i=function(t,e){this.init("tooltip",t,e)};i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype,{constructor:i,init:function(){e.prototype.init.apply(this,arguments),"cursor"==this.options.placement&&/hover/.exec(this.options.trigger)&&this.$element.on("mousemove.tooltip",this.options.selector,t.proxy(this.mousemove,this)),this.options.zIndex&&this.tip().css("z-index",this.options.zIndex);var i=this;Common.NotificationCenter.on({"layout:changed":function(t){i.options.keepvisible||i.options.hideonclick||!i.tip().is(":visible")||i.hide()}}),this.isDesktopApp=Common.Controllers.Desktop.isActive()},mousemove:function(t){var e=t.clientX*Common.Utils.zoom(),i=t.clientY*Common.Utils.zoom();this.targetXY=[e,this.isDesktopApp?Math.max(i,14):i]},leave:function(t){e.prototype.leave.apply(this,arguments),this.dontShow=void 0},show:function(i){if(this.hasContent()&&this.enabled&&!this.dontShow){if(!this.$element.is(":visible")&&this.$element.closest("[role=menu]").length>0)return;var n=this.tip();!1===this.options.arrow&&n.addClass("arrow-free"),this.options.cls&&n.addClass(this.options.cls);var o="function"!=typeof this.options.placement?/^([a-zA-Z]+)-?([a-zA-Z]*)$/.exec(this.options.placement):null;if(i||!o||o[2].length){var s=t.Event("show.bs.tooltip");if(this.$element.trigger(s),s.isDefaultPrevented())return;if(this.setContent(),this.options.animation&&n.addClass("fade"),n.detach().css({top:0,left:0,display:"block"}),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element),"function"==typeof this.options.placement)this.options.placement.call(this,n[0],this.$element[0]);else if("object"==typeof i){var a={top:i[1]+15,left:Common.UI.isRTL()?i[0]-n.width()-9:i[0]+18},r=Common.Utils.innerWidth(),l=Common.Utils.innerHeight();a.left<0&&(a.left=i[0]+18),a.left+n.width()>r&&(a.left=r-n.width()-30),a.top+n.height()>l&&(a.top=l-n.height()-30),n.offset(a).addClass("in")}else{var c=this.getPosition(),d=n[0].offsetWidth,h=n[0].offsetHeight;switch(o[1]){case"bottom":a={top:c.top+c.height+10};break;case"top":a={top:c.top-h-10}}switch(o[2]){case"left":a.left=c.left,this.$element.outerWidth()<=18&&(a.left-=4);break;case"right":a.left=c.left+c.width-d,this.$element.outerWidth()<=18&&(a.left+=4)}this.applyPlacement(a,o[1]),this.moveArrow(),n.addClass(o[1]).addClass(o[0])}this.$element.trigger("shown.bs.tooltip")}else e.prototype.show.apply(this,arguments);var m=this;clearTimeout(m.timeout),m.timeout=setTimeout((function(){"in"==m.hoverState&&m.hide(),m.dontShow=!1}),5e3)}},moveArrow:function(){var t=this.tip().find(".tooltip-arrow, .arrow");switch(this.options.placement){case"top-left":case"bottom-left":t.css("left",10);break;case"top-right":case"bottom-right":t.css("right",10)}},enter:function(e){if("mouseenter"===e.type){var i=t(e.target);if(!(i.is("[role=menu]")||i.parentsUntil(e.currentTarget,"[role=menu]").length&&e.target!==e.currentTarget||this.tip().is(":visible"))){var n=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs.tooltip");clearTimeout(n.timeout),n.hoverState="in",this._updateTitle&&(this.tip().find(".tooltip-inner")[this.options.html?"html":"text"](this.options.title),this._updateTitle=void 0),n.options.delay&&n.options.delay.show?n.timeout=setTimeout((function(){"in"==n.hoverState&&n.show("cursor"==n.options.placement?n.targetXY:void 0)}),n.options.delay.show):n.show()}}},replaceArrow:function(t,i,n){!1===this.options.arrow?this.arrow().hide():e.prototype.replaceArrow.apply(this,arguments)},getCalculatedOffset:function(t,i,n,o){var s=e.prototype.getCalculatedOffset.apply(this,arguments);if(this.options.offset>0||this.options.offset<0)switch(/(bottom|top)/.exec(t)[1]){case"bottom":s.top+=this.options.offset;break;case"top":s.top-=this.options.offset}return s},updateTitle:function(t){this.options.title=t,this._updateTitle=t}});var n=t.fn.tooltip;t.fn.tooltip=function(e){return this.each((function(){var n=t(this),o=n.data("bs.tooltip"),s="object"==typeof e&&e;o||n.data("bs.tooltip",o=new i(this,s)),"string"==typeof e&&o[e]()}))},t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=n,this}}(window.jQuery),define("tip",(function(){})),define("pdfeditor/main/app/model/Pages",["underscore","backbone"],(function(t,e){"use strict";PDFE.Models=PDFE.Models||{},PDFE.Models.Pages=e.Model.extend({defaults:{current:0,count:0}})})),define("pdfeditor/main/app/view/Statusbar",["text!pdfeditor/main/app/template/StatusBar.template","jquery","underscore","backbone","tip","common/main/lib/component/Menu","common/main/lib/component/Window","pdfeditor/main/app/model/Pages"],(function(t,e,i,n){"use strict";function o(t){this.pages.set("count",t)}function s(t){this.pages.set("current",t+1),this.btnPagePrev&&this.btnPagePrev.setDisabled(t<1),this.btnPageNext&&this.btnPageNext.setDisabled(t>=this.pages.get("count")-1)}i.template("Page <%= current %> of <%= count %>");function a(t,i,n){e(".statusbar #label-pages",this.$el).text(Common.Utils.String.format(this.pageIndexText,t.get("current"),t.get("count")))}function r(t){var e=this;t.canUseSelectHandTools&&(e.btnSelectTool.updateHint(e.tipSelectTool),e.btnHandTool.updateHint(e.tipHandTool)),e.btnZoomToPage.updateHint(e.tipFitPage),e.btnZoomToWidth.updateHint(e.tipFitWidth),e.btnZoomDown.updateHint(e.tipZoomOut+Common.Utils.String.platformKey("Ctrl+-")),e.btnZoomUp.updateHint(e.tipZoomIn+Common.Utils.String.platformKey("Ctrl++")),e.btnPagePrev.updateHint(e.tipPagePrev),e.btnPageNext.updateHint(e.tipPageNext),e.cntZoom.updateHint(e.tipZoomFactor),e.cntZoom.cmpEl.on({"show.bs.dropdown":function(){i.defer((function(){e.cntZoom.cmpEl.find("ul").focus()}),100)},"hide.bs.dropdown":function(){i.defer((function(){e.api.asc_enableKeyEvents(!0)}),100)}}),e.txtGoToPage.on({"keypress:after":function(t,i){if(i.keyCode===Common.UI.Keys.RETURN){var n=e.$el.find("#status-goto-box"),o=n.find("input[type=text]"),s=parseInt(o.val());return!s||s-- >e.pages.get("count")||s<0?(o.select(),!1):(n.focus(),n.parent().removeClass("open"),e.api.goToPage(s),e.api.asc_enableKeyEvents(!0),!1)}},"keyup:after":function(t,i){if(i.keyCode===Common.UI.Keys.ESC){var n=e.$el.find("#status-goto-box");return n.focus(),n.parent().removeClass("open"),e.api.asc_enableKeyEvents(!0),!1}}});var n=e.$el.find("#status-goto-box");n.on("click",(function(){return!1})),n.parent().on({"show.bs.dropdown":function(){e.txtGoToPage.setValue(e.api.getCurrentPage()+1),e.txtGoToPage.checkValidate();var t=e.txtGoToPage.$el.find("input");i.defer((function(){t.focus().select()}),100)},"hide.bs.dropdown":function(){var t=e.$el.find("#status-goto-box");e.api&&t&&(t.focus(),t.parent().removeClass("open"),e.api.asc_enableKeyEvents(!0))}}),e.zoomMenu.on("item:click",(function(t,i){e.fireEvent("zoom:value",[i.value])}))}PDFE.Views.Statusbar=n.View.extend(i.extend({el:"#statusbar",template:i.template(t),events:{},api:void 0,pages:void 0,initialize:function(t){i.extend(this,t),this.pages=new PDFE.Models.Pages({current:1,count:1}),this.pages.on("change",i.bind(a,this)),this._state={},this._isDisabled=!1;var n=this;this.$layout=e(this.template({textGotoPage:this.goToPageText,textPageNumber:Common.Utils.String.format(this.pageIndexText,1,1)})),this.btnSelectTool=new Common.UI.Button({hintAnchor:"top",toggleGroup:"select-tools",enableToggle:!0,allowDepress:!1}),this.btnHandTool=new Common.UI.Button({hintAnchor:"top",toggleGroup:"select-tools",enableToggle:!0,allowDepress:!1}),this.btnZoomToPage=new Common.UI.Button({hintAnchor:"top",toggleGroup:"status-zoom",enableToggle:!0}),this.btnZoomToWidth=new Common.UI.Button({hintAnchor:"top",toggleGroup:"status-zoom",enableToggle:!0}),this.cntZoom=new Common.UI.Button({hintAnchor:"top"}),this.btnZoomDown=new Common.UI.Button({hintAnchor:"top"}),this.btnZoomUp=new Common.UI.Button({hintAnchor:"top-right"}),this.zoomMenu=new Common.UI.Menu({style:"margin-top:-5px;",menuAlign:"bl-tl",items:[{caption:"50%",value:50},{caption:"75%",value:75},{caption:"100%",value:100},{caption:"125%",value:125},{caption:"150%",value:150},{caption:"175%",value:175},{caption:"200%",value:200},{caption:"300%",value:300},{caption:"400%",value:400},{caption:"500%",value:500}]}),this.txtGoToPage=new Common.UI.InputField({allowBlank:!0,validateOnChange:!0,style:"width: 60px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&t>0&&t<=n.pages.get("count"))||n.txtPageNumInvalid}}),this.btnPagePrev=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-previtem",disabled:!0,hintAnchor:"top",dataHint:"0",dataHintDirection:"top"}),this.btnPageNext=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-nextitem",disabled:!0,hintAnchor:"top-left",dataHint:"0",dataHintDirection:"top"});var o=new Promise((function(t,e){t()}));Common.NotificationCenter.on("app:ready",function(t){o.then(r.bind(this,t))}.bind(this))},render:function(t){var i=this;function n(t,e){t.setElement(e,!1),t.render()}return this.fireEvent("render:before",[this.$layout]),n(i.btnZoomToPage,e("#btn-zoom-topage",i.$layout)),n(i.btnZoomToWidth,e("#btn-zoom-towidth",i.$layout)),n(i.cntZoom,e(".cnt-zoom",i.$layout)),n(i.btnZoomDown,e("#btn-zoom-down",i.$layout)),n(i.btnZoomUp,e("#btn-zoom-up",i.$layout)),n(i.txtGoToPage,e("#status-goto-page",i.$layout)),i.zoomMenu.render(e(".cnt-zoom",i.$layout)),i.zoomMenu.cmpEl.attr({tabindex:-1}),i.btnPagePrev.render(e("#slot-status-btn-prev",i.$layout)),i.btnPageNext.render(e("#slot-status-btn-next",i.$layout)),t.canUseSelectHandTools&&(n(i.btnSelectTool,e("#status-btn-select-tool",i.$layout)),n(i.btnHandTool,e("#status-btn-hand-tool",i.$layout))),this.$el.html(i.$layout),this.fireEvent("render:after",[this]),this},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onCountPages",i.bind(o,this)),this.api.asc_registerCallback("asc_onCurrentPage",i.bind(s,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",i.bind(this.onApiCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",i.bind(this.onApiCoAuthoringDisconnect,this))),this},setMode:function(t){this.mode=t},setVisible:function(t){t?this.show():this.hide()},isVisible:function(){return this.$el&&this.$el.is(":visible")},getStatusLabel:function(){return e(".statusbar #label-action")},showStatusMessage:function(t){this.getStatusLabel().text(t)},clearStatusMessage:function(){this.getStatusLabel().text("")},SetDisabled:function(t){this._isDisabled=t},onApiCoAuthoringDisconnect:function(){this.setMode({isDisconnected:!0}),this.SetDisabled(!0)},pageIndexText:"Page {0} of {1}",goToPageText:"Go to Page",tipFitPage:"Fit to Page",tipFitWidth:"Fit to Width",tipZoomIn:"Zoom In",tipZoomOut:"Zoom Out",tipZoomFactor:"Magnification",txtPageNumInvalid:"Page number invalid",tipPagePrev:"Go to previous page",tipPageNext:"Go to nex page",tipSelectTool:"Select tool",tipHandTool:"Hand tool"},PDFE.Views.Statusbar||{}))})),void 0===window.Common&&(window.Common={}),Common.util=Common.util||{},Common.util.LanguageInfo=new function(){var t={54:["af","Afrikaans"],1078:["af-ZA","Afrikaans (Suid Afrika)","Afrikaans (South Africa)"],28:["sq","Shqipe"],1052:["sq-AL","Shqipe (ShqipÃ«ria)","Albanian (Albania)"],132:["gsw","ElsÃ¤ssisch"],1156:["gsw-FR","ElsÃ¤ssisch (FrÃ nkrisch)","Alsatian (France)"],94:["am","á áá­á"],1118:["am-ET","á áá­á (á¢áµá®áµá«)","Amharic (Ethiopia)"],1:["ar","Ø§ÙØ¹Ø±Ø¨ÙØ©â"],5121:["ar-DZ","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¬Ø²Ø§Ø¦Ø±)â","Arabic (Algeria)"],15361:["ar-BH","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¨Ø­Ø±ÙÙ)â","Arabic (Bahrain)"],3073:["ar-EG","Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØµØ±)â","Arabic (Egypt)"],2049:["ar-IQ","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¹Ø±Ø§Ù)â","Arabic (Iraq)"],11265:["ar-JO","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ£Ø±Ø¯Ù)â","Arabic (Jordan)"],13313:["ar-KW","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙØª)â","Arabic (Kuwait)"],12289:["ar-LB","Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØ¨ÙØ§Ù)â","Arabic (Lebanon)"],4097:["ar-LY","Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙÙØ¨ÙØ§)â","Arabic (Libya)"],6145:["ar-MA","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙÙØ© Ø§ÙÙØºØ±Ø¨ÙØ©)â","Arabic (Morocco)"],8193:["ar-OM","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø¹ÙØ§Ù)â","Arabic (Oman)"],16385:["ar-QA","Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØ·Ø±)â","Arabic (Qatar)"],1025:["ar-SA","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙÙØ© Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙØ³Ø¹ÙØ¯ÙØ©)â","Arabic (Saudi Arabia)"],10241:["ar-SY","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø³ÙØ±ÙØ§)â","Arabic (Syria)"],7169:["ar-TN","Ø§ÙØ¹Ø±Ø¨ÙØ© (ØªÙÙØ³)â","Arabic (Tunisia)"],14337:["ar-AE","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¥ÙØ§Ø±Ø§Øª Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙÙØªØ­Ø¯Ø©)â","Arabic (U.A.E.)"],9217:["ar-YE","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙ)â","Arabic (Yemen)"],43:["hy","ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶"],1067:["hy-AM","ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶ (ÕÕ¡ÕµÕ¡Õ½Õ¿Õ¡Õ¶)","Armenian (Armenia)"],77:["as","à¦à¦¸à¦®à§à§à¦¾"],1101:["as-IN","à¦à¦¸à¦®à§à§à¦¾ (à¦­à¦¾à§°à¦¤)","Assamese (India)"],44:["az","AzÉrbaycanÂ­Ä±lÄ±"],29740:["az-Cyrl","ÐÐ·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½Â Ð´Ð¸Ð»Ð¸"],2092:["az-Cyrl-AZ","ÐÐ·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½ (ÐÐ·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½)","Azeri (Cyrillic, Azerbaijan)"],30764:["az-Latn","AzÉrbaycanÂ­Ä±lÄ±"],1068:["az-Latn-AZ","AzÉrbaycanÂ­Ä±lÄ± (AzÉrbaycan)","Azeri (Latin, Azerbaijan)"],109:["ba","ÐÐ°ÑÒ¡Ð¾ÑÑ"],1133:["ba-RU","ÐÐ°ÑÒ¡Ð¾ÑÑ (Ð Ð¾ÑÑÐ¸Ñ)","Bashkir (Russia)"],45:["eu","Euskara"],1069:["eu-ES","Euskara (Euskara)","Basque (Basque)"],35:["be","ÐÐµÐ»Ð°ÑÑÑÐºÑ"],1059:["be-BY","ÐÐµÐ»Ð°ÑÑÑÐºÑ (ÐÐµÐ»Ð°ÑÑÑÑ)","Belarusian (Belarus)"],69:["bn","à¦¬à¦¾à¦à¦²à¦¾"],2117:["bn-BD","à¦¬à¦¾à¦à¦²à¦¾ (à¦¬à¦¾à¦à¦²à¦¾à¦¦à§à¦¶)","Bengali (Bangladesh)"],1093:["bn-IN","à¦¬à¦¾à¦à¦²à¦¾ (à¦­à¦¾à¦°à¦¤)","Bengali (India)"],30746:["bs","bosanski"],25626:["bs-Cyrl","ÐÐ¾ÑÐ°Ð½ÑÐºÐ¸ (ÐÐ¸ÑÐ¸Ð»Ð¸ÑÐ°)"],8218:["bs-Cyrl-BA","ÐÐ¾ÑÐ°Ð½ÑÐºÐ¸ (ÐÐ¾ÑÐ½Ð° Ð¸ Ð¥ÐµÑÑÐµÐ³Ð¾Ð²Ð¸Ð½Ð°)","Bosnian (Cyrillic) (Bosnia and Herzegovina)"],26650:["bs-Latn","Bosanski (Latinica)"],5146:["bs-Latn-BA","Bosanski (Bosna i Hercegovina)","Bosnian (Latin) (Bosnia and Herzegovina)"],126:["br","Brezhoneg"],1150:["br-FR","Brezhoneg (FraÃ±s)","Breton (France)"],2:["bg","ÐÑÐ»Ð³Ð°ÑÑÐºÐ¸"],1026:["bg-BG","ÐÑÐ»Ð³Ð°ÑÑÐºÐ¸ (ÐÑÐ»Ð³Ð°ÑÐ¸Ñ)","Bulgarian (Bulgaria)"],3:["ca","CatalÃ "],1027:["ca-ES","CatalÃ  (CatalÃ )","Catalan (Catalan)"],2051:["ca-ES-valencia","CatalÃ  (ValenciÃ )","Catalan (Valencia)"],30724:["zh","ä¸­æ"],4:["zh-Hans","ä¸­æ(ç®ä½)","Chinese (Simplified)"],2052:["zh-CN","ä¸­æ(ä¸­åäººæ°å±åå½)","Chinese (People's Republic of China)"],4100:["zh-SG","ä¸­æ(æ°å å¡)","Chinese (Simplified, Singapore)"],31748:["zh-Hant","ä¸­æ(ç¹é«)","Chinese (Traditional)"],3076:["zh-HK","ä¸­æ(é¦æ¸¯ç¹å¥è¡æ¿å)","Chinese (Traditional, Hong Kong S.A.R.)"],5124:["zh-MO","ä¸­æ(æ¾³éç¹å¥è¡æ¿å)","Chinese (Traditional, Macao S.A.R.)"],1028:["zh-TW","ä¸­æ(å°ç£)","Chinese (Traditional, Taiwan)"],131:["co","Corsu"],1155:["co-FR","Corsu (France)","Corsican (France)"],26:["hr","Hrvatski"],1050:["hr-HR","Hrvatski (Hrvatska)","Croatian (Croatia)"],4122:["hr-BA","Hrvatski (Bosna i Hercegovina)","Croatian (Bosnia and Herzegovina)"],5:["cs","ÄeÅ¡tina"],1029:["cs-CZ","ÄeÅ¡tina (ÄeskÃ¡Â republika)","Czech (Czech Republic)"],6:["da","Dansk"],1030:["da-DK","Dansk (Danmark)","Danish (Denmark)"],140:["prs","Ø¯Ø±Ùâ"],1164:["prs-AF","Ø¯Ø±Ù (Ø§ÙØºØ§ÙØ³ØªØ§Ù)â","Dari (Afghanistan)"],101:["dv","ÞÞ¨ÞÞ¬ÞÞ¨ÞÞ¦ÞÞ°â"],1125:["dv-MV","ÞÞ¨ÞÞ¬ÞÞ¨ÞÞ¦ÞÞ° (ÞÞ¨ÞÞ¬ÞÞ¨ ÞÞ§ÞÞ°ÞÞ¬)â","Divehi (Maldives)"],19:["nl","Nederlands"],2067:["nl-BE","Nederlands (BelgiÃ«)","Dutch (Belgium)"],1043:["nl-NL","Nederlands (Nederland)","Dutch (Netherlands)"],9:["en","English"],3081:["en-AU","English (Australia)","English (Australia)"],10249:["en-BZ","English (Belize)","English (Belize)"],4105:["en-CA","English (Canada)","English (Canada)"],9225:["en-029","English (Caribbean)","English (Caribbean)"],16393:["en-IN","English (India)","English (India)"],6153:["en-IE","English (Ireland)","English (Ireland)"],8201:["en-JM","English (Jamaica)","English (Jamaica)"],17417:["en-MY","English (Malaysia)","English (Malaysia)"],5129:["en-NZ","English (New Zealand)","English (New Zealand)"],13321:["en-PH","English (Philippines)","English (Philippines)"],18441:["en-SG","English (Singapore)","English (Singapore)"],7177:["en-ZA","English (South Africa)","English (South Africa)"],11273:["en-TT","English (Trinidad y Tobago)","English (Trinidad y Tobago)"],2057:["en-GB","English (United Kingdom)","English (United Kingdom)"],1033:["en-US","English (United States)","English (United States)"],12297:["en-ZW","English (Zimbabwe)","English (Zimbabwe)"],15369:["en-HK","English (Hong Kong)","English (Hong Kong)"],14345:["en-ID","English (Indonesia)","English (Indonesia)"],37:["et","Eesti"],1061:["et-EE","Eesti (Eesti)","Estonian (Estonia)"],56:["fo","FÃ¸royskt"],1080:["fo-FO","FÃ¸royskt (FÃ¸royar)","Faroese (Faroe Islands)"],100:["fil","Filipino"],1124:["fil-PH","Filipino (Pilipinas)","Filipino (Philippines)"],11:["fi","Suomi"],1035:["fi-FI","Suomi (Suomi)","Finnish (Finland)"],12:["fr","FranÃ§ais"],2060:["fr-BE","FranÃ§ais (Belgique)","French (Belgium)"],3084:["fr-CA","FranÃ§ais (Canada)","French (Canada)"],1036:["fr-FR","FranÃ§ais (France)","French (France)"],5132:["fr-LU","FranÃ§ais (Luxembourg)","French (Luxembourg)"],6156:["fr-MC","FranÃ§ais (PrincipautÃ© de Monaco)","French (Principality of Monaco)"],4108:["fr-CH","FranÃ§ais (Suisse)","French (Switzerland)"],15372:["fr-HT","FranÃ§ais (HaÃ¯ti)","French (Haiti)"],9228:["fr-CG","FranÃ§ais (Congo-Brazzaville)","French (Congo)"],12300:["fr-CI","FranÃ§ais (CÃ´te dâIvoire)","French (Cote d'Ivoire)"],11276:["fr-CM","FranÃ§ais (Cameroun)","French (Cameroon)"],14348:["fr-MA","FranÃ§ais (Maroc)","French (Morocco)"],13324:["fr-ML","FranÃ§ais (Mali)","French (Mali)"],8204:["fr-RE","FranÃ§ais (La RÃ©union)","French (Reunion)"],10252:["fr-SN","FranÃ§ais (SÃ©nÃ©gal)","French (Senegal)"],7180:["fr-West","French"],98:["fy","Frysk"],1122:["fy-NL","Frysk (NederlÃ¢n)","Frisian (Netherlands)"],86:["gl","Galego"],1110:["gl-ES","Galego (Galego)","Galician (Galician)"],55:["ka","á¥áá áá£áá"],1079:["ka-GE","á¥áá áá£áá (á¡áá¥áá ááááá)","Georgian (Georgia)"],7:["de","Deutsch"],3079:["de-AT","Deutsch (Ãsterreich)","German (Austria)"],1031:["de-DE","Deutsch (Deutschland)","German (Germany)"],5127:["de-LI","Deutsch (Liechtenstein)","German (Liechtenstein)"],4103:["de-LU","Deutsch (Luxemburg)","German (Luxembourg)"],2055:["de-CH","Deutsch (Schweiz)","German (Switzerland)"],8:["el","ÎÎ»Î»Î·Î½Î¹ÎºÎ¬"],1032:["el-GR","ÎÎ»Î»Î·Î½Î¹ÎºÎ¬ (ÎÎ»Î»Î¬Î´Î±)","Greek (Greece)"],111:["kl","Kalaallisut"],1135:["kl-GL","Kalaallisut (Kalaallit Nunaat)","Greenlandic (Greenland)"],71:["gu","àªà«àªàª°àª¾àª¤à«"],1095:["gu-IN","àªà«àªàª°àª¾àª¤à« (àª­àª¾àª°àª¤)","Gujarati (India)"],104:["ha","Hausa"],31848:["ha-Latn","Hausa (Latin)"],1128:["ha-Latn-NG","Hausa (Nigeria)","Hausa (Latin) (Nigeria)"],13:["he","×¢××¨××ªâ"],1037:["he-IL","×¢××¨××ª (××©×¨××)â","Hebrew (Israel)"],57:["hi","à¤¹à¤¿à¤à¤¦à¥"],1081:["hi-IN","à¤¹à¤¿à¤à¤¦à¥ (à¤­à¤¾à¤°à¤¤)","Hindi (India)"],14:["hu","Magyar"],1038:["hu-HU","Magyar (MagyarorszÃ¡g)","Hungarian (Hungary)"],15:["is","Ãslenska"],1039:["is-IS","Ãslenska (Ãsland)","Icelandic (Iceland)"],112:["ig","Igbo"],1136:["ig-NG","Igbo (Nigeria)","Igbo (Nigeria)"],33:["id","Bahasa Indonesia"],1057:["id-ID","Bahasa Indonesia (Indonesia)","Indonesian (Indonesia)"],93:["iu","Inuktitut"],31837:["iu-Latn","Inuktitut (Qaliujaaqpait)"],2141:["iu-Latn-CA","Inuktitut (Kanatami) (kanata)","Inuktitut (Latin) (Canada)"],30813:["iu-Cans","áááááá¦ (áááá®áá¸áá¦)"],1117:["iu-Cans-CA","áááááá¦ (á²ááá¥)","Inuktitut (Canada)"],60:["ga","Gaeilge"],2108:["ga-IE","Gaeilge (Ãire)","Irish (Ireland)"],52:["xh","isiXhosa"],1076:["xh-ZA","isiXhosa (uMzantsi Afrika)","isiXhosa (South Africa)"],53:["zu","isiZulu"],1077:["zu-ZA","isiZulu (iNingizimu Afrika)","isiZulu (South Africa)"],16:["it","Italiano"],1040:["it-IT","Italiano (Italia)","Italian (Italy)"],2064:["it-CH","Italiano (Svizzera)","Italian (Switzerland)"],17:["ja","æ¥æ¬èª"],1041:["ja-JP","æ¥æ¬èª (æ¥æ¬)","Japanese (Japan)"],75:["kn","à²à²¨à³à²¨à²¡"],1099:["kn-IN","à²à²¨à³à²¨à²¡ (à²­à²¾à²°à²¤)","Kannada (India)"],63:["kk","ÒÐ°Ð·Ð°Ò"],1087:["kk-KZ","ÒÐ°Ð·Ð°Ò (ÒÐ°Ð·Ð°ÒÑÑÐ°Ð½)","Kazakh (Kazakhstan)"],83:["km","ááááá"],1107:["km-KH","ááááá (ááááá»áá¶)","Khmer (Cambodia)"],134:["qut","K'iche"],1158:["qut-GT","K'iche (Guatemala)","K'iche (Guatemala)"],135:["rw","Kinyarwanda"],1159:["rw-RW","Kinyarwanda (Rwanda)","Kinyarwanda (Rwanda)"],65:["sw","Kiswahili"],1089:["sw-KE","Kiswahili (Kenya)","Kiswahili (Kenya)"],87:["kok","à¤à¥à¤à¤à¤£à¥"],1111:["kok-IN","à¤à¥à¤à¤à¤£à¥ (à¤­à¤¾à¤°à¤¤)","Konkani (India)"],18:["ko","íêµ­ì´"],1042:["ko-KR","íêµ­ì´ (ëíë¯¼êµ­)","Korean (Korea)"],64:["ky","ÐÑÑÐ³ÑÐ·"],1088:["ky-KG","ÐÑÑÐ³ÑÐ· (ÐÑÑÐ³ÑÐ·ÑÑÐ°Ð½)","Kyrgyz (Kyrgyzstan)"],84:["lo","àº¥àº²àº§"],1108:["lo-LA","àº¥àº²àº§ (àºª.àº.àº. àº¥àº²àº§)","Lao (Lao P.D.R.)"],38:["lv","LatvieÅ¡u"],1062:["lv-LV","LatvieÅ¡u (Latvija)","Latvian (Latvia)"],39:["lt","LietuviÅ³"],1063:["lt-LT","LietuviÅ³ (Lietuva)","Lithuanian (Lithuania)"],31790:["dsb","DolnoserbÅ¡Äina"],2094:["dsb-DE","DolnoserbÅ¡Äina (Nimska)","Lower Sorbian (Germany)"],110:["lb","LÃ«tzebuergesch"],1134:["lb-LU","LÃ«tzebuergesch (Luxembourg)","Luxembourgish (Luxembourg)"],1071:["mk-MK","ÐÐ°ÐºÐµÐ´Ð¾Ð½ÑÐºÐ¸ ÑÐ°Ð·Ð¸Ðº (ÐÐ°ÐºÐµÐ´Ð¾Ð½Ð¸ÑÐ°)","Macedonian (Former Yugoslav Republic of Macedonia)"],47:["mk","ÐÐ°ÐºÐµÐ´Ð¾Ð½ÑÐºÐ¸ ÑÐ°Ð·Ð¸Ðº"],62:["ms","Bahasa Melayu"],2110:["ms-BN","Bahasa Melayu (Brunei Darussalam)","Malay (Brunei Darussalam)"],1086:["ms-MY","Bahasa Melayu (Malaysia)","Malay (Malaysia)"],76:["ml","à´®à´²à´¯à´¾à´³à´"],1100:["ml-IN","à´®à´²à´¯à´¾à´³à´ (à´­à´¾à´°à´¤à´)","Malayalam (India)"],58:["mt","Malti"],1082:["mt-MT","Malti (Malta)","Maltese (Malta)"],129:["mi","Reo MÄori"],1153:["mi-NZ","Reo MÄori (Aotearoa)","Maori (New Zealand)"],122:["arn","Mapudungun"],1146:["arn-CL","Mapudungun (Chile)","Mapudungun (Chile)"],78:["mr","à¤®à¤°à¤¾à¤ à¥"],1102:["mr-IN","à¤®à¤°à¤¾à¤ à¥ (à¤­à¤¾à¤°à¤¤)","Marathi (India)"],124:["moh","Kanien'kÃ©ha"],1148:["moh-CA","Kanien'kÃ©ha (Canada)","Mohawk (Canada)"],80:["mn","ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÑÐ»"],30800:["mn-Cyrl","ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÑÐ»"],1104:["mn-MN","ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÑÐ» (ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÐ»Ñ)","Mongolian (Cyrillic, Mongolia)"],31824:["mn-Mong","á ®á ¤á ¨á ­á ­á ¤á ¯ á ¬á ¡á ¯á ¡"],2128:["mn-Mong-CN","á ®á ¤á ¨á ­á ­á ¤á ¯ á ¬á ¡á ¯á ¡ (á ªá ¦á ­á ¦á ³á ¡ á ¨á  á ¢á ·á  á ®á ³á  á ¬á ¤ á ³á ¤á ®á ³á  á ³á ¤ á  á ·á  á ³ á £á ¯á £á °)","Mongolian (Traditional Mongolian) (People's Republic of China)"],97:["ne","à¤¨à¥à¤ªà¤¾à¤²à¥"],1121:["ne-NP","à¤¨à¥à¤ªà¤¾à¤²à¥ (à¤¨à¥à¤ªà¤¾à¤²)","Nepali (Nepal)"],2145:["ne-IN","à¤¨à¥à¤ªà¤¾à¤²à¥ (à¤­à¤¾à¤°à¤¤)","Nepali (India)"],20:["no","Norsk"],31764:["nb","Norsk (bokmÃ¥l)"],1044:["nb-NO","Norsk, bokmÃ¥l (Norge)","Norwegian, BokmÃ¥l (Norway)"],30740:["nn","Norsk (Nynorsk)"],2068:["nn-NO","Norsk, nynorsk (Noreg)","Norwegian, Nynorsk (Norway)"],130:["oc","Occitan"],1154:["oc-FR","Occitan (FranÃ§a)","Occitan (France)"],72:["or","à¬à­à¬¿à¬"],1096:["or-IN","à¬à­à¬¿à¬ (à¬­à¬¾à¬°à¬¤)","Oriya (India)"],99:["ps","Ù¾ÚØªÙâ"],1123:["ps-AF","Ù¾ÚØªÙ (Ø§ÙØºØ§ÙØ³ØªØ§Ù)â","Pashto (Afghanistan)"],41:["fa","ÙØ§Ø±Ø³Ùâ"],1065:["fa-IR","ÙØ§Ø±Ø³Ù (Ø§ÛØ±Ø§Ù)â","Persian (Iran)"],21:["pl","Polski"],1045:["pl-PL","Polski (Polska)","Polish (Poland)"],22:["pt","PortuguÃªs"],1046:["pt-BR","PortuguÃªs (Brasil)","Portuguese (Brazil)"],2070:["pt-PT","PortuguÃªs (Portugal)","Portuguese (Portugal)"],70:["pa","à¨ªà©°à¨à¨¾à¨¬à©"],1094:["pa-IN","à¨ªà©°à¨à¨¾à¨¬à© (à¨­à¨¾à¨°à¨¤)","Punjabi (India)"],107:["quz","Runasimi"],1131:["quz-BO","Runasimi (Qullasuyu)","Quechua (Bolivia)"],2155:["quz-EC","Runasimi (Ecuador)","Quechua (Ecuador)"],3179:["quz-PE","Runasimi (Piruw)","Quechua (Peru)"],24:["ro","RomÃ¢nÄ"],1048:["ro-RO","RomÃ¢nÄ (RomÃ¢nia)","Romanian (Romania)"],2072:["ro-MD","RomÃ¢nÄ (Moldova)","Romanian (Republic of Moldova)"],23:["rm","Rumantsch"],1047:["rm-CH","Rumantsch (Svizra)","Romansh (Switzerland)"],25:["ru","Ð ÑÑÑÐºÐ¸Ð¹"],1049:["ru-RU","Ð ÑÑÑÐºÐ¸Ð¹ (Ð Ð¾ÑÑÐ¸Ñ)","Russian (Russia)"],2073:["ru-MD","Ð ÑÑÑÐºÐ¸Ð¹ (ÐÐ¾Ð»Ð´Ð°Ð²Ð¸Ñ)","Russian (Republic of Moldova)"],28731:["smn","SÃ¤mikielÃ¢"],9275:["smn-FI","SÃ¤mikielÃ¢ (SuomÃ¢)","Sami (Inari) (Finland)"],31803:["smj","JulevusÃ¡megiella"],4155:["smj-NO","JulevusÃ¡megiella (Vuodna)","Sami (Lule) (Norway)"],5179:["smj-SE","JulevusÃ¡megiella (Svierik)","Sami (Lule) (Sweden)"],59:["se","DavvisÃ¡megiella"],3131:["se-FI","DavvisÃ¡megiella (Suopma)","Sami (Northern) (Finland)"],1083:["se-NO","DavvisÃ¡megiella (Norga)","Sami (Northern) (Norway)"],2107:["se-SE","DavvisÃ¡megiella (RuoÅ§Å§a)","Sami (Northern) (Sweden)"],29755:["sms","SÃ¤Ã¤mÂ´Ç©iÃµll"],8251:["sms-FI","SÃ¤Ã¤mÂ´Ç©iÃµll (LÃ¤Ã¤Â´ddjÃ¢nnam)","Sami (Skolt) (Finland)"],30779:["sma","Ã¥arjelsaemiengiele"],6203:["sma-NO","Ã¥arjelsaemiengiele (NÃ¶Ã¶rje)","Sami (Southern) (Norway)"],7227:["sma-SE","Ã¥arjelsaemiengiele (Sveerje)","Sami (Southern) (Sweden)"],79:["sa","à¤¸à¤à¤¸à¥à¤à¥à¤¤"],1103:["sa-IN","à¤¸à¤à¤¸à¥à¤à¥à¤¤ (à¤­à¤¾à¤°à¤¤à¤®à¥)","Sanskrit (India)"],145:["gd","GÃ idhlig"],1169:["gd-GB","GÃ idhlig (An RÃ¬oghachd Aonaichte)","Scottish Gaelic (United Kingdom)"],31770:["sr","Srpski"],27674:["sr-Cyrl","Ð¡ÑÐ¿ÑÐºÐ¸ (ÐÐ¸ÑÐ¸Ð»Ð¸ÑÐ°)"],7194:["sr-Cyrl-BA","Ð¡ÑÐ¿ÑÐºÐ¸ (ÐÐ¾ÑÐ½Ð° Ð¸ Ð¥ÐµÑÑÐµÐ³Ð¾Ð²Ð¸Ð½Ð°)","Serbian (Cyrillic) (Bosnia and Herzegovina)"],12314:["sr-Cyrl-ME","Ð¡ÑÐ¿ÑÐºÐ¸ (Ð¦ÑÐ½Ð° ÐÐ¾ÑÐ°)","Serbian (Cyrillic, Montenegro)"],3098:["sr-Cyrl-CS","Ð¡ÑÐ¿ÑÐºÐ¸ (Ð¡ÑÐ±Ð¸ÑÐ° Ð¸ Ð¦ÑÐ½Ð° ÐÐ¾ÑÐ° (ÐÑÐµÑÑÐ¾Ð´Ð½Ð¾))","Serbian (Cyrillic, Serbia and Montenegro (Former))"],10266:["sr-Cyrl-RS","Ð¡ÑÐ¿ÑÐºÐ¸ (Ð¡ÑÐ±Ð¸ÑÐ°)","Serbian (Cyrillic, Serbia)"],28698:["sr-Latn","Srpski (Latinica)"],6170:["sr-Latn-BA","Srpski (Bosna i Hercegovina)","Serbian (Latin, Bosnia and Herzegovina)"],11290:["sr-Latn-ME","Srpski (Crna Gora)","Serbian (Latin, Montenegro)"],2074:["sr-Latn-CS","Srpski (Srbija i Crna Gora (Prethodno))","Serbian (Latin, Serbia and Montenegro (Former))"],9242:["sr-Latn-RS","Srpski (Srbija, Latinica)","Serbian (Latin, Serbia)"],108:["nso","Sesotho sa Leboa"],1132:["nso-ZA","Sesotho sa Leboa (Afrika Borwa)","Sesotho sa Leboa (South Africa)"],50:["tn","Setswana"],1074:["tn-ZA","Setswana (Aforika Borwa)","Setswana (South Africa)"],91:["si","à·à·à¶à·"],1115:["si-LK","à·à·à¶à·à¶½ (à·à·âà¶»à· à¶½à¶à¶à·à·)","Sinhala (Sri Lanka)"],27:["sk","SlovenÄina"],1051:["sk-SK","SlovenÄina (SlovenskÃ¡ republika)","Slovak (Slovakia)"],36:["sl","Slovenski"],1060:["sl-SI","Slovenski (Slovenija)","Slovenian (Slovenia)"],10:["es","EspaÃ±ol"],11274:["es-AR","EspaÃ±ol (Argentina)","Spanish (Argentina)"],16394:["es-BO","EspaÃ±ol (Bolivia)","Spanish (Bolivia)"],13322:["es-CL","EspaÃ±ol (Chile)","Spanish (Chile)"],9226:["es-CO","EspaÃ±ol (Colombia)","Spanish (Colombia)"],5130:["es-CR","EspaÃ±ol (Costa Rica)","Spanish (Costa Rica)"],7178:["es-DO","EspaÃ±ol (RepÃºblica Dominicana)","Spanish (Dominican Republic)"],12298:["es-EC","EspaÃ±ol (Ecuador)","Spanish (Ecuador)"],17418:["es-SV","EspaÃ±ol (El Salvador)","Spanish (El Salvador)"],4106:["es-GT","EspaÃ±ol (Guatemala)","Spanish (Guatemala)"],18442:["es-HN","EspaÃ±ol (Honduras)","Spanish (Honduras)"],2058:["es-MX","EspaÃ±ol (MÃ©xico)","Spanish (Mexico)"],19466:["es-NI","EspaÃ±ol (Nicaragua)","Spanish (Nicaragua)"],6154:["es-PA","EspaÃ±ol (PanamÃ¡)","Spanish (Panama)"],15370:["es-PY","EspaÃ±ol (Paraguay)","Spanish (Paraguay)"],10250:["es-PE","EspaÃ±ol (PerÃº)","Spanish (Peru)"],20490:["es-PR","EspaÃ±ol (Puerto Rico)","Spanish (Puerto Rico)"],3082:["es-ES","EspaÃ±ol (EspaÃ±a, alfabetizaciÃ³n internacional)","Spanish (Spain)"],21514:["es-US","EspaÃ±ol (Estados Unidos)","Spanish (United States)"],14346:["es-UY","EspaÃ±ol (Uruguay)","Spanish (Uruguay)"],8202:["es-VE","EspaÃ±ol (Republica Bolivariana de Venezuela)","Spanish (Venezuela)"],1034:["es-ES_tradnl","Spanish"],22538:["es-419","EspaÃ±ol (AmÃ©rica Latina y el Caribe)","Spanish (Latin America and the Caribbean)"],23562:["es-CU","EspaÃ±ol (Cuba)","Spanish (Cuba)"],29:["sv","Svenska"],2077:["sv-FI","Svenska (Finland)","Swedish (Finland)"],1053:["sv-SE","Svenska (Sverige)","Swedish (Sweden)"],90:["syr","Ü£ÜÜªÜÜÜâ"],1114:["syr-SY","Ü£ÜÜªÜÜÜ (Ø³ÙØ±ÙØ§)â","Syriac (Syria)"],40:["tg","Ð¢Ð¾Ò·Ð¸ÐºÓ£"],31784:["tg-Cyrl","Ð¢Ð¾Ò·Ð¸ÐºÓ£"],1064:["tg-Cyrl-TJ","Ð¢Ð¾Ò·Ð¸ÐºÓ£ (Ð¢Ð¾Ò·Ð¸ÐºÐ¸ÑÑÐ¾Ð½)","Tajik (Cyrillic) (Tajikistan)"],95:["tzm","Tamazight"],31839:["tzm-Latn","Tamazight (Latin)"],2143:["tzm-Latn-DZ","Tamazight (DjazaÃ¯r)","Tamazight (Latin) (Algeria)"],73:["ta","à®¤à®®à®¿à®´à¯"],1097:["ta-IN","à®¤à®®à®¿à®´à¯ (à®à®¨à¯à®¤à®¿à®¯à®¾)","Tamil (India)"],68:["tt","Ð¢Ð°ÑÐ°Ñ"],1092:["tt-RU","Ð¢Ð°ÑÐ°Ñ (Ð Ð¾ÑÑÐ¸Ñ)","Tatar (Russia)"],74:["te","à°¤à±à°²à±à°à±"],1098:["te-IN","à°¤à±à°²à±à°à± (à°­à°¾à°°à°¤Â à°¦à±à°¶à°)","Telugu (India)"],30:["th","à¹à¸à¸¢"],1054:["th-TH","à¹à¸à¸¢ (à¹à¸à¸¢)","Thai (Thailand)"],81:["bo","à½à½¼à½à¼à½¡à½²à½"],1105:["bo-CN","à½à½¼à½à¼à½¡à½²à½ (à½à¾²à½´à½à¼à½§à¾­à¼à½à½²à¼à½à½à½à½¦à¼à½¦à¾¤à¾±à½²à¼à½à½à½´à½à¼à½¢à¾à¾±à½£à¼à½à½à¼)","Tibetan (People's Republic of China)"],2129:["bo-BT","Tibetan (Bhutan)","Tibetan (Bhutan)"],31:["tr","TÃ¼rkÃ§e"],1055:["tr-TR","TÃ¼rkÃ§e (TÃ¼rkiye)","Turkish (Turkey)"],66:["tk","TÃ¼rkmenÃ§e"],1090:["tk-TM","TÃ¼rkmenÃ§e (TÃ¼rkmenistan)","Turkmen (Turkmenistan)"],34:["uk","Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°"],1058:["uk-UA","Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ° (Ð£ÐºÑÐ°ÑÐ½Ð°)","Ukrainian (Ukraine)"],46:["hsb","HornjoserbÅ¡Äina"],1070:["hsb-DE","HornjoserbÅ¡Äina (NÄmska)","Upper Sorbian (Germany)"],32:["ur","Ø§ÙØ±Ø¯Ùâ"],1056:["ur-PK","Ø§ÙØ±Ø¯Ù (Ù¾Ø§Ú©Ø³ØªØ§Ù)â","Urdu (Islamic Republic of Pakistan)"],2080:["ur-IN","Ø§ÙØ±Ø¯Ù (Ø¨Ú¾Ø§Ø±Øª)â","Urdu (India)"],128:["ug","Ø¦ÛÙØºÛØ± ÙÛØ²ÙÙÙâ"],1152:["ug-CN","(Ø¦ÛÙØºÛØ± ÙÛØ²ÙÙÙ (Ø¬ÛÚ­Ø®ÛØ§ Ø®ÛÙÙ Ø¬ÛÙÚ¾ÛØ±ÙÙÙØªÙâ","Uighur (People's Republic of China)"],30787:["uz-Cyrl","ÐÐ·Ð±ÐµÐº"],2115:["uz-Cyrl-UZ","ÐÐ·Ð±ÐµÐº (ÐÐ·Ð±ÐµÐºÐ¸ÑÑÐ¾Ð½)","Uzbek (Cyrillic, Uzbekistan)"],67:["uz","U'zbek"],31811:["uz-Latn","U'zbek"],1091:["uz-Latn-UZ","U'zbek (U'zbekiston Respublikasi)","Uzbek (Latin, Uzbekistan)"],42:["vi","TiÃªÌng Viá»t"],1066:["vi-VN","TiÃªÌng Viá»t (Viá»t Nam)","Vietnamese (Vietnam)"],82:["cy","Cymraeg"],1106:["cy-GB","Cymraeg (y Deyrnas Unedig)","Welsh (United Kingdom)"],136:["wo","Wolof"],1160:["wo-SN","Wolof (SÃ©nÃ©gal)","Wolof (Senegal)"],133:["sah","Ð¡Ð°ÑÐ°"],1157:["sah-RU","Ð¡Ð°ÑÐ° (Ð Ð¾ÑÑÐ¸Ñ)","Yakut (Russia)"],120:["ii","êê ê±ê·"],1144:["ii-CN","êê ê±ê· (êê¸êê±ê­ê¼ê©)","Yi (People's Republic of China)"],106:["yo","Yoruba"],1130:["yo-NG","Yoruba (Nigeria)","Yoruba (Nigeria)"],1126:["bin-NG","Bini (Nigeria)","Bini (Nigeria)"],1116:["chr-US","á£á³á© (áá á¢á³á¾áµááá áá¦áá©)","Cherokee (United States)"],1127:["fuv-NG","Nigerian Fulfulde (Nigeria)","Nigerian Fulfulde (Nigeria)"],1138:["gaz-ET","West Central Oromo (Ethiopia)","West Central Oromo (Ethiopia)"],1140:["gn-PY","Guarani (Paraguay)","Guarani (Paraguay)"],1141:["haw-US","Ê»Ålelo HawaiÊ»i (Ê»Amelika Hui PÅ« Ê»Ia)","Hawaiian (United States)"],1129:["ibb-NG","Ibibio (Nigeria)","Ibibio (Nigeria)"],1137:["kr-NG","Kanuri (Nigeria)","Kanuri (Nigeria)"],1112:["mni","Manipuri","Manipuri"],1109:["my-MM","Burmese (Myanmar)","Burmese (Myanmar)"],1145:["pap-AN","Papiamento, Netherlands Antilles","Papiamento, Netherlands Antilles"],2118:["pa-PK","Panjabi (Pakistan)","Panjabi (Pakistan)"],1165:["plt-MG","Plateau Malagasy (Madagascar)","Plateau Malagasy (Madagascar)"],1113:["sd-IN","Sindhi (India)","Sindhi (India)"],2137:["sd-PK","Sindhi (Pakistan)","Sindhi (Pakistan)"],1143:["so-SO","Soomaali (Soomaaliya)","Somali (Somalia)"],1072:["st-ZA","Southern Sotho (South Africa)","Southern Sotho (South Africa)"],1139:["ti-ER","áµáá­á (á¤á­áµá«)","Tigrinya (Eritrea)"],2163:["ti-ET","áµáá­á (á¢áµá®áµá«)","Tigrinya (Ethiopia)"],1119:["tmz","Tamanaku"],3167:["tmz-MA","TamaziÉ£t n laá¹­laá¹£ (Meá¹á¹uk)","Tamanaku (Morocco)"],1073:["ts-ZA","Tsonga (South Africa)","Tsonga (South Africa)"],1075:["ven-ZA","South Africa","South Africa"]};return{getLocalLanguageName:function(e){return t[e]||["",e]},getLocalLanguageCode:function(e){if(e)for(var i in t)if(t[i][0].toLowerCase()===e.toLowerCase())return i;return null},getLanguages:function(){return t}}},define("common/main/lib/util/LanguageInfo",(function(){})),define("pdfeditor/main/app/controller/Statusbar",["core","pdfeditor/main/app/view/Statusbar","common/main/lib/util/LanguageInfo"],(function(){"use strict";PDFE.Controllers.Statusbar=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Statusbar"],initialize:function(){this.addListeners({Statusbar:{"zoom:value":function(t){this.api.zoom(t),Common.NotificationCenter.trigger("edit:complete",this.statusbar)}.bind(this)},ViewTab:{"statusbar:hide":_.bind(this.onChangeCompactView,this)}})},events:function(){return{"click #btn-zoom-down":_.bind(this.zoomDocument,this,"down"),"click #btn-zoom-up":_.bind(this.zoomDocument,this,"up"),"click #btn-zoom-topage":_.bind(this.onBtnZoomTo,this,"topage"),"click #btn-zoom-towidth":_.bind(this.onBtnZoomTo,this,"towidth")}},onLaunch:function(){this.statusbar=this.createView("Statusbar",{});var t=this;Common.NotificationCenter.on("app:face",(function(e){t.statusbar.render(e),t.statusbar.$el.css("z-index",1);var i=$(".statusbar #label-zoom");i.css("min-width",80),i.text(Common.Utils.String.format(t.zoomText,100)),e.canUseSelectHandTools&&t.statusbar.$el.find(".hide-select-tools").removeClass("hide-select-tools")})),Common.NotificationCenter.on("app:ready",t.onAppReady.bind(t))},onAppReady:function(t){var e=this;e._isDocReady=!0,new Promise((function(t){t()})).then((function(){e.bindViewEvents(e.statusbar,e.events),e.statusbar.btnPagePrev.on("click",_.bind(e.onGotoPage,e,!1)),e.statusbar.btnPageNext.on("click",_.bind(e.onGotoPage,e,!0)),t.canUseSelectHandTools&&(e.statusbar.btnSelectTool.on("click",_.bind(e.onSelectTool,e,"select")),e.statusbar.btnHandTool.on("click",_.bind(e.onSelectTool,e,"hand")),e.statusbar.btnHandTool.toggle(!0,!0))}))},onChangeCompactView:function(t,e){this.statusbar.setVisible(!e),Common.localStorage.setBool("de-hidden-status",e),"slot-btn-options"===t.$el.closest(".btn-slot").prop("id")&&this.statusbar.fireEvent("view:hide",[this,e]),Common.NotificationCenter.trigger("layout:changed","status"),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onZoomChange",_.bind(this._onZoomChange,this)),this.statusbar.setApi(t)},onBtnZoomTo:function(t,e){var i,n;"topage"==t?(i="btnZoomToPage",n="zoomFitToPage"):(i="btnZoomToWidth",n="zoomFitToWidth"),this.statusbar[i].pressed?this.api[n]():this.api.zoomCustomMode(),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},zoomDocument:function(t,e){switch(t){case"up":this.api.zoomIn();break;case"down":this.api.zoomOut()}Common.NotificationCenter.trigger("edit:complete",this.statusbar)},onGotoPage:function(t,e,i){this.api&&this.api.goToPage(this.api.getCurrentPage()+(t?1:-1))},_onZoomChange:function(t,e){this.statusbar.btnZoomToPage.toggle(2==e,!0),this.statusbar.btnZoomToWidth.toggle(1==e,!0),$(".statusbar #label-zoom").text(Common.Utils.String.format(this.zoomText,t)),this._isDocReady&&Common.localStorage.setItem("pdfe-last-zoom",t)},setStatusCaption:function(t,e,i,n){this.timerCaption&&(new Date<this.timerCaption||0==t.length)&&!e||(this.timerCaption=void 0,t.length?(this.statusbar.showStatusMessage(t),n&&n(),i>0&&(this.timerCaption=(new Date).getTime()+i)):this.statusbar.clearStatusMessage())},createDelayedElements:function(){this.statusbar.$el.css("z-index","")},synchronizeChanges:function(){this.setStatusCaption("")},showDisconnectTip:function(){var t=this;if(!this.disconnectTip){var e=this.statusbar.getStatusLabel();e=e.is(":visible")?e.parent():this.statusbar.isVisible()?this.statusbar.$el:$(document.body),this.disconnectTip=new Common.UI.SynchronizeTip({target:e,text:this.textDisconnect,placement:"top",position:this.statusbar.isVisible()?void 0:{bottom:0},showLink:!1,style:"max-width: 310px;"}),this.disconnectTip.on({closeclick:function(){t.disconnectTip.hide(),t.disconnectTip=null}})}this.disconnectTip.show()},hideDisconnectTip:function(){this.disconnectTip&&this.disconnectTip.hide(),this.disconnectTip=null},onSelectTool:function(t,e,i){this.api&&this.api.asc_setViewerTargetType(t)},zoomText:"Zoom {0}%",textDisconnect:"<b>Connection is lost</b><br>Trying to connect. Please check connection settings."},PDFE.Controllers.Statusbar||{}))})),define("pdfeditor/main/app/collection/Navigation",["underscore","backbone","common/main/lib/component/TreeView"],(function(t,e){"use strict";PDFE.Collections=PDFE.Collections||{},PDFE.Collections.Navigation=Common.UI.TreeViewStore.extend({model:Common.UI.TreeViewModel})})),define("pdfeditor/main/app/controller/Navigation",["core","pdfeditor/main/app/collection/Navigation","pdfeditor/main/app/view/Navigation"],(function(){"use strict";PDFE.Controllers.Navigation=Backbone.Controller.extend(_.extend({models:[],collections:["Navigation"],views:["Navigation"],initialize:function(){var t=this;this.addListeners({Navigation:{show:function(){t.panelNavigation&&t.panelNavigation.viewNavigationList&&(t.panelNavigation.viewNavigationList.scroller&&t.panelNavigation.viewNavigationList.scroller.update({alwaysVisibleY:!0}),t.panelNavigation.viewNavigationList.focus())}}})},events:function(){},onLaunch:function(){this.panelNavigation=this.createView("Navigation",{storeNavigation:this.getApplication().getCollection("Navigation")}),this.panelNavigation.on("render:after",_.bind(this.onAfterRender,this)),this._viewerNavigationObject=null,this._isDisabled=!1},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onViewerBookmarksUpdate",_.bind(this.updateViewerNavigation,this)),this},setMode:function(t){return this.mode=t,this.canUseViwerNavigation=this.mode.canUseViwerNavigation,this},onAfterRender:function(t){t.viewNavigationList.on("item:click",_.bind(this.onSelectItem,this)),t.viewNavigationList.on("item:contextmenu",_.bind(this.onItemContextMenu,this)),t.viewNavigationList.on("item:add",_.bind(this.onItemAdd,this)),t.navigationMenu.on("item:click",_.bind(this.onMenuItemClick,this)),t.navigationMenu.items[2].menu.on("item:click",_.bind(this.onMenuLevelsItemClick,this)),t.btnSettingsMenu.on("item:click",_.bind(this.onMenuSettingsItemClick,this)),t.btnSettingsMenu.items[2].menu.on("item:click",_.bind(this.onMenuLevelsItemClick,this)),t.btnSettingsMenu.items[4].menu.on("item:click",_.bind(this.onMenuFontSizeClick,this)),t.btnClose.on("click",_.bind(this.onClickClosePanel,this)),this.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",(function(){t.viewNavigationList&&t.viewNavigationList.scroller&&t.viewNavigationList.scroller.update({alwaysVisibleY:!0})}))},onItemContextMenu:function(t,e,i,n){var o,s=this.panelNavigation.navigationMenu;s.isVisible()&&s.hide();var a=this.panelNavigation.$el.offset(),r=n.clientY*Common.Utils.zoom();if(null!=(o=[n.clientX*Common.Utils.zoom()+5,r-a.top+5])){var l=this.panelNavigation.$el.find("#menu-navigation-container");s.rendered||(l.length<1&&(l=$('<div id="menu-navigation-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',s.id),$(this.panelNavigation.$el).append(l)),s.render(l),s.cmpEl.attr({tabindex:"-1"})),s.cmpEl.attr("data-value",i.get("index")),l.css({left:o[0],top:o[1]}),s.show(),_.delay((function(){s.cmpEl.focus()}),10)}},onSelectItem:function(t,e,i,n){this._viewerNavigationObject&&this.api.asc_viewerNavigateTo(i.get("index"))},onItemAdd:function(t,e,i,n){i.set("dataItem",e)},onMenuItemClick:function(t,e){this._viewerNavigationObject&&("expand"==e.value?this.panelNavigation.viewNavigationList.expandAll():"collapse"==e.value&&this.panelNavigation.viewNavigationList.collapseAll())},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")},onMenuSettingsItemClick:function(t,e){switch(e.value){case"expand":this.panelNavigation.viewNavigationList.expandAll();break;case"collapse":this.panelNavigation.viewNavigationList.collapseAll();break;case"wrap":this.panelNavigation.changeWrapHeadings()}},onMenuLevelsItemClick:function(t,e){this.panelNavigation.viewNavigationList.expandToLevel(e.value-1)},onMenuFontSizeClick:function(t,e){this.panelNavigation.changeFontSize(e.value)},SetDisabled:function(t){this._isDisabled=t},updateViewerNavigation:function(t){if(this._viewerNavigationObject=t.length>0?t:null,this._viewerNavigationObject){for(var e=this._viewerNavigationObject.length,i=-1,n=-1,o=[],s=0;s<e;s++){var a=this._viewerNavigationObject[s].level-1,r=!0;a>i&&s>0&&o[s-1].set("hasSubItems",!0),(n<0||a<=n)&&(n=a,r=!1),o.push(new Common.UI.TreeViewModel({name:this._viewerNavigationObject[s].description,level:a,index:s,hasParent:r,isEmptyItem:!this._viewerNavigationObject[s].description})),i=a}0,this.getApplication().getCollection("Navigation").reset(o),this.panelNavigation&&this.panelNavigation.viewNavigationList&&this.panelNavigation.viewNavigationList.scroller&&this.panelNavigation.viewNavigationList.scroller.update({alwaysVisibleY:!0})}},txtBeginning:"Beginning of document",txtGotoBeginning:"Go to the beginning of the document"},PDFE.Controllers.Navigation||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/Slider",["common/main/lib/component/BaseView","underscore"],(function(t,e){"use strict";Common.UI.SingleSlider=Common.UI.BaseView.extend({options:{width:100,minValue:0,maxValue:100,step:1,value:100,enableKeyEvents:!1,direction:"horizontal"},disabled:!1,template:e.template(['<div class="slider single-slider <% if (this.options.direction === \'vertical\') { %>vertical<% } %>" style="">','<div class="track"></div>','<div class="thumb" style=""></div>',"<% if (this.options.enableKeyEvents) { %>",'<input type="text" style="position: absolute; top:-10px; width: 1px; height: 1px;">',"<% } %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.width=e.options.width,e.minValue=e.options.minValue,e.maxValue=e.options.maxValue,e.delta=100/(e.maxValue-e.minValue),e.step=e.options.step,e.direction=e.options.direction,e.options.el&&e.render(),this.setValue(e.options.value)},render:function(t){var i=this;i.rendered?this.cmpEl=i.$el:(this.cmpEl=$(this.template({})),t?(this.setElement(t,!1),t.html(this.cmpEl)):i.$el.html(this.cmpEl)),this.cmpEl.find(".track-center").width(i.options.width-14),this.cmpEl["vertical"===i.direction?"height":"width"](i.options.width),this.thumb=this.cmpEl.find(".thumb");var n,o=function(t){t.preventDefault(),t.stopPropagation();var e=Math.max(0,Math.min(100,Math.round(("vertical"===i.direction?t.pageY*Common.Utils.zoom()-i.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-i.cmpEl.offset().left-i._dragstart)/i.width*100)));i.setThumbPosition(e),i.lastValue=i.value,i.value=e/i.delta+i.minValue,i.thumb.removeClass("active"),$(document).off("mouseup",o),$(document).off("mousemove",s),i._dragstart=void 0,i.trigger("changecomplete",i,Common.UI.isRTL()?i.maxValue-i.value:i.value,i.lastValue)},s=function(t){if(!i.disabled&&void 0!==i._dragstart){t.preventDefault(),t.stopPropagation();var e=Math.max(0,Math.min(100,Math.round(("vertical"===i.direction?t.pageY*Common.Utils.zoom()-i.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-i.cmpEl.offset().left-i._dragstart)/i.width*100)));i.setThumbPosition(e),i.lastValue=i.value,i.value=e/i.delta+i.minValue,Math.abs(i.value-i.lastValue)>.001&&i.trigger("change",i,Common.UI.isRTL()?i.maxValue-i.value:i.value,i.lastValue)}},a=function(t){i.lastValue=i.value,i.value=Math.max(i.minValue,Math.min(i.maxValue,i.value+(t?i.step:-i.step))),i.setThumbPosition(Math.round((i.value-i.minValue)*i.delta)),i.trigger("change",i,Common.UI.isRTL()?i.maxValue-i.value:i.value,i.lastValue)},r=function(t){i.disabled||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN&&t.keyCode!=Common.UI.Keys.LEFT&&t.keyCode!=Common.UI.Keys.RIGHT||(t.preventDefault(),t.stopPropagation(),l.off("keydown","input",r),n=setInterval(e.bind(a,i,t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.RIGHT),100))};if(!i.rendered){var l=i.cmpEl;l.on("mousedown",".thumb",(function(t){i.disabled||(i._dragstart="vertical"===i.direction?t.pageY*Common.Utils.zoom()-i.thumb.offset().top:t.pageX*Common.Utils.zoom()-i.thumb.offset().left-7,i.thumb.addClass("active"),$(document).on("mouseup",o),$(document).on("mousemove",s),i.options.enableKeyEvents&&setTimeout((function(){i.input.focus()}),10))})),l.on("mousedown",".track",(function(t){if(!i.disabled){var e=Math.max(0,Math.min(100,Math.round(("vertical"===i.direction?t.pageY*Common.Utils.zoom()-i.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-i.cmpEl.offset().left)/i.width*100)));i.setThumbPosition(e),i.lastValue=i.value,i.value=e/i.delta+i.minValue,i.trigger("change",i,Common.UI.isRTL()?i.maxValue-i.value:i.value,i.lastValue),i.trigger("changecomplete",i,Common.UI.isRTL()?i.maxValue-i.value:i.value,i.lastValue)}})),this.options.enableKeyEvents&&(l.on("keydown","input",r),l.on("keyup","input",(function(t){i.disabled||(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN||Common.UI.Keys.LEFT||Common.UI.Keys.RIGHT)&&(t.stopPropagation(),t.preventDefault(),clearInterval(n),a(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.RIGHT),l.on("keydown","input",r),i.trigger("changecomplete",i,Common.UI.isRTL()?i.maxValue-i.value:i.value,i.lastValue))})))}return i.rendered=!0,this},setThumbPosition:function(t){"vertical"===this.direction?this.thumb.css({top:t+"%"}):this.thumb.css({left:t+"%"})},setValue:function(t){this.lastValue=this.value,this.value=Math.max(this.minValue,Math.min(this.maxValue,t)),this.setThumbPosition(Math.round(((Common.UI.isRTL()?this.maxValue-t:t)-this.minValue)*this.delta))},getValue:function(){return this.value},setDisabled:function(t){(t=!!t)!==this.disabled&&this.cmpEl.toggleClass("disabled",t),this.disabled=t}}),Common.UI.MultiSlider=Common.UI.BaseView.extend({options:{width:100,minValue:0,maxValue:100,values:[0,100],includeSnap:!1,intervalSnap:void 0,thumbTemplate:'<div class="thumb" style=""></div>'},disabled:!1,template:e.template(['<div class="slider multi-slider">','<div class="track">','<div class="track-left"></div>','<div class="track-center""></div>','<div class="track-right" style=""></div>',"</div>","<% _.each(items, function(item) { %>","<%= thumbTemplate %>","<% }); %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.width=e.options.width,e.minValue=e.options.minValue,e.maxValue=e.options.maxValue,e.delta=100/(e.maxValue-e.minValue),e.includeSnap=e.options.includeSnap,e.intervalSnap=e.options.intervalSnap,e.thumbs=[],e.options.el&&e.render()},render:function(t){var i=this;i.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({items:this.options.values,thumbTemplate:this.options.thumbTemplate})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl));var n=this.cmpEl;n.find(".track-center").width(i.options.width-14),n.width(i.options.width);var o=function(t){i.includeSnap&&e.each(i.centers,(function(e){t.pageX<=e+i.intervalSnap&&t.pageX>=e-i.intervalSnap&&(t.pageX=e)}))},s=function(t){for(var e,n=100,o=0,s=i.thumbs.length,a=0;a<s;a++)if(e=Math.abs(i.thumbs[a].position-t),Math.abs(e<=n)){var r=i.thumbs[a+1],l=i.thumbs[a-1];if(void 0!==l&&t<l.position)continue;if(void 0!==r&&t>r.position)continue;o=a,n=e}return o};return this.binding={onMouseUp:e.bind((function(t){t.preventDefault(),t.stopPropagation(),o(t);var n=t.data.index,s=i.thumbs[n].value,a=n-1<0?0:i.thumbs[n-1].position,r=n+1<i.thumbs.length?i.thumbs[n+1].position:100,l=Math.round((t.pageX*Common.Utils.zoom()-i.cmpEl.offset().left-i._dragstart)/i.width*100),c=l<a||l>r,d=Math.max(0,Math.min(100,l)),h=d/i.delta+i.minValue;i.thumbs.length<3&&(i.isRemoveThumb=!1),i.isRemoveThumb?(i.trigger("removethumb",i,e.findIndex(i.thumbs,{index:n})),i.trigger("change",i,h,s),i.trigger("changecomplete",i,h,s)):(i.setThumbPosition(n,d),i.thumbs[n].value=h,c&&i.sortThumbs()),$(document).off("mouseup",i.binding.onMouseUp),$(document).off("mousemove",i.binding.onMouseMove),i._dragstart=void 0,!i.isRemoveThumb&&i.trigger("changecomplete",i,h,s),i.isRemoveThumb=void 0}),this),onMouseMove:e.bind((function(t){if(!i.disabled&&void 0!==i._dragstart){t.preventDefault(),t.stopPropagation(),o(t);var e=t.data.index,n=i.thumbs[e].value,s=e-1<0?0:i.thumbs[e-1].position,a=e+1<i.thumbs.length?i.thumbs[e+1].position:100,r=Math.round((t.pageX*Common.Utils.zoom()-i.cmpEl.offset().left-i._dragstart)/i.width*100),l=r<s||r>a,c=Math.max(0,Math.min(100,r)),d=c/i.delta+i.minValue;i.setThumbPosition(e,c),i.thumbs[e].value=d,l&&i.sortThumbs();var h=t.pageY*Common.Utils.zoom()-i.cmpEl.offset().top;i.isRemoveThumb=h>i.cmpEl.height()||h<0,i.setRemoveThumb(e,i.isRemoveThumb),Math.abs(d-n)>.001&&i.trigger("change",i,d,n)}}),this),onMouseDown:e.bind((function(t){if(!i.disabled){var n=t.data.index,o=i.thumbs[n].thumb;i._dragstart=t.pageX*Common.Utils.zoom()-o.offset().left-o.width()/2,function(t){if(i.includeSnap){var n=i.minValue,o=function(t){return(.01*i.width*t+i.cmpEl.offset().left+i._dragstart)/Common.Utils.zoom()};i.centers=[],e.each(i.thumbs,(function(e,s){s!=t&&n!=e.position&&(i.centers.push(o((e.position-n)/2+n)),n=e.position)})),n!=i.maxValue&&i.centers.push(o((i.maxValue-n)/2+n))}}(n),i.setActiveThumb(n),e.each(i.thumbs,(function(t,e){n==e?t.thumb.css("z-index",500):t.thumb.css("z-index","")})),$(document).on("mouseup",null,t.data,i.binding.onMouseUp),$(document).on("mousemove",null,t.data,i.binding.onMouseMove)}}),this)},this.$thumbs=n.find(".thumb"),e.each(this.$thumbs,(function(t,e){var n=$(t);i.thumbs.push({thumb:n,index:e}),i.setValue(e,i.options.values[e]),n.on("mousedown",null,i.thumbs[e],i.binding.onMouseDown)})),i.setActiveThumb(0,!0),i.rendered||n.on("mouseup",".track",(function(t){if(!(i.disabled||!e.isUndefined(i._dragstart)||i.thumbs.length>9)){var n=Math.max(0,Math.min(100,Math.round((t.pageX*Common.Utils.zoom()-i.cmpEl.offset().left)/i.width*100))),o=s(n),a=(i.thumbs[o].colorValue,i.thumbs[o].value,n/i.delta+i.minValue);i.addThumb();var r=i.thumbs.length-1;i.setThumbPosition(r,n),i.thumbs[r].value=a,i.trigger("addthumb",i,r,n),i.trigger("change",i),i.trigger("changecomplete",i)}})),i.rendered=!0,this},setActiveThumb:function(t,e){this.currentThumb=t,this.$thumbs=this.cmpEl.find(".thumb"),this.$thumbs.removeClass("active"),this.thumbs[t].thumb.addClass("active"),!0!==e&&this.trigger("thumbclick",this,t)},setRemoveThumb:function(t,i){-1!==e.findIndex(this.thumbs,{index:t})&&(i&&this.thumbs.length>2?this.$el.find(".active").addClass("remove"):this.$el.find(".remove").removeClass("remove"))},setThumbPosition:function(t,e){this.thumbs[t].position=e,this.thumbs[t].thumb.css({left:e+"%"})},setValue:function(t,e){this.thumbs[t].value=Math.max(this.minValue,Math.min(this.maxValue,e)),this.setThumbPosition(t,Math.round((e-this.minValue)*this.delta))},getValue:function(t){return this.thumbs[t].value},getValues:function(){var t=[];return e.each(this.thumbs,(function(e){t.push(e.value)})),t},setDisabled:function(t){(t=!!t)!==this.disabled&&this.cmpEl.toggleClass("disabled",t),this.disabled=t},sortThumbs:function(){this.thumbs.sort((function(t,e){return t.position-e.position}));var t=[];return e.each(this.thumbs,(function(e,i){t.push(e.index),e.index=i})),t},setThumbs:function(t){var e=this.thumbs.length;if(e!=t)for(var i=0;i<Math.abs(t-e);i++)e<t?this.addThumb():this.removeThumb()},addThumb:function(){var t=this.cmpEl,e=$(this.options.thumbTemplate),i=this.thumbs.length;t.append(e),this.thumbs.push({thumb:e,index:i}),i>0&&this.setValue(i,this.getValue(i-1)),e.on("mousedown",null,this.thumbs[i],this.binding.onMouseDown)},removeThumb:function(t){void 0===t&&(t=this.thumbs.length-1),t>0&&(this.thumbs[t].thumb.remove(),this.thumbs.splice(t,1))}})})),define("pdfeditor/main/app/view/PageThumbnails",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/TreeView","common/main/lib/component/Slider"],(function(t){"use strict";PDFE.Views.PageThumbnails=Common.UI.BaseView.extend(_.extend({el:"#left-panel-thumbnails",storeThumbnails:void 0,template:_.template(['<div id="thumbnails-box" class="layout-ct vbox">','<div id="thumbnails-header">',"<label><%= scope.textPageThumbnails %></label>",'<div id="thumbnails-btn-close" class="float-right margin-left-4"></div>','<div id="thumbnails-btn-settings" class="float-right"></div>',"</div>",'<div id="thumbnails-list">',"</div>","</div>"].join("")),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return this.rendered||(t=t||this.el,$(t).html(this.template({scope:this})),this.$el=$(t),this.buttonClose=new Common.UI.Button({parentEl:$("#thumbnails-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.mnuSizeSetting=new Common.UI.MenuItem({template:_.template(['<div id="thumbnails-size"',"<% if(!_.isUndefined(options.stopPropagation)) { %>",'data-stopPropagation="true"',"<% } %>",">","<label>"+this.textThumbnailsSize+"</label>",'<div class="thumbnails-sld-box">','<span class="menu-item-icon menu__icon btn-thumbnail-small"></span>','<div id="sld-thumbnails-size"></div>','<span class="menu-item-icon menu__icon btn-thumbnail-big"></span>',"</div>","</div>"].join("")),stopPropagation:!0}),this.buttonSettings=new Common.UI.Button({parentEl:$("#thumbnails-btn-settings",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",hint:this.textThumbnailsSettings,menu:new Common.UI.Menu({menuAlign:"tr-br",style:"min-width: 198px;",items:[this.mnuSizeSetting,{caption:"--"},{caption:this.textHighlightVisiblePart,checkable:!0,value:"highlight",checked:Common.localStorage.getBool("de-thumbnails-highlight",!0)}]})})),this.sldrThumbnailsSize=new Common.UI.SingleSlider({el:$("#sld-thumbnails-size"),width:120,minValue:0,maxValue:100,value:50}),this.rendered=!0,this.trigger("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this)},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},ChangeSettings:function(t){},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")},textPageThumbnails:"Page Thumbnails",textClosePanel:"Close page thumbnails",textThumbnailsSettings:"Thumbnails settings",textThumbnailsSize:"Thumbnails size",textHighlightVisiblePart:"Highlight visible part of page"},PDFE.Views.PageThumbnails||{}))})),define("pdfeditor/main/app/controller/PageThumbnails",["core","pdfeditor/main/app/view/PageThumbnails"],(function(){"use strict";PDFE.Controllers.PageThumbnails=Backbone.Controller.extend(_.extend({models:[],views:["PageThumbnails"],initialize:function(){this._sendUndoPoint=!0,this.firstShow=!0,this.addListeners({PageThumbnails:{show:_.bind((function(){this.api.asc_viewerThumbnailsResize(),this.firstShow&&(this.api.asc_setViewerThumbnailsUsePageRect(Common.localStorage.getBool("de-thumbnails-highlight",!0)),this.firstShow=!1)}),this)}})},events:function(){},onLaunch:function(){this.panelThumbnails=this.createView("PageThumbnails"),this.panelThumbnails.on("render:after",_.bind(this.onAfterRender,this))},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onViewerThumbnailsZoomUpdate",_.bind(this.updateSize,this)),this},setMode:function(t){return this.mode=t,this},onAfterRender:function(t){t.sldrThumbnailsSize.on("change",_.bind(this.onChangeSize,this)),t.buttonSettings.menu.on("item:click",_.bind(this.onHighlightVisiblePart,this)),t.buttonSettings.menu.on("show:before",_.bind((function(){this.panelThumbnails.sldrThumbnailsSize.setValue(this.thumbnailsSize)}),this)),PDFE.getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind((function(){this.firstShow||this.api.asc_viewerThumbnailsResize()}),this))},onHighlightVisiblePart:function(t,e,i){if("highlight"===e.value){var n=e.isChecked();this.api.asc_setViewerThumbnailsUsePageRect(n),Common.localStorage.setBool("de-thumbnails-highlight",n)}},updateSize:function(t){this.thumbnailsSize=Math.min(100*t,100)},onChangeSize:function(t,e){void 0!==e&&(this.thumbnailsSize=e,this.api.asc_setViewerThumbnailsZoom(e/100))}},PDFE.Controllers.PageThumbnails||{}))})),function(t){var e,i,n,o={},s={16:!1,18:!1,17:!1,91:!1},a="all",r={"â§":16,shift:16,"â¥":18,alt:18,option:18,"â":17,ctrl:17,control:17,"â":91,command:91},l={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,"ff-":173,"ff=":61,numplus:107,numminus:109,0:48},c=function(t){return l[t]||t.toUpperCase().charCodeAt(0)},d=[];for(e=1;e<20;e++)l["f"+e]=111+e;function h(t,e){for(var i=t.length;i--;)if(t[i]===e)return i;return-1}function m(t,e){if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}var u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function p(t){for(e in s)s[e]=t[u[e]]}function f(t,e,i){var n,s;n=b(t),void 0===i&&(i=e,e="all");for(var a=0;a<n.length;a++)s=[],(t=n[a].split("+")).length>1&&(s=v(t),t=[t[t.length-1]]),t=t[0],(t=c(t))in o||(o[t]=[]),o[t].push({shortcut:n[a],scope:e,method:i,key:n[a],mods:s})}for(e in r)f[e]=!1;function g(){return a||"all"}function b(t){var e;return""==(e=(t=t.replace(/\s/g,"")).split(","))[e.length-1]&&(e[e.length-2]+=","),e}function v(t){for(var e=t.slice(0,t.length-1),i=0;i<e.length;i++)e[i]=r[e[i]];return e}function C(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,(function(){i(window.event)}))}C(document,"keydown",(function(t){!function(t){var e,a,l,c,m,u;if(e=t.keyCode,Common.UI.HintManager&&Common.UI.HintManager.isHintVisible())if(112===e)Common.UI.HintManager.clearHints();else if(27!==e)return;if(-1==h(d,e)&&d.push(e),93!=e&&224!=e||(e=91),e in s)for(l in s[e]=!0,r)r[l]==e&&(f[l]=!0);else if(p(t),f.filter.call(this,t)&&e in o)for(u=g(),c=0;c<o[e].length;c++)if((a=o[e][c]).scope==u||"all"==a.scope){for(l in m=a.mods.length>0,s)(!s[l]&&h(a.mods,+l)>-1||s[l]&&-1==h(a.mods,+l))&&(m=!1);if((0==a.mods.length&&!s[16]&&!s[18]&&!s[17]&&!s[91]||m)&&(!0===i||a.locked||!1===a.method(t,a))){if(!0===i&&n||a.locked&&a.propagate)continue;t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)}}}(t)})),C(document,"keyup",(function(t){var e,i=t.keyCode,n=h(d,i);if(n>=0&&d.splice(n,1),93!=i&&224!=i||(i=91),i in s)for(e in s[i]=!1,r)r[e]==i&&(f[e]=!1)})),C(window,"focus",(function(){for(e in s)s[e]=!1;for(e in r)f[e]=!1}));var y=t.key;function w(t,e,i,n){for(var s,a,r,l=[],d=b(t),h=d.length;h--;)if((s=d[h].split("+")).length>1&&(l=v(s)),s.length>0&&(t=s[s.length-1]),t=c(t),void 0===e&&(e=g()),o[t])for(a in o[t])(r=o[t][a]).scope===e&&m(r.mods,l)&&(o[t][a][i]=n)}t.key=f,t.key.setScope=function(t){a=t||"all"},t.key.getScope=g,t.key.deleteScope=function(t){var e,i,n;for(e in o)for(i=o[e],n=0;n<i.length;)i[n].scope===t?i.splice(n,1):n++},t.key.filter=function(t){var e=(t.target||t.srcElement).tagName;return!("INPUT"==e||"SELECT"==e||"TEXTAREA"==e)},t.key.isPressed=function(t){return"string"==typeof t&&(t=c(t)),-1!=h(d,t)},t.key.getPressedKeyCodes=function(){return d.slice(0)},t.key.noConflict=function(){var e=t.key;return t.key=y,e},t.key.unbind=function(t,e){var i,n,s,a,r,l=[];for(i=b(t),a=0;a<i.length;a++){if((n=i[a].split("+")).length>1&&(l=v(n)),n.length>0&&(t=n[n.length-1]),t=c(t),void 0===e&&(e=g()),!o[t])return;for(s in o[t])(r=o[t][s]).scope===e&&m(r.mods,l)&&(o[t][s]={})}},t.key.suspend=function(t,e,o){t?(w(t,e,"locked",!0),o&&w(t,e,"propagate",!0)):(i=!0,o&&(n=!0))},t.key.resume=function(t,e){t?(w(t,e,"locked",!1),w(t,e,"propagate",!1)):i=n=!1},"undefined"!=typeof module&&(module.exports=key)}(this),define("keymaster",(function(){})),void 0===Common)var Common={};if(Common.util=Common.util||{},define("common/main/lib/util/Shortcuts",["backbone","keymaster"],(function(t){"use strict";var e=function(t){return this.cid=_.uniqueId("shortcuts"),this.initialize.apply(this,arguments),this};_.extend(e.prototype,t.Events,{initialize:function(){window.key.filter=function(t){return!0},Common.NotificationCenter.on({"modal:show":function(t){window.key.suspend()},"modal:close":function(t,e){e&&window.key.resume()},"modal:hide":function(t,e){e&&window.key.resume()}})},delegateShortcuts:function(t){if(t&&t.shortcuts){var e,i,n,o,s,a;this.removeShortcuts(t);var r=[];for(s in t.shortcuts){if(e=t.shortcuts[s],_.isFunction(e))n=e;else if(!(n=t[e]))throw new Error("Method "+e+" does not exist");a=(i=s.match(/^(\S+)\s*(.*)$/))[1],o=i[2].length?i[2]:"all",n=_.bind(n,this),r.push(window.key(a,o,n))}}},removeShortcuts:function(t){if(t&&t.shortcuts){var e,i,n,o;for(n in t.shortcuts)o=(e=n.match(/^(\S+)\s*(.*)$/))[1],i=e[2].length?e[2]:"all",window.key.unbind(o,i)}},suspendEvents:function(t,e,i){window.key.suspend(t,e,i)},resumeEvents:function(t,e){window.key.resume(t,e)}}),e.extend=t.View.extend,Common.util.Shortcuts=new e})),void 0===Common)var Common={};if(define("common/main/lib/component/LoadMask",["common/main/lib/component/BaseView"],(function(){"use strict";Common.UI.LoadMask=Common.UI.BaseView.extend({options:{cls:"",style:"",title:"Loading...",owner:document.body},template:_.template(['<div id="<%= id %>" class="asc-loadmask-body <%= cls %>" role="presentation" tabindex="-1">','<i id="loadmask-spinner" class="asc-loadmask-image"></i>','<div class="asc-loadmask-title"><%= title %></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.template=this.options.template||this.template,this.title=this.options.title,this.ownerEl=this.options.owner instanceof Common.UI.BaseView?$(this.options.owner.el):$(this.options.owner),this.loaderEl=$(this.template({id:this.id,cls:this.options.cls,style:this.options.style,title:this.title})),this.maskeEl=$('<div class="asc-loadmask"></div>'),this.timerId=0},render:function(){return this},internalShowLoader:function(){this.ownerEl.append(this.loaderEl),this.loaderEl.css("min-width",$(".asc-loadmask-title",this.loaderEl).width()+105),this.ownerEl&&0==this.ownerEl.closest(".asc-window.modal").length&&Common.util.Shortcuts.suspendEvents()},internalShowMask:function(){this.ownerEl.ismasked||(this.ownerEl.ismasked=!0,this.ownerEl.append(this.maskeEl))},show:function(t){if(this.internalShowMask(),this.ownerEl.hasloader)return this;this.ownerEl.hasloader=!0;var e=this;return e.title!=e.options.title&&(e.options.title=e.title,$(".asc-loadmask-title",this.loaderEl).html(e.title)),t?e.internalShowLoader():e.timerId||(e.timerId=setTimeout((function(){e.internalShowLoader()}),500)),this},hide:function(){var t=this.ownerEl;this.timerId&&(clearTimeout(this.timerId),this.timerId=0),t&&t.ismasked&&this.maskeEl&&this.maskeEl.remove(),delete t.ismasked,t&&t.hasloader&&(0!=t.closest(".asc-window.modal").length||Common.Utils.ModalWindow.isVisible()||Common.util.Shortcuts.resumeEvents(),this.loaderEl&&this.loaderEl.remove()),delete t.hasloader},setTitle:function(t){if(this.title=t,this.ownerEl&&this.ownerEl.hasloader&&this.loaderEl){var e=$(".asc-loadmask-title",this.loaderEl);e.html(t),this.loaderEl.css("min-width",e.width()+105)}},isVisible:function(){return!!this.ownerEl.ismasked},updatePosition:function(){var t=this.ownerEl,e=this.loaderEl;t&&t.hasloader&&e&&(e.css({top:Math.round(t.height()/2-(e.height()+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")))/2)+"px",left:Math.round(t.width()/2-(e.width()+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right")))/2)+"px"}),e.css({visibility:"visible"}))}})})),define("common/main/lib/view/SaveAsDlg",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],(function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,height:681,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Folder for save",textLoading:"Loading"},Common.Views.SaveAsDlg||{}))})),define("pdfeditor/main/app/view/ViewTab",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],(function(){"use strict";PDFE.Views.ViewTab=Common.UI.BaseView.extend(_.extend({options:{},setEvents:function(){var t=this;t.btnNavigation.on("click",(function(e,i){t.fireEvent("viewtab:navigation",[e.pressed])})),t.btnsFitToPage.forEach((function(e){e.on("click",(function(){t.fireEvent("zoom:topage",[e])}))})),t.btnsFitToWidth.forEach((function(e){e.on("click",(function(){t.fireEvent("zoom:towidth",[e])}))})),t.chToolbar.on("change",_.bind((function(e,i){t.fireEvent("toolbar:setcompact",[t.chToolbar,"checked"!==i])}),t)),t.chStatusbar.on("change",_.bind((function(e,i){t.fireEvent("statusbar:hide",[t.chStatusbar,"checked"!==i])}),t)),t.chLeftMenu.on("change",_.bind((function(e,i){t.fireEvent("leftmenu:hide",[t.chLeftMenu,"checked"===i])}),t)),t.btnDarkDocument.on("click",_.bind((function(){t.fireEvent("darkmode:change")}),t)),t.cmbsZoom.forEach((function(e){e.on("combo:focusin",_.bind(t.onComboOpen,this,!1)),e.on("show:after",_.bind(t.onComboOpen,this,!0))}))},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.appConfig=t.mode,this.lockedControls=[];var e=Common.enumLock;this.btnNavigation=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-menu-navigation",lock:[e.lostConnect,e.disableOnStart],caption:this.textOutline,enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnNavigation),this.cmbsZoom=[this.getZoomCombo()],this.btnsFitToPage=[new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-zoomtopage",lock:[e.lostConnect,e.disableOnStart],caption:this.textFitToPage,toggleGroup:"view-zoom",enableToggle:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"})],this.btnsFitToWidth=[new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-zoomtowidth",lock:[e.lostConnect,e.disableOnStart],caption:this.textFitToWidth,toggleGroup:"view-zoom",enableToggle:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"})],this.btnInterfaceTheme=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-day",lock:[e.lostConnect,e.disableOnStart],caption:this.textInterfaceTheme,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnInterfaceTheme),this.btnDarkDocument=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-dark-mode",lock:[e.inLightTheme,e.lostConnect,e.disableOnStart],caption:this.textDarkDocument,enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnDarkDocument),this.chStatusbar=new Common.UI.CheckBox({lock:[e.lostConnect,e.disableOnStart],labelText:this.textStatusBar,value:!Common.localStorage.getBool("de-hidden-status"),dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chStatusbar),this.chToolbar=new Common.UI.CheckBox({lock:[e.lostConnect,e.disableOnStart],labelText:this.textAlwaysShowToolbar,value:!t.compactToolbar,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chToolbar),this.chLeftMenu=new Common.UI.CheckBox({lock:[e.lostConnect,e.disableOnStart],labelText:this.textLeftMenu,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLeftMenu),Common.Utils.lockControls(e.disableOnStart,!0,{array:this.lockedControls}),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return t&&t.html(this.getPanel()),this},getZoomCombo:function(){var t=new Common.UI.ComboBox({cls:"input-group-nr",lock:[Common.enumLock.lostConnect,Common.enumLock.disableOnStart],menuStyle:"min-width: 55px;",editable:!0,data:[{displayValue:"50%",value:50},{displayValue:"75%",value:75},{displayValue:"100%",value:100},{displayValue:"125%",value:125},{displayValue:"150%",value:150},{displayValue:"175%",value:175},{displayValue:"200%",value:200},{displayValue:"300%",value:300},{displayValue:"400%",value:400},{displayValue:"500%",value:500}],dataHint:"1",dataHintDirection:"top",dataHintOffset:"small"});return t.setValue(100),t},getPanel:function(){this.$el=$(_.template('<section class="panel" data-tab="view"><div class="group" data-layout-name="toolbar-view-navigation"><span class="btn-slot text x-huge" id="slot-btn-navigation"></span></div><div class="separator long" data-layout-name="toolbar-view-navigation"></div><div class="group small"><div class="elset" style="display: flex;"><span class="btn-slot slot-field-zoom" style="flex-grow: 1;"></span></div><div class="elset" style="text-align: center;"><span class="btn-slot text font-size-normal slot-lbl-zoom" style="text-align: center;margin-top: 4px;"></span></div></div><div class="group small"><div class="elset"><span class="btn-slot text slot-btn-ftp" style="text-align: center;"></span></div><div class="elset"><span class="btn-slot text slot-btn-ftw" style="text-align: center;"></span></div></div><div class="separator long"></div><div class="group"><span class="btn-slot text x-huge" id="slot-btn-interface-theme"></span><span class="btn-slot text x-huge" id="slot-btn-dark-document"></span></div><div class="separator long separator-theme"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-toolbar"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-statusbar"></span></div></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-leftmenu"></span></div><div class="elset"></div></div></section>')({}));var t=this.$el;this.btnNavigation.render(t.find("#slot-btn-navigation")),this.cmbsZoom[0].render(t.find(".slot-field-zoom")),t.find(".slot-lbl-zoom").text(this.textZoom),this.btnsFitToPage[0].render(t.find(".slot-btn-ftp")),this.btnsFitToWidth[0].render(t.find(".slot-btn-ftw")),this.btnInterfaceTheme.render(t.find("#slot-btn-interface-theme")),this.btnDarkDocument.render(t.find("#slot-btn-dark-document")),this.chStatusbar.render(t.find("#slot-chk-statusbar")),this.chToolbar.render(t.find("#slot-chk-toolbar")),this.chLeftMenu.render(t.find("#slot-chk-leftmenu")),this.toolbar&&this.toolbar.$el&&(this.btnsFitToPage=Common.Utils.injectButtons(this.toolbar.$el.find(".slot-btn-ftp"),"tlbtn-btn-ftp-","toolbar__icon btn-ic-zoomtopage",this.textFitToPage,[Common.enumLock.lostConnect,Common.enumLock.disableOnStart],!1,!1,!0,"1","left","medium").concat(this.btnsFitToPage),this.btnsFitToWidth=Common.Utils.injectButtons(this.toolbar.$el.find(".slot-btn-ftw"),"tlbtn-btn-ftw-","toolbar__icon btn-ic-zoomtowidth",this.textFitToWidth,[Common.enumLock.lostConnect,Common.enumLock.disableOnStart],!1,!1,!0,"1","left","medium").concat(this.btnsFitToWidth),this.toolbar.$el.find(".slot-lbl-zoom").text(this.textZoom),this.cmbsZoom.push(this.getZoomCombo()),this.cmbsZoom[1].render(this.toolbar.$el.find(".slot-field-zoom")));var e=this.btnsFitToPage.concat(this.btnsFitToWidth).concat(this.cmbsZoom);return Common.Utils.lockControls(Common.enumLock.disableOnStart,!0,{array:e}),Array.prototype.push.apply(this.lockedControls,e),this.$el},onAppReady:function(){var t=this;this.btnNavigation.updateHint(this.tipHeadings),this.btnInterfaceTheme.updateHint(this.tipInterfaceTheme),this.btnDarkDocument.updateHint(this.tipDarkDocument),this.btnsFitToPage.forEach((function(e){e.updateHint(t.tipFitToPage)})),this.btnsFitToWidth.forEach((function(e){e.updateHint(t.tipFitToWidth)}));var e=Common.UI.LayoutManager.getInitValue("leftMenu");e=void 0!==e&&!e,this.chLeftMenu.setValue(!Common.localStorage.getBool("de-hidden-leftmenu",e))},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(t){return void 0===t?this.lockedControls:[]},SetDisabled:function(t){this.lockedControls&&this.lockedControls.forEach((function(e){e&&e.setDisabled(t)}),this)},turnNavigation:function(t){this.btnNavigation&&this.btnNavigation.toggle(t,!0)},onComboOpen:function(t,e,i,n){n&&n.fromKeyDown||_.delay((function(){var i=$("input",e.cmpEl).select();t?i.focus():e.isMenuOpen()||i.one("mouseup",(function(t){t.preventDefault()}))}),10)},textNavigation:"Navigation",textOutline:"Headings",textZoom:"Zoom",textFitToPage:"Fit To Page",textFitToWidth:"Fit To Width",textInterfaceTheme:"Interface theme",textStatusBar:"Status Bar",textAlwaysShowToolbar:"Always show toolbar",textDarkDocument:"Dark document",tipHeadings:"Headings",tipFitToPage:"Fit to page",tipFitToWidth:"Fit to width",tipInterfaceTheme:"Interface theme",tipDarkDocument:"Dark document",textLeftMenu:"Left panel"},PDFE.Views.ViewTab||{}))})),define("pdfeditor/main/app/controller/LeftMenu",["core","common/main/lib/util/Shortcuts","common/main/lib/view/SaveAsDlg","pdfeditor/main/app/view/LeftMenu","pdfeditor/main/app/view/FileMenu","pdfeditor/main/app/view/ViewTab"],(function(){"use strict";PDFE.Controllers.LeftMenu=Backbone.Controller.extend(_.extend({views:["LeftMenu","FileMenu","ViewTab"],initialize:function(){this.addListeners({"Common.Views.Chat":{hide:_.bind(this.onHideChat,this)},"Common.Views.Header":{rename:_.bind((function(t){this.mode&&this.mode.wopi&&this.api?this.api.asc_wopi_renameFile(t):Common.Gateway.requestRename(t)}),this)},"Common.Views.About":{show:_.bind(this.aboutShowHide,this,!1),hide:_.bind(this.aboutShowHide,this,!0)},"Common.Views.Plugins":{"plugin:open":_.bind(this.onPluginOpen,this),hide:_.bind(this.onHidePlugins,this)},LeftMenu:{"comments:show":_.bind(this.commentsShowHide,this,"show"),"comments:hide":_.bind(this.commentsShowHide,this,"hide")},FileMenu:{"menu:hide":_.bind(this.menuFilesShowHide,this,"hide"),"menu:show":_.bind(this.menuFilesShowHide,this,"show"),"item:click":_.bind(this.clickMenuFileItem,this),"saveas:format":_.bind(this.clickSaveAsFormat,this),"settings:apply":_.bind(this.applySettings,this),"create:new":_.bind(this.onCreateNew,this),"recent:open":_.bind(this.onOpenRecent,this)},Toolbar:{"file:settings":_.bind(this.clickToolbarSettings,this),"file:open":this.clickToolbarTab.bind(this,"file"),"file:close":this.clickToolbarTab.bind(this,"other"),"save:disabled":this.changeToolbarSaveState.bind(this)},ViewTab:{"viewtab:navigation":_.bind(this.onShowHideNavigation,this),"leftmenu:hide":_.bind(this.onLeftMenuHide,this)},SearchBar:{"search:show":_.bind(this.onShowHideSearch,this)}}),Common.NotificationCenter.on("leftmenu:change",_.bind(this.onMenuChange,this)),Common.NotificationCenter.on("app:comment:add",_.bind(this.onAppAddComment,this)),Common.NotificationCenter.on("file:print",_.bind(this.clickToolbarPrint,this))},onLaunch:function(){this.leftMenu=this.createView("LeftMenu").render(),this.leftMenu.btnSearchBar.on("toggle",_.bind(this.onMenuSearchBar,this)),this._state={disableEditing:!1};var t={"command+shift+s,ctrl+shift+s":_.bind(this.onShortcut,this,"save"),"command+f,ctrl+f":_.bind(this.onShortcut,this,"search"),esc:_.bind(this.onShortcut,this,"escape"),"command+shift+h,ctrl+shift+h":_.bind(this.onShortcut,this,"comments"),f1:_.bind(this.onShortcut,this,"help")};t[Common.Utils.isMac?"ctrl+alt+f":"alt+f"]=_.bind(this.onShortcut,this,"file"),t[Common.Utils.isMac?"ctrl+alt+q":"alt+q"]=_.bind(this.onShortcut,this,"chat"),Common.util.Shortcuts.delegateShortcuts({shortcuts:t}),Common.util.Shortcuts.suspendEvents()},setApi:function(t){if(this.api=t,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiServerDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiServerDisconnect,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.mode.canCoAuthoring&&(this.mode.canChat&&this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage",_.bind(this.onApiChatMessage,this)),this.mode.canComments)){this.api.asc_registerCallback("asc_onAddComment",_.bind(this.onApiAddComment,this)),this.api.asc_registerCallback("asc_onAddComments",_.bind(this.onApiAddComments,this));for(var e=this.getApplication().getCollection("Common.Collections.Comments"),i=Common.Utils.InternalSettings.get("pdfe-settings-resolvedcomment"),n=0;n<e.length;++n){var o=e.at(n);if(!o.get("hide")&&o.get("userid")!==this.mode.user.id&&(i||!o.get("resolved"))){this.leftMenu.markCoauthOptions("comments",!0);break}}}return this.leftMenu.getMenu("file").setApi(t),this.getApplication().getController("PageThumbnails").setApi(this.api).setMode(this.mode),this.getApplication().getController("Search").setApi(this.api).setMode(this.mode),this.leftMenu.setOptionsPanel("advancedsearch",this.getApplication().getController("Search").getView("Common.Views.SearchPanel")),this},setMode:function(t){return this.mode=t,this.leftMenu.setMode(t),this.leftMenu.getMenu("file").setMode(t),t.isEdit||Common.util.Shortcuts.removeShortcuts({shortcuts:{"command+shift+s,ctrl+shift+s":_.bind(this.onShortcut,this,"save"),"alt+f":_.bind(this.onShortcut,this,"file"),"ctrl+alt+f":_.bind(this.onShortcut,this,"file")}}),this},createDelayedElements:function(){return this.mode.canCoAuthoring?(this.leftMenu.btnComments[this.mode.canViewComments&&!this.mode.isLightVersion?"show":"hide"](),this.mode.canViewComments&&this.leftMenu.setOptionsPanel("comment",this.getApplication().getController("Common.Controllers.Comments").getView()),this.leftMenu.btnChat[this.mode.canChat&&!this.mode.isLightVersion?"show":"hide"](),this.mode.canChat&&this.leftMenu.setOptionsPanel("chat",this.getApplication().getController("Common.Controllers.Chat").getView("Common.Views.Chat"))):(this.leftMenu.btnChat.hide(),this.leftMenu.btnComments.hide()),this.leftMenu.setOptionsPanel("navigation",this.getApplication().getController("Navigation").getView("Navigation")),this.mode.canUseThumbnails?this.leftMenu.setOptionsPanel("thumbnails",this.getApplication().getController("PageThumbnails").getView("PageThumbnails")):this.leftMenu.btnThumbnails.hide(),(this.mode.trialMode||this.mode.isBeta)&&this.leftMenu.setDeveloperMode(this.mode.trialMode,this.mode.isBeta,this.mode.buildVersion),Common.util.Shortcuts.resumeEvents(),this},enablePlugins:function(){this.mode.canPlugins?this.leftMenu.setOptionsPanel("plugins",this.getApplication().getController("Common.Controllers.Plugins").getView("Common.Views.Plugins")):this.leftMenu.btnPlugins.hide(),(this.mode.trialMode||this.mode.isBeta)&&this.leftMenu.setDeveloperMode(this.mode.trialMode,this.mode.isBeta,this.mode.buildVersion)},clickMenuFileItem:function(t,e,i){var n=!0;switch(e){case"back":break;case"save":Common.NotificationCenter.trigger("leftmenu:save");break;case"save-desktop":this.api.asc_DownloadAs();break;case"saveas":i?n=!1:this.clickSaveAsFormat();break;case"save-copy":i?n=!1:this.clickSaveAsFormat(void 0,void 0,!0);break;case"print":this.api.asc_Print(new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86));break;case"exit":Common.NotificationCenter.trigger("goback");break;case"edit":this.getApplication().getController("Statusbar").setStatusCaption(this.requestEditRightsText),Common.Gateway.requestEditRights();break;case"new":i?n=!1:this.onCreateNew(void 0,"blank");break;case"rename":var o=this,s=o.api.asc_getDocumentName();new Common.Views.RenameDialog({filename:s,maxLength:this.mode.wopi?this.mode.wopi.FileNameMaxLength:void 0,handler:function(t,e){"ok"!=t||_.isEmpty(e.trim())||s===e.trim()||(o.mode.wopi?o.api.asc_wopi_renameFile(e):Common.Gateway.requestRename(e)),Common.NotificationCenter.trigger("edit:complete",o)}}).show();break;case"external-help":n=!!i;break;default:n=!1}n&&t&&t.hide()},_saveAsFormat:function(t,e,i,n){var o=!!i;if(t){var s=new Asc.asc_CDownloadOptions(e,o);s.asc_setTextParams(n),e==Asc.c_oAscFileType.TXT||e==Asc.c_oAscFileType.RTF?Common.UI.warning({title:this.notcriticalErrorTitle,msg:e==Asc.c_oAscFileType.TXT?this.warnDownloadAs:this.warnDownloadAsRTF,buttons:["ok","cancel"],callback:_.bind((function(n){"ok"==n&&(this.isFromFileDownloadAs=i,e==Asc.c_oAscFileType.TXT?Common.NotificationCenter.trigger("download:advanced",Asc.c_oAscAdvancedOptionsID.TXT,this.api.asc_getAdvancedOptions(),2,s):this.api.asc_DownloadAs(s),t.hide())}),this)}):e==Asc.c_oAscFileType.DOCX?Common.Utils.InternalSettings.get("pdfe-settings-compatible")||Common.localStorage.getBool("pdfe-hide-save-compatible")||!this.api.asc_isCompatibilityMode()?(this.isFromFileDownloadAs=i,s.asc_setCompatible(!!Common.Utils.InternalSettings.get("pdfe-settings-compatible")),this.api.asc_DownloadAs(s),t.hide()):Common.UI.warning({closable:!1,width:600,title:this.notcriticalErrorTitle,msg:this.txtCompatible,buttons:["ok","cancel"],dontshow:!0,callback:_.bind((function(e,n){n&&Common.localStorage.setItem("pdfe-hide-save-compatible",1),"ok"==e&&(this.isFromFileDownloadAs=i,this.api.asc_DownloadAs(s),t.hide())}),this)}):(this.isFromFileDownloadAs=i,this.api.asc_DownloadAs(s),t.hide())}else this.isFromFileDownloadAs=o,this.api.asc_DownloadOrigin(o)},clickSaveAsFormat:function(t,e,i){var n=this,o=this.getApplication().getController("Main").document.fileType;/^pdf|xps|oxps|djvu$/.test(o)?void 0===e?(this._saveAsFormat(void 0,e,i),t&&t.hide()):e==Asc.c_oAscFileType.PDF||e==Asc.c_oAscFileType.PDFA||e==Asc.c_oAscFileType.JPG||e==Asc.c_oAscFileType.PNG?this._saveAsFormat(t,e,i):e==Asc.c_oAscFileType.TXT||e==Asc.c_oAscFileType.RTF?n._saveAsFormat(t,e,i,new AscCommon.asc_CTextParams(Asc.c_oAscTextAssociation.PlainLine)):Common.UI.warning({width:600,title:this.notcriticalErrorTitle,msg:Common.Utils.String.format(this.warnDownloadAsPdf,o.toUpperCase()),buttons:["ok","cancel"],callback:_.bind((function(o){"ok"==o&&n._saveAsFormat(t,e,i,new AscCommon.asc_CTextParams(Asc.c_oAscTextAssociation.PlainLine))}),this)}):this._saveAsFormat(t,e,i)},onDownloadUrl:function(t,e){if(this.isFromFileDownloadAs){var i=this,n=this.getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption();if(!n&&(n=i.txtUntitled),"string"==typeof this.isFromFileDownloadAs){var o=n.lastIndexOf(".");o>0&&(n=n.substring(0,o)+this.isFromFileDownloadAs)}i.mode.canRequestSaveAs?Common.Gateway.requestSaveAs(t,n,e):(i._saveCopyDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.mode.saveAsUrl,saveFileUrl:t,defFileName:n}),i._saveCopyDlg.on("saveaserror",(function(t,e){var n={closable:!1,title:i.notcriticalErrorTitle,msg:e,iconCls:"warn",buttons:["ok"],callback:function(t){Common.NotificationCenter.trigger("edit:complete",i)}};Common.UI.alert(n)})).on("close",(function(t){i._saveCopyDlg=void 0})),i._saveCopyDlg.show())}this.isFromFileDownloadAs=!1},applySettings:function(t){var e,i=Common.Utils.InternalSettings.get("pdfe-settings-coauthmode"),n=this.mode.isPDFAnnotate||this.mode.isPDFEdit;if(this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring&&n){switch(this.mode.canChangeCoAuthoring&&(i=Common.localStorage.getBool("pdfe-settings-coauthmode",!0),Common.Utils.InternalSettings.set("pdfe-settings-coauthmode",i),this.api.asc_SetFastCollaborative(i)),e=Common.localStorage.getItem(i?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict"),Common.Utils.InternalSettings.set(i?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict",e),e){case"all":e=Asc.c_oAscCollaborativeMarksShowType.All;break;case"none":e=Asc.c_oAscCollaborativeMarksShowType.None;break;case"last":e=Asc.c_oAscCollaborativeMarksShowType.LastChanges;break;default:e=i?Asc.c_oAscCollaborativeMarksShowType.None:Asc.c_oAscCollaborativeMarksShowType.LastChanges}this.api.SetCollaborativeMarksShowType(e)}e=Common.localStorage.getBool("pdfe-settings-livecomment",!0),Common.Utils.InternalSettings.set("pdfe-settings-livecomment",e);var o=Common.localStorage.getBool("pdfe-settings-resolvedcomment");switch(Common.Utils.InternalSettings.set("pdfe-settings-resolvedcomment",o),e?this.api.asc_showComments(o):this.api.asc_hideComments(),e=Common.localStorage.getBool("pdfe-settings-cachemode",!0),Common.Utils.InternalSettings.set("pdfe-settings-cachemode",e),this.api.asc_setDefaultBlitMode(e),e=Common.localStorage.getItem("pdfe-settings-fontrender"),Common.Utils.InternalSettings.set("pdfe-settings-fontrender",e),e){case"1":this.api.SetFontRenderingMode(1);break;case"2":this.api.SetFontRenderingMode(2);break;case"0":this.api.SetFontRenderingMode(3)}this.mode.isEdit&&n&&(!this.mode.canChangeCoAuthoring&&i||(e=parseInt(Common.localStorage.getItem("pdfe-settings-autosave")),Common.Utils.InternalSettings.set("pdfe-settings-autosave",e),this.api.asc_setAutoSaveGap(e))),this.api.put_ShowSnapLines(Common.Utils.InternalSettings.get("pdfe-settings-showsnaplines")),t.hide()},onCreateNew:function(t,e){if(!Common.Controllers.Desktop.process("create:new"))if("blank"==e&&this.mode.canRequestCreateNew)Common.Gateway.requestCreateNew();else{var i=window.open("blank"==e?this.mode.createUrl:e,"_blank");i&&i.focus()}t&&t.hide()},onOpenRecent:function(t,e){t&&t.hide();var i=window.open(e);i&&i.focus(),Common.component.Analytics.trackEvent("Open Recent")},clickToolbarSettings:function(t){this.leftMenu.showMenu("file:opts")},clickToolbarTab:function(t,e){"file"==t?this.leftMenu.showMenu("file"):this.leftMenu.menuFile.hide()},clickToolbarPrint:function(){this.mode.canPreviewPrint?this.leftMenu.showMenu("file:printpreview"):this.mode.canPrint&&this.clickMenuFileItem(null,"print")},changeToolbarSaveState:function(t){var e=this.leftMenu.menuFile.getButton("save");e&&e.setDisabled(t)},onHideChat:function(){$(this.leftMenu.btnChat.el).blur(),Common.NotificationCenter.trigger("layout:changed","leftmenu")},onHidePlugins:function(){Common.NotificationCenter.trigger("layout:changed","leftmenu")},onApiServerDisconnect:function(t){this.mode.isEdit=!1,this.leftMenu.close(),this.leftMenu.btnComments.setDisabled(!0),this.leftMenu.btnChat.setDisabled(!0),this.leftMenu.btnPlugins.setDisabled(!0),this.leftMenu.btnNavigation.setDisabled(!0),this.leftMenu.getMenu("file").setMode({isDisconnected:!0,enableDownload:!!t})},setPreviewMode:function(t){this._state.disableEditing=t,this.updatePreviewMode()},updatePreviewMode:function(){var t=this._state.disableEditing;this.viewmode!==t&&(this.viewmode=t)},SetDisabled:function(t,e){this.leftMenu._state.disabled!==t&&(this.leftMenu._state.disabled=t,t?(this.previsEdit=this.mode.isEdit,this.prevcanEdit=this.mode.canEdit,this.mode.isEdit=this.mode.canEdit=!t):(this.mode.isEdit=this.previsEdit,this.mode.canEdit=this.prevcanEdit)),t&&this.leftMenu.close(),(!e||e.comments&&e.comments.disable)&&this.leftMenu.btnComments.setDisabled(t),e&&!e.chat||this.leftMenu.btnChat.setDisabled(t),(!e||e.navigation&&e.navigation.disable)&&this.leftMenu.btnNavigation.setDisabled(t),this.leftMenu.btnPlugins.setDisabled(t)},onApiChatMessage:function(){this.leftMenu.markCoauthOptions("chat")},onApiAddComment:function(t,e){var i=Common.Utils.InternalSettings.get("pdfe-settings-resolvedcomment");e&&e.asc_getUserId()!==this.mode.user.id&&(i||!e.asc_getSolved())&&AscCommon.UserInfoParser.canViewComment(e.asc_getUserName())&&this.leftMenu.markCoauthOptions("comments")},onApiAddComments:function(t){for(var e=Common.Utils.InternalSettings.get("pdfe-settings-resolvedcomment"),i=0;i<t.length;++i)if(t[i].asc_getUserId()!==this.mode.user.id&&(e||!t[i].asc_getSolved())&&AscCommon.UserInfoParser.canViewComment(t.asc_getUserName())){this.leftMenu.markCoauthOptions("comments");break}},onAppAddComment:function(t){var e=this;!1===this.api.can_AddQuotedComment()&&new Promise((function(t,e){t()})).then((function(){Common.UI.Menu.Manager.hideAll(),e.leftMenu.showMenu("comments");var t=PDFE.getController("Common.Controllers.Comments");t.getView().showEditContainer(!0),t.onAfterShow()}))},commentsShowHide:function(t){Common.Utils.InternalSettings.get("pdfe-settings-livecomment"),Common.Utils.InternalSettings.get("pdfe-settings-resolvedcomment");"show"===t&&this.getApplication().getController("Common.Controllers.Comments").onAfterShow(),$(this.leftMenu.btnComments.el).blur()},aboutShowHide:function(t){this.api&&this.api.asc_enableKeyEvents(t),t&&$(this.leftMenu.btnAbout.el).blur(),t&&this.leftMenu._state.pluginIsRunning&&(this.leftMenu.panelPlugins.show(),this.mode.canCoAuthoring&&(this.mode.canViewComments&&this.leftMenu.panelComments.hide(),this.mode.canChat&&this.leftMenu.panelChat.hide()))},menuFilesShowHide:function(t){this.api&&"hide"==t&&this.api.asc_enableKeyEvents(!0)},onMenuChange:function(t){"hide"===t&&this.api&&(this.leftMenu.btnComments.isActive()?(this.leftMenu.btnComments.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnComments),this.api.asc_enableKeyEvents(!0)):this.leftMenu.btnThumbnails.isActive()?(this.leftMenu.btnThumbnails.toggle(!1),this.leftMenu.panelThumbnails.hide(),this.leftMenu.onBtnMenuClick(this.leftMenu.btnThumbnails)):this.leftMenu.btnSearchBar.isActive()?(this.leftMenu.btnSearchBar.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSearchBar)):this.leftMenu.btnNavigation.isActive()&&(this.leftMenu.btnNavigation.toggle(!1),this.leftMenu.panelNavigation.hide(),this.leftMenu.onBtnMenuClick(this.leftMenu.btnNavigation)))},onShortcut:function(t,e){if(this.mode)switch(t){case"search":this.leftMenu.btnAbout.toggle(!1),Common.UI.Menu.Manager.hideAll();var i=this.api.asc_GetSelectedText();if(this.isSearchPanelVisible())return i&&this.leftMenu.panelSearch.setFindText(i),this.leftMenu.panelSearch.focus(""!==i?t:"search"),this.leftMenu.fireEvent("search:aftershow",this.leftMenu,i||void 0),!1;if(this.getApplication().getController("Viewport").isSearchBarVisible()){var n=this.getApplication().getController("Viewport");if("replace"!==t)return i&&n.searchBar.setText(i),n.searchBar.focus(),!1;n.header.btnSearch.toggle(!1),this.onShowHideSearch(!0,n.searchBar.inputSearch.val())}else{if("search"===t)return Common.NotificationCenter.trigger("search:show"),!1;this.onShowHideSearch(!0,i||void 0)}return this.leftMenu.btnSearchBar.toggle(!0,!0),this.leftMenu.panelSearch.focus(i?t:"search"),!1;case"save":return(this.mode.canDownload||this.mode.canDownloadOrigin)&&(this.mode.isDesktopApp&&this.mode.isOffline?this.api.asc_DownloadAs():this.mode.canDownload?(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file:saveas")):this.api.asc_DownloadOrigin()),!1;case"help":return this.mode.isEdit&&this.mode.canHelp&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file:help")),!1;case"file":return Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file"),!1;case"escape":var o=this.getApplication().getController("Viewport").header.btnSearch;if(o.pressed&&o.toggle(!1),this.leftMenu.menuFile.isVisible())return Common.UI.HintManager.needCloseFileMenu()&&this.leftMenu.menuFile.hide(),!1;var s=PDFE.getController("Statusbar").statusbar.$el.find('.open > [data-toggle="dropdown"]');if(s.length)return $.fn.dropdown.Constructor.prototype.keydown.call(s[0],e),!1;if(this.mode.canPlugins&&this.leftMenu.panelPlugins&&(s=this.leftMenu.panelPlugins.$el.find('#menu-plugin-container.open > [data-toggle="dropdown"]')).length)return $.fn.dropdown.Constructor.prototype.keydown.call(s[0],e),!1;if(this.leftMenu.btnAbout.pressed||this.leftMenu.btnPlugins.pressed||$(e.target).parents("#left-menu").length)return Common.UI.HintManager.isHintVisible()||(this.leftMenu.close(),Common.NotificationCenter.trigger("layout:changed","leftmenu")),!1;break;case"chat":return this.mode.canCoAuthoring&&this.mode.canChat&&!this.mode.isLightVersion&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("chat")),!1;case"comments":return this.mode.canCoAuthoring&&this.mode.canViewComments&&!this.mode.isLightVersion&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("comments"),this.getApplication().getController("Common.Controllers.Comments").onAfterShow()),!1}},onPluginOpen:function(t,e,i){"onboard"==e&&("open"==i?(this.tryToShowLeftMenu(),this.leftMenu.close(),this.leftMenu.panelPlugins.show(),this.leftMenu.onBtnMenuClick({pressed:!0,options:{action:"plugins"}}),this.leftMenu._state.pluginIsRunning=!0):(this.leftMenu._state.pluginIsRunning=!1,this.leftMenu.close()))},onShowHideChat:function(t){this.mode.canCoAuthoring&&this.mode.canChat&&!this.mode.isLightVersion&&(t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("chat")):(this.leftMenu.btnChat.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnChat)))},onShowHideNavigation:function(t){t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("navigation")):(this.leftMenu.btnNavigation.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnNavigation))},onShowHideSearch:function(t,e){t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("advancedsearch",void 0,!0),this.leftMenu.fireEvent("search:aftershow",this.leftMenu,e)):(this.leftMenu.btnSearchBar.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSearchBar))},onMenuSearchBar:function(t,e){e&&this.leftMenu.panelSearch.setSearchMode("no-replace")},isSearchPanelVisible:function(){return this.leftMenu&&this.leftMenu.panelSearch&&this.leftMenu.panelSearch.isVisible()},isCommentsVisible:function(){return this.leftMenu&&this.leftMenu.panelComments&&this.leftMenu.panelComments.isVisible()},onLeftMenuHide:function(t,e){this.leftMenu&&(!e&&this.leftMenu.close(),e?this.leftMenu.show():this.leftMenu.hide(),Common.localStorage.setBool("pdfe-hidden-leftmenu",!e),!t&&this.leftMenu.fireEvent("view:hide",[this,!e])),Common.NotificationCenter.trigger("layout:changed","main"),Common.NotificationCenter.trigger("edit:complete",this.leftMenu)},tryToShowLeftMenu:function(){this.mode.canBrandingExt&&this.mode.customization&&!1===this.mode.customization.leftMenu||!Common.UI.LayoutManager.isElementVisible("leftMenu")||this.onLeftMenuHide(null,!0)},textNoTextFound:"Text not found",newDocumentTitle:"Unnamed document",requestEditRightsText:"Requesting editing rights...",notcriticalErrorTitle:"Warning",leavePageText:"All unsaved changes in this document will be lost.<br> Click 'Cancel' then 'Save' to save them. Click 'OK' to discard all the unsaved changes.",warnDownloadAs:"If you continue saving in this format all features except the text will be lost.<br>Are you sure you want to continue?",warnDownloadAsRTF:"If you continue saving in this format some of the formatting might be lost.<br>Are you sure you want to continue?",txtUntitled:"Untitled",txtCompatible:"The document will be saved to the new format. It will allow to use all the editor features, but might affect the document layout.<br>Use the 'Compatibility' option of the advanced settings if you want to make the files compatible with older MS Word versions.",warnDownloadAsPdf:"Your {0} will be converted to an editable format. This may take a while. The resulting document will be optimized to allow you to edit the text, so it might not look exactly like the original {0}, especially if the original file contained lots of graphics."},PDFE.Controllers.LeftMenu||{}))})),void 0===Common)var Common={};if(Common.IrregularStack=function(t){var e=[],i=function(t,e){return"object"==typeof t&&"object"==typeof e&&window.JSON?window.JSON.stringify(t)===window.JSON.stringify(e):t===e},n=(t=t||{}).strongCompare||i,o=t.weakCompare||i,s=function(t,i){for(var n=e.length-1;n>=0;n--)if(i(e[n],t))return n;return-1};return{push:function(t){e.push(t)},pop:function(t){var i=s(t,n);if(-1!=i)return e.splice(i,1)[0]},get:function(t){var i="object"==typeof t?s(t,o):t;if(-1!=i)return e[i]},exist:function(t){return!(s(t,n)<0)},length:function(){return e.length}}},define("irregularstack",(function(){})),define("common/main/lib/component/Tooltip",["tip","backbone"],(function(){"use strict";var t=function(t){this.$element=this.placement=void 0,this.init.call(this,t)};_.extend(t.prototype,Backbone.Events,{init:function(t){if(this.$element=t.owner instanceof Backbone.View?t.owner.$el:$(t.owner),this.placement=t.placement,this.$element.data("bs.tooltip")&&this.$element.removeData("bs.tooltip"),this.$element.tooltip({title:t.title,trigger:"manual",placement:t.placement,offset:t.offset,cls:t.cls,html:t.html,hideonclick:t.hideonclick,keepvisible:t.keepvisible}),t.hideonclick){var e=this,i=this.$element.data("bs.tooltip");i&&i.tip().on("click",(function(){i.hide(),e.trigger("tooltip:hideonclick",this)}))}this.$element.on("shown.bs.tooltip",_.bind(this.onTipShown,this)),this.$element.on("hidden.bs.tooltip",_.bind(this.onTipHidden,this))},show:function(t){this.getBSTip().show(t)},hide:function(t){this.getBSTip().hide(t)},setTitle:function(t){var e=this.getBSTip();e&&(e.options.title=t)},updateTitle:function(){var t=this.getBSTip();t.$tip.find(".tooltip-inner")[t.options.html?"html":"text"](t.options.title)},getBSTip:function(){return this.$element.data("bs.tooltip")},onTipShown:function(){this.trigger("tooltip:show",this)},onTipHidden:function(){this.trigger("tooltip:hide",this)},isVisible:function(){return this.getBSTip().tip().is(":visible")}}),Common.UI=Common.UI||{},Common.UI.Tooltip=t})),void 0===Common)var Common={};if(Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Fonts",["core","common/main/lib/collection/Fonts"],(function(){"use strict";Common.Controllers.Fonts=Backbone.Controller.extend(function(){var t=4;function e(e,i){e.showlastused&&function(e,i){for(var n,o=i.get("type")==t,s=-1,a=e.length,r=i.get("name");!o&&++s<a&&(n=e.at(s)).get("type")==t;)o=n.get("name")==r}(e.store,i)}function i(t){Common.NotificationCenter.trigger("fonts:change",t)}function n(t,e){var i=[];_.each(t,(function(t){var e=t.asc_getFontId();i.push({id:_.isEmpty(e)?Common.UI.getId():e,name:t.asc_getFontName(),imgidx:t.asc_getFontThumbnail(),type:t.asc_getFontType()})}));var n=this.getCollection("Common.Collections.Fonts");n&&n.add(i),Common.NotificationCenter.trigger("fonts:load",n,e)}return{models:["Common.Models.Fonts"],collections:["Common.Collections.Fonts"],views:[],initialize:function(){Common.NotificationCenter.on("fonts:select",_.bind(e,this))},onLaunch:function(){},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onInitEditorFonts",_.bind(n,this)),this.api.asc_registerCallback("asc_onFontFamily",_.bind(i,this))}}}())})),define("common/main/lib/view/OpenDialog",["common/main/lib/component/Window"],(function(){"use strict";Common.Views.OpenDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e,i,n=this,o={};if(t.preview)e=414,i=t.type==Common.Utils.importTextType.Data?385:277;else switch(e=t.type!==Common.Utils.importTextType.DRM?340:t.warning?420:280,t.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:i=190;break;case Common.Utils.importTextType.Data:i=245;break;default:i=t.warning?187:147}_.extend(o,{closable:!1,preview:t.preview,warning:t.warning,codepages:t.codepages,warningMsg:t.warningMsg,width:e,height:i,header:!0,cls:"open-dlg",contentTemplate:"",toolcallback:_.bind(n.onToolClose,n),closeFile:!1},t),this.txtOpenFile=t.txtOpenFile||this.txtOpenFile,this.template=t.template||['<div class="box" style="height:'+(o.height-85)+'px;">','<div class="content-panel" >',"<% if (type == Common.Utils.importTextType.DRM) { %>","<% if (warning) { %>","<div>",'<div class="icon warn"></div>','<div class="padding-left-50"><div style="font-size: 12px;">'+("string"==typeof o.warningMsg?o.warningMsg:n.txtProtected)+"</div>",'<label class="header" style="margin-top: 15px;">'+n.txtPassword+"</label>",'<div id="id-password-txt" style="width: 290px;"></div></div>',"</div>","<% } else { %>","<div>",'<label class="">'+n.txtOpenFile+"</label>",'<div id="id-password-txt"></div>',"</div>","<% } %>","<% } else { %>","<% if (codepages && codepages.length>0) { %>",'<div <% if (!!preview && (type == Common.Utils.importTextType.CSV || type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns)) { %> class="margin-right-10" style="width: 230px;display: inline-block;margin-bottom:15px;" <% } else { %> style="width: 100%;margin-bottom:15px;"<% } %> >','<label class="header">'+n.txtEncoding+"</label>","<div>",'<div id="id-codepages-combo" class="input-group-nr" style="width: 100%; display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.CSV) { %>",'<div style="display: inline-block; margin-bottom:15px;">','<label class="header">'+n.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row margin-left-10" style="display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns || type == Common.Utils.importTextType.Data) { %>",'<div style="display: inline-block; margin-bottom:15px;width: 100%;">','<label class="header">'+n.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row margin-left-10" style="display: inline-block; vertical-align: middle;"></div>','<button type="button" class="btn auto btn-text-default float-right" id="id-delimiters-advanced" style="min-width:100px; display: inline-block;">'+n.txtAdvanced+"</button>","</div>","</div>","<% } %>","<% if (!!preview) { %>",'<div style="">','<label class="header">'+n.txtPreview+"</label>",'<div style="position: relative;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data"></div></div>',"</div>","</div>","</div>","</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Data) { %>",'<label class="header" style="margin-top:15px;">'+n.txtDestData+"</label>",'<div id="id-open-data-range" class="input-row" style="width: 100%;"></div>',"<% } %>","<% } %>","</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">'+n.okButtonText+"</button>","<% if (closeFile) { %>",'<button class="btn normal dlg-btn custom margin-left-10" result="cancel">'+n.closeButtonText+"</button>","<% } %>","<% if (closable) { %>",'<button class="btn normal dlg-btn custom margin-left-10" result="cancel">'+n.cancelButtonText+"</button>","<% } %>","</div>"].join(""),this.handler=o.handler,this.type=o.type,this.preview=o.preview,this.previewData=o.previewData,this.warning=o.warning||!1,this.closable=o.closable,this.codepages=o.codepages,this.settings=o.settings,this.api=o.api,this.validatePwd=o.validatePwd||!1,o.tpl=_.template(this.template)(o),this._previewTdWidth=[],this._previewTdMaxLength=0,Common.UI.Window.prototype.initialize.call(this,o)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.$window){var t=this;this.closable||this.$window.find(".tool").hide(),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.previewPanel=this.$window.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=this.$window.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.type==Common.Utils.importTextType.DRM?this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",showCls:("svg"===this.options.iconType?"svg-icon":"toolbar__icon")+" btn-sheet-view",hideCls:"svg"===this.options.iconType?"svg-icon hide-password":"toolbar__icon btn-hide-password",maxLength:this.options.maxPasswordLength,validateOnBlur:!1,showPwdOnClick:!0,validation:function(e){return t.txtIncorrectPwd}}):(this.initCodePages(),this.preview&&(this.previewData?this.previewCallback(this.previewData):this.updatePreview())),this.type==Common.Utils.importTextType.Data&&(this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#id-open-data-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this)),this.dataDestValid=this.api.asc_getActiveRangeStr(Asc.referenceType.A,!0),this.txtDestRange.setValue(this.dataDestValid)),this.onPrimary=function(){return t._handleInput("ok"),!1}}},getFocusedComponents:function(){var t=[];return this.inputPwd&&t.push(this.inputPwd),this.cmbEncoding&&t.push(this.cmbEncoding),this.cmbDelimiter&&t.push(this.cmbDelimiter),this.inputDelimiter&&t.push(this.inputDelimiter),this.btnAdvanced&&t.push(this.btnAdvanced),this.txtDestRange&&t.push(this.txtDestRange),t},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;if(this.type==Common.Utils.importTextType.DRM)setTimeout((function(){t.inputPwd.focus(),t.validatePwd&&t.inputPwd.checkValidate()}),500);else{var e=t.txtDestRange?t.txtDestRange:t.cmbEncoding?t.cmbEncoding:t.cmbDelimiter;e&&setTimeout((function(){e.focus()}),500)}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onToolClose:function(){this._handleInput("cancel")},_handleInput:function(t){if(this.handler)if(this.type==Common.Utils.importTextType.DRM)this.handler.call(this,t,{drmOptions:new Asc.asc_CDRMAdvancedOptions(this.inputPwd.getValue())});else{if(this.type==Common.Utils.importTextType.Data&&"ok"==t&&!this.isRangeValid())return;var e=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,i=this.cmbDelimiter?this.cmbDelimiter.getValue():null,n=-1==i?this.inputDelimiter.getValue():null;-1==i&&(i=null),this.closable||this.type!=Common.Utils.importTextType.TXT||Common.localStorage.setItem("de-settings-open-encoding",e),this.type===Common.Utils.importTextType.CSV&&(Common.localStorage.setItem("sse-settings-csv-delimiter",null===i?-1:i),Common.localStorage.setItem("sse-settings-csv-delimiter-char",n||""),Common.localStorage.setItem("sse-settings-csv-encoding",e));var o=this.separatorOptions?this.separatorOptions.decimal:void 0,s=this.separatorOptions?this.separatorOptions.thousands:void 0,a=this.separatorOptions?this.separatorOptions.qualifier:'"',r=new Asc.asc_CTextOptions(e,i,n);o&&r.asc_setNumberDecimalSeparator(o),s&&r.asc_setNumberGroupSeparator(s),a&&r.asc_setTextQualifier(a),this.handler.call(this,t,{textOptions:r,range:this.txtDestRange?this.txtDestRange.getValue():"",data:this.data})}this.close()},initCodePages:function(){var t,e,i,n,o=[],s=[],a=0;if(this.codepages){for(o=[],t=0;t<this.codepages.length;++t)i=this.codepages[t],(e=[])[0]=i.asc_getCodePage(),e[1]=i.asc_getCodePageName(),e[2]=i.asc_getLcid(),o.push(e);a=50}if(n=o.length){for(t=0;t<n;++t)s.push({value:o[t][0],displayValue:Common.Utils.String.htmlEncode(o[t][1]),lcid:o[t][2]||""});var r=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="display: inline-block;"><%= item.displayValue %></div>','<label class="text-align-right" style="width:'+a+'px;"><%= item.lcid %></label>',"</a></li>","<% }); %>"].join(""));this.cmbEncoding=new Common.UI.ComboBox({el:$("#id-codepages-combo",this.$window),style:"width: 100%;",menuStyle:"min-width: 100%; max-height: 200px;",cls:"input-group-nr",menuCls:"scrollable-menu",data:s,editable:!1,disabled:!0,search:!0,itemsTemplate:r,takeFocusOnClose:!0}),this.cmbEncoding.setDisabled(!1);var l=this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():o[0][0];if(this.closable||this.type!=Common.Utils.importTextType.TXT){if(this.type===Common.Utils.importTextType.CSV){(m=Common.localStorage.getItem("sse-settings-csv-encoding"))&&(l=parseInt(m))}}else(m=Common.localStorage.getItem("de-settings-open-encoding"))&&(l=parseInt(m));this.cmbEncoding.setValue(l),this.preview&&this.cmbEncoding.on("selected",_.bind(this.onCmbEncodingSelect,this));var c=this.cmbEncoding.cmpEl.find("ul"),d=c.find("li:nth(0) a"),h=c.width()-parseInt(d.css("padding-left"))-parseInt(d.css("padding-right"))-50;c.find("li div").width(h)}if(this.type==Common.Utils.importTextType.CSV||this.type==Common.Utils.importTextType.Paste||this.type==Common.Utils.importTextType.Columns||this.type==Common.Utils.importTextType.Data){var m,u=this.settings&&this.settings.asc_getDelimiter()?this.settings.asc_getDelimiter():4,p=this.settings&&this.settings.asc_getDelimiterChar()?this.settings.asc_getDelimiterChar():"";if(this.type==Common.Utils.importTextType.CSV)(m=Common.localStorage.getItem("sse-settings-csv-delimiter"))&&(m=parseInt(m),isNaN(m)||-1===(u=m)&&(p=Common.localStorage.getItem("sse-settings-csv-delimiter-char")||""));this.cmbDelimiter=new Common.UI.ComboBox({el:$("#id-delimiters-combo",this.$window),style:"width: 100px;",menuStyle:"min-width: 100px;",cls:"input-group-nr",data:[{value:4,displayValue:this.txtComma},{value:2,displayValue:this.txtSemicolon},{value:3,displayValue:this.txtColon},{value:1,displayValue:this.txtTab},{value:5,displayValue:this.txtSpace},{value:-1,displayValue:this.txtOther}],editable:!1,takeFocusOnClose:!0}),this.cmbDelimiter.setValue(u),this.cmbDelimiter.on("selected",_.bind(this.onCmbDelimiterSelect,this)),this.inputDelimiter=new Common.UI.InputField({el:$("#id-delimiter-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:p}),this.inputDelimiter.setVisible(-1===u),this.preview&&this.inputDelimiter.on("changing",_.bind(this.updatePreview,this)),this.type!=Common.Utils.importTextType.Paste&&this.type!=Common.Utils.importTextType.Columns&&this.type!=Common.Utils.importTextType.Data||(this.btnAdvanced=new Common.UI.Button({el:$("#id-delimiters-advanced")}),this.btnAdvanced.on("click",_.bind(this.onAdvancedClick,this)))}},updatePreview:function(){this._previewTdWidth=[],this._previewTdMaxLength=0;var t=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,e=this.cmbDelimiter?this.cmbDelimiter.getValue():null,i=-1==e?this.inputDelimiter.getValue():null;-1==e&&(e=null);var n=new Asc.asc_CTextOptions(t,e,i);switch(this.separatorOptions&&(n.asc_setNumberDecimalSeparator(this.separatorOptions.decimal),n.asc_setNumberGroupSeparator(this.separatorOptions.thousands),n.asc_setTextQualifier(this.separatorOptions.qualifier)),this.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.TXT:case Common.Utils.importTextType.Data:this.api.asc_decodeBuffer(this.preview,n,_.bind(this.previewCallback,this));break;case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:this.api.asc_TextImport(n,_.bind(this.previewCallback,this),this.type==Common.Utils.importTextType.Paste)}},previewCallback:function(t){t&&t.length&&(this.data=t,this.previewInner.height(17*t.length),this.scrollerY||(this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:20,alwaysVisibleY:!0,alwaysVisibleX:!0,onChange:_.bind((function(){if(this.scrollerY){var t=this.scrollerY.getScrollTop(),e=Math.floor(t/17+.5),i=e+Math.min(6,this.data.length);i>this.data.length&&(i=this.data.length,t=17*(e=this.data.length-6)),this.previewParent.height(108),this.previewParent.css({top:t}),this.previewDataBlock(this.data.slice(e,i))}}),this)})),this.scrollerY.update(),this.scrollerY.scrollTop(0))},previewDataBlock:function(t){if(_.isUndefined(this.scrollerX)||(this.scrollerX.destroy(),delete this.scrollerX),this.type==Common.Utils.importTextType.CSV||this.type==Common.Utils.importTextType.Paste||this.type==Common.Utils.importTextType.Columns||this.type==Common.Utils.importTextType.Data){for(var e=0,i=0;i<t.length;i++){(o=t[i]||"").length>e&&(e=o.length)}this._previewTdMaxLength=Math.max(this._previewTdMaxLength,e);var n="<table>";for(i=0;i<t.length;i++){var o=t[i]||"";n+='<tr style="vertical-align: top;">';for(var s=0;s<o.length;s++){var a="";0==i&&this._previewTdWidth[s]&&(a='style="min-width:'+this._previewTdWidth[s]+'px;"'),n+="<td "+a+">"+Common.Utils.String.htmlEncode(o[s])+"</td>"}for(s=o.length;s<this._previewTdMaxLength;s++){a="";0==i&&this._previewTdWidth[s]&&(a='style="min-width:'+this._previewTdWidth[s]+'px;"'),n+="<td "+a+"></td>"}n+="</tr>"}n+="</table>"}else{for(n="<table>",i=0;i<t.length;i++){o=t[i]||"";n+='<tr style="vertical-align: top;"><td>'+Common.Utils.String.htmlEncode(o)+"</td></tr>"}n+="</table>"}if(this.previewPanel.html(n),t.length>0){var r=this;0===this._previewTdWidth.length&&this.previewScrolled.scrollLeft(0),this.previewPanel.find("tr:first td").each((function(t,e){r._previewTdWidth[t]=Math.max(Math.max(Math.ceil($(e).outerWidth()),30),r._previewTdWidth[t]||0)}))}this.scrollerX=new Common.UI.Scroller({el:this.previewPanel,suppressScrollY:!0,alwaysVisibleX:!0,minScrollbarLength:20})},onCmbDelimiterSelect:function(t,e){this.inputDelimiter.setVisible(-1==e.value);var i=this;-1==e.value&&setTimeout((function(){i.inputDelimiter.focus()}),10),this.preview&&this.updatePreview()},onCmbEncodingSelect:function(t,e){this.updatePreview()},onAdvancedClick:function(){if(SSE){var t=this,e=this.separatorOptions?this.separatorOptions.decimal:this.api.asc_getDecimalSeparator(),i=this.separatorOptions?this.separatorOptions.thousands:this.api.asc_getGroupSeparator(),n=this.separatorOptions?this.separatorOptions.qualifier:(this.settings||new Asc.asc_CTextOptions).asc_getTextQualifier();new SSE.Views.AdvancedSeparatorDialog({props:{decimal:e,thousands:i,qualifier:n},handler:function(n,o){"ok"==n&&(t.separatorOptions={decimal:o.decimal.length>0?o.decimal:e,thousands:o.thousands.length>0?o.thousands:i,qualifier:o.qualifier},t.preview&&t.updatePreview())}}).show()}},onSelectData:function(t){var e=this,i=e.txtDestRange;if(e.api){var n=new SSE.Views.CellRangeDialog({handler:function(t,n){if("ok"==n){var o=t.getSettings();e.dataDestValid=o,i.setValue(o),i.checkValidate()}}}).on("close",(function(){e.show(),_.delay((function(){i.focus()}),1)})),o=e.$window.offset();e.hide(),n.show(o.left+160,o.top+125),n.setSettings({api:e.api,range:_.isEmpty(i.getValue())||1!=i.checkValidate()?e.dataDestValid:i.getValue(),type:Asc.c_oAscSelectionDialogType.Chart})}},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):!(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange),t||(this.txtDestRange.showError([e]),this.txtDestRange.focus(),t)},txtDelimiter:"Delimiter",txtEncoding:"Encoding ",txtSpace:"Space",txtTab:"Tab",txtTitle:"Choose %1 options",txtPassword:"Password",txtTitleProtected:"Protected File",txtOther:"Other",txtIncorrectPwd:"Password is incorrect.",closeButtonText:"Close File",txtPreview:"Preview",txtComma:"Comma",txtColon:"Colon",txtSemicolon:"Semicolon",txtProtected:"Once you enter the password and open the file, the current password to the file will be reset.",txtAdvanced:"Advanced",txtOpenFile:"Enter a password to open the file",textSelectData:"Select data",txtDestData:"Choose where to put the data",txtEmpty:"This field is required",textInvalidRange:"Invalid cells range"},Common.Views.OpenDialog||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/InputField",["common/main/lib/component/BaseView","common/main/lib/component/Tooltip","common/main/lib/component/Button"],(function(){"use strict";Common.UI.InputField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0},template:_.template(['<div class="input-field" style="<%= style %>">',"<input ",'type="<%= type %>" ','name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','data-hint="<%= dataHint %>"','data-hint-direction="<%= dataHintDirection %>"','data-hint-offset="<%= dataHintOffset %>"',">",'<span class="input-error"></span>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.value=e.options.value,this.type=e.options.type,this.name=e.options.name,this.validation=e.options.validation,this.allowBlank=e.options.allowBlank,this.placeHolder=e.options.placeHolder,this.template=e.options.template||e.template,this.editable=e.options.editable,this.disabled=e.options.disabled,this.spellcheck=e.options.spellcheck,this.blankError=e.options.blankError||"This field is required",this.validateOnChange=e.options.validateOnChange,this.validateOnBlur=e.options.validateOnBlur,this.maxLength=e.options.maxLength,e.rendered=e.options.rendered||!1,e.options.el&&e.render()},render:function(t){var e=this;if(e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:e})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;if(this._input=this.cmpEl.find("input").addBack().filter("input").first(),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),this._input.closest(".asc-window").length>0)var n=function(){var t=i.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":n})};Common.NotificationCenter.on({"modal:close":n})}return e.rendered=!0,e.value&&e.setValue(e.value),this},_doChange:function(t,e){if(!e||!e.synthetic){var i=$(t.target).val(),n=this.value;this.trigger("changed:before",this,i,n,t),t.isDefaultPrevented()||(this.value=i,this.validateOnBlur&&this.checkValidate(),this.trigger("changed:after",this,i,n,t))}},onInputChanged:function(t,e){this._doChange(t,e)},onInputChanging:function(t,e){var i=$(t.target).val(),n=this.value;t.isDefaultPrevented()||(this.value=i,this.validateOnBlur&&this.checkValidate(),this.trigger("changing",this,i,n,t))},onKeyPress:function(t){if(this.trigger("keypress:before",this,t),!t.isDefaultPrevented()){if(this.options.maskExp&&!_.isEmpty(this.options.maskExp.source)){var e=String.fromCharCode(t.which);this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN||(t.preventDefault(),t.stopPropagation())}this.trigger("keypress:after",this,t)}},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&this._doChange(t),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this))},onKeyUp:function(t){this.trigger("keyup:before",this,t),t.isDefaultPrevented()||this.trigger("keyup:after",this,t)},setEditable:function(t){var e=this._input;this.editable=t,t&&e?(e.removeAttr("readonly"),e.removeAttr("data-can-copy")):(e.attr("readonly","readonly"),e.attr("data-can-copy",!1))},isEditable:function(){return this.editable},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),this._input&&(t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"))},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input&&this._input.focus()},checkValidate:function(){var t=this,e=[];if(!t.allowBlank&&_.isEmpty(t.value)&&e.push(t.blankError),_.isFunction(t.validation)){var i=t.validation.call(t,t.value);!0!==i&&(e=_.flatten(e.concat(i)))}if(!_.isEmpty(e)){if(t.cmpEl.hasClass("error"))return(n=t.cmpEl.find(".input-error").data("bs.tooltip"))&&(n.options.title=e.join("\n"),n.setContent()),e;t.cmpEl.addClass("error");var n,o=t.cmpEl.find(".input-error"),s=o.closest(".asc-window");return(n=o.data("bs.tooltip"))&&n.tip().remove(),o.attr("data-toggle","tooltip"),o.removeData("bs.tooltip"),o.tooltip({title:e.join("\n"),placement:"cursor"}),s.length>0&&o.data("bs.tooltip").tip().css("z-index",parseInt(s.css("z-index"))+10),e}return t.cmpEl.removeClass("error"),!0},showError:function(t,e){var i=this;if(_.isEmpty(t))i.cmpEl.removeClass("error"),i.cmpEl.removeClass("warning");else{i.cmpEl.addClass(e?"warning":"error");var n=i.cmpEl.find(".input-error"),o=n.closest(".asc-window"),s=n.data("bs.tooltip");s&&s.tip().remove(),n.attr("data-toggle","tooltip"),n.removeData("bs.tooltip"),n.tooltip({title:t.join("\n"),placement:"cursor"}),o.length>0&&n.data("bs.tooltip").tip().css("z-index",parseInt(o.css("z-index"))+10)}},showWarning:function(t){this.showError(t,!0)}}),Common.UI.InputFieldBtn=Common.UI.InputField.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-select-range",btnHint:""},template:_.template(['<div class="input-field input-field-btn" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<div class="select-button"></div>',"</div>"].join("")),render:function(t){var e=this;if(e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,scope:e,dataHint:this.options.dataHint,dataHintOffset:this.options.dataHintOffset,dataHintDirection:this.options.dataHintDirection})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;if(this._button=new Common.UI.Button({cls:"btn-toolbar",iconCls:this.options.iconCls,hint:this.options.btnHint||"",menu:this.options.menu}),this._button.render(this.cmpEl.find(".select-button")),this._button.on("click",_.bind(this.onButtonClick,this)),this._input=this.cmpEl.find("input").addBack().filter("input"),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),this._input.closest(".asc-window").length>0)var n=function(){var t=i.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":n})};Common.NotificationCenter.on({"modal:close":n})}return e.rendered=!0,e.value&&e.setValue(e.value),this},onButtonClick:function(t,e){this.trigger("button:click",this,e)},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this._button.setDisabled(t)},setBtnDisabled:function(t){this._button.setDisabled(t)},updateBtnHint:function(t){this.options.hint=t,this.rendered&&this._button.updateHint(this.options.hint)}}),Common.UI.InputFieldBtnPassword=Common.UI.InputFieldBtn.extend(_.extend({options:{id:null,cls:"",style:"",value:"",name:"",type:"password",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,showCls:"toolbar__icon btn-sheet-view",hideCls:"toolbar__icon btn-hide-password",btnHint:"",repeatInput:null,showPwdOnClick:!0},initialize:function(t){(t=t||{}).btnHint=t.btnHint||this.textHintShowPwd,t.iconCls=t.showCls||this.options.showCls,Common.UI.InputFieldBtn.prototype.initialize.call(this,t),this.hidePwd=!0,this.repeatInput=this.options.repeatInput},render:function(t){return Common.UI.InputFieldBtn.prototype.render.call(this,t),this._btnElm=this._button.$el,this.options.showPwdOnClick?this._button.on("click",_.bind(this.passwordClick,this)):this._btnElm.on("mousedown",_.bind(this.passwordShow,this)),this},passwordClick:function(t){this.hidePwd?(this.passwordShow(t),this.hidePwd=!1):(this.passwordHide(t),this.hidePwd=!0);var e=this,i=e._input[0].selectionStart,n=e._input[0].selectionEnd;setTimeout((function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=n}),1)},passwordShow:function(t){this.disabled||(this._button.setIconCls(this.options.hideCls),this.type="text",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick?this._button.updateHint(this.textHintHidePwd):(this._btnElm.on("mouseup",_.bind(this.passwordHide,this)),this._btnElm.on("mouseout",_.bind(this.passwordHide,this))))},passwordHide:function(t){if(this._button.setIconCls(this.options.showCls),this.type="password",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick)this._button.updateHint(this.textHintShowPwd);else{this._btnElm.off("mouseup",this.passwordHide),this._btnElm.off("mouseout",this.passwordHide);var e=this,i=e._input[0].selectionStart,n=e._input[0].selectionEnd;setTimeout((function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=n}),1)}},textHintShowPwd:"Show password",textHintHidePwd:"Hide password"},Common.UI.InputFieldBtnPassword||{})),Common.UI.InputFieldBtnCalendar=Common.UI.InputFieldBtn.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-date",btnHint:"",menu:!0},initialize:function(t){(t=t||{}).btnHint=t.btnHint||this.textDate,Common.UI.InputFieldBtn.prototype.initialize.call(this,t)},render:function(t){var e=this;Common.UI.InputFieldBtn.prototype.render.call(this,t);var i="id-"+Common.UI.getId()+"input-field-datetime",n=new Common.UI.Menu({menuAlign:"tr-br",style:"border: none; padding: 0;",items:[{template:_.template('<div id="'+i+'" style=""></div>'),stopPropagation:!0}]});$("button",this._button.cmpEl).addClass("no-caret"),this._button.setMenu(n),this._button.menu.on("show:after",(function(t){e.cmpCalendar||(e.cmpCalendar=new Common.UI.Calendar({el:e.cmpEl.find("#"+i),enableKeyEvents:!0,firstday:1}),e.cmpCalendar.on("date:click",(function(i,n){e.trigger("date:click",e,n),t.hide()})),t.alignPosition()),e.cmpCalendar.focus()}))},setDate:function(t){this.cmpCalendar&&t&&t instanceof Date&&!isNaN(t)&&this.cmpCalendar&&this.cmpCalendar.setDate(t)},textDate:"Select date"}),Common.UI.InputFieldFixed=Common.UI.InputField.extend({options:{id:null,cls:"",style:"",value:"",fixedValue:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,btnHint:""},template:_.template(['<div class="input-field input-field-fixed" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<input class="fixed-text form-control" type="text" readonly="readonly"></div>'].join("")),initialize:function(t){this.fixedValue=t.fixedValue,Common.UI.InputField.prototype.initialize.call(this,t)},render:function(t){return Common.UI.InputField.prototype.render.call(this,t),this.fixedValue&&this.setFixedValue(this.fixedValue),this},setFixedValue:function(t){this.fixedValue=t,this.rendered&&this.cmpEl.find("input.fixed-text").addBack().filter("input.fixed-text").val(t)},setDisabled:function(t){if(t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),this.cmpEl){var e=this.cmpEl.find("input").addBack().filter("input");t?e.attr("disabled",!0):e.removeAttr("disabled")}}})})),define("common/main/lib/view/UserNameDialog",["common/main/lib/component/Window","common/main/lib/component/InputField"],(function(){"use strict";Common.Views.UserNameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,modal:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div style="margin-bottom: 2px;">'+(this.options.label?this.options.label:this.textLabel)+"</div>",'<div id="id-dlg-username-caption" class="input-row"></div>','<div id="id-dlg-username-chk-use" class="" style="margin-top: 10px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputLabel=new Common.UI.InputField({el:$("#id-dlg-username-caption"),allowBlank:!0,style:"width: 100%;",maxLength:128,validateOnBlur:!1,validation:t.options.validation||function(t){return!!t||""}}),t.inputLabel.setValue(this.options.value||""),t.chDontShow=new Common.UI.CheckBox({el:$("#id-dlg-username-chk-use"),labelText:this.textDontShow,value:this.options.check}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.getChild("input").focus()}),50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,{input:this.inputLabel.getValue(),checkbox:"checked"==this.chDontShow.getValue()})}this.close()},textLabel:"Label:",textLabelError:"Label must not be empty.",textDontShow:"Don't ask me again"},Common.Views.UserNameDialog||{}))})),define("pdfeditor/main/app/model/ShapeGroup",["backbone"],(function(t){"use strict";PDFE.Models=PDFE.Models||{},PDFE.Models.ShapeModel=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),imageUrl:null,data:null}}}),PDFE.Models.ShapeGroup=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),groupName:null,groupId:null,groupStore:null}}})})),define("pdfeditor/main/app/collection/ShapeGroups",["backbone","pdfeditor/main/app/model/ShapeGroup"],(function(t){"use strict";if(void 0===e)var e={};e.Collections=e.Collections||{},PDFE.Collections=PDFE.Collections||{},PDFE.Collections.ShapeGroups=t.Collection.extend({model:PDFE.Models.ShapeGroup})})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.HintManager=new function(){var t,e,i,n="en",o=[],s=[],a=[],r=[],l=!1,c=!1,d=0,h=document,m=[],u=[],p="",f=!1,g=!1,b=!1,v=!1,C=!0,y=[],w={"scroll-right":"R","scroll-left":"V"},x=function(t,e){e?h=e:"esc"!==t?h=v?[$(window.parent.document).find(".advanced-settings-dlg:visible")[0],window.document]:$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):t&&t.closest(".hint-section")||document:0===d&&(h=document)},S=function(t){i&&(g=t,i.asc_enableKeyEvents(!t))},k=function(){p="",0===d&&Common.NotificationCenter.trigger("toolbar:collapse"),(0===u.length||$("#file-menu-panel").is(":visible")&&1===d)&&D(),u.length>0?(!g&&S(!0),c=!0,u.forEach((function(t){t.show()})),t=setInterval((function(){p.length>0&&(p="")}),5e3)):c=!1,Common.NotificationCenter.trigger("hints:show",c,d)},T=function(){c=!1,u&&u.forEach((function(t){t.remove()})),clearInterval(t),Common.NotificationCenter.trigger("hints:show",!1)},A=function(t){U(),u.length=0,m.length=0,void 0!==t?d=t:d++},I=function(t){var e=t;if(-1===o.indexOf(e)){var i=s.indexOf(e);e=o[i]}return e},P=function(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")},E=function(){m=[],y=[];var t=[],e=[];_.isArray(h)?h.forEach((function(i){t=t.concat($(i).find("[data-hint="+d+"]").toArray()),e=e.concat($(i).find("[data-hint-title][data-hint="+d+"]").toArray())})):(t=$(h).find("[data-hint="+d+"]").toArray(),e=$(h).find("[data-hint-title][data-hint="+d+"]").toArray());var i=t.filter((function(t){return $(t).is(":visible")})),a=e.filter((function(t){return $(t).is(":visible")}));if(i.length!==a.length){var r=[],l=[];if(0===d)for(var c in w){var u=w[c].charAt(0).toLowerCase();y.push(u);var p=o.indexOf(u);l.indexOf(p)<0&&l.push(p)}i.length+(0===d?_.size(w):0)>o.length?(a.forEach((function(t){var e=$(t).data("hint-title").charAt(0).toLowerCase();e=I(e),y.indexOf(e)<0&&y.push(e)})),r=function(t){for(var e,i,n=o.slice(),s=0;o.length,!e;s++)-1===y.indexOf(o[s])&&(e=o[s],i=s);for(n[i]=e+o[0],s=0;n.length<t;s++)e+o[s]!==n[i]&&n.push(e+o[s]);return n}(i.length+(0===d?_.size(w):0))):r=o.slice(),e.length>0&&i.forEach((function(t){var e=$(t),i=e.attr("data-hint-title");if(i){var a,r=(i=i.toLowerCase()).charAt(0),c=s.indexOf(r);if(-1===c)a=o.indexOf(r),l.indexOf(a)<0&&l.push(a);else if(l.indexOf(c)<0&&l.push(c),"en"!==n){var d="";for(a=0;a<i.length;a++)d+=I(i.charAt(a));e.attr("data-hint-title",d.toUpperCase())}}}));var f=0;i.forEach((function(t){for(var e=$(t);-1!==l.indexOf(f);)f++;e.attr("data-hint-title")||f>r.length||(e.attr("data-hint-title",r[f].toUpperCase()),f++),m.push(e)}))}else i.forEach((function(t){var e=$(t);if("en"!==n){var i=e.attr("data-hint-title").toLowerCase(),s=i.charAt(0);if(-1===o.indexOf(s)){for(var a="",r=0;r<i.length;r++){var l=i.charAt(r);a+=I(l)}e.attr("data-hint-title",a.toUpperCase())}}m.push(e)}))},D=function(){var t=v?window.parent.innerHeight*Common.Utils.zoom():Common.Utils.innerHeight()-20,e=v?window.parent.innerWidth*Common.Utils.zoom():Common.Utils.innerWidth(),i=v?h[0]:h,n=0!==d&&$(i).length>0&&!v?$(i).offset().top:0,o=0!==d&&$(i).length>0&&!v?n+$(i).height():t;"toolbar"===$(i).prop("id")&&$(i).outerHeight()<$(i).find(".box-controls").outerHeight()&&(o+=$(i).find(".box-controls").outerHeight()),0===m.length&&E(),m.forEach((function(i,s){if(!P(i)){var a=0,r=e;if(!v&&"toolbar"===$(h).prop("id")&&$(h).find(".toolbar-mask").length>0||$("#about-menu-panel").is(":visible")&&"right-menu"===i.closest(".hint-section").prop("id"))return;if(window.SSE&&"statusbar_bottom"===i.parent().prop("id")){var l=i.parent();if(i.offset().left>l.offset().left+l.width())return}if(0===d&&i.closest(".tabs.short").length>0){var c=i.closest(".tabs.short");r=(a=c.offset().left)+c.width(),i.hasClass("scroll")||(a+=20,r-=20)}var m=$('<div style="" class="hint-div">'+i.attr("data-hint-title")+"</div>"),p=i.attr("data-hint-direction");window.SSE&&!v&&9!==h.nodeType&&"toolbar"===h.prop("id")&&"data"===i.closest(".panel").attr("data-tab")&&(i.parent().hasClass("slot-sortdesc")||i.parent().hasClass("slot-btn-setfilter")?(p="top",i.attr("data-hint-direction","top")):(i.parent().hasClass("slot-btn-clear-filter")||i.parent().hasClass("slot-sortasc"))&&(p="bottom",i.attr("data-hint-direction","bottom")));var f=t;$("#file-menu-panel").is(":visible")&&d>1&&($(".fms-flex-apply").is(":visible")||$("#fms-flex-apply").is(":visible"))&&i.closest(".fms-flex-apply").length<1&&i.closest("#fms-flex-apply").length<1&&(f=t-$(".fms-flex-apply").height());var g=i.attr("data-hint-offset"),b="big"===g?6:"medium"===g?4:"small"===g?2:0;if(b)switch(p){case"bottom":g=[-b,0];break;case"top":g=[b,0];break;case"right":g=[0,-b];break;case"left":g=[0,b]}else g=g?i.attr("data-hint-offset").split(",").map((function(t){return parseInt(t)})):[0,0];var C,y,w=i.offset();"left-top"===p?(C=w.top-10+g[0],y=w.left-10+g[1]):"top"===p?(C=w.top-18+g[0],y=w.left+(i.outerWidth()-18)/2+g[1]):"right"===p?(C=w.top+(i.outerHeight()-18)/2+g[0],y=w.left+i.outerWidth()+g[1]):"left"===p?(C=w.top+(i.outerHeight()-18)/2+g[0],y=w.left-18+g[1]):(C=w.top+i.outerHeight()+g[0],y=w.left+(i.outerWidth()-18)/2+g[1]),C<f&&y<e&&C>n&&C<o&&y>a&&y+18<r&&(m.css({top:C,left:y}),v&&s<2?(m.css("z-index","1060"),$(window.parent.document.body).append(m)):$(document.body).append(m)),u.push(m)}}))},U=function(){u&&u.forEach((function(t){t.remove()}))},M=function(){d=$("#file-menu-panel").is(":visible")||v?1:0,x(),u.length=0,m.length=0},L=function(t){Common.Utils.loadConfig("../../common/main/resources/alphabetletters/alphabetletters.json",(function(e){s=e.en;var i=function(t){return n=t,o=e[t]},a=!!i(t)||(!!i(t.split(/[\-_]/)[0])||i("en"));if(a&&"en"!==n)for(var r in w){var l=I(w[r].toLowerCase());l&&(w[r]=l.toUpperCase())}return a})),Common.Utils.loadConfig("../../common/main/resources/alphabetletters/qwertyletters.json",(function(t){a=t[n],"en"!==n&&(r=t.en)}))},F=function(t){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)&&(c&&T(),u.length>0&&M(),g&&S(!1),t&&(f=!0),$(".hint-div").length>0&&$(".hint-div").remove(),$("iframe").length>0))try{$("iframe").contents().find(".hint-div").remove()}catch(t){}},V=function(t){C!==t&&(C=t)};return{init:function(t){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)){i=t;var s=Common.localStorage.getKeysFilter();e=s&&s.length?s.split(",")[0]:"",Common.NotificationCenter.on({"app:ready":function(t){var e=t.lang?t.lang.toLowerCase():"en";L(e),b=!0},"hints:clear":F,"window:resize":F}),$("#editor_sdk").on("click",(function(){F()})),$(document).on("mousedown",(function(){F()})),$(document).on("keyup",(function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!l||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?c&&t.preventDefault():(t.preventDefault(),c?(T(),M(),g&&(g=!1,i.asc_enableKeyEvents(!0))):($("input:focus").blur(),d=$("#file-menu-panel").is(":visible")||v?1:0,x(),k())),l=!1})),$(document).on("keydown",(function(t){if(c)if(t.preventDefault(),t.keyCode==Common.UI.Keys.ESC)setTimeout((function(){0===d?(T(),M(),S(!1)):(U(),u.length=0,m.length=0,d--,x("esc"),k())}),10);else{var i=null,s=!1,g=t.keyCode;if(16!==g&&17!==g&&18!==g&&91!==g&&(i="en"===n?g>47&&g<58||g>64&&g<91?String.fromCharCode(t.keyCode):null:/[.*+?^${}()|[\]\\]/g.test(t.key)?null:t.key),i){var y;if("en"!==n&&-1===o.indexOf(i.toLowerCase())){var w=r.indexOf(i.toLowerCase());-1!==w&&(i=a[w])}p+=i.toUpperCase();for(var _=0;_<m.length;_++){var I=m[_];if(!P(I)){var E=I.attr("data-hint-title");if(new RegExp("^"+p).test(E)&&(s=!0),E===p){y=I;break}}}if(y){var D=y.prop("tagName").toLowerCase();if(window.SSE&&"statusbar_bottom"===y.parent().prop("id"))T(),y.contextmenu(),M();else if("input"===D||"textarea"===D)T(),y.trigger(jQuery.Event("click",{which:1})),y.focus(),M();else if(y.hasClass("listview"))T(),y.focus(),M();else{if(f=!1,T(),!v&&"toolbar"===$(h).prop("id")&&$(h).find(".toolbar-mask").length>0)return void M();var L=y.attr("content-target")&&!$("#"+y.attr("content-target")).is(":visible")||"slot-btn-chat"===y.parent().prop("id")&&!$("#left-panel-chat").is(":visible")||y.parent().hasClass("ribtab")&&!$("#toolbar").children(".toolbar").hasClass("expanded");if((!y.attr("content-target")&&"slot-btn-chat"!==y.parent().prop("id")||L)&&($("#file-menu-panel").is(":visible")&&("fm-btn-info"===y.parent().prop("id")&&$("#panel-info").is(":visible")||"fm-btn-settings"===y.parent().prop("id")&&$("#panel-settings").is(":visible"))||(y.attr("for")?$("#"+y.attr("for")).trigger(jQuery.Event("click",{which:1})):(y.trigger(jQuery.Event("click",{which:1})),L&&(f=!1)))),"btn-go-back"===y.prop("id")||"slot-btn-options"===y.closest(".btn-slot").prop("id")||"slot-btn-mode"===y.closest(".btn-slot").prop("id")||"id-btn-favorite"===y.prop("id")||"tlb-box-users"===y.parent().prop("id")||"left-btn-thumbs"===y.prop("id")||y.hasClass("scroll")||"left-btn-about"===y.prop("id")||"left-btn-support"===y.prop("id")||"slot-btn-search"===y.closest(".btn-slot").prop("id")||"slot-btn-pdf-mode"===y.closest(".btn-slot").prop("id"))return void M();if("add-comment-doc"===y.prop("id"))return U(),u.length=0,m.length=0,void k();f||("slot-btn-chat"===y.parent().prop("id")?(A(1),x(void 0,$("#left-menu.hint-section"))):"id-right-menu-signature"===y.prop("id")?(A(2),x(y)):(A(),x(y)),k(),u.length<1&&M())}}else s||(p="")}}l=Common.Utils.InternalSettings.get(e+"settings-show-alt-hints")&&!t.shiftKey&&t.keyCode==Common.UI.Keys.ALT&&!Common.Utils.ModalWindow.isVisible()&&b&&o.length>0&&!(window.PE&&$("#pe-preview").is(":visible")),Common.Utils.InternalSettings.get(e+"settings-show-alt-hints")&&t.altKey&&115!==t.keyCode&&C&&t.preventDefault()}))}},setMode:function(t){v=t.isEditDiagram||t.isEditMailMerge||t.isEditOle,V(!!v)},clearHints:F,needCloseFileMenu:function(){return!(c&&d>1)},isHintVisible:function(){return c},getStaticHint:function(t){return w[t]},setInternalEditorLoading:V}},define("common/main/lib/controller/HintManager",(function(){})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.LayoutManager=new function(){var t,e,i=function(n,o,s){if(!n&&(n=t),e&&n)for(var a in n)if(n.hasOwnProperty(a))if("object"==typeof n[a])i(n[a],o,(s||"")+a+"-");else if(!1===n[a]){var r="[data-layout-name="+(s||"")+a+"]",l=o?o.find(r):$(r);l&&l.hide&&l.hide()}},n=function(i,o,s){if(!o&&(o=t),!e||!o)return!0;var a=!0;for(var r in o)if(o.hasOwnProperty(r)&&("object"==typeof o[r]?a=n(i,o[r],(s||"")+r+"-"):i===(s||"")+r&&(a=o[r]),!1===a))return a;return a};return{init:function(i,n){t=i,e=n},applyCustomization:i,isElementVisible:n,getInitValue:function(i){if(e&&t){var n=i.split("-"),o=0,s=t;for(o=0;o<n.length&&("object"==typeof s[n[o]]&&s[n[o]]);o++)s=s[n[o]];if(o===n.length)return"object"==typeof s&&s?s.mode:s}}}},Common.UI.FeaturesManager=new function(){var t,e;return{init:function(i,n){t=i,e=n},canChange:function(i,n){return!((e||n)&&t&&"object"==typeof t[i]&&t[i]&&!1===t[i].change)},getInitValue:function(i,n){if((e||n)&&t&&void 0!==t[i]){if("object"!=typeof t[i]||!t[i])return t[i];if(void 0!==t[i].mode)return t[i].mode}}}},define("common/main/lib/controller/LayoutManager",(function(){})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.ExternalUsers=new function(){var t=[],e=!1;return{init:function(i){i&&(Common.Gateway.on("setusers",(function(i){if(null!==i.users){var n=i.c||"mention";t[n]=i.users||[],e=!1,Common.NotificationCenter.trigger("mentions:setusers",n,t[n])}else t=[]})),Common.NotificationCenter.on("mentions:clearusers",(function(){t=[]})))},get:function(i){e||(void 0===t[i=i||"mention"]?(e=!0,Common.Gateway.requestUsers(i||"mention")):Common.NotificationCenter.trigger("mentions:setusers",i,t[i]))}}},define("common/main/lib/controller/ExternalUsers",(function(){})),define("pdfeditor/main/app/controller/Main",["core","irregularstack","common/main/lib/component/Window","common/main/lib/component/LoadMask","common/main/lib/component/Tooltip","common/main/lib/controller/Fonts","common/main/lib/view/OpenDialog","common/main/lib/view/UserNameDialog","common/main/lib/util/LocalStorage","pdfeditor/main/app/collection/ShapeGroups","common/main/lib/controller/FocusManager","common/main/lib/controller/HintManager","common/main/lib/controller/LayoutManager","common/main/lib/controller/ExternalUsers"],(function(){"use strict";var t,e,i,n,o;PDFE.Controllers.Main=Backbone.Controller.extend(_.extend((e=-255,i=-256,n={about:"button#left-btn-about",feedback:"button#left-btn-support",goback:"#fm-btn-back > a, #header-back > div"},o={toolbar:"#viewport #toolbar",leftMenu:"#viewport #left-menu, #viewport #id-toolbar-full-placeholder-btn-settings, #viewport #id-toolbar-short-placeholder-btn-settings",statusBar:"#statusbar"},Common.localStorage.setId("pdf"),Common.localStorage.setKeysFilter("pdfe-,asc.pdf"),Common.localStorage.sync(),{models:[],collections:["ShapeGroups"],views:[],initialize:function(){this.addListeners({FileMenu:{"settings:apply":_.bind(this.applySettings,this)}}),this.translationTable={"Choose an item":this.txtChoose,"Enter a date":this.txtEnterDate}},onLaunch:function(){var t=this;if(this.stackLongActions=new Common.IrregularStack({strongCompare:function(t,e){return t.id===e.id&&t.type===e.type},weakCompare:function(t,e){return t.type===e.type}}),this.stackDisableActions=new Common.IrregularStack({strongCompare:function(t,e){return t.type===e.type},weakCompare:function(t,e){return t.type===e.type}}),this.stackMacrosRequests=[],this._state={isDisconnected:!1,usersCount:1,fastCoauth:!0,lostEditingRights:!1,licenseType:!1,isDocModified:!1},this.languages=null,!Common.Utils.isBrowserSupported())return Common.Utils.showBrowserRestriction(),void Common.Gateway.reportError(void 0,this.unsupportedBrowserErrorText);if(window.flat_desine=!0,this.api=this.getApplication().getController("Viewport").getApi(),Common.UI.FocusManager.init(),Common.UI.HintManager.init(this.api),Common.UI.Themes.init(this.api),this.api){this.api.SetDrawingFreeze(!0);var e=Common.localStorage.getBool("pdfe-settings-cachemode",!0);switch(Common.Utils.InternalSettings.set("pdfe-settings-cachemode",e),this.api.asc_setDefaultBlitMode(!!e),null===(e=Common.localStorage.getItem("pdfe-settings-fontrender"))&&(e="0"),Common.Utils.InternalSettings.set("pdfe-settings-fontrender",e),e){case"0":this.api.SetFontRenderingMode(3);break;case"1":this.api.SetFontRenderingMode(1);break;case"2":this.api.SetFontRenderingMode(2)}if(!Common.Utils.isIE&&/^https?:\/\//.test("https://helpcenter.onlyoffice.com/userguides/docs-de.aspx")){const t=new URL("https://helpcenter.onlyoffice.com/userguides/docs-de.aspx");t.searchParams&&t.searchParams.set("lang",Common.Locale.getCurrentLanguage()),Common.Utils.InternalSettings.set("url-help-center",t.toString())}this.api.asc_registerCallback("asc_onError",_.bind(this.onError,this)),this.api.asc_registerCallback("asc_onDocumentContentReady",_.bind(this.onDocumentContentReady,this)),this.api.asc_registerCallback("asc_onOpenDocumentProgress",_.bind(this.onOpenDocument,this)),this.api.asc_registerCallback("asc_onDocumentUpdateVersion",_.bind(this.onUpdateVersion,this)),this.api.asc_registerCallback("asc_onServerVersion",_.bind(this.onServerVersion,this)),this.api.asc_registerCallback("asc_onAdvancedOptions",_.bind(this.onAdvancedOptions,this)),this.api.asc_registerCallback("asc_onDocumentName",_.bind(this.onDocumentName,this)),this.api.asc_registerCallback("asc_onPrintUrl",_.bind(this.onPrintUrl,this)),this.api.asc_registerCallback("asc_onMeta",_.bind(this.onMeta,this)),this.api.asc_registerCallback("asc_onOpenLinkPdfForm",_.bind(this.onOpenLinkPdfForm,this)),this.api.asc_registerCallback("asc_onOpenFilePdfForm",_.bind(this.onOpenFilePdfForm,this)),this.api.asc_registerCallback("asc_onValidateErrorPdfForm",_.bind(this.onValidateErrorPdfForm,this)),this.api.asc_registerCallback("asc_onFormatErrorPdfForm",_.bind(this.onFormatErrorPdfForm,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("goback",_.bind(this.goBack,this)),Common.NotificationCenter.on("markfavorite",_.bind(this.markFavorite,this)),Common.NotificationCenter.on("download:advanced",_.bind(this.onAdvancedOptions,this)),Common.NotificationCenter.on("showmessage",_.bind(this.onExternalMessage,this)),Common.NotificationCenter.on("showerror",_.bind(this.onError,this)),Common.NotificationCenter.on("editing:disable",_.bind(this.onEditingDisable,this)),Common.NotificationCenter.on("pdf:mode",_.bind(this.onPdfModeChange,this)),this.isShowOpenDialog=!1,this.editorConfig={},this.appOptions={},Common.Gateway.on("init",_.bind(this.loadConfig,this)),Common.Gateway.on("showmessage",_.bind(this.onExternalMessage,this)),Common.Gateway.on("opendocument",_.bind(this.loadDocument,this)),Common.Gateway.on("grabfocus",_.bind(this.onGrabFocus,this)),Common.Gateway.appReady(),this.getApplication().getController("Viewport").setApi(this.api),this.getApplication().getController("Statusbar").setApi(this.api),this.contComments=this.getApplication().getController("Common.Controllers.Comments"),$(document.body).on("focus","input, textarea",(function(e){/area_id/.test(e.target.id)||(/msg-reply/.test(e.target.className)?(t.dontCloseDummyComment=!0,t.beforeShowDummyComment=t.beforeCloseDummyComment=!1):/textarea-control/.test(e.target.className)?t.inTextareaControl=!0:!Common.Utils.ModalWindow.isVisible()&&/form-control/.test(e.target.className)&&(t.inFormControl=!0))})),$(document.body).on("blur","input, textarea",(function(e){if(!Common.Utils.ModalWindow.isVisible()){if(/form-control/.test(e.target.className)&&(t.inFormControl=!1),t.getApplication().getController("LeftMenu").getView("LeftMenu").getMenu("file").isVisible())return;if(!e.relatedTarget||!/area_id/.test(e.target.id)&&!("input"==e.target.localName&&$(e.target).parent().find(e.relatedTarget).length>0)&&!("textarea"==e.target.localName&&$(e.target).closest(".asc-window").find(".dropdown-menu").find(e.relatedTarget).length>0)&&("input"!=e.relatedTarget.localName||!/form-control/.test(e.relatedTarget.className))&&("textarea"!=e.relatedTarget.localName||/area_id/.test(e.relatedTarget.id))){if(Common.Utils.isIE&&e.originalEvent&&e.originalEvent.target&&/area_id/.test(e.originalEvent.target.id)&&e.originalEvent.target===e.originalEvent.srcElement)return;Common.Utils.isLinux&&t.appOptions&&t.appOptions.isDesktopApp?(e.relatedTarget||!e.originalEvent||e.originalEvent.sourceCapabilities)&&t.api.asc_enableKeyEvents(!0):t.api.asc_enableKeyEvents(!0),t.dontCloseDummyComment&&/msg-reply/.test(e.target.className)?$(e.target).closest(".user-comment-item").find(e.relatedTarget).length<1?t.dontCloseDummyComment=t.beforeCloseDummyComment=!1:t.beforeCloseDummyComment=!0:/textarea-control/.test(e.target.className)&&(t.inTextareaControl=!1)}}})).on("dragover",(function(t){var e=t.originalEvent;if(e.target&&$(e.target).closest("#editor_sdk").length<1)return e.preventDefault(),e.dataTransfer.dropEffect="none",!1})).on("dragstart",(function(t){var e=t.originalEvent;if(e.target){var i=$(e.target);(i.closest(".combobox").length>0||i.closest(".dropdown-menu").length>0||i.closest(".input-field").length>0||i.closest(".spinner").length>0||i.closest(".textarea-field").length>0||i.closest(".ribtab").length>0||i.closest(".combo-dataview").length>0)&&e.preventDefault()}})).on("mouseup",(function(e){t.beforeCloseDummyComment&&setTimeout((function(){t.dontCloseDummyComment=t.beforeCloseDummyComment=!1}),10)})),Common.Utils.isChrome&&$(document.body).on("keydown","textarea",(function(t){t.keyCode!==Common.UI.Keys.PAGEUP&&t.keyCode!==Common.UI.Keys.PAGEDOWN||setTimeout((function(){$("#viewport").scrollLeft(0),$("#viewport").scrollTop(0)}),0)})),Common.NotificationCenter.on({"modal:show":function(){Common.Utils.ModalWindow.show(),t.api.asc_enableKeyEvents(!1)},"modal:close":function(e){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"modal:hide":function(e){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"settings:unitschanged":_.bind(this.unitsChanged,this),"dataview:focus":function(t){},"dataview:blur":function(e){Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"menu:show":function(t){},"menu:hide":function(e,i){Common.Utils.ModalWindow.isVisible()||i||t.api.asc_enableKeyEvents(!0)},"edit:complete":_.bind(t.onEditComplete,t)}),Common.util.Shortcuts.delegateShortcuts({shortcuts:{"command+s,ctrl+s,command+p,ctrl+p,command+k,ctrl+k,command+d,ctrl+d":_.bind((function(t){t.preventDefault(),t.stopPropagation()}),this)}})}t.defaultTitleText="ONLYOFFICE",t.warnNoLicense=t.warnNoLicense.replace(/%1/g,"ONLYOFFICE"),t.warnNoLicenseUsers=t.warnNoLicenseUsers.replace(/%1/g,"ONLYOFFICE"),t.textNoLicenseTitle=t.textNoLicenseTitle.replace(/%1/g,"ONLYOFFICE"),t.warnLicenseExceeded=t.warnLicenseExceeded.replace(/%1/g,"ONLYOFFICE"),t.warnLicenseUsersExceeded=t.warnLicenseUsersExceeded.replace(/%1/g,"ONLYOFFICE")},loadConfig:function(e){var i;if(this.editorConfig=$.extend(this.editorConfig,e.config),this.appOptions.customization=this.editorConfig.customization,this.appOptions.canRenameAnonymous=!("object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&!1===this.appOptions.customization.anonymous.request),this.appOptions.guestName="object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&"string"==typeof this.appOptions.customization.anonymous.label&&""!==this.appOptions.customization.anonymous.label.trim()?Common.Utils.String.htmlEncode(this.appOptions.customization.anonymous.label):this.textGuest,this.appOptions.canRenameAnonymous&&(i=Common.localStorage.getItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",i),Common.Utils.InternalSettings.set("save-guest-username",!!i)),this.appOptions.customization.font){if(this.appOptions.customization.font.name&&"string"==typeof this.appOptions.customization.font.name){for(var n=this.appOptions.customization.font.name.split(","),o=0;o<n.length;o++){var s=n[o].trim();s&&/[\s0-9\.]/.test(s)&&(n[o]="'"+s+"'")}document.documentElement.style.setProperty("--font-family-base-custom",n.join(","))}if(this.appOptions.customization.font.size){var a=parseInt(this.appOptions.customization.font.size);!isNaN(a)&&document.documentElement.style.setProperty("--font-size-base-app-custom",a+"px")}}this.editorConfig.user=this.appOptions.user=Common.Utils.fillUserInfo(this.editorConfig.user,this.editorConfig.lang,i?i+" ("+this.appOptions.guestName+")":this.textAnonymous,Common.localStorage.getItem("guest-id")||"uid-"+Date.now()),this.appOptions.user.anonymous&&Common.localStorage.setItem("guest-id",this.appOptions.user.id),this.appOptions.isDesktopApp="desktop"==this.editorConfig.targetApp||Common.Controllers.Desktop.isActive(),Common.Controllers.Desktop.isActive()&&!this.editorConfig.recent&&(this.editorConfig.recent=[]),this.appOptions.canCreateNew=this.editorConfig.canRequestCreateNew||!_.isEmpty(this.editorConfig.createUrl)||this.editorConfig.templates&&this.editorConfig.templates.length,this.appOptions.canOpenRecent=void 0!==this.editorConfig.recent,this.appOptions.templates=this.editorConfig.templates,this.appOptions.recent=this.editorConfig.recent,this.appOptions.createUrl=this.editorConfig.createUrl,this.appOptions.canRequestCreateNew=this.editorConfig.canRequestCreateNew,this.appOptions.lang=this.editorConfig.lang,this.appOptions.location="string"==typeof this.editorConfig.location?this.editorConfig.location.toLowerCase():"",this.appOptions.sharingSettingsUrl=this.editorConfig.sharingSettingsUrl,this.appOptions.fileChoiceUrl=this.editorConfig.fileChoiceUrl,this.appOptions.saveAsUrl=this.editorConfig.saveAsUrl,this.appOptions.canAnalytics=!1,this.appOptions.canRequestClose=this.editorConfig.canRequestClose,this.appOptions.canBackToFolder=!1!==this.editorConfig.canBackToFolder&&"object"==typeof this.editorConfig.customization&&"object"==typeof this.editorConfig.customization.goback&&(!_.isEmpty(this.editorConfig.customization.goback.url)||this.editorConfig.customization.goback.requestClose&&this.appOptions.canRequestClose),this.appOptions.canBack=!0===this.appOptions.canBackToFolder,this.appOptions.canPlugins=!1,this.appOptions.canMakeActionLink=this.editorConfig.canMakeActionLink,this.appOptions.canRequestUsers=this.editorConfig.canRequestUsers,this.appOptions.canRequestSendNotify=this.editorConfig.canRequestSendNotify,this.appOptions.canRequestSaveAs=this.editorConfig.canRequestSaveAs,this.appOptions.canRequestInsertImage=this.editorConfig.canRequestInsertImage,this.appOptions.canRequestSharingSettings=this.editorConfig.canRequestSharingSettings,this.appOptions.compatibleFeatures=!0,this.appOptions.uiRtl=!1,this.appOptions.mentionShare=!("object"==typeof this.appOptions.customization&&0==this.appOptions.customization.mentionShare),this.appOptions.user.guest&&this.appOptions.canRenameAnonymous&&Common.NotificationCenter.on("user:rename",_.bind(this.showRenameUserDialog,this)),(t=this.getApplication().getController("Viewport").getView("Common.Views.Header")).setCanBack(!0===this.appOptions.canBackToFolder,this.appOptions.canBackToFolder?this.editorConfig.customization.goback.text:""),this.editorConfig.lang&&this.api.asc_setLocale(this.editorConfig.lang),"us"!=this.appOptions.location&&"ca"!=this.appOptions.location||Common.Utils.Metric.setDefaultMetric(Common.Utils.Metric.c_MetricUnits.inch),this.appOptions.wopi=this.editorConfig.wopi,t.setWopi(this.appOptions.wopi),Common.Controllers.Desktop.init(this.appOptions),Common.UI.HintManager.setMode(this.appOptions)},loadDocument:function(e){this.permissions={},this.document=e.doc;var i={};if(e.doc){this.permissions=$.extend(this.permissions,e.doc.permissions);var n=$.extend({},e.doc.options,this.editorConfig.actionLink||{}),o=new Asc.asc_CUserInfo;o.put_Id(this.appOptions.user.id),o.put_FullName(this.appOptions.user.fullname),o.put_IsAnonymousUser(!!this.appOptions.user.anonymous),(i=new Asc.asc_CDocInfo).put_Id(e.doc.key),i.put_Url(e.doc.url),i.put_DirectUrl(e.doc.directUrl),i.put_Title(e.doc.title),i.put_Format(e.doc.fileType),i.put_VKey(e.doc.vkey),i.put_Options(n),i.put_UserInfo(o),i.put_CallbackUrl(this.editorConfig.callbackUrl),i.put_Token(e.doc.token),i.put_Permissions(e.doc.permissions),i.put_EncryptedInfo(this.editorConfig.encryptionKeys),i.put_Lang(this.editorConfig.lang),i.put_Mode(this.editorConfig.mode);var s=!this.editorConfig.customization||!1!==this.editorConfig.customization.plugins;i.asc_putIsEnabledPlugins(!!s);var a=/^(?:(djvu|xps|oxps))$/.exec(e.doc.fileType),r=a&&"string"==typeof a[1]?"strict":this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing?"view"===this.editorConfig.mode&&!1!==this.editorConfig.coEditing.change?"fast":this.editorConfig.coEditing.mode||"fast":"fast";i.put_CoEditingMode(r),a&&"string"==typeof a[1]&&(this.permissions.edit=this.permissions.review=!1)}this.editorConfig.customization&&(this.editorConfig.customization.toolbarNoTabs||"desktop"!==this.editorConfig.targetApp&&(this.editorConfig.customization.loaderName||this.editorConfig.customization.loaderLogo))||($("#editor-container").css("overflow","hidden"),$("#editor-container").append('<div class="doc-placeholder">'+'<div class="line"></div>'.repeat(20)+"</div>")),this.api.asc_registerCallback("asc_onGetEditorPermissions",_.bind(this.onEditorPermissions,this)),this.api.asc_registerCallback("asc_onLicenseChanged",_.bind(this.onLicenseChanged,this)),this.api.asc_setDocInfo(i),this.api.asc_getEditorPermissions(this.editorConfig.licenseUrl,this.editorConfig.customerId),e.doc&&t.setDocumentCaption(e.doc.title)},onProcessSaveResult:function(t){this.api.asc_OnSaveEnd(t.result),t&&!1===t.result&&Common.UI.error({title:this.criticalErrorTitle,msg:_.isEmpty(t.message)?this.errorProcessSaveResult:t.message})},onProcessRightsChange:function(t){if(t&&!1===t.enabled){var e=this,i=this._state.lostEditingRights;this._state.lostEditingRights=!this._state.lostEditingRights,this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("collaboration:sharingdeny"),Common.NotificationCenter.trigger("api:disconnect"),i||Common.UI.warning({title:this.notcriticalErrorTitle,maxwidth:600,msg:_.isEmpty(t.message)?this.warnProcessRightsChange:t.message,callback:function(){e._state.lostEditingRights=!1,e.onEditComplete()}})}},onDownloadAs:function(t){if(this.appOptions.canDownload||this.appOptions.canDownloadOrigin){this._state.isFromGatewayDownloadAs=!0;var e=t&&"string"==typeof t?Asc.c_oAscFileType[t.toUpperCase()]:null,i=new AscCommon.asc_CTextParams(Asc.c_oAscTextAssociation.PlainLine),n=[Asc.c_oAscFileType.TXT,Asc.c_oAscFileType.RTF,Asc.c_oAscFileType.ODT,Asc.c_oAscFileType.DOCX,Asc.c_oAscFileType.HTML,Asc.c_oAscFileType.DOTX,Asc.c_oAscFileType.OTT,Asc.c_oAscFileType.FB2,Asc.c_oAscFileType.EPUB,Asc.c_oAscFileType.DOCM,Asc.c_oAscFileType.JPG,Asc.c_oAscFileType.PNG],o=/^(?:(pdf|djvu|xps|oxps))$/.exec(this.document.fileType);if(t&&"string"==typeof t&&o[1]!==t.toLowerCase())if(/^xps|oxps$/.test(this.document.fileType)?n=n.concat([Asc.c_oAscFileType.PDF,Asc.c_oAscFileType.PDFA]):/^djvu$/.test(this.document.fileType)&&(n=[Asc.c_oAscFileType.PDF]),(!e||n.indexOf(e)<0)&&(e=null),e){var s=new Asc.asc_CDownloadOptions(e,!0);i&&s.asc_setTextParams(i),this.api.asc_DownloadAs(s)}else this.api.asc_DownloadOrigin(!0);else this.api.asc_DownloadOrigin(!0)}else Common.Gateway.reportError(Asc.c_oAscError.ID.AccessDeny,this.errorAccessDeny)},onProcessMouse:function(t){if("mouseup"==t.type){var e=document.getElementById("editor_sdk");if(e){var i=e.getBoundingClientRect();this.api.OnMouseUp(t.x-i.left,t.y-i.top)}}},disableEditing:function(t,e){this.getApplication(),Common.NotificationCenter.trigger("editing:disable",t,{viewMode:t,allowSignature:!1,statusBar:!0,leftMenu:{disable:!0,previewMode:!0},fileMenu:{protect:!0},navigation:{disable:!e,previewMode:!0},comments:{disable:!e,previewMode:!0},chat:!0,viewport:!0,documentHolder:{clear:!e,disable:!0},toolbar:!0,plugins:!1},e?"reconnect":"disconnect")},onEditingDisable:function(t,e,i){var n=this.getApplication(),o={type:i,disable:t,options:e};t&&!this.stackDisableActions.get({type:i})&&this.stackDisableActions.push(o),!t&&this.stackDisableActions.pop({type:i});var s=!t&&this.stackDisableActions.length()>0?this.stackDisableActions.get(this.stackDisableActions.length()-1):null;if(e.statusBar&&n.getController("Statusbar").getView("Statusbar").SetDisabled(t),e.viewport&&n.getController("Viewport").SetDisabled(t),e.toolbar&&n.getController("Toolbar").DisableToolbar(t,e.viewMode,e.reviewMode,e.fillFormMode),e.documentHolder&&e.documentHolder.disable&&n.getController("DocumentHolder").SetDisabled(t,e.allowProtect,e.fillFormMode),e.leftMenu&&(e.leftMenu.disable&&n.getController("LeftMenu").SetDisabled(t,e),e.leftMenu.previewMode&&n.getController("LeftMenu").setPreviewMode(t)),e.fileMenu&&(n.getController("LeftMenu").leftMenu.getMenu("file").SetDisabled(t,e.fileMenu),e.leftMenu.disable&&n.getController("LeftMenu").leftMenu.getMenu("file").applyMode()),e.comments){var a=this.getApplication().getController("Common.Controllers.Comments");a&&e.comments.previewMode&&a.setPreviewMode(t)}e.navigation&&e.navigation.previewMode&&n.getController("Navigation")&&n.getController("Navigation").SetDisabled(t),e.plugins&&n.getController("Common.Controllers.Plugins").getView("Common.Views.Plugins").SetDisabled(t,e.reviewMode,e.fillFormMode),s&&this.onEditingDisable(s.disable,s.options,s.type)},onRequestClose:function(){var t=this;this.api.isDocumentModified()?(this.api.asc_stopSaving(),Common.UI.warning({closable:!1,width:500,title:this.notcriticalErrorTitle,msg:this.leavePageTextOnClose,buttons:["ok","cancel"],primary:"ok",callback:function(e){"ok"==e?(t.api.asc_undoAllChanges(),t.api.asc_continueSaving(),Common.Gateway.requestClose()):t.api.asc_continueSaving()}})):Common.Gateway.requestClose()},goBack:function(t){if(!Common.Controllers.Desktop.process("goback"))if(this.appOptions.customization.goback.requestClose&&this.appOptions.canRequestClose)this.onRequestClose();else{var e=this.appOptions.customization.goback.url;t||!1===this.appOptions.customization.goback.blank?parent.location.href=e:window.open(e,"_blank")}},markFavorite:function(t){Common.Controllers.Desktop.process("markfavorite")||Common.Gateway.metaChange({favorite:t})},onSetFavorite:function(e){this.appOptions.canFavorite&&t.setFavorite(!!e)},onEditComplete:function(t){var e=this.getApplication(),i=e.getController("Toolbar").getView();if(this.appOptions.isEdit&&i&&i._isEyedropperStart&&(i._isEyedropperStart=!1,this.api.asc_cancelEyedropper()),e.getController("DocumentHolder").getView().focus(),this.appOptions.isEdit&&i&&(!i.btnStrikeout.pressed||_.isObject(arguments[1])&&"id-toolbar-btn-strikeout"===arguments[1].id||((!_.isObject(arguments[1])||"id-toolbar-btn-underline"!==arguments[1].id&&"id-toolbar-btn-highlight"!==arguments[1].id)&&this.api.SetMarkerFormat(i.btnStrikeout.options.type,!1),i.btnStrikeout.toggle(!1,!1)),!i.btnUnderline.pressed||_.isObject(arguments[1])&&"id-toolbar-btn-underline"===arguments[1].id||((!_.isObject(arguments[1])||"id-toolbar-btn-strikeout"!==arguments[1].id&&"id-toolbar-btn-highlight"!==arguments[1].id)&&this.api.SetMarkerFormat(i.btnUnderline.options.type,!1),i.btnUnderline.toggle(!1,!1)),!i.btnHighlight.pressed||_.isObject(arguments[1])&&"id-toolbar-btn-highlight"===arguments[1].id||((!_.isObject(arguments[1])||"id-toolbar-btn-underline"!==arguments[1].id&&"id-toolbar-btn-strikeout"!==arguments[1].id)&&this.api.SetMarkerFormat(i.btnHighlight.options.type,!1),i.btnHighlight.toggle(!1,!1))),this.api&&this.appOptions.isEdit&&!i._state.previewmode){var n=this.api.asc_isDocumentCanSave(),o=this.appOptions.forcesave,s=!!i.btnCollabChanges.rendered&&i.btnCollabChanges.cmpEl.hasClass("notify"),a=!n&&!s&&!o||this._state.isDisconnected||this._state.fastCoauth&&this._state.usersCount>1&&!o||!this.appOptions.isPDFEdit&&!this.appOptions.isPDFAnnotate;i.btnSave.setDisabled(a&&!this.appOptions.saveAlwaysEnabled)}Common.UI.HintManager.clearHints(!0)},onLongActionBegin:function(t,e){var i={id:e,type:t};this.stackLongActions.push(i),this.setLongActionView(i)},onLongActionEnd:function(e,i){var n={id:i,type:e};if(this.stackLongActions.pop(n),t&&t.setDocumentCaption(this.api.asc_getDocumentName()),this.updateWindowTitle(!0),n=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.Information}))this.setLongActionView(n);else{var o=this;i!=Asc.c_oAscAsyncAction.Save&&i!=Asc.c_oAscAsyncAction.ForceSaveButton||this.appOptions.isOffline?this.getApplication().getController("Statusbar").setStatusCaption(""):this._state.fastCoauth&&this._state.usersCount>1?o._state.timerSave=setTimeout((function(){o.getApplication().getController("Statusbar").setStatusCaption(o.textChangesSaved,!1,3e3)}),500):o.getApplication().getController("Statusbar").setStatusCaption(o.textChangesSaved,!1,3e3)}(n=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.BlockInteraction}))?this.setLongActionView(n):this.loadMask&&this.loadMask.hide(),!this.appOptions.isEdit||i!=Asc.c_oAscAsyncAction.Save&&i!=Asc.c_oAscAsyncAction.ForceSaveButton||this._state.fastCoauth&&!(this._state.usersCount<2)||this.synchronizeChanges(),i==Asc.c_oAscAsyncAction.Open&&(Common.Utils.InternalSettings.get("pdfe-settings-livecomment")?this.api.asc_showComments(Common.Utils.InternalSettings.get("pdfe-settings-resolvedcomment")):this.api.asc_hideComments()),i==Asc.c_oAscAsyncAction.Disconnect&&(this._state.timerDisconnect&&clearTimeout(this._state.timerDisconnect),this.disableEditing(!1,!0),this.getApplication().getController("Statusbar").hideDisconnectTip(),this.getApplication().getController("Statusbar").setStatusCaption(this.textReconnect)),e!=Asc.c_oAscAsyncActionType.BlockInteraction||this.getApplication().getController("LeftMenu").dlgSearch&&this.getApplication().getController("LeftMenu").dlgSearch.isVisible()||this.getApplication().getController("Toolbar").dlgSymbolTable&&this.getApplication().getController("Toolbar").dlgSymbolTable.isVisible()||(i==Asc.c_oAscAsyncAction.LoadDocumentFonts||i==Asc.c_oAscAsyncAction.ApplyChanges||i==Asc.c_oAscAsyncAction.DownloadAs)&&(this.dontCloseDummyComment||this.inTextareaControl||Common.Utils.ModalWindow.isVisible()||this.inFormControl)||this.api.asc_enableKeyEvents(!0)},setLongActionView:function(t){var n="",o="",s=!1,a=null;switch(t.id){case Asc.c_oAscAsyncAction.Open:n=this.openTitleText,o=this.openTextText;break;case Asc.c_oAscAsyncAction.Save:case Asc.c_oAscAsyncAction.ForceSaveButton:clearTimeout(this._state.timerSave),s=!0,n=this.saveTitleText,o=this.appOptions.isOffline?"":this.saveTextText;break;case Asc.c_oAscAsyncAction.LoadDocumentFonts:n=this.loadFontsTitleText,o=this.loadFontsTextText;break;case Asc.c_oAscAsyncAction.LoadDocumentImages:n=this.loadImagesTitleText,o=this.loadImagesTextText;break;case Asc.c_oAscAsyncAction.LoadFont:n=this.loadFontTitleText,o=this.loadFontTextText;break;case Asc.c_oAscAsyncAction.LoadImage:n=this.loadImageTitleText,o=this.loadImageTextText;break;case Asc.c_oAscAsyncAction.DownloadAs:n=this.downloadTitleText,o=this.downloadTextText;break;case Asc.c_oAscAsyncAction.Print:n=this.printTitleText,o=this.printTextText;break;case Asc.c_oAscAsyncAction.UploadImage:n=this.uploadImageTitleText,o=this.uploadImageTextText;break;case Asc.c_oAscAsyncAction.ApplyChanges:n=this.applyChangesTitleText,o=this.applyChangesTextText;break;case Asc.c_oAscAsyncAction.Waiting:n=this.waitText,o=this.waitText;break;case e:n=this.txtEditingMode,o=this.txtEditingMode;break;case i:n=this.loadingDocumentTitleText+"           ",o=this.loadingDocumentTextText;break;case Asc.c_oAscAsyncAction.Disconnect:o=this.textDisconnect,Common.UI.Menu.Manager.hideAll(),this.disableEditing(!0,!0);var r=this;a=function(){r._state.timerDisconnect=setTimeout((function(){r.getApplication().getController("Statusbar").showDisconnectTip()}),r._state.unloadTimer||0)};break;default:"string"==typeof t.id&&(n=t.id,o=t.id)}t.type==Asc.c_oAscAsyncActionType.BlockInteraction?(this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:$("#viewport")})),this.loadMask.setTitle(n),this.isShowOpenDialog||this.loadMask.show(t.id===Asc.c_oAscAsyncAction.Open)):this.getApplication().getController("Statusbar").setStatusCaption(o,s,0,a)},onApplyEditRights:function(t){this.getApplication().getController("Statusbar").setStatusCaption(""),t&&!t.allowed&&Common.UI.info({title:this.requestEditFailedTitleText,msg:t.message||this.requestEditFailedMessageText})},onDocumentContentReady:function(){if(!this._isDocReady){this._state.openDlg&&this._state.openDlg.close();var e,n=this;n._isDocReady=!0,Common.NotificationCenter.trigger("app:ready",this.appOptions),n.api.SetDrawingFreeze(!1),n.hidePreloader(),n.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,i),this.isLiveCommenting=Common.localStorage.getBool("pdfe-settings-livecomment",!0),Common.Utils.InternalSettings.set("pdfe-settings-livecomment",this.isLiveCommenting),e=Common.localStorage.getBool("pdfe-settings-resolvedcomment"),Common.Utils.InternalSettings.set("pdfe-settings-resolvedcomment",e),this.isLiveCommenting?this.api.asc_showComments(e):this.api.asc_hideComments(),e=Common.localStorage.getItem("pdfe-settings-zoom"),Common.Utils.InternalSettings.set("pdfe-settings-zoom",e);var o=null!==e?parseInt(e):this.appOptions.customization&&this.appOptions.customization.zoom?parseInt(this.appOptions.customization.zoom):100,s=null!==(e=Common.localStorage.getItem("pdfe-last-zoom"))?parseInt(e):0;-1==o?this.api.zoomFitToPage():-2==o?this.api.zoomFitToWidth():this.api.zoom(o>0?o:-3==o&&s>0?s:100),e=Common.localStorage.getBool("pdfe-settings-compatible",!1),Common.Utils.InternalSettings.set("pdfe-settings-compatible",e),Common.Utils.InternalSettings.set("pdfe-settings-showsnaplines",n.api.get_ShowSnapLines()),void 0!==document.hidden&&document.hidden?document.addEventListener("visibilitychange",f):f(),n.api.asc_registerCallback("asc_onStartAction",_.bind(n.onLongActionBegin,n)),n.api.asc_registerCallback("asc_onEndAction",_.bind(n.onLongActionEnd,n)),n.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(n.onCoAuthoringDisconnect,n)),n.api.asc_registerCallback("asc_onPrint",_.bind(n.onPrint,n)),n.api.asc_registerCallback("asc_onConfirmAction",_.bind(n.onConfirmAction,n)),t.setDocumentCaption(n.api.asc_getDocumentName()),n.updateWindowTitle(!0),e=Common.localStorage.getBool("pdfe-settings-show-alt-hints",!Common.Utils.isMac),Common.Utils.InternalSettings.set("pdfe-settings-show-alt-hints",e),n.onPdfModeApply();var a=n.getApplication(),r=a.getController("Toolbar"),l=a.getController("Statusbar"),c=a.getController("DocumentHolder"),d=a.getController("LeftMenu"),h=a.getController("Common.Controllers.Chat"),m=a.getController("Common.Controllers.Plugins"),u=a.getController("Navigation");d.getView("LeftMenu").getMenu("file").loadDocument({doc:n.document}),d.createDelayedElements().setApi(n.api),u.setMode(n.appOptions).setApi(n.api),h.setApi(this.api).setMode(this.appOptions),m.setApi(n.api),c.setApi(n.api),l.createDelayedElements(),d.getView("LeftMenu").disableMenu("all",!1),n.appOptions.canBranding&&n.getApplication().getController("LeftMenu").leftMenu.getMenu("about").setLicInfo(n.editorConfig.customization),c.getView().on("editcomplete",_.bind(n.onEditComplete,n)),n.appOptions.isEdit?(n.appOptions.canForcesave&&(n.appOptions.forcesave=Common.localStorage.getBool("pdfe-settings-forcesave",n.appOptions.canForcesave),Common.Utils.InternalSettings.set("pdfe-settings-forcesave",n.appOptions.forcesave),n.api.asc_setIsForceSaveOnUserSave(n.appOptions.forcesave)),n.needToUpdateVersion&&Common.NotificationCenter.trigger("api:disconnect"),setTimeout((function(){r.createDelayedElements(),r.activateControls(),n.needToUpdateVersion&&r.onApiCoAuthoringDisconnect(),n.api.UpdateInterfaceState(),Common.NotificationCenter.trigger("document:ready","main"),n.applyLicense()}),500)):(Common.NotificationCenter.trigger("document:ready","main"),n.applyLicense());var p=~~(1e6*Math.random());$(".toolbar").prepend(Common.Utils.String.format('<div class="lazy-{0} x-huge"><div class="toolbar__icon" style="position: absolute; width: 1px; height: 1px;"></div>',p)),setTimeout((function(){$(Common.Utils.String.format(".toolbar .lazy-{0}",p)).remove()}),10),this.appOptions.canAnalytics,Common.Gateway.on("applyeditrights",_.bind(n.onApplyEditRights,n)),Common.Gateway.on("processsaveresult",_.bind(n.onProcessSaveResult,n)),Common.Gateway.on("processrightschange",_.bind(n.onProcessRightsChange,n)),Common.Gateway.on("processmouse",_.bind(n.onProcessMouse,n)),Common.Gateway.on("downloadas",_.bind(n.onDownloadAs,n)),Common.Gateway.on("setfavorite",_.bind(n.onSetFavorite,n)),Common.Gateway.on("requestclose",_.bind(n.onRequestClose,n)),Common.Gateway.sendInfo({mode:n.appOptions.isEdit?"edit":"view"}),(n.appOptions.sharingSettingsUrl&&n.appOptions.sharingSettingsUrl.length||n.appOptions.canRequestSharingSettings)&&(Common.Gateway.on("showsharingsettings",_.bind(n.changeAccessRights,n)),Common.Gateway.on("setsharingsettings",_.bind(n.setSharingSettings,n)),Common.NotificationCenter.on("collaboration:sharing",_.bind(n.changeAccessRights,n)),Common.NotificationCenter.on("collaboration:sharingdeny",_.bind(n.setSharingSettings,n))),$(document).on("contextmenu",_.bind(n.onContextMenu,n)),Common.Gateway.documentReady(),$("#editor-container").css("overflow",""),$(".doc-placeholder").remove(),this.appOptions.user.guest&&this.appOptions.canRenameAnonymous&&null===Common.Utils.InternalSettings.get("guest-username")&&this.showRenameUserDialog(),this._needToSaveAsFile&&this.getApplication().getController("LeftMenu").leftMenu.showMenu("file:saveas")}function f(){if(!Common.Controllers.Desktop.isActive()){var t=[];Common.Utils.isIE9m&&t.push(n.warnBrowserIE9),t.length&&n.showTips(t)}document.removeEventListener("visibilitychange",f)}},onLicenseChanged:function(t){var e=t.asc_getLicenseType();void 0!==e&&this.appOptions.canPDFEdit&&"view"!==this.editorConfig.mode&&(e===Asc.c_oLicenseResult.Connections||e===Asc.c_oLicenseResult.UsersCount||e===Asc.c_oLicenseResult.ConnectionsOS||e===Asc.c_oLicenseResult.UsersCountOS||e===Asc.c_oLicenseResult.SuccessLimit&&0!=(this.appOptions.trialMode&Asc.c_oLicenseMode.Limited))&&(this._state.licenseType=e),this._isDocReady&&this.applyLicense()},applyLicense:function(){this.appOptions.canSwitchMode&&(this.appOptions.canPDFAnnotate||this.appOptions.canPDFEdit)&&!this.appOptions.isDesktopApp&&!this.appOptions.canBrandingExt&&this.editorConfig&&this.editorConfig.customization&&(this.editorConfig.customization.loaderName||this.editorConfig.customization.loaderLogo||this.editorConfig.customization.font&&(this.editorConfig.customization.font.size||this.editorConfig.customization.font.name))&&Common.UI.warning({title:this.textPaidFeature,msg:this.textCustomLoader,buttons:[{value:"contact",caption:this.textContactUs},{value:"close",caption:this.textClose}],primary:"contact",callback:function(t){"contact"==t&&window.open("mailto:sales@onlyoffice.com","_blank")}})},onOpenDocument:function(t){var e=document.getElementById("loadmask-text"),i=(t.asc_getCurrentFont()+t.asc_getCurrentImage())/(t.asc_getFontsCount()+t.asc_getImagesCount());i=this.textLoadingDocument+": "+Common.Utils.String.fixedDigits(Math.min(Math.round(100*i),100),3,"  ")+"%",e?e.innerHTML=i:this.loadMask&&this.loadMask.setTitle(i)},onEditorPermissions:function(e){var n=e.asc_getLicenseType();if(Asc.c_oLicenseResult.Expired!==n&&Asc.c_oLicenseResult.Error!==n&&Asc.c_oLicenseResult.ExpiredTrial!==n&&Asc.c_oLicenseResult.NotBefore!==n&&Asc.c_oLicenseResult.ExpiredLimited!==n){if(!this.onServerVersion(e.asc_getBuildVersion())&&this.onLanguageLoaded()){e.asc_getRights()!==Asc.c_oRights.Edit&&(this.permissions.edit=this.permissions.review=!1);var o=/^(?:(djvu|xps|oxps))$/.test(this.document.fileType)||"ru"===Common.Locale.getDefaultLanguage();this.appOptions.permissionsLicense=n,this.appOptions.canAnalytics=e.asc_getIsAnalyticsEnable(),this.appOptions.canLicense=n===Asc.c_oLicenseResult.Success||n===Asc.c_oLicenseResult.SuccessLimit,this.appOptions.isLightVersion=e.asc_getIsLight(),this.appOptions.canCoAuthoring=!this.appOptions.isLightVersion,this.appOptions.isOffline=this.api.asc_isOffline(),this.appOptions.canCreateNew=this.appOptions.canCreateNew&&!this.appOptions.isOffline,this.appOptions.isCrypted=this.api.asc_isCrypto(),this.appOptions.canRequestEditRights=this.editorConfig.canRequestEditRights,this.appOptions.canSwitchMode=!o&&!1,this.appOptions.canEdit=!o,this.appOptions.isEdit=!o,this.appOptions.canPDFEdit=!1,this.appOptions.isPDFEdit=!1,this.appOptions.canPDFAnnotate=this.appOptions.canSwitchMode&&this.appOptions.canLicense&&!1!==this.permissions.comment,this.appOptions.canPDFAnnotate=this.appOptions.canPDFAnnotate&&!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.comments),this.appOptions.isPDFAnnotate=!1,this.appOptions.canComments=!o,this.appOptions.canViewComments=this.appOptions.canComments,this.appOptions.canChat=this.appOptions.canLicense&&!this.appOptions.isOffline&&!(!1===this.permissions.chat||void 0===this.permissions.chat&&"object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.chat),"object"==typeof this.editorConfig.customization&&void 0!==this.editorConfig.customization.chat&&console.log("Obsolete: The 'chat' parameter of the 'customization' section is deprecated. Please use 'chat' parameter in the permissions instead."),this.appOptions.canPrint=!1!==this.permissions.print,this.appOptions.canPreviewPrint=this.appOptions.canPrint&&!Common.Utils.isMac&&this.appOptions.isDesktopApp,this.appOptions.canQuickPrint=this.appOptions.canPrint&&!Common.Utils.isMac&&this.appOptions.isDesktopApp,this.appOptions.canRename=this.editorConfig.canRename,this.appOptions.buildVersion=e.asc_getBuildVersion(),this.appOptions.canForcesave=this.appOptions.isPDFEdit&&!this.appOptions.isOffline&&"object"==typeof this.editorConfig.customization&&!!this.editorConfig.customization.forcesave,this.appOptions.forcesave=this.appOptions.canForcesave,this.appOptions.saveAlwaysEnabled=!0,this.appOptions.canEditComments=this.appOptions.isOffline||!this.permissions.editCommentAuthorOnly,this.appOptions.canDeleteComments=this.appOptions.isOffline||!this.permissions.deleteCommentAuthorOnly,"object"==typeof this.editorConfig.customization&&!0===this.editorConfig.customization.commentAuthorOnly&&(console.log("Obsolete: The 'commentAuthorOnly' parameter of the 'customization' section is deprecated. Please use 'editCommentAuthorOnly' and 'deleteCommentAuthorOnly' parameters in the permissions instead."),void 0===this.permissions.editCommentAuthorOnly&&void 0===this.permissions.deleteCommentAuthorOnly&&(this.appOptions.canEditComments=this.appOptions.canDeleteComments=this.appOptions.isOffline)),this.appOptions.trialMode=e.asc_getLicenseMode(),this.appOptions.isBeta=e.asc_getIsBeta(),this.appOptions.isSignatureSupport=!1,this.appOptions.isPasswordSupport=!1,this.appOptions.canProtect=!1!==this.permissions.protect,this.appOptions.canHelp=!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.help),this.appOptions.canCoAuthoring||(this.appOptions.canChat=!1),this.appOptions.canDownloadOrigin=!1,this.appOptions.canDownload=!1!==this.permissions.download,this.appOptions.canUseSelectHandTools=o,this.appOptions.canUseThumbnails=this.appOptions.canUseViwerNavigation=!0,this.appOptions.fileKey=this.document.key,this.appOptions.canBranding=e.asc_getCustomization(),this.appOptions.canBranding&&t.setBranding(this.editorConfig.customization),this.appOptions.canFavorite=this.document.info&&void 0!==this.document.info.favorite&&null!==this.document.info.favorite&&!this.appOptions.isOffline,this.appOptions.canFavorite&&t.setFavorite(this.document.info.favorite),this.appOptions.canUseCommentPermissions=this.appOptions.canLicense&&!!this.permissions.commentGroups,this.appOptions.canUseUserInfoPermissions=this.appOptions.canLicense&&!!this.permissions.userInfoGroups,AscCommon.UserInfoParser.setParser(!0),AscCommon.UserInfoParser.setCurrentName(this.appOptions.user.fullname),this.appOptions.canUseCommentPermissions&&AscCommon.UserInfoParser.setCommentPermissions(this.permissions.commentGroups),this.appOptions.canUseUserInfoPermissions&&AscCommon.UserInfoParser.setUserInfoPermissions(this.permissions.userInfoGroups),t.setUserName(AscCommon.UserInfoParser.getParsedName(AscCommon.UserInfoParser.getCurrentName())),this.appOptions.canRename&&t.setCanRename(!0),this.appOptions.canBrandingExt=e.asc_getCanBranding()&&("object"==typeof this.editorConfig.customization||this.editorConfig.plugins),this.getApplication().getController("Common.Controllers.Plugins").setMode(this.appOptions,this.api),this.editorConfig.customization&&Common.UI.LayoutManager.init(this.editorConfig.customization.layout,this.appOptions.canBrandingExt),this.editorConfig.customization&&Common.UI.FeaturesManager.init(this.editorConfig.customization.features,this.appOptions.canBrandingExt),Common.UI.ExternalUsers.init(this.appOptions.canRequestUsers),this.appOptions.canComments&&Common.NotificationCenter.on("comments:cleardummy",_.bind(this.onClearDummyComment,this)),Common.NotificationCenter.on("comments:showdummy",_.bind(this.onShowDummyComment,this)),this.appOptions.canLiveView=!1,this.appOptions.canChangeCoAuthoring=this.appOptions.isEdit&&this.appOptions.canCoAuthoring&&!(this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&!1===this.editorConfig.coEditing.change),this.loadCoAuthSettings(),this.applyModeCommonElements(),this.applyModeEditorElements(),this.appOptions.isEdit||(Common.NotificationCenter.trigger("app:face",this.appOptions),this.hidePreloader(),this.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,i)),this.api.asc_setViewMode(!this.appOptions.isEdit),this.api.asc_LoadDocument()}}else Common.UI.warning({title:Asc.c_oLicenseResult.NotBefore===n?this.titleLicenseNotActive:this.titleLicenseExp,msg:Asc.c_oLicenseResult.NotBefore===n?this.warnLicenseBefore:this.warnLicenseExp,buttons:[],closable:!1})},loadCoAuthSettings:function(){var t,e=!0,i=1;this.appOptions.isEdit&&!this.appOptions.isOffline&&this.appOptions.canCoAuthoring?(this.appOptions.canChangeCoAuthoring?null===(t=Common.localStorage.getItem("pdfe-settings-coauthmode"))&&null===(t=this.editorConfig.coEditing&&void 0!==this.editorConfig.coEditing.mode?"strict"===this.editorConfig.coEditing.mode?0:1:null)&&!Common.localStorage.itemExists("pdfe-settings-autosave")&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0):null===(t=this.editorConfig.coEditing&&void 0!==this.editorConfig.coEditing.mode?"strict"===this.editorConfig.coEditing.mode?0:1:null)&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0),e=null===t||1==parseInt(t),null==(t=Common.localStorage.getItem(e?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict"))&&(t=e?"none":"last"),Common.Utils.InternalSettings.set(e?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict",t)):(e=!1,i=0),this.appOptions.isEdit&&(null===(t=Common.localStorage.getItem("pdfe-settings-autosave"))&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0),i=e||null===t?this.appOptions.canCoAuthoring?1:0:parseInt(t)),Common.Utils.InternalSettings.set("pdfe-settings-coauthmode",e),Common.Utils.InternalSettings.set("pdfe-settings-autosave",i)},onPdfModeChange:function(t,e){if(this.appOptions.canSwitchMode){if("comment"===t||"edit"===t){if(!this.appOptions.isAnonymousSupport&&this.appOptions.user.anonymous)return void Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.warnLicenseAnonymous,buttons:["ok"]});if(this._state.licenseType){var i=this._state.licenseType,n=["ok"],o="ok";return 0==(this.appOptions.trialMode&Asc.c_oLicenseMode.Limited)||i!==Asc.c_oLicenseResult.SuccessLimit&&this.appOptions.permissionsLicense!==Asc.c_oLicenseResult.SuccessLimit?i===Asc.c_oLicenseResult.Connections||i===Asc.c_oLicenseResult.UsersCount?i=i===Asc.c_oLicenseResult.Connections?this.warnLicenseExceeded:this.warnLicenseUsersExceeded:(i=i===Asc.c_oLicenseResult.ConnectionsOS?this.warnNoLicense:this.warnNoLicenseUsers,n=[{value:"buynow",caption:this.textBuyNow},{value:"contact",caption:this.textContactUs}],o="buynow"):i=this.warnLicenseLimitedRenewed,void Common.UI.info({maxwidth:500,title:this.textNoLicenseTitle,msg:i,buttons:n,primary:o,callback:function(t){"buynow"==t?window.open("https://www.onlyoffice.com","_blank"):"contact"==t&&window.open("mailto:sales@onlyoffice.com","_blank")}})}}"edit"===t&&this.appOptions.canPDFEdit?(this.appOptions.isPDFEdit=!0,this.appOptions.isPDFAnnotate=!1):"comment"===t&&this.appOptions.canPDFAnnotate?(this.appOptions.isPDFEdit=!1,this.appOptions.isPDFAnnotate=!0):"view"===t&&(this.appOptions.isPDFEdit=this.appOptions.isPDFAnnotate=!1),e&&e(),this.onPdfModeApply()}},onPdfModeApply:function(){if(this.api){if(this._state.fastCoauth=!(!this.appOptions.isPDFAnnotate&&!this.appOptions.isPDFEdit)&&Common.Utils.InternalSettings.get("pdfe-settings-coauthmode"),this.api.asc_SetFastCollaborative(this._state.fastCoauth),this.api.asc_setAutoSaveGap(this.appOptions.isPDFAnnotate||this.appOptions.isPDFEdit?Common.Utils.InternalSettings.get("pdfe-settings-autosave"):0),this.appOptions.isPDFAnnotate||this.appOptions.isPDFEdit){var t=Common.Utils.InternalSettings.get(this._state.fastCoauth?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict");switch(t){case"all":t=Asc.c_oAscCollaborativeMarksShowType.All;break;case"none":t=Asc.c_oAscCollaborativeMarksShowType.None;break;case"last":t=Asc.c_oAscCollaborativeMarksShowType.LastChanges;break;default:t=this._state.fastCoauth?Asc.c_oAscCollaborativeMarksShowType.None:Asc.c_oAscCollaborativeMarksShowType.LastChanges}this.api.SetCollaborativeMarksShowType(t)}this.getApplication().getController("LeftMenu").leftMenu.getMenu("file").applyMode()}},applyModeCommonElements:function(){window.editor_elements_prepared=!0;var t=this.getApplication(),e=t.getController("Viewport").getView("Viewport"),i=t.getController("Statusbar").getView("Statusbar"),n=t.getController("DocumentHolder"),o=t.getController("Toolbar"),s=t.getController("LeftMenu");e&&e.setMode(this.appOptions),i&&i.setMode(this.appOptions),o.setMode(this.appOptions),n.setMode(this.appOptions),s.setMode(this.appOptions),e.applyCommonMode();var a=t.getController("Print");a&&this.api&&a.setApi(this.api).setMode(this.appOptions),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onConnectionStateChanged",_.bind(this.onUserConnection,this)),this.api.asc_registerCallback("asc_onDocumentModifiedChanged",_.bind(this.onDocumentModifiedChanged,this));var r=Common.localStorage.getItem("pdfe-settings-unit");void 0===(r=null!==r?parseInt(r):this.appOptions.customization&&this.appOptions.customization.unit?Common.Utils.Metric.c_MetricUnits[this.appOptions.customization.unit.toLocaleLowerCase()]:Common.Utils.Metric.getDefaultMetric())&&(r=Common.Utils.Metric.getDefaultMetric()),Common.Utils.Metric.setCurrentMetric(r),Common.Utils.InternalSettings.set("pdfe-settings-unit",r)},applyModeEditorElements:function(){this.contComments.setMode(this.appOptions),this.contComments.setConfig({config:this.editorConfig},this.api);var t=this,n=this.getApplication().getController("Toolbar");if(n&&n.setApi(t.api),this.appOptions.isEdit){this.getApplication().getController("Viewport").getView("Viewport").applyEditorMode();var o=n?n.getView():null;o&&(o.setApi(t.api),o.on("editcomplete",_.bind(t.onEditComplete,t)));var s=Common.Utils.InternalSettings.get("pdfe-settings-unit");t.api.asc_SetDocumentUnits(s==Common.Utils.Metric.c_MetricUnits.inch?Asc.c_oAscDocumentUnits.Inch:s==Common.Utils.Metric.c_MetricUnits.pt?Asc.c_oAscDocumentUnits.Point:Asc.c_oAscDocumentUnits.Millimeter),t.api.asc_registerCallback("asc_onDocumentCanSaveChanged",_.bind(t.onDocumentCanSaveChanged,t)),t.api.asc_registerCallback("asc_onCollaborativeChanges",_.bind(t.onCollaborativeChanges,t)),t.api.asc_registerCallback("asc_OnTryUndoInFastCollaborative",_.bind(t.onTryUndoInFastCollaborative,t)),t.stackLongActions.exist({id:e,type:Asc.c_oAscAsyncActionType.BlockInteraction})?t.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,e):this._isDocReady||(Common.NotificationCenter.trigger("app:face",t.appOptions),t.hidePreloader(),t.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,i)),window.onbeforeunload=_.bind(t.onBeforeUnload,t),window.onunload=_.bind(t.onUnload,t)}},onExternalMessage:function(t,e){t&&t.msg&&(t.msg=t.msg.toString(),this.showTips([t.msg.charAt(0).toUpperCase()+t.msg.substring(1)],e),Common.component.Analytics.trackEvent("External Error"))},onError:function(t,e,n){if(t==Asc.c_oAscError.ID.LoadingScriptError)return this.showTips([this.scriptLoadError]),void(this.tooltip&&this.tooltip.getBSTip().$tip.css("z-index",1e4));if(t!=Asc.c_oAscError.ID.CanNotPasteImage){this.hidePreloader(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,i);var o={closable:!0};switch(t){case Asc.c_oAscError.ID.Unknown:o.msg=this.unknownErrorText;break;case Asc.c_oAscError.ID.ConvertationTimeout:o.msg=this.convertationTimeoutText;break;case Asc.c_oAscError.ID.ConvertationOpenError:o.msg=this.openErrorText;break;case Asc.c_oAscError.ID.ConvertationSaveError:o.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.saveErrorTextDesktop:this.saveErrorText;break;case Asc.c_oAscError.ID.DownloadError:o.msg=this.downloadErrorText;break;case Asc.c_oAscError.ID.UplImageSize:o.msg=this.uploadImageSizeMessage;break;case Asc.c_oAscError.ID.UplImageExt:o.msg=this.uploadImageExtMessage;break;case Asc.c_oAscError.ID.UplImageFileCount:o.msg=this.uploadImageFileCountMessage;break;case Asc.c_oAscError.ID.UplDocumentSize:o.msg=this.uploadDocSizeMessage;break;case Asc.c_oAscError.ID.UplDocumentExt:o.msg=this.uploadDocExtMessage;break;case Asc.c_oAscError.ID.UplDocumentFileCount:o.msg=this.uploadDocFileCountMessage;break;case Asc.c_oAscError.ID.VKeyEncrypt:o.msg=this.errorToken;break;case Asc.c_oAscError.ID.KeyExpire:o.msg=this.errorTokenExpire;break;case Asc.c_oAscError.ID.UserCountExceed:o.msg=this.errorUsersExceed;break;case Asc.c_oAscError.ID.CoAuthoringDisconnect:o.msg=this.errorViewerDisconnect;break;case Asc.c_oAscError.ID.ConvertationPassword:o.msg=this.errorFilePassProtect;break;case Asc.c_oAscError.ID.UserDrop:if(this._state.lostEditingRights)return void(this._state.lostEditingRights=!1);this._state.lostEditingRights=!0,o.msg=this.errorUserDrop,Common.NotificationCenter.trigger("collaboration:sharingdeny");break;case Asc.c_oAscError.ID.Warning:o.msg=this.errorConnectToServer,o.closable=!1;break;case Asc.c_oAscError.ID.SessionAbsolute:o.msg=this.errorSessionAbsolute;break;case Asc.c_oAscError.ID.SessionIdle:o.msg=this.errorSessionIdle;break;case Asc.c_oAscError.ID.SessionToken:o.msg=this.errorSessionToken;break;case Asc.c_oAscError.ID.AccessDeny:o.msg=this.errorAccessDeny;break;case Asc.c_oAscError.ID.UplImageUrl:o.msg=this.errorBadImageUrl;break;case Asc.c_oAscError.ID.ForceSaveButton:case Asc.c_oAscError.ID.ForceSaveTimeout:o.msg=this.errorForceSave,o.maxwidth=600;break;case Asc.c_oAscError.ID.DataEncrypted:o.msg=this.errorDataEncrypted;break;case Asc.c_oAscError.ID.EditingError:o.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.errorEditingSaveas:this.errorEditingDownloadas;break;case Asc.c_oAscError.ID.ConvertationOpenLimitError:o.msg=this.errorFileSizeExceed;break;case Asc.c_oAscError.ID.UpdateVersion:o.msg=this.errorUpdateVersionOnDisconnect,o.maxwidth=600;break;case Asc.c_oAscError.ID.DirectUrl:o.msg=this.errorDirectUrl;break;case Asc.c_oAscError.ID.Password:o.msg=this.errorSetPassword;break;case Asc.c_oAscError.ID.LoadingFontError:o.msg=this.errorLoadingFont;break;case Asc.c_oAscError.ID.PasswordIsNotCorrect:o.msg=this.errorPasswordIsNotCorrect;break;case Asc.c_oAscError.ID.ConvertationOpenFormat:o.maxwidth=600,o.msg="pdf"===n?this.errorInconsistentExtPdf.replace("%1",this.document.fileType||""):"docx"===n?this.errorInconsistentExtDocx.replace("%1",this.document.fileType||""):"xlsx"===n?this.errorInconsistentExtXlsx.replace("%1",this.document.fileType||""):"pptx"===n?this.errorInconsistentExtPptx.replace("%1",this.document.fileType||""):this.errorInconsistentExt;break;case Asc.c_oAscError.ID.MailToClientMissing:o.msg=this.errorEmailClient;break;default:o.msg="string"==typeof t?t:this.errorDefaultMessage.replace("%1",t)}e==Asc.c_oAscError.Level.Critical?(Common.Gateway.reportError(t,o.msg),o.title=this.criticalErrorTitle,o.iconCls="error",o.closable=!1,this.appOptions.canBackToFolder&&!this.appOptions.isDesktopApp&&"string"!=typeof t&&(o.msg+="<br><br>"+this.criticalErrorExtText,o.callback=function(t){"ok"==t&&Common.NotificationCenter.trigger("goback",!0)}),t!=Asc.c_oAscError.ID.DataEncrypted&&t!=Asc.c_oAscError.ID.ConvertationOpenLimitError||(this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("api:disconnect"))):(Common.Gateway.reportWarning(t,o.msg),o.title=this.notcriticalErrorTitle,o.iconCls="warn",o.buttons=["ok"],o.callback=_.bind((function(e){t==Asc.c_oAscError.ID.Warning&&"ok"==e&&(this.appOptions.canDownload||this.appOptions.canDownloadOrigin)?(Common.UI.Menu.Manager.hideAll(),this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.api.asc_DownloadAs():this.appOptions.canDownload?this._isDocReady?this.getApplication().getController("LeftMenu").leftMenu.showMenu("file:saveas"):this._needToSaveAsFile=!0:this.api.asc_DownloadOrigin()):t==Asc.c_oAscError.ID.EditingError&&(this.disableEditing(!0),Common.NotificationCenter.trigger("api:disconnect",!0)),this._state.lostEditingRights=!1,this.onEditComplete()}),this)),(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+t+"]").length<1)&&Common.UI.alert(o).$window.attr("data-value",t),void 0!==t&&Common.component.Analytics.trackEvent("Internal Error",t.toString())}else this.showTips([this.errorCannotPasteImg],{timeout:7e3,hideCloseTip:!0})},onOpenLinkPdfForm:function(t,e,i){var n="pdf-link",o={closable:!0,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok","cancel"],msg:Common.Utils.String.format(this.txtSecurityWarningLink,t||""),callback:_.bind((function(t){"ok"==t&&window.event&&1==window.event.ctrlKey?e():i()}),this)};(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+n+"]").length<1)&&Common.UI.alert(o).$window.attr("data-value",n)},onOpenFilePdfForm:function(t,e){var i="pdf-form",n={closable:!0,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok","cancel"],msg:this.txtSecurityWarningOpenFile,callback:_.bind((function(i){"ok"==i?t():e()}),this)};(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+i+"]").length<1)&&Common.UI.alert(n).$window.attr("data-value",i)},onValidateErrorPdfForm:function(t){var e="pdf-validate-error",i={closable:!0,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"]};null!=t.greater&&null!=t.less?i.msg=Common.Utils.String.format(this.txtInvalidGreaterLess,t.target.api.name,t.greater,t.less):null!=t.greater?i.msg=Common.Utils.String.format(this.txtInvalidGreater,t.target.api.name,t.greater):null!=t.less&&(i.msg=Common.Utils.String.format(this.txtInvalidLess,t.target.api.name,t.less)),(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+e+"]").length<1)&&Common.UI.alert(i).$window.attr("data-value",e)},onFormatErrorPdfForm:function(t){var e="pdf-format-error",i={closable:!0,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"]};i.msg=Common.Utils.String.format(this.txtInvalidPdfFormat,t.target.api.name),t.format&&(i.msg+="<br>"+Common.Utils.String.format(this.txtValidPdfFormat,t.format)),(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+e+"]").length<1)&&Common.UI.alert(i).$window.attr("data-value",e)},onCoAuthoringDisconnect:function(){this.getApplication().getController("Viewport").getView("Viewport").setMode({isDisconnected:!0}),t.setCanRename(!1),this.appOptions.canRename=!1,this._state.isDisconnected=!0},showTips:function(t,e){var i=this;function n(t){i.tipTimeout&&clearTimeout(i.tipTimeout),setTimeout(o,300)}function o(){var o=t.shift();o&&(e&&e.hideCloseTip||(o+="\n"+i.textCloseTip),i.tooltip.setTitle(o),i.tooltip.show(),i.tipTimeout&&clearTimeout(i.tipTimeout),e&&e.timeout&&(i.tipTimeout=setTimeout((function(){i.tooltip.hide(),n()}),e.timeout)))}t.length&&("object"!=typeof t&&(t=[t]),this.tooltip||(this.tooltip=new Common.UI.Tooltip({owner:this.getApplication().getController("Toolbar").getView(),hideonclick:!0,placement:"bottom",cls:"main-info",offset:30}),this.tooltip.on("tooltip:hideonclick",n)),o())},updateWindowTitle:function(e){var i=this.api.isDocumentModified();if(this._state.isDocModified!==i||e){var n=this.defaultTitleText;t&&!_.isEmpty(t.getDocumentCaption())&&(n=t.getDocumentCaption()+" - "+n),i&&(clearTimeout(this._state.timerCaption),_.isUndefined(n)||(n="* "+n)),window.document.title!=n&&(window.document.title=n),this._isDocReady&&this._state.isDocModified!==i&&Common.Gateway.setDocumentModified(i),i&&(!this._state.fastCoauth||this._state.usersCount<2)&&this.getApplication().getController("Statusbar").setStatusCaption("",!0),this._state.isDocModified=i}},onDocumentModifiedChanged:function(){var t=this.api.asc_isDocumentCanSave();this._state.isDocModified!==t&&this._isDocReady&&Common.Gateway.setDocumentModified(this.api.isDocumentModified()),this.updateWindowTitle();var e=this.getApplication().getController("Toolbar").getView();if(e&&e.btnCollabChanges&&!e._state.previewmode){var i=e.btnCollabChanges.cmpEl.hasClass("notify"),n=this.appOptions.forcesave,o=!t&&!i&&!n||this._state.isDisconnected||this._state.fastCoauth&&this._state.usersCount>1&&!n||!this.appOptions.isPDFEdit&&!this.appOptions.isPDFAnnotate;e.btnSave.setDisabled(o&&!this.appOptions.saveAlwaysEnabled)}!this.contComments.isDummyComment||this.dontCloseDummyComment||this.beforeShowDummyComment||this.contComments.clearDummyComment()},onDocumentCanSaveChanged:function(t){var e=this.getApplication().getController("Toolbar").getView();if(e&&this.api&&!e._state.previewmode){var i=e.btnCollabChanges.cmpEl.hasClass("notify"),n=this.appOptions.forcesave,o=!t&&!i&&!n||this._state.isDisconnected||this._state.fastCoauth&&this._state.usersCount>1&&!n||!this.appOptions.isPDFEdit&&!this.appOptions.isPDFAnnotate;e.btnSave.setDisabled(o&&!this.appOptions.saveAlwaysEnabled)}},onContextMenu:function(t){var e=t.target.getAttribute("data-can-copy"),i=t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement;if(i&&"false"===e||!i&&"true"!==e)return t.stopPropagation(),t.preventDefault(),!1},onBeforeUnload:function(){if(Common.localStorage.save(),this.api.isDocumentModified()){var t=this;return this.api.asc_stopSaving(),this._state.unloadTimer=1e3,this.continueSavingTimer=window.setTimeout((function(){t.api.asc_continueSaving(),t._state.unloadTimer=0}),500),this.leavePageText}this._state.unloadTimer=1e4},onUnload:function(){this.continueSavingTimer&&clearTimeout(this.continueSavingTimer)},hidePreloader:function(){var t;this._state.customizationDone||(this._state.customizationDone=!0,this.appOptions.customization&&(this.appOptions.isDesktopApp?this.appOptions.customization.about=!1:this.appOptions.canBrandingExt||(this.appOptions.customization.about=!0)),Common.Utils.applyCustomization(this.appOptions.customization,n),this.appOptions.canBrandingExt&&(Common.Utils.applyCustomization(this.appOptions.customization,o),Common.UI.LayoutManager.applyCustomization(),this.appOptions.customization&&"object"==typeof this.appOptions.customization&&(void 0!==this.appOptions.customization.leftMenu&&console.log("Obsolete: The 'leftMenu' parameter of the 'customization' section is deprecated. Please use 'leftMenu' parameter in the 'customization.layout' section instead."),void 0!==this.appOptions.customization.statusBar&&console.log("Obsolete: The 'statusBar' parameter of the 'customization' section is deprecated. Please use 'statusBar' parameter in the 'customization.layout' section instead."),void 0!==this.appOptions.customization.toolbar&&console.log("Obsolete: The 'toolbar' parameter of the 'customization' section is deprecated. Please use 'toolbar' parameter in the 'customization.layout' section instead.")),t=this.getApplication().getController("Common.Controllers.Plugins").applyUICustomization())),Common.NotificationCenter.trigger("layout:changed","main"),(t||new Promise((function(t,e){t()}))).then((function(){$("#loading-mask").hide().remove(),Common.Controllers.Desktop.process("preloader:hide")}))},onDownloadUrl:function(t,e){this._state.isFromGatewayDownloadAs&&Common.Gateway.downloadAs(t,e),this._state.isFromGatewayDownloadAs=!1},onUpdateVersion:function(t){var e=this;e.needToUpdateVersion=!0,e.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,i),Common.UI.warning({title:e.titleUpdateVersion,msg:this.errorUpdateVersion,callback:function(){_.defer((function(){Common.Gateway.updateVersion(),t&&t.call(e),e.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,i)}))}})},onServerVersion:function(t){if(this.changeServerVersion)return!0;const e=this.getApplication().getController("LeftMenu").leftMenu.getMenu("about").txtVersionNum.match(/^(\d+.\d+.\d+)/);return!(window.compareVersions||e&&e[1]===t||(this.changeServerVersion=!0,Common.UI.warning({title:this.titleServerVersion,msg:this.errorServerVersion,callback:function(){_.defer((function(){Common.Gateway.updateVersion()}))}}),0))},onCollaborativeChanges:function(){this._state.hasCollaborativeChanges||(this._state.hasCollaborativeChanges=!0,this.appOptions.isEdit&&this.getApplication().getController("Statusbar").setStatusCaption(this.txtNeedSynchronize,!0))},synchronizeChanges:function(){this.getApplication().getController("Statusbar").synchronizeChanges(),this.getApplication().getController("DocumentHolder").hideTips(),this.getApplication().getController("Toolbar").getView().synchronizeChanges(),this._state.hasCollaborativeChanges=!1},unitsChanged:function(t){var e=Common.localStorage.getItem("pdfe-settings-unit");e=null!==e?parseInt(e):Common.Utils.Metric.getDefaultMetric(),Common.Utils.Metric.setCurrentMetric(e),Common.Utils.InternalSettings.set("pdfe-settings-unit",e),this.api.asc_SetDocumentUnits(e==Common.Utils.Metric.c_MetricUnits.inch?Asc.c_oAscDocumentUnits.Inch:e==Common.Utils.Metric.c_MetricUnits.pt?Asc.c_oAscDocumentUnits.Point:Asc.c_oAscDocumentUnits.Millimeter),this.getApplication().getController("Toolbar").getView().updateMetricUnit(),this.appOptions.canPreviewPrint&&this.getApplication().getController("Print").getView("PrintWithPreview").updateMetricUnit()},onAdvancedOptions:function(t,e,n,o){if(!this._state.openDlg){var s=this;t==Asc.c_oAscAdvancedOptionsID.DRM&&(s._state.openDlg=new Common.Views.OpenDialog({title:Common.Views.OpenDialog.prototype.txtTitleProtected,closeFile:s.appOptions.canRequestClose,type:Common.Utils.importTextType.DRM,warning:!(s.appOptions.isDesktopApp&&s.appOptions.isOffline)&&"string"==typeof e,warningMsg:e,validatePwd:!!s._state.isDRM,handler:function(e,i){s.isShowOpenDialog=!1,"ok"==e?s.api&&(s.api.asc_setAdvancedOptions(t,i.drmOptions),s.loadMask&&s.loadMask.show()):(Common.Gateway.requestClose(),Common.Controllers.Desktop.requestClose()),s._state.openDlg=null}}),s._state.isDRM=!0),s._state.openDlg&&(this.isShowOpenDialog=!0,this.loadMask&&this.loadMask.hide(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,i),s._state.openDlg.show())}},onTryUndoInFastCollaborative:function(){Common.localStorage.getBool("pdfe-hide-try-undoredo")||Common.UI.info({width:500,msg:this.appOptions.canChangeCoAuthoring?this.textTryUndoRedo:this.textTryUndoRedoWarn,iconCls:"info",buttons:this.appOptions.canChangeCoAuthoring?["custom","cancel"]:["ok"],primary:this.appOptions.canChangeCoAuthoring?"custom":"ok",customButtonText:this.textStrict,dontshow:!0,callback:_.bind((function(t,e){e&&Common.localStorage.setItem("pdfe-hide-try-undoredo",1),"custom"==t&&(Common.localStorage.setItem("pdfe-settings-coauthmode",0),Common.Utils.InternalSettings.set("pdfe-settings-coauthmode",!1),this.api.asc_SetFastCollaborative(!1),this._state.fastCoauth=!1,Common.localStorage.setItem("pdfe-settings-showchanges-strict","last"),this.api.SetCollaborativeMarksShowType(Asc.c_oAscCollaborativeMarksShowType.LastChanges)),this.onEditComplete()}),this)})},onAuthParticipantsChanged:function(t){var e=0;_.each(t,(function(t){t.asc_getView()||e++})),this._state.usersCount=e},onUserConnection:function(e){if(e&&this.appOptions.user.guest&&this.appOptions.canRenameAnonymous&&e.asc_getIdOriginal()==this.appOptions.user.id){var i=e.asc_getUserName();if(i&&i!==AscCommon.UserInfoParser.getCurrentName()){this._renameDialog&&this._renameDialog.close(),AscCommon.UserInfoParser.setCurrentName(i),t.setUserName(AscCommon.UserInfoParser.getParsedName(i));var n=i.lastIndexOf("("),o=i.lastIndexOf(")"),s=n>0&&n<o?i.substring(0,n-1):"";null!==Common.localStorage.getItem("guest-username")&&Common.localStorage.setItem("guest-username",s),Common.Utils.InternalSettings.set("guest-username",s)}}},applySettings:function(){if(this.appOptions.isPDFAnnotate||this.appOptions.isPDFEdit){if(this.appOptions.isEdit&&!this.appOptions.isOffline&&this.appOptions.canCoAuthoring){var t=this._state.fastCoauth;this._state.fastCoauth=Common.localStorage.getBool("pdfe-settings-coauthmode",!0),this._state.fastCoauth&&!t&&this.synchronizeChanges()}this.appOptions.canForcesave&&(this.appOptions.forcesave=Common.localStorage.getBool("pdfe-settings-forcesave",this.appOptions.canForcesave),Common.Utils.InternalSettings.set("pdfe-settings-forcesave",this.appOptions.forcesave),this.api.asc_setIsForceSaveOnUserSave(this.appOptions.forcesave))}},onDocumentName:function(e){t.setDocumentCaption(e),this.updateWindowTitle(!0)},onMeta:function(e){t.setDocumentCaption(e.title),this.updateWindowTitle(!0),this.document.title=e.title;var i=this.getApplication().getController("LeftMenu").getView("LeftMenu").getMenu("file");if(i.loadDocument({doc:this.document}),i.panels&&i.panels.info&&i.panels.info.updateInfo(this.document),Common.Gateway.metaChange(e),this.appOptions.wopi){var n=e.title.lastIndexOf(".");Common.Gateway.requestRename(n>0?e.title.substring(0,n):e.title)}},onPrint:function(){this.appOptions.canPrint&&!Common.Utils.ModalWindow.isVisible()&&(Common.NotificationCenter.trigger("file:print"),Common.component.Analytics.trackEvent("Print"))},onPrintUrl:function(t){if(this.iframePrint&&(this.iframePrint.parentNode.removeChild(this.iframePrint),this.iframePrint=null),!this.iframePrint){var e=this;this.iframePrint=document.createElement("iframe"),this.iframePrint.id="id-print-frame",this.iframePrint.style.display="none",this.iframePrint.style.visibility="hidden",this.iframePrint.style.position="fixed",this.iframePrint.style.right="0",this.iframePrint.style.bottom="0",document.body.appendChild(this.iframePrint),this.iframePrint.onload=function(){try{e.iframePrint.contentWindow.focus(),e.iframePrint.contentWindow.print(),e.iframePrint.contentWindow.blur(),window.focus()}catch(t){e.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF))}}}t&&(this.iframePrint.src=t)},onPrintQuick:function(){if(this.appOptions.canQuickPrint){var t=Common.localStorage.getBool("pdfe-hide-quick-print-warning"),e=this,i=function(){var t=new Asc.asc_CAdjustPrint;t.asc_setNativeOptions({quickPrint:!0});var i=new Asc.asc_CDownloadOptions;i.asc_setAdvancedOptions(t),e.api.asc_Print(i),Common.component.Analytics.trackEvent("Print")};t?i.call(this):Common.UI.warning({msg:this.textTryQuickPrint,buttons:["yes","no"],primary:"yes",dontshow:!0,maxwidth:500,callback:function(t,e){e&&Common.localStorage.setBool("pdfe-hide-quick-print-warning",!0),"yes"===t&&setTimeout(i,1)}})}},onClearDummyComment:function(){this.dontCloseDummyComment=!1},onShowDummyComment:function(){this.beforeShowDummyComment=!0},warningDocumentIsLocked:function(){var t=this;Common.Utils.warningDocumentIsLocked({disablefunc:function(e){t.disableEditing(e,!0)}})},showRenameUserDialog:function(){if(!this._renameDialog){var t=this;this._renameDialog=new Common.Views.UserNameDialog({label:this.textRenameLabel,error:this.textRenameError,value:Common.Utils.InternalSettings.get("guest-username")||"",check:Common.Utils.InternalSettings.get("save-guest-username")||!1,validation:function(e){return e.length<128||t.textLongName},handler:function(e,i){if("ok"==e){var n=i.input?i.input+" ("+t.appOptions.guestName+")":t.textAnonymous,o=new Asc.asc_CUserInfo;o.put_FullName(n);var s=new Asc.asc_CDocInfo;s.put_UserInfo(o),t.api.asc_changeDocInfo(s),i.checkbox?Common.localStorage.setItem("guest-username",i.input):Common.localStorage.removeItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",i.input),Common.Utils.InternalSettings.set("save-guest-username",i.checkbox)}}}),this._renameDialog.on("close",(function(){t._renameDialog=void 0})),this._renameDialog.show(Common.Utils.innerWidth()-this._renameDialog.options.width-15,30)}},onGrabFocus:function(){this.getApplication().getController("DocumentHolder").getView().focus()},onLanguageLoaded:function(){return!!Common.Locale.getCurrentLanguage()||(Common.UI.warning({msg:this.errorLang,buttons:[],closable:!1}),!1)},onConfirmAction:function(t,e,i){var n=this;t==Asc.c_oAscConfirm.ConfirmMaxChangesSize&&Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.confirmMaxChangesSize,buttons:[{value:"ok",caption:this.textUndo,primary:!0},{value:"cancel",caption:this.textContinue}],maxwidth:600,callback:_.bind((function(t){e&&e("ok"===t),n.onEditComplete()}),this)})},onLostEditRights:function(){this._readonlyRights=!0},changeAccessRights:function(t,e,i){if(!this._docAccessDlg&&!this._readonlyRights)if(this.appOptions.canRequestSharingSettings)Common.Gateway.requestSharingSettings();else{var n=this;n._docAccessDlg=new Common.Views.DocumentAccessDialog({settingsurl:this.appOptions.sharingSettingsUrl}),n._docAccessDlg.on("accessrights",(function(t,e){n.setSharingSettings({sharingSettings:e})})).on("close",(function(t){n._docAccessDlg=void 0})),n._docAccessDlg.show()}},setSharingSettings:function(t){t&&(this.document.info.sharingSettings=t.sharingSettings,Common.NotificationCenter.trigger("collaboration:sharingupdate",t.sharingSettings),Common.NotificationCenter.trigger("mentions:clearusers",this))},leavePageText:"You have unsaved changes in this document. Click 'Stay on this Page' then 'Save' to save them. Click 'Leave this Page' to discard all the unsaved changes.",criticalErrorTitle:"Error",notcriticalErrorTitle:"Warning",errorDefaultMessage:"Error code: %1",criticalErrorExtText:'Press "OK" to back to document list.',openTitleText:"Opening Document",openTextText:"Opening document...",loadFontsTitleText:"Loading Data",loadFontsTextText:"Loading data...",loadImagesTitleText:"Loading Images",loadImagesTextText:"Loading images...",loadFontTitleText:"Loading Data",loadFontTextText:"Loading data...",loadImageTitleText:"Loading Image",loadImageTextText:"Loading image...",downloadTitleText:"Downloading Document",downloadTextText:"Downloading document...",printTitleText:"Printing Document",printTextText:"Printing document...",uploadImageTitleText:"Uploading Image",uploadImageTextText:"Uploading image...",uploadImageSizeMessage:"Maximum image size limit exceeded.",uploadImageExtMessage:"Unknown image format.",uploadImageFileCountMessage:"No images uploaded.",reloadButtonText:"Reload Page",unknownErrorText:"Unknown error.",convertationTimeoutText:"Convertation timeout exceeded.",downloadErrorText:"Download failed.",unsupportedBrowserErrorText:"Your browser is not supported.",requestEditFailedTitleText:"Access denied",requestEditFailedMessageText:"Someone is editing this document right now. Please try again later.",txtNeedSynchronize:"You have an updates",textLoadingDocument:"Loading document",warnBrowserZoom:"Your browser's current zoom setting is not fully supported. Please reset to the default zoom by pressing Ctrl+0.",warnBrowserIE9:"The application has low capabilities on IE9. Use IE10 or higher",applyChangesTitleText:"Loading Data",applyChangesTextText:"Loading data...",errorKeyEncrypt:"Unknown key descriptor",errorKeyExpire:"Key descriptor expired",errorUsersExceed:"Count of users was exceed",errorCoAuthoringDisconnect:"Server connection lost. You can't edit anymore.",errorFilePassProtect:"The file is password protected and cannot be opened.",txtEditingMode:"Set editing mode...",textAnonymous:"Anonymous",loadingDocumentTitleText:"Loading document",loadingDocumentTextText:"Loading document...",warnProcessRightsChange:"You have been denied the right to edit the file.",errorProcessSaveResult:"Saving is failed.",textCloseTip:"Click to close the tip.",titleUpdateVersion:"Version changed",errorUpdateVersion:"The file version has been changed. The page will be reloaded.",errorUserDrop:"The file cannot be accessed right now.",errorConnectToServer:"The document could not be saved. Please check connection settings or contact your administrator.<br>When you click the 'OK' button, you will be prompted to download the document.",textTryUndoRedo:"The Undo/Redo functions are disabled for the Fast co-editing mode.<br>Click the 'Strict mode' button to switch to the Strict co-editing mode to edit the file without other users interference and send your changes only after you save them. You can switch between the co-editing modes using the editor Advanced settings.",textStrict:"Strict mode",textBuyNow:"Visit website",textNoLicenseTitle:"License limit reached",textContactUs:"Contact sales",errorViewerDisconnect:"Connection is lost. You can still view the document,<br>but will not be able to download or print until the connection is restored and page is reloaded.",warnLicenseExp:"Your license has expired.<br>Please update your license and refresh the page.",titleLicenseExp:"License expired",openErrorText:"An error has occurred while opening the file",saveErrorText:"An error has occurred while saving the file",errorToken:"The document security token is not correctly formed.<br>Please contact your Document Server administrator.",errorTokenExpire:"The document security token has expired.<br>Please contact your Document Server administrator.",errorSessionAbsolute:"The document editing session has expired. Please reload the page.",errorSessionIdle:"The document has not been edited for quite a long time. Please reload the page.",errorSessionToken:"The connection to the server has been interrupted. Please reload the page.",errorAccessDeny:"You are trying to perform an action you do not have rights for.<br>Please contact your Document Server administrator.",titleServerVersion:"Editor updated",errorServerVersion:"The editor version has been updated. The page will be reloaded to apply the changes.",textChangesSaved:"All changes saved",errorBadImageUrl:"Image url is incorrect",saveTextText:"Saving document...",saveTitleText:"Saving Document",errorForceSave:"An error occurred while saving the file. Please use the 'Download as' option to save the file to your computer hard drive or try again later.",warnNoLicense:"You've reached the limit for simultaneous connections to %1 editors. This document will be opened for viewing only.<br>Contact %1 sales team for personal upgrade terms.",warnNoLicenseUsers:"You've reached the user limit for %1 editors. Contact %1 sales team for personal upgrade terms.",warnLicenseExceeded:"You've reached the limit for simultaneous connections to %1 editors. This document will be opened for viewing only.<br>Contact your administrator to learn more.",warnLicenseUsersExceeded:"You've reached the user limit for %1 editors. Contact your administrator to learn more.",errorDataEncrypted:"Encrypted changes have been received, they cannot be deciphered.",textClose:"Close",textPaidFeature:"Paid feature",scriptLoadError:"The connection is too slow, some of the components could not be loaded. Please reload the page.",errorEditingSaveas:"An error occurred during the work with the document.<br>Use the 'Save as...' option to save the file backup copy to your computer hard drive.",errorEditingDownloadas:"An error occurred during the work with the document.<br>Use the 'Download as...' option to save the file backup copy to your computer hard drive.",textCustomLoader:"Please note that according to the terms of the license you are not entitled to change the loader.<br>Please contact our Sales Department to get a quote.",waitText:"Please, wait...",errorFileSizeExceed:"The file size exceeds the limitation set for your server.<br>Please contact your Document Server administrator for details.",uploadDocSizeMessage:"Maximum document size limit exceeded.",uploadDocExtMessage:"Unknown document format.",uploadDocFileCountMessage:"No documents uploaded.",errorUpdateVersionOnDisconnect:"Internet connection has been restored, and the file version has been changed.<br>Before you can continue working, you need to download the file or copy its content to make sure nothing is lost, and then reload this page.",errorDirectUrl:"Please verify the link to the document.<br>This link must be a direct link to the file for downloading.",warnLicenseLimitedRenewed:"License needs to be renewed.<br>You have a limited access to document editing functionality.<br>Please contact your administrator to get full access",warnLicenseLimitedNoAccess:"License expired.<br>You have no access to document editing functionality.<br>Please contact your administrator.",saveErrorTextDesktop:"This file cannot be saved or created.<br>Possible reasons are: <br>1. The file is read-only. <br>2. The file is being edited by other users. <br>3. The disk is full or corrupted.",errorSetPassword:"Password could not be set.",textRenameLabel:"Enter a name to be used for collaboration",textRenameError:"User name must not be empty.",textLongName:"Enter a name that is less than 128 characters.",textGuest:"Guest",txtClickToLoad:"Click to load image",leavePageTextOnClose:"All unsaved changes in this document will be lost.<br> Click 'Cancel' then 'Save' to save them. Click 'OK' to discard all the unsaved changes.",textTryUndoRedoWarn:"The Undo/Redo functions are disabled for the Fast co-editing mode.",textDisconnect:"Connection is lost",textReconnect:"Connection is restored",errorLang:"The interface language is not loaded.<br>Please contact your Document Server administrator.",errorLoadingFont:"Fonts are not loaded.<br>Please contact your Document Server administrator.",errorPasswordIsNotCorrect:"The password you supplied is not correct.<br>Verify that the CAPS LOCK key is off and be sure to use the correct capitalization.",confirmMaxChangesSize:'The size of actions exceeds the limitation set for your server.<br>Press "Undo" to cancel your last action or press "Continue" to keep action locally (you need to download the file or copy its content to make sure nothing is lost).',textUndo:"Undo",textContinue:"Continue",errorInconsistentExtDocx:"An error has occurred while opening the file.<br>The file content corresponds to text documents (e.g. docx), but the file has the inconsistent extension: %1.",errorInconsistentExtXlsx:"An error has occurred while opening the file.<br>The file content corresponds to spreadsheets (e.g. xlsx), but the file has the inconsistent extension: %1.",errorInconsistentExtPptx:"An error has occurred while opening the file.<br>The file content corresponds to presentations (e.g. pptx), but the file has the inconsistent extension: %1.",errorInconsistentExtPdf:"An error has occurred while opening the file.<br>The file content corresponds to one of the following formats: pdf/djvu/xps/oxps, but the file has the inconsistent extension: %1.",errorInconsistentExt:"An error has occurred while opening the file.<br>The file content does not match the file extension.",errorCannotPasteImg:"We can't paste this image from the Clipboard, but you can save it to your device and \ninsert it from there, or you can copy the image without text and paste it into the document.",textTryQuickPrint:"You have selected Quick print: the entire document will be printed on the last selected or default printer.<br>Do you want to continue?",textAnyone:"Anyone",textText:"Text",warnLicenseBefore:"License not active.<br>Please contact your administrator.",titleLicenseNotActive:"License not active",warnLicenseAnonymous:"Access denied for anonymous users. This document will be opened for viewing only.",txtSecurityWarningLink:'This document is trying to connect to {0}.<br>If you trust this site, press "OK" while holding down the ctrl key.',txtSecurityWarningOpenFile:'This document is trying to open file dialog, press "OK" to open.',txtInvalidGreaterLess:'Ivalid value for field "{0}": must be greater than or equal to {1} and less then or equal to {2}.',txtInvalidGreater:'Ivalid value for field "{0}": must be greater than or equal to {1}.',txtInvalidLess:'Ivalid value for field "{0}": must be less than or equal to {1}.',txtInvalidPdfFormat:'The value entered does not match the format of the field "{0}".',txtValidPdfFormat:'Field value should match format "{0}".',txtChoose:"Choose an item",txtEnterDate:"Enter a date",errorEmailClient:"No email client could be found"}),PDFE.Controllers.Main||{}))})),define("pdfeditor/main/app/controller/ViewTab",["core","pdfeditor/main/app/view/ViewTab"],(function(){"use strict";PDFE.Controllers.ViewTab=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["ViewTab"],sdkViewName:"#id_main",initialize:function(){},onLaunch:function(){this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("contenttheme:dark",this.onContentThemeChangedToDark.bind(this)),Common.NotificationCenter.on("uitheme:changed",this.onThemeChanged.bind(this)),Common.NotificationCenter.on("document:ready",_.bind(this.onDocumentReady,this))},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onZoomChange",_.bind(this.onZoomChange,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))),this},setConfig:function(t){var e=t.mode;this.toolbar=t.toolbar,this.view=this.createView("ViewTab",{toolbar:this.toolbar.toolbar,mode:e,compactToolbar:this.toolbar.toolbar.isCompactView}),this.addListeners({ViewTab:{"zoom:topage":_.bind(this.onBtnZoomTo,this,"topage"),"zoom:towidth":_.bind(this.onBtnZoomTo,this,"towidth"),"darkmode:change":_.bind(this.onChangeDarkMode,this)},Toolbar:{"view:compact":_.bind((function(t,e){this.view.chToolbar.setValue(!e,!0)}),this)},Statusbar:{"view:hide":_.bind((function(t,e){this.view.chStatusbar.setValue(!e,!0)}),this)},LeftMenu:{"view:hide":_.bind((function(t,e){this.view.chLeftMenu.setValue(!e,!0)}),this)}})},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onCoAuthoringDisconnect:function(){Common.Utils.lockControls(Common.enumLock.lostConnect,!0,{array:this.view.lockedControls})},onAppReady:function(t){var e=this;e.view&&new Promise((function(t,e){t()})).then((function(){e.view.setEvents(),Common.UI.Themes.available()||(e.view.btnInterfaceTheme.$el.closest(".group").remove(),e.view.$el.find(".separator-theme").remove());var i=[];if((t.canBrandingExt&&t.customization&&!1===t.customization.statusBar||!Common.UI.LayoutManager.isElementVisible("statusBar"))&&(i.push(e.view.chStatusbar.$el.closest(".elset")),e.view.chStatusbar.$el.remove()),t.canBrandingExt&&t.customization&&!1===t.customization.leftMenu||!Common.UI.LayoutManager.isElementVisible("leftMenu")?(i.push(e.view.chLeftMenu.$el.closest(".elset")),e.view.chLeftMenu.$el.remove()):i.length>0&&(i.push(e.view.chLeftMenu.$el.closest(".elset")),i.shift().append(e.view.chLeftMenu.$el[0])),i.length>1&&i[i.length-1].closest(".group").remove(),e.view.cmbsZoom.forEach((function(t){t.on("selected",_.bind(e.onSelectedZoomValue,e)).on("changed:before",_.bind(e.onZoomChanged,e,!0)).on("changed:after",_.bind(e.onZoomChanged,e,!1)).on("combo:blur",_.bind(e.onComboBlur,e,!1))})),e.getApplication().getController("LeftMenu").leftMenu.btnNavigation.on("toggle",(function(t,i){i!==e.view.btnNavigation.pressed&&e.view.turnNavigation(i)})),Common.UI.Themes.available()){function n(){var t=this.view.btnInterfaceTheme;"object"==typeof t.menu?t.menu.removeAll():t.setMenu(new Common.UI.Menu);var e=Common.UI.Themes.currentThemeId()||Common.UI.Themes.defaultThemeId();for(var i in Common.UI.Themes.map())t.menu.addItem({value:i,caption:Common.UI.Themes.get(i).text,checked:i===e,checkable:!0,toggleGroup:"interface-theme"})}Common.NotificationCenter.on("uitheme:countchanged",n.bind(e)),n.call(e),e.view.btnInterfaceTheme.menu.items.length&&(e.view.btnInterfaceTheme.menu.on("item:click",_.bind((function(t,i){var n=i.value;Common.UI.Themes.setTheme(n),Common.Utils.lockControls(Common.enumLock.inLightTheme,!Common.UI.Themes.isDarkTheme(),{array:[e.view.btnDarkDocument]})}),e)),setTimeout((function(){e.onContentThemeChangedToDark(Common.UI.Themes.isContentThemeDark()),Common.Utils.lockControls(Common.enumLock.inLightTheme,!Common.UI.Themes.isDarkTheme(),{array:[e.view.btnDarkDocument]})}),0))}}))},onDocumentReady:function(){Common.Utils.lockControls(Common.enumLock.disableOnStart,!1,{array:this.view.lockedControls})},onZoomChange:function(t,e){this.view.btnsFitToPage.forEach((function(t){t.toggle(2===e,!0)})),this.view.btnsFitToWidth.forEach((function(t){t.toggle(1===e,!0)})),this.setZoomValue(t),this._state.zoomValue=t},applyZoom:function(t){var e=Math.max(10,Math.min(500,t));this._state.zoomValue===e&&this.setZoomValue(this._state.zoomValue),this.api.zoom(e),Common.NotificationCenter.trigger("edit:complete",this.view)},onSelectedZoomValue:function(t,e){this.applyZoom(e.value)},onZoomChanged:function(t,e,i,n){var o=parseFloat(i.value);t?new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*(%)?\\s*$").exec(i.value)||(this.setZoomValue(this._state.zoomValue),Common.NotificationCenter.trigger("edit:complete",this.view)):this._state.zoomValue===o||isNaN(o)?i.value!==this._state.zoomValue+"%"&&this.setZoomValue(this._state.zoomValue):this.applyZoom(o)},setZoomValue:function(t){this.view&&this.view.cmbsZoom&&this.view.cmbsZoom.forEach((function(e){e.setValue(t,t+"%")}))},onBtnZoomTo:function(t,e){var i;i="topage"===t?"zoomFitToPage":"zoomFitToWidth",e&&!e.pressed?this.api.zoomCustomMode():this.api[i](),Common.NotificationCenter.trigger("edit:complete",this.view)},onChangeDarkMode:function(){Common.UI.Themes.toggleContentTheme()},onContentThemeChangedToDark:function(t){this.view&&this.view.btnDarkDocument.toggle(t,!0)},onThemeChanged:function(){if(this.view&&Common.UI.Themes.available()){var t=Common.UI.Themes.currentThemeId()||Common.UI.Themes.defaultThemeId(),e=_.findWhere(this.view.btnInterfaceTheme.menu.items,{value:t});e&&(this.view.btnInterfaceTheme.menu.clearAll(),e.setChecked(!0,!0)),Common.Utils.lockControls(Common.enumLock.inLightTheme,!Common.UI.Themes.isDarkTheme(),{array:[this.view.btnDarkDocument]})}},onComboBlur:function(){Common.NotificationCenter.trigger("edit:complete",this.view)}},PDFE.Controllers.ViewTab||{}))})),define("text!common/main/lib/template/SearchPanel.template",[],(function(){return'<div id="search-box" class="layout-ct vbox search-panel">\n    <div id="search-header">\n        <label id="search-adv-title"></label>\n        <div id="search-btn-close" class="float-right"></div>\n    </div>\n    <div id="search-container">\n    <div id="search-adv-settings">\n        <table cols="1">\n            <tbody>\n                <tr>\n                    <td class="padding-small"><div id="search-adv-text"></div></td>\n                </tr>\n                <tr class="edit-setting">\n                    <td class="padding-large"><div id="search-adv-replace-text"></div></td>\n                </tr>\n                <tr>\n                    <td class="padding-large">\n                        <label id="search-adv-results-number" style="display: inline-block;">\n                            <%= scope.textSearchResults %>\n                        </label>\n                        <div class="search-nav-btns float-right">\n                            <div id="search-adv-back"></div>\n                            <div id="search-adv-next"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr class="edit-setting">\n                    <td class="padding-large">\n                       <button type="button" class="btn btn-text-default" id="search-adv-replace" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textReplace %></button>\n                       <button type="button" class="btn btn-text-default" id="search-adv-replace-all" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textReplaceAll %></button>\n                    </td>\n                </tr>\n                <tr class="search-options-block">\n                    <td class="padding-large">\n                        <div id="open-search-options" data-hint="1" data-hint-direction="left" data-hint-offset="0, -15">\n                            <div class="search-options-caret img-commonctrl"></div>\n                            <div class="search-options-txt"><%= scope.textSearchOptions %></div>\n                        </div>\n                        <div id="search-options">\n                            <label class="input-label"><%= scope.textWithin %></label>\n                            <div id="search-adv-cmb-within"></div>\n                            <div id="search-adv-select-range"></div>\n                            <label class="input-label"><%= scope.textSearch %></label>\n                            <div id="search-adv-cmb-search"></div>\n                            <label class="input-label"><%= scope.textLookIn %></label>\n                            <div id="search-adv-cmb-look-in"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="padding-small"><div id="search-adv-case-sensitive"></div></td>\n                </tr>\n                \x3c!---<tr>\n                    <td class="padding-small"><div id="search-adv-use-regexp"></div></td>\n                </tr>--\x3e\n                <tr>\n                    <td class="padding-large"><div id="search-adv-match-word"></div></td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    <div id="search-results" class="ps-container oo">\n    </div>\n    </div>\n</div>'})),define("common/main/lib/view/SearchPanel",["text!common/main/lib/template/SearchPanel.template","common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],(function(t){"use strict";Common.Views.SearchPanel=Common.UI.BaseView.extend(_.extend({el:"#left-panel-search",template:_.template(t),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments),this.mode=!1,window.SSE&&(this.extendedOptions=Common.localStorage.getBool("sse-search-options-extended",!0))},render:function(t){var e=this;if(!this.rendered){if(t=t||this.el,$(t).html(this.template({scope:this})),this.$el=$(t),this.inputText=new Common.UI.InputField({el:$("#search-adv-text"),placeHolder:this.textFind,allowBlank:!0,validateOnBlur:!1,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.inputText._input.on("input",_.bind((function(){this.fireEvent("search:input",[this.inputText._input.val()])}),this)).on("keydown",_.bind((function(t){this.fireEvent("search:keydown",[this.inputText._input.val(),t])}),this)),this.inputReplace=new Common.UI.InputField({el:$("#search-adv-replace-text"),placeHolder:this.textReplaceWith,allowBlank:!0,validateOnBlur:!1,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.inputReplace._input.on("keydown",_.bind((function(t){t.keyCode!==Common.UI.Keys.RETURN||this.btnReplace.isDisabled()||this.onReplaceClick("replace")}),this)),this.btnBack=new Common.UI.Button({parentEl:$("#search-adv-back"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-up",hint:this.tipPreviousResult,dataHint:"1",dataHintDirection:"bottom"}),this.btnBack.on("click",_.bind(this.onBtnNextClick,this,"back")),this.btnNext=new Common.UI.Button({parentEl:$("#search-adv-next"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-down",hint:this.tipNextResult,dataHint:"1",dataHintDirection:"bottom"}),this.btnNext.on("click",_.bind(this.onBtnNextClick,this,"next")),this.btnReplace=new Common.UI.Button({el:$("#search-adv-replace")}),this.btnReplace.on("click",_.bind(this.onReplaceClick,this,"replace")),this.btnReplaceAll=new Common.UI.Button({el:$("#search-adv-replace-all")}),this.btnReplaceAll.on("click",_.bind(this.onReplaceClick,this,"replaceall")),this.$reaultsNumber=$("#search-adv-results-number"),this.updateResultsNumber("no-results"),this.chCaseSensitive=new Common.UI.CheckBox({el:$("#search-adv-case-sensitive"),labelText:this.textCaseSensitive,value:!1,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t){e.fireEvent("search:options",["case-sensitive","checked"===t.getValue()])})),this.chMatchWord=new Common.UI.CheckBox({el:$("#search-adv-match-word"),labelText:window.SSE?this.textItemEntireCell:this.textWholeWords,value:!1,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t){e.fireEvent("search:options",["match-word","checked"===t.getValue()])})),this.buttonClose=new Common.UI.Button({parentEl:$("#search-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textCloseSearch,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.$resultsContainer=$("#search-results"),this.$resultsContainer.hide(),this.$searchContainer=$("#search-container"),this.$searchContainer.scroller=new Common.UI.Scroller({el:$("#search-container"),useKeyboard:!0,minScrollbarLength:40}),Common.NotificationCenter.on("search:updateresults",_.bind(this.disableNavButtons,this)),window.SSE){this.cmbWithin=new Common.UI.ComboBox({el:$("#search-adv-cmb-within"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textSheet},{value:1,displayValue:this.textWorkbook},{value:2,displayValue:this.textSpecificRange}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.fireEvent("search:options",["within",i.value])})),this.inputSelectRange=new Common.UI.InputFieldBtn({el:$("#search-adv-select-range"),placeHolder:this.textSelectDataRange,allowBlank:!0,validateOnChange:!0,validateOnBlur:!0,style:"width: 219px; margin-top: 8px",disabled:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("keyup:after",(function(t,i){e.fireEvent("search:options",["range",t.getValue(),i.keyCode!==Common.UI.Keys.RETURN])})),this.inputSelectRange.$el.hide(),this.cmbSearch=new Common.UI.ComboBox({el:$("#search-adv-cmb-search"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textByRows},{value:1,displayValue:this.textByColumns}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.fireEvent("search:options",["search",!i.value])})),this.cmbLookIn=new Common.UI.ComboBox({el:$("#search-adv-cmb-look-in"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textFormulas},{value:1,displayValue:this.textValues}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.fireEvent("search:options",["lookIn",!i.value])})),this.$searchOptionsBlock=$(".search-options-block"),this.$searchOptionsBlock.show(),$("#open-search-options").on("click",_.bind(this.expandSearchOptions,this)),this.extendedOptions||this.$searchOptionsBlock.addClass("no-expand"),this.cmbWithin.setValue(0),this.cmbSearch.setValue(0),this.cmbLookIn.setValue(0);var i='<div class="search-table"><div class="header-items"><div class="header-item">'+this.textSheet+'</div><div class="header-item">'+this.textName+'</div><div class="header-item">'+this.textCell+'</div><div class="header-item">'+this.textValue+'</div><div class="header-item">'+this.textFormula+'</div></div><div class="ps-container oo search-items"></div></div>',n=$(i).appendTo(this.$resultsContainer);this.$resultsContainer.scroller=new Common.UI.Scroller({el:n.find(".search-items"),includePadding:!0,useKeyboard:!0,minScrollbarLength:40,alwaysVisibleY:!0}),this.$resultsTable=this.$resultsContainer.find(".search-table")}else this.$resultsContainer.scroller=new Common.UI.Scroller({el:this.$resultsContainer,includePadding:!0,useKeyboard:!0,minScrollbarLength:40,alwaysVisibleY:!0});Common.NotificationCenter.on("window:resize",(function(){e.updateResultsContainerHeight()}))}return this.rendered=!0,this.trigger("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this),this.updateResultsContainerHeight()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},focus:function(t){var e=this,i="replace"===t?e.inputReplace.$el:"range"===t?e.inputSelectRange.$el:e.inputText.$el;setTimeout((function(){i.find("input").focus(),i.find("input").select()}),10)},setSearchMode:function(t){this.mode!==t&&(this.$el.find(".edit-setting")["no-replace"!==t?"show":"hide"](),this.$el.find("#search-adv-title").text("no-replace"!==t?this.textFindAndReplace:this.textFind),this.mode=t)},ChangeSettings:function(t){},updateScrollers:function(){this.$resultsContainer.scroller.update({alwaysVisibleY:!0}),this.$searchContainer.scroller.update({alwaysVisibleY:!0}),setTimeout(_.bind((function(){this.$searchContainer.find("> .ps-scrollbar-y-rail").is(":visible")?this.$resultsContainer.find(".ps-scrollbar-y-rail").addClass("set-left"):this.$resultsContainer.find(".ps-scrollbar-y-rail").removeClass("set-left")}),this),100)},updateResultsContainerHeight:function(){this.$resultsContainer&&(this.$resultsContainer.outerHeight(Math.max($("#search-box").outerHeight()-$("#search-header").outerHeight()-$("#search-adv-settings").outerHeight(),112)),this.updateScrollers())},updateResultsNumber:function(t,e){var i;if(this.$resultsContainer&&"content-changed"!==t&&"replace-all"!==t&&"replace"!==t&&(e>300?this.showToManyResults():(this.$resultsContainer.find(".many-results").remove(),window.SSE&&this.$resultsTable.show())),i="no-results"===t?this.textNoSearchResults:"stop"===t?this.textSearchHasStopped:"content-changed"===t?this.textContentChanged+" "+Common.Utils.String.format(this.textSearchAgain,'<a class="search-again">',"</a>"):"replace-all"===t?Common.Utils.String.format(this.textItemsSuccessfullyReplaced,e):"replace"===t?Common.Utils.String.format(this.textPartOfItemsNotReplaced,e[0],e[1],e[2]):e?Common.Utils.String.format(this.textSearchResults,t+1,e):this.textNoMatches,"content-changed"===t){var n=this;this.$reaultsNumber.html(i),this.$reaultsNumber.find(".search-again").on("click",(function(){n.fireEvent("search:next",[n.inputText.getValue(),!0])}))}else this.$reaultsNumber.text(i);this.updateResultsContainerHeight(),!window.SSE&&this.disableReplaceButtons(!e)},showToManyResults:function(){window.SSE?(this.$resultsTable.hide(),this.$resultsTable.find(".search-items").empty(),this.$resultsContainer.find(".many-results").remove()):this.$resultsContainer.empty(),this.$resultsContainer.append('<div class="many-results">'+this.textTooManyResults+"</div>"),this.$resultsContainer.is(":visible")||this.$resultsContainer.show()},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide"),this.fireEvent("hide",this)},onBtnNextClick:function(t){this.fireEvent("search:"+t,[this.inputText.getValue(),!0])},onReplaceClick:function(t){this.fireEvent("search:"+t,[this.inputText.getValue(),this.inputReplace.getValue()])},getSettings:function(){return{textsearch:this.inputText.getValue(),matchcase:this.chCaseSensitive.checked,matchword:this.chMatchWord.checked}},expandSearchOptions:function(){this.extendedOptions=!this.extendedOptions,this.$searchOptionsBlock[this.extendedOptions?"removeClass":"addClass"]("no-expand"),Common.localStorage.setBool("sse-search-options-extended",this.extendedOptions),this.updateResultsContainerHeight()},setFindText:function(t){this.inputText.setValue(t)},clearResultsNumber:function(){this.updateResultsNumber("no-results")},disableNavButtons:function(t,e){var i=""===this.inputText._input.val()&&!window.SSE||!e;this.btnBack.setDisabled(i),this.btnNext.setDisabled(i)},disableReplaceButtons:function(t){this.btnReplace.setDisabled(t),this.btnReplaceAll.setDisabled(t)},textFind:"Find",textFindAndReplace:"Find and replace",textCloseSearch:"Close search",textReplace:"Replace",textReplaceAll:"Replace All",textSearchResults:"Search results: {0}/{1}",textReplaceWith:"Replace with",textCaseSensitive:"Case sensitive",textMatchUsingRegExp:"Match using regular expressions",textWholeWords:"Whole words only",textWithin:"Within",textSelectDataRange:"Select Data range",textSearch:"Search",textLookIn:"Look in",textSheet:"Sheet",textWorkbook:"Workbook",textSpecificRange:"Specific range",textByRows:"By rows",textByColumns:"By columns",textFormulas:"Formulas",textValues:"Values",textSearchOptions:"Search options",textNoMatches:"No matches",textNoSearchResults:"No search results",textItemEntireCell:"Entire cell contents",textTooManyResults:"There are too many results to show here",tipPreviousResult:"Previous result",tipNextResult:"Next result",textName:"Name",textCell:"Cell",textValue:"Value",textFormula:"Formula",textSearchHasStopped:"Search has stopped",textContentChanged:"Document changed.",textSearchAgain:"{0}Perform new search{1} for accurate results.",textItemsSuccessfullyReplaced:"{0} items successfully replaced.",textPartOfItemsNotReplaced:"{0}/{1} items replaced. Remaining {2} items are locked by other users."},Common.Views.SearchPanel||{}))})),define("pdfeditor/main/app/controller/Search",["core","common/main/lib/view/SearchPanel"],(function(){"use strict";PDFE.Controllers.Search=Backbone.Controller.extend(_.extend({sdkViewName:"#id_main",views:["Common.Views.SearchPanel"],initialize:function(){this.addListeners({SearchBar:{"search:back":_.bind(this.onSearchNext,this,"back"),"search:next":_.bind(this.onSearchNext,this,"next"),"search:input":_.bind((function(t){this._state.searchText!==t?this.onInputSearchChange(t):Common.NotificationCenter.trigger("search:updateresults",this._state.currentResult,this._state.resultsNumber)}),this),"search:keydown":_.bind(this.onSearchNext,this,"keydown"),show:_.bind(this.onSelectSearchingResults,this,!0),hide:_.bind(this.onSelectSearchingResults,this,!1)},"Common.Views.SearchPanel":{"search:back":_.bind(this.onSearchNext,this,"back"),"search:next":_.bind(this.onSearchNext,this,"next"),"search:replace":_.bind(this.onQueryReplace,this),"search:replaceall":_.bind(this.onQueryReplaceAll,this),"search:input":_.bind(this.onInputSearchChange,this),"search:options":_.bind(this.onChangeSearchOption,this),"search:keydown":_.bind(this.onSearchNext,this,"keydown"),show:_.bind(this.onShowPanel,this),hide:_.bind(this.onHidePanel,this)},LeftMenu:{"search:aftershow":_.bind(this.onShowAfterSearch,this)}})},onLaunch:function(){this._state={searchText:"",matchCase:!1,matchWord:!1,useRegExp:!1,isHighlightedResults:!1,isContentChanged:!1}},setMode:function(t){this.view=this.createView("Common.Views.SearchPanel",{mode:t})},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onSetSearchCurrent",_.bind(this.onUpdateSearchCurrent,this)),this.api.asc_registerCallback("asc_onStartTextAroundSearch",_.bind(this.onStartTextAroundSearch,this)),this.api.asc_registerCallback("asc_onEndTextAroundSearch",_.bind(this.onEndTextAroundSearch,this)),this.api.asc_registerCallback("asc_onGetTextAroundSearchPack",_.bind(this.onApiGetTextAroundSearch,this)),this.api.asc_registerCallback("asc_onRemoveTextAroundSearch",_.bind(this.onApiRemoveTextAroundSearch,this)),this.api.asc_registerCallback("asc_onSearchEnd",_.bind(this.onApiSearchEnd,this)),this.api.asc_registerCallback("asc_onReplaceAll",_.bind(this.onApiTextReplaced,this))),this},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},checkPunctuation:function(t){if(t){for(var e=!1,i=0;i<t.length;i++){var n=t.charCodeAt(i),o=t.charAt(i);if(AscCommon.IsPunctuation(n)||""===o.trim()){e=!0;break}}e?(this._state.matchWord&&(this.view.chMatchWord.setValue(!1,!0),this._state.matchWord=!1),this.view.chMatchWord.setDisabled(!0)):this.view.chMatchWord.isDisabled()&&this.view.chMatchWord.setDisabled(!1)}},onChangeSearchOption:function(t,e){switch(t){case"case-sensitive":this._state.matchCase=e;break;case"match-word":this._state.matchWord=e;break;case"regexp":this._state.useRegExp=e}this._state.searchText&&this.onQuerySearch()},onSearchNext:function(t,e,i){var n="keydown"===t&&i.keyCode===Common.UI.Keys.RETURN;e&&e.length>0&&(n||"keydown"!==t)&&(this.checkPunctuation(e),this._state.searchText=e,this.onQuerySearch(t,!(this.searchTimer||n)))},onInputSearchChange:function(t){var e=this;(t&&this._state.searchText!==t||!t&&this._state.newSearchText)&&(this._state.newSearchText=t,this._lastInputChange=new Date,void 0===this.searchTimer&&(this.searchTimer=setInterval((function(){new Date-e._lastInputChange<400||(e.checkPunctuation(e._state.newSearchText),e._state.searchText=e._state.newSearchText,""!==e._state.newSearchText&&e.onQuerySearch()||""!==e._state.newSearchText||(e.api.asc_endFindText(),e.view.updateResultsNumber("no-results"),e.hideResults(),e.view.disableNavButtons(),e.view.disableReplaceButtons(!0),clearInterval(e.searchTimer),e.searchTimer=void 0,Common.NotificationCenter.trigger("search:updateresults")))}),10)))},onQuerySearch:function(t,e){var i=!e||this._state.isContentChanged;this._state.isContentChanged=!1,this.searchTimer&&clearInterval(this.searchTimer),this.searchTimer=void 0,i&&this.hideResults();var n=new AscCommon.CSearchSettings;return n.put_Text(this._state.searchText),n.put_MatchCase(this._state.matchCase),n.put_WholeWords(this._state.matchWord),this.api.asc_findText(n,"back"!=t)?(i&&this.view.$el.is(":visible")&&0===this.view.$resultsContainer.find(".many-results").length&&this.api.asc_StartTextAroundSearch(),this.view.disableReplaceButtons(!1),!0):(this.resultItems=[],this.view.updateResultsNumber(void 0,0),this.hideResults(),this.view.disableReplaceButtons(!0),this._state.currentResult=0,this._state.resultsNumber=0,this.view.disableNavButtons(),Common.NotificationCenter.trigger("search:updateresults"),!1)},onQueryReplace:function(t,e){if(""!==t){var i=this,n=this.api.asc_GetErrorForReplaceString(e);if(n)return void setTimeout((function(){Common.UI.warning({title:i.notcriticalErrorTitle,msg:Common.Utils.String.format(i.warnReplaceString,n),buttons:["ok"],callback:function(){i.view.focus("replace")}})}),1);var o=new AscCommon.CSearchSettings;o.put_Text(t),o.put_MatchCase(this._state.matchCase),o.put_WholeWords(this._state.matchWord),this.api.asc_replaceText(o,e,!1)||this.removeResultItems()}},onQueryReplaceAll:function(t,e){if(""!==t){var i=this,n=this.api.asc_GetErrorForReplaceString(e);if(n)return void setTimeout((function(){Common.UI.warning({title:i.notcriticalErrorTitle,msg:Common.Utils.String.format(i.warnReplaceString,n),buttons:["ok"],callback:function(){i.view.focus("replace")}})}),1);var o=new AscCommon.CSearchSettings;o.put_Text(t),o.put_MatchCase(this._state.matchCase),o.put_WholeWords(this._state.matchWord),this.api.asc_replaceText(o,e,!0),this.removeResultItems("replace-all")}},removeResultItems:function(t){this.resultItems=[],"replace-all"!==t&&this.view.updateResultsNumber(t,0),this.hideResults(),this.view.disableReplaceButtons(!0),this._state.currentResult=0,this._state.resultsNumber=0,this.view.disableNavButtons()},onUpdateSearchCurrent:function(t,e){-1!==t&&(this._state.currentResult=t,this._state.resultsNumber=e,this.view&&(this.view.updateResultsNumber(t,e),this.view.disableNavButtons(t,e),this.resultItems&&this.resultItems.length>0&&(this.resultItems.forEach((function(t){t.selected=!1})),this.resultItems[t]&&(this.resultItems[t].selected=!0,$("#search-results").find(".item").removeClass("selected"),$(this.resultItems[t].el).addClass("selected"),this.scrollToSelectedResult(t)))),Common.NotificationCenter.trigger("search:updateresults",t,e))},scrollToSelectedResult:function(t){var e=void 0!==t?t:_.findIndex(this.resultItems,{selected:!0});if(-1!==e){var i=this.resultItems[e].$el,n=i.outerHeight(),o=i.position().top,s=this.view.$resultsContainer,a=s.outerHeight(),r=s.scrollTop();o<0||0===r&&o>a?s.scroller.scrollTop(r+o-12):o+n>a&&s.scroller.scrollTop(r+n)}},onStartTextAroundSearch:function(){this.view&&(this._state.isStartedAddingResults=!0)},onEndTextAroundSearch:function(){this.view&&this.view.updateScrollers()},onApiGetTextAroundSearch:function(t){if(this.view&&this._state.isStartedAddingResults){if(this._state.isStartedAddingResults=!1,t.length>300||!t.length)return;var e,i=this;i.resultItems=[],t.forEach((function(t,n){var o=document.createElement("div"),s=n===i._state.currentResult;o.className="item";for(var a="",r=0,l=t[1].length;r<l;++r)a+=1==r?"<b>"+Common.Utils.String.htmlEncode(t[1][r])+"</b>":Common.Utils.String.htmlEncode(t[1][r]);o.innerHTML=a.trim(),i.view.$resultsContainer.append(o),s&&($(o).addClass("selected"),e=n);var c={id:t[0],$el:$(o),el:o,selected:s};i.resultItems.push(c),$(o).on("click",_.bind((function(e){if(i._state.isContentChanged)i.onQuerySearch();else{var n=t[0];i.api.asc_SelectSearchElement(n)}}),i))})),this.view.$resultsContainer.show(),this.scrollToSelectedResult(e)}},onApiRemoveTextAroundSearch:function(t){var e=this;t.forEach((function(t){var i=_.findIndex(e.resultItems,{id:t});-1!==i&&(e.resultItems[i].$el.remove(),e.resultItems.splice(i,1))}))},hideResults:function(){this.view&&(0===this.view.$resultsContainer.find(".many-results").length&&this.view.$resultsContainer.hide(),this.view.$resultsContainer.find(".item").remove())},onShowAfterSearch:function(t){var e=this.getApplication().getController("Viewport");e.isSearchBarVisible()&&e.searchBar.hide();var i=this.api.asc_GetSelectedText(),n="string"==typeof t?t:i&&i.trim()||this._state.searchText;this.checkPunctuation(n),this.resultItems&&this.resultItems.length>0&&(!this._state.matchCase&&n&&n.toLowerCase()===this.view.inputText.getValue().toLowerCase()||this._state.matchCase&&n===this.view.inputText.getValue())||(n?this.view.setFindText(n):void 0!==n&&(this.view.setFindText(""),this._state.searchText=void 0),this.hideResults(),n&&""!==n&&n===this._state.searchText?(this.view.disableReplaceButtons(!1),0===this.view.$resultsContainer.find(".many-results").length&&this.api.asc_StartTextAroundSearch()):n&&""!==n?this.onInputSearchChange(n):(this.resultItems=[],this.view.disableReplaceButtons(!0),this.view.clearResultsNumber()),this.view.disableNavButtons(this._state.currentResult,this._state.resultsNumber))},onShowPanel:function(){if(this.onSelectSearchingResults(!0),this.resultItems&&this.resultItems.length>0&&!this._state.isStartedAddingResults){var t=this;this.view.$resultsContainer.show(),this.resultItems.forEach((function(e){t.view.$resultsContainer.append(e.el),$(e.el)[e.selected?"addClass":"removeClass"]("selected"),$(e.el).on("click",(function(i){t.api.asc_SelectSearchElement(e.id),$("#search-results").find(".item").removeClass("selected"),$(i.currentTarget).addClass("selected")}))})),this.scrollToSelectedResult()}},onHidePanel:function(){this.hideResults(),this.onSelectSearchingResults(!1)},onSelectSearchingResults:function(t){!t&&this.getApplication().getController("LeftMenu").isSearchPanelVisible()||this._state.isHighlightedResults!==t&&(this.api.asc_selectSearchingResults(t),this._state.isHighlightedResults=t)},onApiSearchEnd:function(){this._state.isContentChanged||(this._state.isContentChanged=!0,this.view.updateResultsNumber("content-changed"),this.view.disableReplaceButtons(!0))},onApiTextReplaced:function(t,e){t?t-e>0?this.view.updateResultsNumber("replace",[e,t,t-e]):this.view.updateResultsNumber("replace-all",e):Common.UI.info({msg:this.textNoTextFound})},getSearchText:function(){return this._state.searchText},getResultsNumber:function(){return[this._state.currentResult,this._state.resultsNumber]},notcriticalErrorTitle:"Warning",warnReplaceString:"{0} is not a valid special character for the Replace With box.",textReplaceSuccess:"Search has been done. {0} occurrences have been replaced",textReplaceSkipped:"The replacement has been made. {0} occurrences were skipped.",textNoTextFound:"The data you have been searching for could not be found. Please adjust your search options."},PDFE.Controllers.Search||{}))})),define("common/main/lib/view/DocumentAccessDialog",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],(function(){"use strict";Common.Views.DocumentAccessDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:600,height:536,header:!0},t),this.template=['<div id="id-sharing-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.settingsurl=t.settingsurl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=500,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-sharing-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-sharing-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.settingsurl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(t.needUpdate&&this.trigger("accessrights",this,t.sharingSettings),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Sharing Settings",textLoading:"Loading"},Common.Views.DocumentAccessDialog||{}))})),define("pdfeditor/main/app/view/FileMenuPanels",["common/main/lib/view/DocumentAccessDialog"],(function(){"use strict";!PDFE.Views.FileMenuPanels&&(PDFE.Views.FileMenuPanels={}),PDFE.Views.FileMenuPanels.ViewSaveAs=Common.UI.BaseView.extend({el:"#panel-saveas",menu:void 0,formats:[[{name:"DOCX",imgCls:"docx",type:Asc.c_oAscFileType.DOCX},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF},{name:"ODT",imgCls:"odt",type:Asc.c_oAscFileType.ODT}],[{name:"DOTX",imgCls:"dotx",type:Asc.c_oAscFileType.DOTX},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA},{name:"OTT",imgCls:"ott",type:Asc.c_oAscFileType.OTT}],[{name:"RTF",imgCls:"rtf",type:Asc.c_oAscFileType.RTF},{name:"TXT",imgCls:"txt",type:Asc.c_oAscFileType.TXT},{name:"FB2",imgCls:"fb2",type:Asc.c_oAscFileType.FB2},{name:"EPUB",imgCls:"epub",type:Asc.c_oAscFileType.EPUB},{name:"HTML (Zipped)",imgCls:"html",type:Asc.c_oAscFileType.HTML}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,this.mode=t.mode,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){/^pdf$/.test(this.fileType)?(this.formats[0].splice(1,1,{name:"PDF",imgCls:"pdf",type:""}),this.formats[1].splice(1,1)):/^xps|oxps$/.test(this.fileType)?this.formats[0].push({name:this.fileType.toUpperCase(),imgCls:this.fileType,type:""}):/^djvu$/.test(this.fileType)&&(this.formats=[[{name:"DJVU",imgCls:"djvu",type:""},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF}]]),this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"docx").toLowerCase(),header:Common.Locale.get("btnDownloadCaption",{name:"DE.Views.FileMenu",default:this.textDownloadAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var n=e.length;n>t&&(t=n)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format;!_.isUndefined(e)&&this.menu&&this.menu.fireEvent("saveas:format",[this.menu,e.value?parseInt(e.value):void 0])},textDownloadAs:"Download as"}),PDFE.Views.FileMenuPanels.ViewSaveCopy=Common.UI.BaseView.extend({el:"#panel-savecopy",menu:void 0,formats:[[{name:"DOCX",imgCls:"docx",type:Asc.c_oAscFileType.DOCX,ext:".docx"},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"},{name:"ODT",imgCls:"odt",type:Asc.c_oAscFileType.ODT,ext:".odt"}],[{name:"DOTX",imgCls:"dotx",type:Asc.c_oAscFileType.DOTX,ext:".dotx"},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA,ext:".pdf"},{name:"OTT",imgCls:"ott",type:Asc.c_oAscFileType.OTT,ext:".ott"}],[{name:"RTF",imgCls:"rtf",type:Asc.c_oAscFileType.RTF,ext:".rtf"},{name:"TXT",imgCls:"txt",type:Asc.c_oAscFileType.TXT,ext:".txt"},{name:"FB2",imgCls:"fb2",type:Asc.c_oAscFileType.FB2,ext:".fb2"},{name:"EPUB",imgCls:"epub",type:Asc.c_oAscFileType.EPUB,ext:".epub"},{name:"HTML (Zipped)",imgCls:"html",type:Asc.c_oAscFileType.HTML,ext:".html"}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG,ext:".zip"},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG,ext:".zip"}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" format-ext="<%= item.ext %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,this.mode=t.mode,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){/^pdf$/.test(this.fileType)?(this.formats[0].splice(1,1,{name:"PDF",imgCls:"pdf",type:"",ext:!0}),this.formats[1].splice(1,1)):/^xps|oxps$/.test(this.fileType)?this.formats[0].push({name:this.fileType.toUpperCase(),imgCls:this.fileType,type:"",ext:!0}):/^djvu$/.test(this.fileType)&&(this.formats=[[{name:"DJVU",imgCls:"djvu",type:"",ext:!0},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"}]]),this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"docx").toLowerCase(),header:Common.Locale.get("btnSaveCopyAsCaption",{name:"DE.Views.FileMenu",default:this.textSaveCopyAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var n=e.length;n>t&&(t=n)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format,i=t.currentTarget.attributes["format-ext"];_.isUndefined(e)||_.isUndefined(i)||!this.menu||this.menu.fireEvent("saveas:format",[this.menu,e.value?parseInt(e.value):void 0,i.value])},textSaveCopyAs:"Save Copy as"}),PDFE.Views.FileMenuPanels.Settings=Common.UI.BaseView.extend(_.extend({el:"#panel-settings",menu:void 0,template:_.template(['<div class="flex-settings">','<div class="header"><%= scope.txtAdvancedSettings %></div>',"<table><tbody>",'<tr class="editsave">','<td colspan="2" class="group-name top"><label><%= scope.txtEditingSaving %></label></td>',"</tr>",'<tr class="autosave">','<td colspan="2"><span id="fms-chb-autosave"></span></td>',"</tr>",'<tr class="forcesave">','<td colspan="2"><span id="fms-chb-forcesave"></span></td>',"</tr>",'<tr class ="editsave divider-group"></tr>','<tr class="collaboration">','<td colspan="2" class="group-name"><label><%= scope.txtCollaboration %></label></td>',"</tr>",'<tr class="coauth changes-mode">','<td colspan="2" class="subgroup-name"><label><%= scope.strCoAuthMode %></label></td>',"</tr>",'<tr class="coauth changes-mode">','<td colspan="2"><div style="display: flex;"><div id="fms-rb-coauth-mode-fast"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strFast %></label>','<label class="comment-text"><%= scope.txtFastTip %></label></span></div>',"</td>","</tr>",'<tr class="coauth changes-mode">','<td colspan="2"><div style="display: flex;"><div id="fms-rb-coauth-mode-strict"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strStrict %></label>','<label class="comment-text"><%= scope.txtStrictTip %></label></span>',"</div></td>","</tr>",'<tr class ="divider-subgroup coauth changes-mode"></tr>','<tr class="coauth changes-show">','<td colspan="2" class="subgroup-name"><label><%= scope.strShowChanges %></label></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-none"></div></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-all"></div></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-last"></div></td>',"</tr>",'<tr class="divider coauth changes-show"></tr>','<tr class="comments">','<td colspan="2"><div id="fms-chb-live-comment"></div></td>',"</tr>",'<tr class="comments">','<td colspan="2"><div id="fms-chb-resolved-comment"></div></td>',"</tr>",'<tr class ="collaboration divider-group"></tr>',"<tr>",'<td colspan="2" class="group-name"><label><%= scope.txtWorkspace %></label></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-use-alt-key"></div></td>',"</tr>",'<tr class="ui-rtl">','<td colspan="2"><div id="fms-chb-rtl-ui"></div></td>',"</tr>",'<tr class="quick-print">','<td colspan="2"><div style="display: flex;"><div id="fms-chb-quick-print"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.txtQuickPrint %></label>','<label class="comment-text"><%= scope.txtQuickPrintTip %></label></span></div>',"</td>","</tr>",'<tr class="themes">',"<td><label><%= scope.strTheme %></label></td>","<td>",'<div><div id="fms-cmb-theme"></div>','<div id="fms-chb-dark-mode"></div></div></td>',"</tr>","<tr>","<td><label><%= scope.strZoom %></label></td>",'<td><div id="fms-cmb-zoom" class="input-group-nr"></div></td>',"</tr>","<tr>","<td><label><%= scope.strFontRender %></label></td>",'<td><span id="fms-cmb-font-render"></span></td>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="fms-btn-apply">','<td style="padding-top:15px; padding-bottom: 15px;"><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>",'<div class="fms-flex-apply hidden">','<table style="margin: 10px 20px;"><tbody>',"<tr>",'<td><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu},render:function(t){var e=this,i=$(this.template({scope:this}));this.chUseAltKey=new Common.UI.CheckBox({el:i.findById("#fms-chb-use-alt-key"),labelText:Common.Utils.isMac?this.txtUseOptionKey:this.txtUseAltKey,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),(Common.Utils.isIE||Common.Utils.isMac&&Common.Utils.isGecko)&&this.chUseAltKey.$el.parent().parent().hide(),this.chLiveComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-comment"),labelText:this.strShowComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,n,o){e.chResolvedComment.setDisabled("checked"!==t.getValue())})),this.chResolvedComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-resolved-comment"),labelText:this.strShowResolvedComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chAutosave=new Common.UI.CheckBox({el:i.findById("#fms-chb-autosave"),labelText:this.textAutoSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,n,o){"checked"!==t.getValue()&&e.rbCoAuthModeFast.getValue()&&(e.rbCoAuthModeStrict.setValue(!0),e.onChangeCoAuthMode(e.rbCoAuthModeFast.getValue()?1:0))})),this.chForcesave=new Common.UI.CheckBox({el:i.findById("#fms-chb-forcesave"),labelText:this.textForceSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbZoom=new Common.UI.ComboBox({el:i.findById("#fms-cmb-zoom"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",cls:"input-group-nr",restoreMenuHeight:!1,menuStyle:"min-width:100%; max-height: 157px;",data:[{value:-3,displayValue:this.txtLastUsed},{value:-1,displayValue:this.txtFitPage},{value:-2,displayValue:this.txtFitWidth},{value:50,displayValue:"50%"},{value:60,displayValue:"60%"},{value:70,displayValue:"70%"},{value:80,displayValue:"80%"},{value:90,displayValue:"90%"},{value:100,displayValue:"100%"},{value:110,displayValue:"110%"},{value:120,displayValue:"120%"},{value:150,displayValue:"150%"},{value:175,displayValue:"175%"},{value:200,displayValue:"200%"},{value:300,displayValue:"300%"},{value:400,displayValue:"400%"},{value:500,displayValue:"500%"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.rbCoAuthModeFast=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-fast"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbCoAuthModeFast.on("change",(function(){e.chAutosave.setValue(1),e.onChangeCoAuthMode(1)})),this.rbCoAuthModeFast.$el.parent().on("click",(function(){e.rbCoAuthModeFast.setValue(!0)})),this.rbCoAuthModeStrict=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-strict"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbCoAuthModeStrict.on("change",_.bind(this.onChangeCoAuthMode,this,0)),this.rbCoAuthModeStrict.$el.parent().on("click",(function(){e.rbCoAuthModeStrict.setValue(!0)})),this.rbShowChangesNone=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-none"),name:"show-changes",labelText:this.txtNone,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesAll=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-all"),name:"show-changes",labelText:this.txtAll,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesLast=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-last"),name:"show-changes",labelText:this.txtLast,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"});var n=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "custom") { %> class="border-top" style="margin-top: 5px;padding-top: 5px;" <% } %> ><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""));return this.cmbFontRender=new Common.UI.ComboBox({el:i.find("#fms-cmb-font-render"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",menuStyle:"min-width:100%;",cls:"input-group-nr",itemsTemplate:n,data:[{value:0,displayValue:this.txtWin},{value:1,displayValue:this.txtMac},{value:2,displayValue:this.txtNative},{value:"custom",displayValue:this.txtCacheMode}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontRender.on("selected",_.bind(this.onFontRenderSelected,this)),this.cmbTheme=new Common.UI.ComboBox({el:i.findById("#fms-cmb-theme"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,menuCls:"menu-aligned",cls:"input-group-nr",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.chDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme(i.value))})),this.chDarkMode=new Common.UI.CheckBox({el:i.findById("#fms-chb-dark-mode"),labelText:this.txtDarkMode,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),i.find(".btn.primary").each((function(t,i){new Common.UI.Button({el:$(i)}).on("click",_.bind(e.applySettings,e))})),this.chRTL=new Common.UI.CheckBox({el:i.findById("#fms-chb-rtl-ui"),labelText:this.strRTLSupport,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chQuickPrint=new Common.UI.CheckBox({el:i.findById("#fms-chb-quick-print"),labelText:"",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chQuickPrint.$el.parent().on("click",(function(){e.chQuickPrint.setValue(!e.chQuickPrint.isChecked())})),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=this.pnlSettings.find("table"),this.trApply=i.find(".fms-btn-apply"),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSettings(),this.updateScroller()},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.parent().height()+25+this.pnlApply.height();this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible())}},setMode:function(t){this.mode=t;var e=Common.Utils.InternalSettings.get("pdfe-settings-coauthmode"),i=t.isPDFAnnotate||t.isPDFEdit;$("tr.edit",this.el)[t.isEdit?"show":"hide"](),$("tr.autosave",this.el)[t.isEdit&&i&&(t.canChangeCoAuthoring||!e)?"show":"hide"](),$("tr.forcesave",this.el)[t.canForcesave&&i?"show":"hide"](),$("tr.editsave",this.el)[(t.isEdit||t.canForcesave)&&i?"show":"hide"](),this.mode.isDesktopApp&&this.mode.isOffline&&this.chAutosave.setCaption(this.textAutoRecover),$("tr.collaboration",this.el)[t.canCoAuthoring||t.canViewReview?"show":"hide"](),$("tr.coauth.changes-mode",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring&&t.canChangeCoAuthoring&&i?"show":"hide"](),$("tr.coauth.changes-show",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring&&i?"show":"hide"](),$("tr.comments",this.el)[t.canCoAuthoring?"show":"hide"](),$("tr.ui-rtl",this.el)[t.uiRtl?"show":"hide"](),$("tr.quick-print",this.el)[!t.canQuickPrint||t.customization&&t.customization.compactHeader&&t.isEdit?"hide":"show"](),Common.UI.Themes.available()||$("tr.themes, tr.themes + tr.divider",this.el).hide()},setApi:function(t){return this.api=t,this},updateSettings:function(){this.chUseAltKey.setValue(Common.Utils.InternalSettings.get("pdfe-settings-show-alt-hints"));var t=Common.Utils.InternalSettings.get("pdfe-settings-zoom");t=null!==t?parseInt(t):this.mode.customization&&this.mode.customization.zoom?parseInt(this.mode.customization.zoom):100;var e=this.cmbZoom.store.findWhere({value:t});this.cmbZoom.setValue(e?parseInt(e.get("value")):t>0?t+"%":100),this.chLiveComment.setValue(Common.Utils.InternalSettings.get("pdfe-settings-livecomment")),this.chResolvedComment.setValue(Common.Utils.InternalSettings.get("pdfe-settings-resolvedcomment"));var i=Common.Utils.InternalSettings.get("pdfe-settings-coauthmode");this.rbCoAuthModeFast.setValue(i),this.rbCoAuthModeStrict.setValue(!i),this.fillShowChanges(i),t=Common.Utils.InternalSettings.get(i?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict"),this.rbShowChangesNone.setValue("none"==t),this.rbShowChangesLast.setValue("last"==t),this.rbShowChangesAll.setValue("all"==t),t=Common.Utils.InternalSettings.get("pdfe-settings-fontrender"),e=this.cmbFontRender.store.findWhere({value:parseInt(t)}),this.cmbFontRender.setValue(e?e.get("value"):0),this._fontRender=this.cmbFontRender.getValue(),t=Common.Utils.InternalSettings.get("pdfe-settings-cachemode"),(e=this.cmbFontRender.store.findWhere({value:"custom"}))&&t&&e.set("checked",!!t),e&&t&&this.cmbFontRender.cmpEl.find("#"+e.get("id")+" a").addClass("checked"),t=Common.Utils.InternalSettings.get("pdfe-settings-autosave"),this.chAutosave.setValue(1==t),this.mode.canForcesave&&this.chForcesave.setValue(Common.Utils.InternalSettings.get("pdfe-settings-forcesave")),this.chQuickPrint.setValue(Common.Utils.InternalSettings.get("pdfe-settings-quick-print-button"));var n=[];for(var o in Common.UI.Themes.map())n.push({value:o,displayValue:Common.UI.Themes.get(o).text,themeType:Common.UI.Themes.get(o).type});n.length&&(this.cmbTheme.setData(n),e=this.cmbTheme.store.findWhere({value:Common.UI.Themes.currentThemeId()}),this.cmbTheme.setValue(e?e.get("value"):Common.UI.Themes.defaultThemeId())),this.chDarkMode.setValue(Common.UI.Themes.isContentThemeDark()),this.chDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme()),this.chRTL.setValue(Common.localStorage.getBool("ui-rtl"))},applySettings:function(){Common.UI.Themes.setTheme(this.cmbTheme.getValue()),this.chDarkMode.isDisabled()||this.chDarkMode.isChecked()===Common.UI.Themes.isContentThemeDark()||Common.UI.Themes.toggleContentTheme(),Common.localStorage.setItem("pdfe-settings-show-alt-hints",this.chUseAltKey.isChecked()?1:0),Common.Utils.InternalSettings.set("pdfe-settings-show-alt-hints",Common.localStorage.getBool("pdfe-settings-show-alt-hints")),Common.localStorage.setItem("pdfe-settings-zoom",this.cmbZoom.getValue()),Common.Utils.InternalSettings.set("pdfe-settings-zoom",Common.localStorage.getItem("pdfe-settings-zoom")),Common.localStorage.setItem("pdfe-settings-livecomment",this.chLiveComment.isChecked()?1:0),Common.localStorage.setItem("pdfe-settings-resolvedcomment",this.chResolvedComment.isChecked()?1:0),this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring&&(this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("pdfe-settings-coauthmode",this.rbCoAuthModeFast.getValue()?1:0),Common.localStorage.setItem(this.rbCoAuthModeFast.getValue()?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict",this.rbShowChangesNone.getValue()?"none":this.rbShowChangesLast.getValue()?"last":"all")),Common.localStorage.setItem("pdfe-settings-fontrender",this.cmbFontRender.getValue());var t=this.cmbFontRender.store.findWhere({value:"custom"});Common.localStorage.setItem("pdfe-settings-cachemode",t&&!t.get("checked")?0:1),!this.mode.isEdit||!this.mode.canChangeCoAuthoring&&Common.Utils.InternalSettings.get("pdfe-settings-coauthmode")||Common.localStorage.setItem("pdfe-settings-autosave",this.chAutosave.isChecked()?1:0),this.mode.canForcesave&&Common.localStorage.setItem("pdfe-settings-forcesave",this.chForcesave.isChecked()?1:0);var e=this.chRTL.$el.is(":visible")&&Common.localStorage.getBool("ui-rtl")!==this.chRTL.isChecked();if(Common.localStorage.setBool("ui-rtl",this.chRTL.isChecked()),Common.localStorage.setBool("pdfe-settings-quick-print-button",this.chQuickPrint.isChecked()),Common.localStorage.save(),this.menu&&this.menu.fireEvent("settings:apply",[this.menu]),e){var i={title:this.txtWorkspaceSettingChange,msg:this.txtRestartEditor,iconCls:"warn",buttons:["ok"]};Common.UI.alert(i)}},fillShowChanges:function(t){t?this.rbShowChangesLast.$el.parent().hide():this.rbShowChangesLast.$el.parent().show()},onChangeCoAuthMode:function(t){this.fillShowChanges(1==t),this.rbShowChangesNone.setValue(1==t),this.rbShowChangesLast.setValue(0==t)},onFontRenderSelected:function(t,e){if("custom"==e.value){var i=t.store.findWhere({value:"custom"});i&&i.set("checked",!e.checked),t.cmpEl.find("#"+e.id+" a").toggleClass("checked",!e.checked),t.setValue(this._fontRender)}this._fontRender=t.getValue()},strZoom:"Default Zoom Value",strShowChanges:"Real-time Collaboration Changes",txtAll:"View All",txtNone:"View Nothing",txtLast:"View Last",okButtonText:"Apply",txtWin:"as Windows",txtMac:"as OS X",txtNative:"Native",strFontRender:"Font Hinting",textAutoSave:"Autosave",strCoAuthMode:"Co-editing mode",strFast:"Fast",strStrict:"Strict",textAutoRecover:"Autorecover",txtFitPage:"Fit to Page",txtFitWidth:"Fit to Width",textForceSave:"Save to Server",txtCacheMode:"Default cache mode",strRTLSupport:"RTL interface",strTheme:"Theme",txtDarkMode:"Turn on document dark mode",txtEditingSaving:"Editing and saving",txtCollaboration:"Collaboration",txtWorkspace:"Workspace",txtHieroglyphs:"Hieroglyphs",txtUseAltKey:"Use Alt key to navigate the user interface using the keyboard",txtUseOptionKey:"Use âF6 to navigate the user interface using the keyboard",strShowComments:"Show comments in text",strShowResolvedComments:"Show resolved comments",txtFastTip:"Real-time co-editing. All changes are saved automatically",txtStrictTip:"Use the 'Save' button to sync the changes you and others make",strShowOthersChanges:"Show changes from other users",txtAdvancedSettings:"Advanced Settings",txtQuickPrint:"Show the Quick Print button in the editor header",txtQuickPrintTip:"The document will be printed on the last selected or default printer",txtWorkspaceSettingChange:"Workspace setting (RTL interface) change",txtRestartEditor:"Please restart document editor so that your workspace settings can take effect",txtLastUsed:"Last used"},PDFE.Views.FileMenuPanels.Settings||{})),PDFE.Views.FileMenuPanels.CreateNew=Common.UI.BaseView.extend(_.extend({el:"#panel-createnew",menu:void 0,events:function(){return{"click .blank-document-btn":_.bind(this._onBlankDocument,this),"click .thumb-list .thumb-wrap":_.bind(this._onDocumentTemplate,this)}},template:_.template(['<div class="header"><%= scope.txtCreateNew %></div>','<div class="thumb-list">',"<% if (blank) { %> ",'<div class="blank-document">','<div class="blank-document-btn" data-hint="2" data-hint-direction="left-top" data-hint-offset="2, 10">','<div class="btn-blank-format"><div class ="svg-format-blank"></div></div>',"</div>",'<div class="title"><%= scope.txtBlank %></div>',"</div>","<% } %>","<% _.each(docs, function(item, index) { %>",'<div class="thumb-wrap" template="<%= item.url %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="14, 22">','<div class="thumb" ',"<% if (!_.isEmpty(item.image)) {%> ",' style="background-image: url(<%= item.image %>);">'," <%} else {print(\"><div class='btn-blank-format'><div class='svg-file-template'></div></div>\") } %>","</div>",'<div class="title"><%= Common.Utils.String.htmlEncode(item.title || item.name || "") %></div>',"</div>","<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.docs=t.docs,this.blank=!!t.blank},render:function(){this.$el.html(this.template({scope:this,docs:this.docs,blank:this.blank}));var t=(this.blank?[{title:this.txtBlank}]:[]).concat(this.docs),e=this.$el.find(".thumb-wrap, .blank-document");return _.each(e,(function(e,i){$(e).find(".title").tooltip({title:t[i].title,placement:"cursor"})})),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},_onBlankDocument:function(){this.menu&&this.menu.fireEvent("create:new",[this.menu,"blank"])},_onDocumentTemplate:function(t){this.menu&&this.menu.fireEvent("create:new",[this.menu,t.currentTarget.attributes.template.value])},txtBlank:"Blank document",txtCreateNew:"Create New"},PDFE.Views.FileMenuPanels.CreateNew||{})),PDFE.Views.FileMenuPanels.DocumentInfo=Common.UI.BaseView.extend(_.extend({el:"#panel-info",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="flex-settings">','<div class="header">'+this.txtDocumentInfo+"</div>",'<table class="main">',"<tr>",'<td class="left"><label>'+this.txtPlacement+"</label></td>",'<td class="right"><label id="id-info-placement">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtOwner+"</label></td>",'<td class="right"><label id="id-info-owner">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtUploaded+"</label></td>",'<td class="right"><label id="id-info-uploaded">-</label></td>',"</tr>",'<tr class="divider general"></tr>','<tr class="divider general"></tr>',"<tr>",'<td class="left"><label>'+this.txtPages+"</label></td>",'<td class="right"><label id="id-info-pages"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtParagraphs+"</label></td>",'<td class="right"><label id="id-info-paragraphs"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtWords+"</label></td>",'<td class="right"><label id="id-info-words"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSymbols+"</label></td>",'<td class="right"><label id="id-info-symbols"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSpaces+"</label></td>",'<td class="right"><label id="id-info-spaces"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPageSize+"</label></td>",'<td class="right"><label id="id-info-page-size"></label></td>',"</tr>",'<tr class="divider"></tr>','<tr class="divider"></tr>','<tr class="docx-info">','<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><div id="id-info-title"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtTags+"</label></td>",'<td class="right"><div id="id-info-tags"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><div id="id-info-subject"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtComment+"</label></td>",'<td class="right"><div id="id-info-comment"></div></td>',"</tr>",'<tr class="divider docx-info"></tr>','<tr class="divider docx-info"></tr>','<tr class="pdf-info">','<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><label id="id-lbl-info-title"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><label id="id-lbl-info-subject"></label></td>',"</tr>",'<tr class="divider pdf-info pdf-title"></tr>','<tr class="divider pdf-info pdf-title"></tr>',"<tr>",'<td class="left"><label>'+this.txtModifyDate+"</label></td>",'<td class="right"><label id="id-info-modify-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtModifyBy+"</label></td>",'<td class="right"><label id="id-info-modify-by"></label></td>',"</tr>",'<tr class="divider modify"></tr>','<tr class="divider modify"></tr>',"<tr>",'<td class="left"><label>'+this.txtCreated+"</label></td>",'<td class="right"><label id="id-info-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtAppName+"</label></td>",'<td class="right"><label id="id-info-appname"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtAuthor+"</label></td>",'<td class="right"><label id="id-lbl-info-author"></label></td>',"</tr>",'<tr class="divider pdf-info"></tr>','<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfProducer+"</label></td>",'<td class="right"><label id="id-info-pdf-produce"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfVer+"</label></td>",'<td class="right"><label id="id-info-pdf-ver"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfTagged+"</label></td>",'<td class="right"><label id="id-info-pdf-tagged"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtFastWV+"</label></td>",'<td class="right"><label id="id-info-fast-wv"></label></td>',"</tr>",'<tr class="docx-info">','<td class="left" style="vertical-align: top;"><label style="margin-top: 3px;">'+this.txtAuthor+"</label></td>",'<td class="right" style="vertical-align: top;"><div id="id-info-author">',"<table>","<tr>",'<td><div id="id-info-add-author"><input type="text" spellcheck="false" class="form-control" placeholder="'+this.txtAddAuthor+'"></div></td>',"</tr>","</table>","</div></td>","</tr>",'<tr style="height: 5px;"></tr>',"</table>","</div>",'<div id="fms-flex-apply">','<table class="main">',"<tr>",'<td class="left"></td>','<td class="right"><button id="fminfo-btn-apply" class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"</tr>","</table>","</div>"].join("")),this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0},this.menu=t.menu,this.coreProps=null,this.authors=[],this._state={_locked:!1,disableEditing:!1}},render:function(t){var e=this,i=$(e.template({scope:e}));this.lblPlacement=i.findById("#id-info-placement"),this.lblOwner=i.findById("#id-info-owner"),this.lblUploaded=i.findById("#id-info-uploaded"),this.lblStatPages=i.findById("#id-info-pages"),this.lblStatWords=i.findById("#id-info-words"),this.lblStatParagraphs=i.findById("#id-info-paragraphs"),this.lblStatSymbols=i.findById("#id-info-symbols"),this.lblStatSpaces=i.findById("#id-info-spaces"),this.lblPageSize=i.findById("#id-info-pages-size");var n=function(t,e){if(e.keyCode===Common.UI.Keys.ESC){var i=t._input.val(),n=t.getValue();i!==n&&(t.setValue(n),e.stopPropagation())}};return this.inputTitle=new Common.UI.InputField({el:i.findById("#id-info-title"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n),this.inputTags=new Common.UI.InputField({el:i.findById("#id-info-tags"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n),this.inputSubject=new Common.UI.InputField({el:i.findById("#id-info-subject"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n),this.inputComment=new Common.UI.InputField({el:i.findById("#id-info-comment"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n),this.lblModifyDate=i.findById("#id-info-modify-date"),this.lblModifyBy=i.findById("#id-info-modify-by"),this.lblDate=i.findById("#id-info-date"),this.lblApplication=i.findById("#id-info-appname"),this.tblAuthor=i.findById("#id-info-author table"),this.trAuthor=i.findById("#id-info-add-author").closest("tr"),this.authorTpl='<tr><td><div style="display: inline-block;width: 200px;"><input type="text" spellcheck="false" class="form-control" readonly="true" value="{0}"></div><div class="tool close img-commonctrl img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></td></tr>',this.tblAuthor.on("click",(function(t){var n=i.find(t.target);if(n.hasClass("close")&&!n.hasClass("disabled")){var o=n.closest("tr"),s=e.tblAuthor.find("tr").index(o);o.remove(),e.authors.splice(s,1),e.updateScroller(!0)}})),this.inputAuthor=new Common.UI.InputField({el:i.findById("#id-info-add-author"),style:"width: 200px;",validateOnBlur:!1,placeHolder:this.txtAddAuthor,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("changed:after",(function(t,i,n,o){if(i!=n){var s=i.trim();if(s&&s!==n.trim()){var a=o&&o.relatedTarget&&"fminfo-btn-apply"==o.relatedTarget.id;s.split(/\s*[,;]\s*/).forEach((function(t){var i=t.trim();if(i&&(e.authors.push(t),!a)){var n=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(i)));e.trAuthor.before(n),e.updateScroller()}})),!a&&e.inputAuthor.setValue("")}}})).on("keydown:before",n),this.lblPageSize=i.findById("#id-info-page-size"),this.lblPdfTitle=i.findById("#id-lbl-info-title"),this.lblPdfSubject=i.findById("#id-lbl-info-subject"),this.lblPdfAuthor=i.findById("#id-lbl-info-author"),this.lblPdfVer=i.findById("#id-info-pdf-ver"),this.lblPdfTagged=i.findById("#id-info-pdf-tagged"),this.lblPdfProducer=i.findById("#id-info-pdf-produce"),this.lblFastWV=i.findById("#id-info-fast-wv"),this.btnApply=new Common.UI.Button({el:i.findById("#fminfo-btn-apply")}),this.btnApply.on("click",_.bind(this.applySettings,this)),this.pnlInfo=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.findById("#fms-flex-apply"),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlInfo,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateStatisticInfo(),this.updateFileInfo(),this.scroller&&this.scroller.scrollTop(0),this.updateScroller()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.stopUpdatingStatisticInfo()},updateScroller:function(t){this.scroller&&(this.scroller.update(t?{}:void 0),this.pnlInfo.toggleClass("bordered",this.scroller.isVisible()))},updateInfo:function(t){if(this.doc=t,this.rendered){var e=!1;if((t=t||{}).info)t.info.folder&&this.lblPlacement.text(t.info.folder),e=this._ShowHideInfoItem(this.lblPlacement,void 0!==t.info.folder&&null!==t.info.folder)||e,(o=t.info.owner)&&this.lblOwner.text(o),e=this._ShowHideInfoItem(this.lblOwner,!!o)||e,(o=t.info.uploaded)&&this.lblUploaded.text(o),e=this._ShowHideInfoItem(this.lblUploaded,!!o)||e;else this._ShowHideDocInfo(!1);$("tr.divider.general",this.el)[e?"show":"hide"]();var i=this.api?this.api.asc_getPdfProps():null,n=this.api?this.api.asc_getAppProps():null;if(n?($(".pdf-info",this.el).hide(),n=(n.asc_getApplication()||"")+(n.asc_getAppVersion()?" ":"")+(n.asc_getAppVersion()||""),this.lblApplication.text(n)):i&&($(".docx-info",this.el).hide(),n=i&&i.Creator||"",this.lblApplication.text(n)),this._ShowHideInfoItem(this.lblApplication,!!n),this.coreProps=this.api?this.api.asc_getCoreProps():null,this.coreProps){var o;if(o=this.coreProps.asc_getCreated()){var s=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblDate.text(o.toLocaleString(s,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+o.toLocaleString(s,{timeStyle:"short"}))}catch(t){s="en",this.lblDate.text(o.toLocaleString(s,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+o.toLocaleString(s,{timeStyle:"short"}))}}this._ShowHideInfoItem(this.lblDate,!!o)}else i&&this.updatePdfInfo(i)}},updateFileInfo:function(){if(this.rendered){var t,e=this,i=this.api?this.api.asc_getCoreProps():null;if(this.coreProps=i,i){var n=!1;if(t=i.asc_getModified()){var o=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblModifyDate.text(t.toLocaleString(o,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+t.toLocaleString(o,{timeStyle:"short"}))}catch(e){o="en",this.lblModifyDate.text(t.toLocaleString(o,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+t.toLocaleString(o,{timeStyle:"short"}))}}n=this._ShowHideInfoItem(this.lblModifyDate,!!t)||n,(t=i.asc_getLastModifiedBy())&&this.lblModifyBy.text(AscCommon.UserInfoParser.getParsedName(t)),n=this._ShowHideInfoItem(this.lblModifyBy,!!t)||n,$("tr.divider.modify",this.el)[n?"show":"hide"](),t=i.asc_getTitle(),this.inputTitle.setValue(t||""),t=i.asc_getKeywords(),this.inputTags.setValue(t||""),t=i.asc_getSubject(),this.inputSubject.setValue(t||""),t=i.asc_getDescription(),this.inputComment.setValue(t||""),this.inputAuthor.setValue(""),this.tblAuthor.find("tr:not(:last-of-type)").remove(),this.authors=[],(t=i.asc_getCreator())&&t.split(/\s*[,;]\s*/).forEach((function(t){var i=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(t)));e.trAuthor.before(i),e.authors.push(t)})),this.tblAuthor.find(".close").toggleClass("hidden",!this.mode.isPDFEdit),this._ShowHideInfoItem(this.tblAuthor,this.mode.isPDFEdit||!!this.authors.length)}this.SetDisabled()}},updatePdfInfo:function(t){if(this.rendered){var e;if(t){if(e=t.CreationDate){e=new Date(e);var i=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}catch(t){i="en",this.lblDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}}this._ShowHideInfoItem(this.lblDate,!!e);var n=!1;if(e=t.ModDate){e=new Date(e);i=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblModifyDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}catch(t){i="en",this.lblModifyDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}}if(n=this._ShowHideInfoItem(this.lblModifyDate,!!e)||n,n=this._ShowHideInfoItem(this.lblModifyBy,!1)||n,$("tr.divider.modify",this.el)[n?"show":"hide"](),t.PageWidth&&t.PageHeight&&"number"==typeof t.PageWidth&&"number"==typeof t.PageHeight){var o=t.PageWidth,s=t.PageHeight;switch(Common.Utils.Metric.getCurrentMetric()){case Common.Utils.Metric.c_MetricUnits.cm:o=parseFloat((25.4*o/72e3).toFixed(2)),s=parseFloat((25.4*s/72e3).toFixed(2));break;case Common.Utils.Metric.c_MetricUnits.pt:o=parseFloat((o/100).toFixed(2)),s=parseFloat((s/100).toFixed(2));break;case Common.Utils.Metric.c_MetricUnits.inch:o=parseFloat((o/7200).toFixed(2)),s=parseFloat((s/7200).toFixed(2))}this.lblPageSize.text(o+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+s+" "+Common.Utils.Metric.getCurrentMetricName()),this._ShowHideInfoItem(this.lblPageSize,!0)}else this._ShowHideInfoItem(this.lblPageSize,!1);(e=t.Title)&&this.lblPdfTitle.text(e),n=this._ShowHideInfoItem(this.lblPdfTitle,!!e),(e=t.Subject)&&this.lblPdfSubject.text(e),n=this._ShowHideInfoItem(this.lblPdfSubject,!!e)||n,$("tr.divider.pdf-title",this.el)[n?"show":"hide"](),(e=t.Author)&&this.lblPdfAuthor.text(e),this._ShowHideInfoItem(this.lblPdfAuthor,!!e),(e=t.Version)&&this.lblPdfVer.text(e),this._ShowHideInfoItem(this.lblPdfVer,!!e),void 0!==(e=t.Tagged)&&this.lblPdfTagged.text(!0===e?this.txtYes:this.txtNo),this._ShowHideInfoItem(this.lblPdfTagged,void 0!==e),(e=t.Producer)&&this.lblPdfProducer.text(e),this._ShowHideInfoItem(this.lblPdfProducer,!!e),void 0!==(e=t.FastWebView)&&this.lblFastWV.text(!0===e?this.txtYes:this.txtNo),this._ShowHideInfoItem(this.lblFastWV,void 0!==e)}}},_ShowHideInfoItem:function(t,e){return t.closest("tr")[e?"show":"hide"](),e},_ShowHideDocInfo:function(t){this._ShowHideInfoItem(this.lblPlacement,t),this._ShowHideInfoItem(this.lblOwner,t),this._ShowHideInfoItem(this.lblUploaded,t)},updateStatisticInfo:function(){this.api&&this.doc&&this.api.startGetDocInfo()},stopUpdatingStatisticInfo:function(){this.api&&this.api.stopGetDocInfo()},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onGetDocInfoStart",_.bind(this._onGetDocInfoStart,this)),this.api.asc_registerCallback("asc_onGetDocInfoStop",_.bind(this._onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onDocInfo",_.bind(this._onDocInfo,this)),this.api.asc_registerCallback("asc_onGetDocInfoEnd",_.bind(this._onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onLockCore",_.bind(this.onLockCore,this)),this.updateInfo(this.doc),this},setMode:function(t){this.mode=t;var e=!1;return this.inputAuthor.setVisible(e),this.pnlApply.toggleClass("hidden",!0),this.tblAuthor.find(".close").toggleClass("hidden",!0),this.inputTitle._input.attr("placeholder",""),this.inputTags._input.attr("placeholder",""),this.inputSubject._input.attr("placeholder",""),this.inputComment._input.attr("placeholder",""),this.inputAuthor._input.attr("placeholder",""),this.SetDisabled(),this},setPreviewMode:function(t){this._state.disableEditing=t},_onGetDocInfoStart:function(){var t=this;this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0},this.timerLoading=setTimeout((function(){t.lblStatPages.text(t.txtLoading),t.lblStatWords.text(t.txtLoading),t.lblStatParagraphs.text(t.txtLoading),t.lblStatSymbols.text(t.txtLoading),t.lblStatSpaces.text(t.txtLoading)}),2e3)},_onDocInfo:function(t){if(t&&(clearTimeout(this.timerLoading),t.get_PageCount()>-1&&(this.infoObj.PageCount=t.get_PageCount()),t.get_WordsCount()>-1&&(this.infoObj.WordsCount=t.get_WordsCount()),t.get_ParagraphCount()>-1&&(this.infoObj.ParagraphCount=t.get_ParagraphCount()),t.get_SymbolsCount()>-1&&(this.infoObj.SymbolsCount=t.get_SymbolsCount()),t.get_SymbolsWSCount()>-1&&(this.infoObj.SymbolsWSCount=t.get_SymbolsWSCount()),!this.timerDocInfo)){var e=this;this.timerDocInfo=setInterval((function(){e.fillDocInfo()}),300),this.fillDocInfo()}},_onGetDocInfoEnd:function(){clearTimeout(this.timerLoading),clearInterval(this.timerDocInfo),this.timerLoading=this.timerDocInfo=void 0,this.fillDocInfo()},fillDocInfo:function(){this.lblStatPages.text(this.infoObj.PageCount),this.lblStatWords.text(this.infoObj.WordsCount),this.lblStatParagraphs.text(this.infoObj.ParagraphCount),this.lblStatSymbols.text(this.infoObj.SymbolsCount),this.lblStatSpaces.text(this.infoObj.SymbolsWSCount)},onDocumentName:function(t){},onLockCore:function(t){this._state._locked=t,this.updateFileInfo()},SetDisabled:function(){var t=!this.mode.isEdit||this._state._locked||this._state.disableEditing;this.inputTitle.setDisabled(t),this.inputTags.setDisabled(t),this.inputSubject.setDisabled(t),this.inputComment.setDisabled(t),this.inputAuthor.setDisabled(t),this.tblAuthor.find(".close").toggleClass("disabled",this._state._locked),this.tblAuthor.toggleClass("disabled",t),this.btnApply.setDisabled(this._state._locked)},applySettings:function(){this.coreProps&&this.api&&(this.coreProps.asc_putTitle(this.inputTitle.getValue()),this.coreProps.asc_putKeywords(this.inputTags.getValue()),this.coreProps.asc_putSubject(this.inputSubject.getValue()),this.coreProps.asc_putDescription(this.inputComment.getValue()),this.coreProps.asc_putCreator(this.authors.join(";")),this.api.asc_setCoreProps(this.coreProps)),this.menu.hide()},txtPlacement:"Location",txtOwner:"Owner",txtUploaded:"Uploaded",txtPages:"Pages",txtWords:"Words",txtParagraphs:"Paragraphs",txtSymbols:"Symbols",txtSpaces:"Symbols with spaces",txtLoading:"Loading...",txtAppName:"Application",txtEditTime:"Total Editing time",txtTitle:"Title",txtTags:"Tags",txtSubject:"Subject",txtComment:"Comment",txtModifyDate:"Last Modified",txtModifyBy:"Last Modified By",txtCreated:"Created",txtAuthor:"Author",txtAddAuthor:"Add Author",txtAddText:"Add Text",txtMinutes:"min",okButtonText:"Apply",txtPageSize:"Page Size",txtPdfVer:"PDF Version",txtPdfTagged:"Tagged PDF",txtFastWV:"Fast Web View",txtYes:"Yes",txtNo:"No",txtPdfProducer:"PDF Producer",txtDocumentInfo:"Document Info"},PDFE.Views.FileMenuPanels.DocumentInfo||{})),PDFE.Views.FileMenuPanels.DocumentRights=Common.UI.BaseView.extend(_.extend({el:"#panel-rights",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="header">'+this.txtAccessRights+"</div>",'<table class="main">','<tr class="rights">','<td class="left" style="vertical-align: top;"><label>'+this.txtRights+"</label></td>",'<td class="right"><div id="id-info-rights"></div></td>',"</tr>",'<tr class="edit-rights">','<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary custom margin-right-10">'+this.txtBtnAccessRights+"</button></td>","</tr>","</table>"].join("")),this.templateRights=_.template(["<table>","<% _.each(users, function(item) { %>","<tr>",'<td><span class="userLink img-commonctrl  <% if (item.isLink) { %>sharedLink<% } %>"></span><span><%= Common.Utils.String.htmlEncode(item.user) %></span></td>',"<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>","</tr>","<% }); %>","</table>"].join("")),this.menu=t.menu},render:function(t){var e=$(this.template());return this.cntRights=e.findById("#id-info-rights"),this.btnEditRights=new Common.UI.Button({el:e.elementById("#id-info-btn-edit")}),this.btnEditRights.on("click",_.bind(this.changeAccessRights,this)),this.rendered=!0,this.updateInfo(this.doc),Common.NotificationCenter.on("collaboration:sharingupdate",this.updateSharingSettings.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateInfo:function(t){this.doc=t,this.rendered&&((t=t||{}).info?(t.info.sharingSettings&&this.cntRights.html(this.templateRights({users:t.info.sharingSettings})),this._ShowHideInfoItem("rights",void 0!==t.info.sharingSettings&&null!==t.info.sharingSettings&&t.info.sharingSettings.length>0),this._ShowHideInfoItem("edit-rights",(!!this.sharingSettingsUrl&&this.sharingSettingsUrl.length||this.mode.canRequestSharingSettings)&&!0!==this._readonlyRights)):this._ShowHideDocInfo(!1))},_ShowHideInfoItem:function(t,e){$("tr."+t,this.el)[e?"show":"hide"]()},_ShowHideDocInfo:function(t){this._ShowHideInfoItem("rights",t),this._ShowHideInfoItem("edit-rights",t)},setApi:function(t){return this.api=t,this},setMode:function(t){return this.mode=t,this.sharingSettingsUrl=t.sharingSettingsUrl,this},changeAccessRights:function(t,e,i){Common.NotificationCenter.trigger("collaboration:sharing")},updateSharingSettings:function(t){this._ShowHideInfoItem("rights",void 0!==this.doc.info.sharingSettings&&null!==this.doc.info.sharingSettings&&this.doc.info.sharingSettings.length>0),this.cntRights.html(this.templateRights({users:this.doc.info.sharingSettings}))},onLostEditRights:function(){this._readonlyRights=!0,this.rendered&&this._ShowHideInfoItem("edit-rights",!1)},txtRights:"Persons who have rights",txtBtnAccessRights:"Change access rights",txtAccessRights:"Access Rights"},PDFE.Views.FileMenuPanels.DocumentRights||{})),PDFE.Views.FileMenuPanels.Help=Common.UI.BaseView.extend({el:"#panel-help",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-help-contents" style="position: absolute; width:220px; top: 0; bottom: 0;" class="no-padding"></div>','<div id="id-help-frame" class="no-padding"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.urlPref="resources/help/en/",this.openUrl=null,this.en_data=[{src:"ProgramInterface/ProgramInterface.htm",name:"Introducing Document Editor user interface",headername:"Program Interface"},{src:"ProgramInterface/FileTab.htm",name:"File tab"},{src:"ProgramInterface/HomeTab.htm",name:"Home Tab"},{src:"ProgramInterface/InsertTab.htm",name:"Insert tab"},{src:"ProgramInterface/LayoutTab.htm",name:"Layout tab"},{src:"ProgramInterface/ReviewTab.htm",name:"Review tab"},{src:"ProgramInterface/PluginsTab.htm",name:"Plugins tab"},{src:"UsageInstructions/ChangeColorScheme.htm",name:"Change color scheme",headername:"Basic operations"},{src:"UsageInstructions/CopyPasteUndoRedo.htm",name:"Copy/paste text passages, undo/redo your actions"},{src:"UsageInstructions/OpenCreateNew.htm",name:"Create a new document or open an existing one"},{src:"UsageInstructions/SetPageParameters.htm",name:"Set page parameters",headername:"Page formatting"},{src:"UsageInstructions/NonprintingCharacters.htm",name:"Show/hide nonprinting characters"},{src:"UsageInstructions/SectionBreaks.htm",name:"Insert section breaks"},{src:"UsageInstructions/InsertHeadersFooters.htm",name:"Insert headers and footers"},{src:"UsageInstructions/InsertPageNumbers.htm",name:"Insert page numbers"},{src:"UsageInstructions/InsertFootnotes.htm",name:"Insert footnotes"},{src:"UsageInstructions/AlignText.htm",name:"Align your text in a paragraph",headername:"Paragraph formatting"},{src:"UsageInstructions/BackgroundColor.htm",name:"Select background color for a paragraph"},{src:"UsageInstructions/ParagraphIndents.htm",name:"Change paragraph indents"},{src:"UsageInstructions/LineSpacing.htm",name:"Set paragraph line spacing"},{src:"UsageInstructions/PageBreaks.htm",name:"Insert page breaks"},{src:"UsageInstructions/AddBorders.htm",name:"Add borders"},{src:"UsageInstructions/SetTabStops.htm",name:"Set tab stops"},{src:"UsageInstructions/CreateLists.htm",name:"Create lists"},{src:"UsageInstructions/FormattingPresets.htm",name:"Apply formatting styles",headername:"Text formatting"},{src:"UsageInstructions/FontTypeSizeColor.htm",name:"Set font type, size, and color"},{src:"UsageInstructions/DecorationStyles.htm",name:"Apply font decoration styles"},{src:"UsageInstructions/CopyClearFormatting.htm",name:"Copy/clear text formatting"},{src:"UsageInstructions/AddHyperlinks.htm",name:"Add hyperlinks"},{src:"UsageInstructions/InsertDropCap.htm",name:"Insert a drop cap"},{src:"UsageInstructions/InsertTables.htm",name:"Insert tables",headername:"Operations on objects"},{src:"UsageInstructions/InsertImages.htm",name:"Insert images"},{src:"UsageInstructions/InsertAutoshapes.htm",name:"Insert autoshapes"},{src:"UsageInstructions/InsertCharts.htm",name:"Insert charts"},{src:"UsageInstructions/InsertTextObjects.htm",name:"Insert text objects"},{src:"UsageInstructions/AlignArrangeObjects.htm",name:"Align and arrange objects on a page"},{src:"UsageInstructions/ChangeWrappingStyle.htm",name:"Change wrapping style"},{src:"UsageInstructions/UseMailMerge.htm",name:"Use mail merge",headername:"Mail Merge"},{src:"UsageInstructions/InsertEquation.htm",name:"Insert equations",headername:"Math equations"},{src:"HelpfulHints/CollaborativeEditing.htm",name:"Collaborative document editing",headername:"Document co-editing"},{src:"HelpfulHints/Review.htm",name:"Document Review"},{src:"UsageInstructions/ViewDocInfo.htm",name:"View document information",headername:"Tools and settings"},{src:"UsageInstructions/SavePrintDownload.htm",name:"Save/download/print your document"},{src:"HelpfulHints/AdvancedSettings.htm",name:"Advanced settings of Document Editor"},{src:"HelpfulHints/Navigation.htm",name:"View settings and navigation tools"},{src:"HelpfulHints/Search.htm",name:"Search and replace function"},{src:"HelpfulHints/SpellChecking.htm",name:"Spell-checking"},{src:"HelpfulHints/About.htm",name:"About Document Editor",headername:"Helpful hints"},{src:"HelpfulHints/SupportedFormats.htm",name:"Supported formats of electronic documents"},{src:"HelpfulHints/KeyboardShortcuts.htm",name:"Keyboard shortcuts"}],Common.Utils.isIE&&(window.onhelp=function(){return!1})},render:function(){var t=this;return this.$el.html(this.template()),this.viewHelpPicker=new Common.UI.DataView({el:$("#id-help-contents"),store:new Common.UI.DataViewStore([]),keyMoveDirection:"vertical",itemTemplate:_.template(['<div id="<%= id %>" class="help-item-wrap">','<div class="caption"><%= name %></div>',"</div>"].join(""))}),this.viewHelpPicker.on("item:add",(function(t,e,i){i.has("headername")&&$(e.el).before('<div class="header-name">'+i.get("headername")+"</div>")})),this.viewHelpPicker.on("item:select",(function(e,i,n){t.onSelectItem(n.get("src"))})),this.iFrame=document.createElement("iframe"),this.iFrame.src="",this.iFrame.align="top",this.iFrame.frameBorder="0",this.iFrame.width="100%",this.iFrame.height="100%",(Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)&&(this.iFrame.onload=function(){try{t.findUrl(t.iFrame.contentWindow.location.href)}catch(t){}}),Common.Gateway.on("internalcommand",(function(e){"help:hyperlink"==e.type&&t.findUrl(e.data)})),$("#id-help-frame").append(this.iFrame),this},setLangConfig:function(t){var e=this,i=this.viewHelpPicker.store;if(t){t=t.split(/[\-\_]/)[0];var n={dataType:"json",error:function(){e.urlPref.indexOf("resources/help/en/")<0?(e.urlPref="resources/help/en/",i.url="resources/help/en/Contents.json",i.fetch(n)):(e.urlPref="resources/help/en/",i.reset(e.en_data))},success:function(){var t=e.openUrl?i.find((function(t){return e.openUrl.indexOf(t.get("src"))>=0})):i.at(0);t&&(e.viewHelpPicker.selectRecord(t,!0),e.viewHelpPicker.scrollToRecord(t)),e.onSelectItem(e.openUrl?e.openUrl:t.get("src"))}};Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.isHelpAvailable()?(e.urlPref=Common.Controllers.Desktop.helpUrl()+"/",i.url=e.urlPref+"Contents.json",i.fetch(n)):(e.noHelpContents=!0,e.iFrame.src="../../common/main/resources/help/download.html"):(i.url="resources/help/"+t+"/Contents.json",i.fetch(n),this.urlPref="resources/help/"+t+"/")}},show:function(t){Common.UI.BaseView.prototype.show.call(this),this._scrollerInited||(this.viewHelpPicker.scroller.update(),this._scrollerInited=!0),t&&(this.viewHelpPicker.store.length>0?(this.findUrl(t),this.onSelectItem(t)):this.openUrl=t)},onSelectItem:function(t){this.iFrame.src=this.urlPref+t},findUrl:function(t){var e=this.viewHelpPicker.store.find((function(e){return t.indexOf(e.get("src"))>=0}));e&&(this.viewHelpPicker.selectRecord(e,!0),this.viewHelpPicker.scrollToRecord(e))}}),PDFE.Views.PrintWithPreview=Common.UI.BaseView.extend(_.extend({el:"#panel-print",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-print-settings" class="no-padding">','<div class="print-settings">','<div class="flex-settings ps-container oo settings-container">','<div class="main-header"><%= scope.txtPrint %></div>','<table style="width: 100%;">',"<tbody>",'<tr><td><label class="header"><%= scope.txtPrintRange %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-range" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<table style="width: 100%;"><tbody>','<tr><td class="padding-large"><%= scope.txtPages %>:</td><td class="padding-large" style="width: 100%;"><div id="print-txt-pages" style="width: 100%;"></div></td></tr>','<tr><td><%= scope.txtCopies %>:</td><td style="width: 100%;"><div id="print-txt-copies" style="width: 60px;"></div></td></tr>',"</tbody></table>","</td></tr>",'<tr><td><label class="header"><%= scope.txtPrintSides %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-sides" style="width: 248px;"></div></td></tr>','<tr><td><label class="header"><%= scope.txtPageSize %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-pages" style="width: 248px;"></div></td></tr>','<tr><td><label class="header"><%= scope.txtPageOrientation %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-orient" style="width: 150px;"></div></td></tr>','<tr><td><label class="header"><%= scope.txtMargins %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-margins" style="width: 248px;"></div></td></tr>','<tr class="fms-btn-apply"><td>','<div class="footer justify">','<button id="print-btn-print" class="btn normal dlg-btn primary margin-right-8" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-print-pdf" class="btn normal dlg-btn" result="pdf" style="min-width: 96px;width: auto;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrintPdf %></button>',"</div>","</td></tr>","</tbody>","</table>","</div>","</div>","</div>",'<div id="print-preview-box" class="no-padding">','<div id="print-preview"></div>','<div id="print-navigation">',"<% if (!isRTL) { %>",'<div id="print-prev-page"></div>','<div id="print-next-page"></div>',"<% } else { %>",'<div id="print-next-page"></div>','<div id="print-prev-page"></div>',"<% } %>",'<div class="page-number margin-left-10">',"<label><%= scope.txtPage %></label>",'<div id="print-number-page" class="margin-left-4"></div>','<label id="print-count-page" class="margin-left-4"><%= scope.txtOf %></label>',"</div>","</div>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this._initSettings=!0},render:function(t){var e=this,i=$(this.template({scope:this,isRTL:Common.UI.isRTL()}));return this.cmbRange=new Common.UI.ComboBox({el:i.findById("#print-combo-range"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"all",displayValue:this.txtAllPages},{value:"current",displayValue:this.txtCurrentPage},{value:-1,displayValue:this.txtCustomPages}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbRange.setValue("all"),this.inputPages=new Common.UI.InputField({el:i.findById("#print-txt-pages"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,maskExp:/[0-9,\-]/,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnCopies=new Common.UI.MetricSpinner({el:i.findById("#print-txt-copies"),step:1,width:60,defaultUnit:"",value:1,maxValue:32767,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides=new Common.UI.ComboBox({el:i.findById("#print-combo-sides"),menuStyle:"width:100%;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc},{value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides.setValue("one"),this.cmbPaperSize=new Common.UI.ComboBox({el:i.findById("#print-combo-pages"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:"US Letter (21,59 cm x 27,94 cm)",caption:"US Letter",size:[215.9,279.4]},{value:1,displayValue:"US Legal (21,59 cm x 35,56 cm)",caption:"US Legal",size:[215.9,355.6]},{value:2,displayValue:"A4 (21 cm x 29,7 cm)",caption:"A4",size:[210,297]},{value:3,displayValue:"A5 (14,8 cm x 21 cm)",caption:"A5",size:[148,210]},{value:4,displayValue:"B5 (17,6 cm x 25 cm)",caption:"B5",size:[176,250]},{value:5,displayValue:"Envelope #10 (10,48 cm x 24,13 cm)",caption:"Envelope #10",size:[104.8,241.3]},{value:6,displayValue:"Envelope DL (11 cm x 22 cm)",caption:"Envelope DL",size:[110,220]},{value:7,displayValue:"Tabloid (27,94 cm x 43,18 cm)",caption:"Tabloid",size:[279.4,431.8]},{value:8,displayValue:"A3 (29,7 cm x 42 cm)",caption:"A3",size:[297,420]},{value:9,displayValue:"Tabloid Oversize (30,48 cm x 45,71 cm)",caption:"Tabloid Oversize",size:[304.8,457.1]},{value:10,displayValue:"ROC 16K (19,68 cm x 27,3 cm)",caption:"ROC 16K",size:[196.8,273]},{value:11,displayValue:"Envelope Choukei 3 (11,99 cm x 23,49 cm)",caption:"Envelope Choukei 3",size:[119.9,234.9]},{value:12,displayValue:"Super B/A3 (33,02 cm x 48,25 cm)",caption:"Super B/A3",size:[330.2,482.5]},{value:13,displayValue:"A4 (84,1 cm x 118,9 cm)",caption:"A0",size:[841,1189]},{value:14,displayValue:"A4 (59,4 cm x 84,1 cm)",caption:"A1",size:[594,841]},{value:16,displayValue:"A4 (42 cm x 59,4 cm)",caption:"A2",size:[420,594]},{value:17,displayValue:"A4 (10,5 cm x 14,8 cm)",caption:"A6",size:[105,148]},{value:-1,displayValue:this.txtCustom,caption:this.txtCustom,size:[]}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPaperOrientation=new Common.UI.ComboBox({el:i.findById("#print-combo-orient"),menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPageOrientation.PagePortrait,displayValue:this.txtPortrait},{value:Asc.c_oAscPageOrientation.PageLandscape,displayValue:this.txtLandscape}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPaperMargins=new Common.UI.ComboBox({el:i.findById("#print-combo-margins"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textMarginsNormal,size:[20,30,20,15]},{value:1,displayValue:this.textMarginsUsNormal,size:[25.4,25.4,25.4,25.4]},{value:2,displayValue:this.textMarginsNarrow,size:[12.7,12.7,12.7,12.7]},{value:3,displayValue:this.textMarginsModerate,size:[25.4,19.1,25.4,19.1]},{value:4,displayValue:this.textMarginsWide,size:[25.4,50.8,25.4,50.8]},{value:-1,displayValue:this.txtCustom,size:null}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<div><b><%= scope.getDisplayValue(item) %></b></div>",'<% if (item.size !== null) { %><div class="margin-right-20" style="display: inline-block;min-width: 80px;"><label style="display: block;">'+this.txtTop+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtLeft+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div style="display: inline-block;"><label style="display: block;">'+this.txtBottom+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtRight+": <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %>","<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlTable=$(this.pnlSettings.find("table")[0]),this.trApply=i.find(".fms-btn-apply"),this.btnPrint=new Common.UI.Button({el:i.findById("#print-btn-print")}),this.btnPrintPdf=new Common.UI.Button({el:i.findById("#print-btn-print-pdf")}),this.btnPrevPage=new Common.UI.Button({parentEl:i.findById("#print-prev-page"),cls:"btn-prev-page",iconCls:"arrow",dataHint:"2",dataHintDirection:"top"}),this.btnNextPage=new Common.UI.Button({parentEl:i.findById("#print-next-page"),cls:"btn-next-page",iconCls:"arrow",dataHint:"2",dataHintDirection:"top"}),this.countOfPages=i.findById("#print-count-page"),this.txtNumberPage=new Common.UI.InputField({el:i.findById("#print-number-page"),allowBlank:!0,validateOnChange:!0,style:"width: 50px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&t>0&&t<=e.pageCount)||e.txtPageNumInvalid},dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.$el=$(t).html(i),this.$previewBox=$("#print-preview-box"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this.updateMetricUnit(),this.fireEvent("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this._initSettings&&(this.updateMetricUnit(),this._initSettings=!1),this.updateScroller(),this.fireEvent("show",this)},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.height()+25+this.$el.find(".main-header").outerHeight(!0);this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update()}},setMode:function(t){this.mode=t},setApi:function(t){},updateMetricUnit:function(){if(this.cmbPaperSize){for(var t=this.cmbPaperSize.store,e=0;e<t.length-1;e++){var i=t.at(e),n=i.get("size"),o=n[0],s=n[1];i.set("displayValue",i.get("caption")+" ("+parseFloat(Common.Utils.Metric.fnRecalcFromMM(o).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+parseFloat(Common.Utils.Metric.fnRecalcFromMM(s).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+")")}this.cmbPaperSize.onResetItems(),this.cmbPaperMargins.onResetItems()}},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},updateCountOfPages:function(t){this.countOfPages.text(Common.Utils.String.format(this.txtOf,t)),this.pageCount=t},updateCurrentPage:function(t){this.txtNumberPage.setValue(t+1)},txtPrint:"Print",txtPrintPdf:"Print to PDF",txtPrintRange:"Print range",txtCurrentPage:"Current page",txtAllPages:"All pages",txtSelection:"Selection",txtCustomPages:"Custom print",txtPageSize:"Page size",txtPageOrientation:"Page orientation",txtPortrait:"Portrait",txtLandscape:"Landscape",txtCustom:"Custom",txtMargins:"Margins",txtTop:"Top",txtBottom:"Bottom",txtLeft:"Left",txtRight:"Right",txtPage:"Page",txtOf:"of {0}",txtPageNumInvalid:"Page number invalid",txtPages:"Pages",textMarginsLast:"Last Custom",textMarginsNormal:"Normal",textMarginsUsNormal:"US Normal",textMarginsNarrow:"Narrow",textMarginsModerate:"Moderate",textMarginsWide:"Wide",txtCopies:"Copies",txtPrintSides:"Print sides",txtOneSide:"Print one sided",txtOneSideDesc:"Only print on one side of the page",txtBothSides:"Print on both sides",txtBothSidesLongDesc:"Flip pages on long edge",txtBothSidesShortDesc:"Flip pages on short edge"},PDFE.Views.PrintWithPreview||{}))})),define("pdfeditor/main/app/controller/Print",["core","pdfeditor/main/app/view/FileMenuPanels"],(function(){"use strict";PDFE.Controllers.Print=Backbone.Controller.extend(_.extend({views:["PrintWithPreview"],initialize:function(){this.adjPrintParams=new Asc.asc_CAdjustPrint,this._state={lock_doc:!1,firstPrintPage:0},this._navigationPreview={pageCount:!1,currentPage:0,currentPreviewPage:0},this._isPreviewVisible=!1,this.addListeners({PrintWithPreview:{show:_.bind(this.onShowMainSettingsPrint,this),"render:after":_.bind(this.onAfterRender,this)}})},onLaunch:function(){this.printSettings=this.createView("PrintWithPreview")},onAfterRender:function(t){var e=this;this.printSettings.menu.on("menu:hide",_.bind(this.onHidePrintMenu,this)),this.printSettings.btnPrint.on("click",_.bind(this.onBtnPrint,this,!0)),this.printSettings.btnPrintPdf.on("click",_.bind(this.onBtnPrint,this,!1)),this.printSettings.btnPrevPage.on("click",_.bind(this.onChangePreviewPage,this,!1)),this.printSettings.btnNextPage.on("click",_.bind(this.onChangePreviewPage,this,!0)),this.printSettings.txtNumberPage.on({"keypress:after":_.bind(this.onKeypressPageNumber,this),"keyup:after":_.bind(this.onKeyupPageNumber,this)}),this.printSettings.txtNumberPage.cmpEl.find("input").on("blur",_.bind(this.onBlurPageNumber,this)),this.printSettings.cmbPaperSize.on("selected",_.bind(this.onPaperSizeSelect,this)),this.printSettings.cmbPaperOrientation.on("selected",_.bind(this.onPaperOrientSelect,this)),this.printSettings.cmbPaperMargins.on("selected",_.bind(this.onPaperMarginsSelect,this)),this.printSettings.cmbRange.on("selected",_.bind(this.comboRangeChange,this)),this.printSettings.inputPages.on("changing",_.bind(this.inputPagesChanging,this)),this.printSettings.inputPages.validation=function(t){if(!_.isEmpty(t)&&/[0-9,\-]/.test(t)){var i=[],n=t.split(",");if(e._isPrint&&n.length>1)return e.txtPrintRangeSingleRange;for(var o=0;o<n.length;o++){var s=n[o];if(!s)return e.txtPrintRangeInvalid;var a=s.match(/\-/g);if(a&&a.length>1)return e.txtPrintRangeInvalid;if(a){var r=s.split("-"),l=r[0]?parseInt(r[0])-1:0,c=r[1]?parseInt(r[1])-1:e._navigationPreview.pageCount-1;if(l>c){h=l;l=c,c=h}for(var d=l;d<=c;d++)d>=0&&i.push(d)}else{var h;(h=parseInt(s)-1)>=0&&i.push(h)}}if(i.length>0)return e._state.firstPrintPage=i[0],!0}return e.txtPrintRangeInvalid},Common.NotificationCenter.on("window:resize",_.bind((function(){this._isPreviewVisible&&this.api.asc_drawPrintPreview(this._navigationPreview.currentPreviewPage)}),this)),Common.NotificationCenter.on("margins:update",_.bind(this.onUpdateLastCustomMargins,this));var i=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";this.printSettings.$previewBox.on(i,_.bind(this.onPreviewWheel,this))},setMode:function(t){this.mode=t,this.printSettings&&this.printSettings.setMode(t)},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onDocSize",_.bind(this.onApiPageSize,this)),this.api.asc_registerCallback("asc_onPageOrient",_.bind(this.onApiPageOrient,this)),this.api.asc_registerCallback("asc_onSectionProps",_.bind(this.onSectionProps,this)),this.api.asc_registerCallback("asc_onCountPages",_.bind(this.onCountPages,this)),this.api.asc_registerCallback("asc_onCurrentPage",_.bind(this.onCurrentPage,this)),this.api.asc_registerCallback("asc_onLockDocumentProps",_.bind(this.onApiLockDocumentProps,this)),this.api.asc_registerCallback("asc_onUnLockDocumentProps",_.bind(this.onApiUnLockDocumentProps,this)),this},findPagePreset:function(t,e){for(var i=t<e?t:e,n=t<e?e:t,o=this.printSettings.cmbPaperSize.store,s=null,a=0;a<o.length-1;a++){var r=o.at(a),l=r.get("size"),c=l[0],d=l[1];if(Math.abs(c-i)<.1&&Math.abs(d-n)<.1){s=r;break}}return s?s.get("caption"):void 0},onApiPageSize:function(t,e){if(this._state.pgsize=[t,e],this.printSettings.isVisible()){for(var i=this._state.pgorient?t:e,n=this._state.pgorient?e:t,o=this.printSettings,s=o.cmbPaperSize.store,a=null,r=0;r<s.length-1;r++){var l=s.at(r),c=l.get("size"),d=c[0],h=c[1];if(Math.abs(d-i)<.1&&Math.abs(h-n)<.1){a=l;break}}a?o.cmbPaperSize.setValue(a.get("value")):o.cmbPaperSize.setValue(this.txtCustom+" ("+parseFloat(Common.Utils.Metric.fnRecalcFromMM(i).toFixed(2))+Common.Utils.Metric.getCurrentMetricName()+" x "+parseFloat(Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2))+Common.Utils.Metric.getCurrentMetricName()+")")}else this.isFillProps=!1},onApiPageOrient:function(t){if(this._state.pgorient=!!t,this.printSettings.isVisible()){var e=this.printSettings.cmbPaperOrientation.store.findWhere({value:this._state.pgorient?Asc.c_oAscPageOrientation.PagePortrait:Asc.c_oAscPageOrientation.PageLandscape});e&&this.printSettings.cmbPaperOrientation.setValue(e.get("value"))}},onSectionProps:function(t){if(t&&(this._state.sectionprops=t,this.printSettings.isVisible())){var e=t.get_LeftMargin(),i=t.get_TopMargin(),n=t.get_RightMargin(),o=t.get_BottomMargin();this._state.pgmargins=[i,e,o,n];for(var s=this.printSettings.cmbPaperMargins.store,a=null,r=0;r<s.length-1;r++){var l=s.at(r),c=l.get("size");"object"==typeof c&&Math.abs(c[0]-i)<.1&&Math.abs(c[1]-e)<.1&&Math.abs(c[2]-o)<.1&&Math.abs(c[3]-n)<.1&&(a=l)}a?this.printSettings.cmbPaperMargins.setValue(a.get("value")):this.printSettings.cmbPaperMargins.setValue(this.txtCustom)}},comboRangeChange:function(t,e){if(-1===e.value){var i=this;setTimeout((function(){i.printSettings.inputPages.focus()}),50)}else this.printSettings.inputPages.setValue("");this.printSettings.inputPages.showError()},onCountPages:function(t){this._navigationPreview.pageCount=t,this._navigationPreview.currentPreviewPage>t-1&&(this._navigationPreview.currentPreviewPage=Math.max(0,t-1),this.printSettings.isVisible()&&(this.api.asc_drawPrintPreview(this._navigationPreview.currentPreviewPage),this.updateNavigationButtons(this._navigationPreview.currentPreviewPage,t)))},onCurrentPage:function(t){this._navigationPreview.currentPreviewPage=t,this.printSettings.isVisible()&&(this.api.asc_drawPrintPreview(this._navigationPreview.currentPreviewPage),this.updateNavigationButtons(this._navigationPreview.currentPreviewPage,this._navigationPreview.pageCount))},onShowMainSettingsPrint:function(){this.printSettings.$previewBox.removeClass("hidden"),this.onUpdateLastCustomMargins(this._state.lastmargins),this._state.pgsize&&this.onApiPageSize(this._state.pgsize[0],this._state.pgsize[1]),this.onApiPageOrient(this._state.pgorient),this._state.sectionprops&&this.onSectionProps(this._state.sectionprops);var t=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86);t.asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_initPrintPreview("print-preview",t),this._navigationPreview.currentPreviewPage=this._navigationPreview.currentPage=this.api.getCurrentPage(),this.api.asc_drawPrintPreview(this._navigationPreview.currentPreviewPage),this.updateNavigationButtons(this._navigationPreview.currentPreviewPage,this._navigationPreview.pageCount),this.SetDisabled(),this._isPreviewVisible=!0},onPaperSizeSelect:function(t,e){if(this._state.pgsize=[0,0],-1!==e.value){if(this.checkPageSize(e.size[0],e.size[1])){var i=this.api.asc_GetSectionProps();return void this.onApiPageSize(i.get_W(),i.get_H())}this.api.change_DocSize(e.size[0],e.size[1])}else{var n,o,s=this;(n=new DE.Views.PageSizeDialog({checkPageSize:_.bind(this.checkPageSize,this),handler:function(t,e){"ok"==e&&(o=t.getSettings(),s.api.change_DocSize(o[0],o[1]),Common.NotificationCenter.trigger("edit:complete"))}})).show(),n.setSettings(s.api.asc_GetSectionProps())}Common.NotificationCenter.trigger("edit:complete")},onPaperMarginsSelect:function(t,e){if(this._state.pgmargins=void 0,-1!==e.value){if(this.checkPageSize(void 0,void 0,e.size[1],e.size[3],e.size[0],e.size[2]))return void this.onSectionProps(this.api.asc_GetSectionProps());(n=new Asc.CDocumentSectionProps).put_TopMargin(e.size[0]),n.put_LeftMargin(e.size[1]),n.put_BottomMargin(e.size[2]),n.put_RightMargin(e.size[3]),this.api.asc_SetSectionProps(n)}else{var i,n,o=this;(i=new DE.Views.PageMarginsDialog({api:o.api,handler:function(t,e){"ok"==e&&(n=t.getSettings(),Common.localStorage.setItem("de-pgmargins-top",n.get_TopMargin()),Common.localStorage.setItem("de-pgmargins-left",n.get_LeftMargin()),Common.localStorage.setItem("de-pgmargins-bottom",n.get_BottomMargin()),Common.localStorage.setItem("de-pgmargins-right",n.get_RightMargin()),Common.NotificationCenter.trigger("margins:update",n),o.api.asc_SetSectionProps(n),Common.NotificationCenter.trigger("edit:complete"))}})).show(),i.setSettings(o.api.asc_GetSectionProps())}Common.NotificationCenter.trigger("edit:complete")},onUpdateLastCustomMargins:function(t){if(this._state.lastmargins=t,this.printSettings.isVisible()){var e=t?t.get_TopMargin():Common.localStorage.getItem("de-pgmargins-top"),i=t?t.get_LeftMargin():Common.localStorage.getItem("de-pgmargins-left"),n=t?t.get_BottomMargin():Common.localStorage.getItem("de-pgmargins-bottom"),o=t?t.get_RightMargin():Common.localStorage.getItem("de-pgmargins-right");if(null!==e&&null!==i&&null!==n&&null!==o){var s=this.printSettings.cmbPaperMargins.store.at(0);-2===s.get("value")?s.set("size",[parseFloat(e),parseFloat(i),parseFloat(n),parseFloat(o)]):this.printSettings.cmbPaperMargins.store.unshift({value:-2,displayValue:this.textMarginsLast,size:[parseFloat(e),parseFloat(i),parseFloat(n),parseFloat(o)]}),this.printSettings.cmbPaperMargins.onResetItems()}}},onPaperOrientSelect:function(t,e){this._state.pgorient=void 0,this.api&&this.api.change_PageOrient(e.value===Asc.c_oAscPageOrientation.PagePortrait),Common.NotificationCenter.trigger("edit:complete")},checkPageSize:function(t,e,i,n,o,s){var a=this.api.asc_GetSectionProps();void 0===t&&(t=parseFloat(a.get_W().toFixed(4))),void 0===e&&(e=parseFloat(a.get_H().toFixed(4))),void 0===i&&(i=parseFloat(a.get_LeftMargin().toFixed(4))),void 0===n&&(n=parseFloat(a.get_RightMargin().toFixed(4))),void 0===o&&(o=parseFloat(a.get_TopMargin().toFixed(4))),void 0===s&&(s=parseFloat(a.get_BottomMargin().toFixed(4)));var r=a.get_GutterAtTop()?0:parseFloat(a.get_Gutter().toFixed(4)),l=a.get_GutterAtTop()?parseFloat(a.get_Gutter().toFixed(4)):0,c=null;if(i+n+r>t-12.7?c=this.txtMarginsW:o+s+l>e-2.6&&(c=this.txtMarginsH),c)return Common.UI.warning({title:this.notcriticalErrorTitle,msg:c,callback:function(){Common.NotificationCenter.trigger("edit:complete")}}),!0},getPrintParams:function(){return this.adjPrintParams},onHidePrintMenu:function(){this._isPreviewVisible&&(this.api.asc_closePrintPreview&&this.api.asc_closePrintPreview(),this._isPreviewVisible=!1)},onChangePreviewPage:function(t){var e=this._navigationPreview.currentPreviewPage;t?(e++,e=Math.min(e,this._navigationPreview.pageCount-1)):(e--,e=Math.max(e,0)),this.api.goToPage(e)},onKeypressPageNumber:function(t,e){if(e.keyCode===Common.UI.Keys.RETURN){var i=this.printSettings.$el.find("#print-number-page"),n=i.find("input[type=text]"),o=parseInt(n.val());return!o||o>this._navigationPreview.pageCount||o<0?(n.select(),this.printSettings.txtNumberPage.setValue(this._navigationPreview.currentPreviewPage+1),this.printSettings.txtNumberPage.checkValidate(),!1):(i.focus(),this.api.goToPage(o-1),!1)}},onKeyupPageNumber:function(t,e){if(e.keyCode===Common.UI.Keys.ESC)return this.printSettings.$el.find("#print-number-page").focus(),this.api.asc_enableKeyEvents(!0),!1},onBlurPageNumber:function(){this.printSettings.txtNumberPage.getValue()!=this._navigationPreview.currentPreviewPage+1&&(this.printSettings.txtNumberPage.setValue(this._navigationPreview.currentPreviewPage+1),this.printSettings.txtNumberPage.checkValidate())},onPreviewWheel:function(t){t.ctrlKey&&(t.preventDefault(),t.stopImmediatePropagation());var e=(t.deltaY||t.detail&&-t.detail||t.wheelDelta)<0;this.onChangePreviewPage(e)},updateNavigationButtons:function(t,e){this._navigationPreview.currentPage=t,this.printSettings.updateCurrentPage(t),this._navigationPreview.pageCount=e,this.printSettings.updateCountOfPages(e),this.disableNavButtons()},disableNavButtons:function(t){if(t)return this.printSettings.btnPrevPage.setDisabled(!0),void this.printSettings.btnNextPage.setDisabled(!0);var e=this._navigationPreview.currentPage,i=this._navigationPreview.pageCount;this.printSettings.btnPrevPage.setDisabled(e<1),this.printSettings.btnNextPage.setDisabled(e>i-2)},onBtnPrint:function(t){if(this._isPrint=t,-1===this.printSettings.cmbRange.getValue()&&!0!==this.printSettings.inputPages.checkValidate())return this.printSettings.inputPages.focus(),void(this.isInputFirstChange=!0);"all"===this.printSettings.cmbRange.getValue()?this._state.firstPrintPage=0:"current"===this.printSettings.cmbRange.getValue()&&(this._state.firstPrintPage=this._navigationPreview.currentPage);var e,i=this.api.asc_getPageSize(this._state.firstPrintPage);(this.adjPrintParams.asc_setNativeOptions({pages:-1===this.printSettings.cmbRange.getValue()?this.printSettings.inputPages.getValue():this.printSettings.cmbRange.getValue(),paperSize:{w:i?i.W:void 0,h:i?i.H:void 0,preset:i?this.findPagePreset(i.W,i.H):void 0},paperOrientation:i?i.H>i.W?"portrait":"landscape":null,copies:this.printSettings.spnCopies.getNumberValue()||1,sides:this.printSettings.cmbSides.getValue()}),this.printSettings.menu.hide(),t)?((e=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)).asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_Print(e)):((e=new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF)).asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_DownloadAs(e))},inputPagesChanging:function(t,e){this.isInputFirstChange&&this.printSettings.inputPages.showError(),this.isInputFirstChange=!1,e.length<1?this.printSettings.cmbRange.setValue("all"):-1!==this.printSettings.cmbRange.getValue()&&this.printSettings.cmbRange.setValue(-1)},onApiLockDocumentProps:function(){this._state.lock_doc=!0,this.SetDisabled()},onApiUnLockDocumentProps:function(){this._state.lock_doc=!1,this.SetDisabled()},SetDisabled:function(){if(this.printSettings.isVisible()){var t=!0;this.printSettings.cmbPaperSize.setDisabled(t),this.printSettings.cmbPaperMargins.setDisabled(t),this.printSettings.cmbPaperOrientation.setDisabled(t)}},txtCustom:"Custom",txtPrintRangeInvalid:"Invalid print range",textMarginsLast:"Last Custom",txtPrintRangeSingleRange:"Enter either a single page number or a single page range (for example, 5-12). Or you can Print to PDF."},PDFE.Controllers.Print||{}))})),void 0===Common)var Common={};if(Common.Models=Common.Models||{},define("common/main/lib/model/Comment",["underscore","backbone","common/main/lib/component/BaseView"],(function(t,e){"use strict";Common.Models.Comment=e.Model.extend({defaults:{uid:0,guid:"",userid:0,username:"Guest",parsedName:"Guest",parsedGroups:void 0,usercolor:null,date:void 0,quote:"",comment:"",resolved:!1,lock:!1,lockuserid:"",unattached:!1,userdata:"",position:-1,id:Common.UI.getId(),time:0,showReply:!1,showReplyInPopover:!1,editText:!1,editTextInPopover:!1,last:void 0,replys:[],hideAddReply:!1,scope:null,hide:!1,filtered:!1,hint:!1,fullInfoInHint:!1,dummy:void 0,editable:!0,removable:!0}}),Common.Models.Reply=e.Model.extend({defaults:{time:0,userid:0,username:"Guest",parsedName:"Guest",usercolor:null,reply:"",date:void 0,userdata:"",id:Common.UI.getId(),editText:!1,editTextInPopover:!1,scope:null,editable:!0,removable:!0,hide:!1}})})),void 0===Common)var Common={};if(Common.Collections=Common.Collections||{},define("common/main/lib/collection/Comments",["underscore","backbone","common/main/lib/model/Comment"],(function(t,e){"use strict";Common.Collections.Comments=e.Collection.extend({model:Common.Models.Comment,groups:null,clearEditing:function(){this.each((function(t){t.set("editText",!1),t.set("editTextInPopover",!1),t.set("showReply",!1),t.set("showReplyInPopover",!1),t.set("hideAddReply",!1)}))},getCommentsReplysCount:function(t){var e=0;return this.each((function(i){i.get("userid")==t&&e++;var n=i.get("replys");n&&n.length>0&&n.forEach((function(i){i.get("userid")==t&&e++}))})),e}})})),define("text!common/main/lib/template/CommentsPopover.template",[],(function(){return'<% if (!hide) { %>\r\n<div id="<%=id%>" class="user-comment-item">\r\n\r\n    \x3c!-- comment block --\x3e\r\n\r\n    <div class="user-name">\r\n        <div class="color" style="display: inline-block; background-color: <% if (usercolor!==null) { %><%=usercolor%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(parsedName) %>\r\n    </div>\r\n    <div class="user-date"><%=date%></div>\r\n    <% if (!editTextInPopover || (hint && !fullInfoInHint) || scope.viewmode) { %>\r\n        <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(comment)%></div>\r\n    <% } else { %>\r\n        <div class="inner-edit-ct">\r\n            <textarea class="msg-reply user-select" maxlength="maxCommLength" spellcheck="false" <% if (!!dummy) { %> placeholder="textMentionComment"<% } %>><%=comment%></textarea>\r\n            <% if (hideAddReply) { %>\r\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change-popover">textAdd</button>\r\n            <% } else { %>\r\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change-popover">textEdit</button>\r\n            <% } %>\r\n            <button class="btn normal dlg-btn btn-inner-close">textCancel</button>\r\n        </div>\r\n    <% } %>\r\n\r\n    \x3c!-- replys elements --\x3e\r\n\r\n    <% var add_arrow = true; %>\r\n    <% if (replys.length) { %>\r\n        <% _.each(replys, function (item) { %>\r\n            <% if (!item.get("hide")) { %>\r\n            <% if (add_arrow) { add_arrow = false; %>\r\n                <div class="reply-arrow img-commonctrl"></div>\r\n            <% } %>\r\n            <div class="reply-item-ct">\r\n                <div class="user-name">\r\n                    <div class="color" style="display: inline-block; background-color: <% if (item.get("usercolor")!==null) { %><%=item.get("usercolor")%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(item.get("parsedName")) %>\r\n                </div>\r\n                <div class="user-date"><%=item.get("date")%></div>\r\n                <% if (!item.get("editTextInPopover")) { %>\r\n                    <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(item.get("reply"))%></div>\r\n                    <% if ((fullInfoInHint || !hint) && !scope.viewmode) { %>\r\n                        <div class="btns-reply-ct">\r\n                            <% if (item.get("editable")) { %>\r\n                                <div class="btn-edit img-commonctrl" data-value="<%=item.get("id")%>"></div>\r\n                            <%}%>\r\n                            <% if (item.get("removable")) { %>\r\n                               <div class="btn-delete img-commonctrl" data-value="<%=item.get("id")%>"></div>\r\n                            <%}%>\r\n                        </div>\r\n                    <%}%>\r\n                <% } else { %>\r\n                    <div class="inner-edit-ct">\r\n                        <textarea class="msg-reply textarea-fix user-select" maxlength="maxCommLength" spellcheck="false"><%=item.get("reply")%></textarea>\r\n                        <button class="btn normal dlg-btn primary btn-inner-edit btn-fix" id="id-comments-change-popover">textEdit</button>\r\n                        <button class="btn normal dlg-btn btn-inner-close">textClose</button>\r\n                    </div>\r\n                <% } %>\r\n            </div>\r\n            <% } %>\r\n        <% }); %>\r\n    <% } %>\r\n\r\n    \x3c!-- add reply button --\x3e\r\n\r\n    <% if (!showReplyInPopover && !hideAddReply && (fullInfoInHint || !hint) && !scope.viewmode) { %>\r\n        <% if (replys.length && !add_arrow) { %>\r\n            <label class="user-reply with-reply" role="presentation" tabindex="-1">textAddReply</label>\r\n        <% } else { %>\r\n            <label class="user-reply" role="presentation" tabindex="-1">textAddReply</label>\r\n        <% } %>\r\n    <% } %>\r\n\r\n    \x3c!-- edit buttons --\x3e\r\n\r\n    <% if (!editTextInPopover && !lock) { %>\r\n        <div class="edit-ct">\r\n            <% if ((fullInfoInHint || !hint) && !scope.viewmode) { %>\r\n                <% if (editable) { %>\r\n                    <div class="btn-edit img-commonctrl"></div>\r\n                <% } %>\r\n                <% if (removable) { %>\r\n                    <div class="btn-delete img-commonctrl"></div>\r\n                <% } %>\r\n            <% } %>\r\n            <% if (editable && (fullInfoInHint || !hint) && !scope.viewmode) { %>\r\n                <div class="btn-resolve <% if (resolved) print(\'comment-resolved\') %>" data-toggle="tooltip"></div>\r\n            <% } else if ((fullInfoInHint || !hint) && (!editable || scope.viewmode) && resolved) { %>\r\n                <div class="icon-resolve i-comment-resolved" data-toggle="tooltip"></div>\r\n            <% } %>\r\n        </div>\r\n    <% } %>\r\n\r\n    \x3c!-- reply --\x3e\r\n\r\n    <% if (showReplyInPopover) { %>\r\n        <div class="reply-ct">\r\n            <textarea class="msg-reply user-select" placeholder="textMentionReply" maxlength="maxCommLength" spellcheck="false"></textarea>\r\n            <button class="btn normal dlg-btn primary btn-reply" id="id-comments-change-popover">textReply</button>\r\n            <button class="btn normal dlg-btn btn-close">textClose</button>\r\n        </div>\r\n    <% } %>\r\n\r\n    \x3c!-- locked user --\x3e\r\n\r\n    <% if (lock) { %>\r\n        <div class="lock-area" style="cursor: default;"></div>\r\n        <div class="lock-author" style="cursor: default;"><%=lockuserid%></div>\r\n    <% } %>\r\n\r\n</div>\r\n<% } %>'})),define("text!common/main/lib/template/ReviewChangesPopover.template",[],(function(){return'<div id="<%=id%>" class="user-comment-item">\r\n    <div class="user-name">\r\n        <div class="color" style="display: inline-block; background-color: <% if (usercolor!==null) { %><%=usercolor%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getUserName(username) %>\r\n    </div>\r\n    <div class="user-date"><%=date%></div>\r\n    <div class="user-message limit-height"><%=changetext%></div>\r\n    <div class="edit-ct">\r\n        <% if (goto) { %>\r\n        <div class="btn-goto img-commonctrl"></div>\r\n        <% } %>\r\n        <% if (!hint) { %>\r\n            <% if (scope.appConfig.isReviewOnly || docProtection.isReviewOnly) { %>\r\n                <% if (editable) { %>\r\n                <div class="btn-delete img-commonctrl"></div>\r\n                <% } %>\r\n            <% } else if (editable) { %>\r\n            <div class="btn-accept"></div>\r\n            <div class="btn-reject tool "></div>\r\n            <% } %>\r\n        <% } %>\r\n    </div>\r\n    <% if (!hint && lock) { %>\r\n    <div class="lock-area" style="cursor: default;"></div>\r\n    <div class="lock-author" style="cursor: default;"><%=lockuser%></div>\r\n    <% } %>\r\n</div>'})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/ReviewPopover",["text!common/main/lib/template/CommentsPopover.template","text!common/main/lib/template/ReviewChangesPopover.template","common/main/lib/util/utils","common/main/lib/component/Button","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/Layout","common/main/lib/component/Window"],(function(t,e){"use strict";function i(t,e){var i,n,o=t;for(i in e)void 0!==i&&(n=e[i],o=o.replace(new RegExp(i,"g"),n));return o}Common.Views.ReviewPopover=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};return _.extend(e,{closable:!1,width:265,height:120,header:!1,modal:!1,automove:!1,alias:"Common.Views.ReviewPopover"},t),this.template=t.template||['<div class="box">','<div id="id-popover" class="comments-popover" style="overflow-y: hidden;position: relative;">','<div id="id-review-popover"></div>','<div id="id-comments-popover"></div>',"</div>",'<div id="id-comments-arrow" class="comments-arrow"></div>',"</div>"].join(""),this.commentsStore=t.commentsStore,this.reviewStore=t.reviewStore,this.canRequestUsers=t.canRequestUsers,this.canRequestSendNotify=t.canRequestSendNotify,this.mentionShare=t.mentionShare,this.api=t.api,this._state={commentsVisible:!1,reviewVisible:!1},e.tpl=_.template(this.template)(e),this.arrow={margin:20,width:10,height:30},this.sdkBounds={width:0,height:0,padding:10,paddingTop:20},Common.UI.Window.prototype.initialize.call(this,e),this.canRequestUsers&&Common.NotificationCenter.on("mentions:setusers",_.bind(this.onEmailListMenuCallback,this)),this},render:function(n,o){Common.UI.Window.prototype.render.call(this);var s=this,a=this.$window;a.css({height:"",minHeight:"",overflow:"hidden",position:"absolute",zIndex:"990"});var r=a.find(".body");r&&r.css("position","relative");var l,c=Common.UI.DataView.extend((l=s,{options:{handleSelect:!1,allowScrollbar:!1,template:_.template('<div class="dataview-ct inner" style="overflow-y: visible;"></div>')},getTextBox:function(){var t=$(this.el).find("textarea");return t&&t.length?t:void 0},setFocusToTextBox:function(t){var e=$(this.el).find("textarea");if(t)e.blur();else if(e&&e.length){var i=e.val();e.focus(),e.val(""),e.val(i)}},getActiveTextBoxVal:function(){var t=$(this.el).find("textarea");return t&&t.length?t.val().trim():""},disableTextBoxButton:function(t){var e=$(t.siblings("#id-comments-change-popover")[0]);t.val().trim().length>0?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},autoHeightTextBox:function(){var t=this,e=this.$el.find("textarea"),i=null,n=55,o=0,a=0,r=0;function c(){a=l.scroller.getScrollTop(),i.scrollHeight>i.clientHeight?i.clientHeight+2<parseInt($(i).css("max-height"))&&(e.css({height:i.scrollHeight+o+"px"}),l.calculateSizeOfContent()):i.clientHeight>=n&&(e.css({height:n+"px"}),i.scrollHeight>i.clientHeight&&(r=Math.max(i.scrollHeight+o,n),e.css({height:r+"px"})),l.calculateSizeOfContent(),l.setLeftTop(s.arrowPosX,s.arrowPosY,s.leftX),l.calculateSizeOfContent()),l.scroller.scrollTop(a),l.autoScrollToEditButtons()}e&&e.length&&l.scroller&&(i=e.get(0),t.disableTextBoxButton(e),i&&(o=.25*parseInt(e.css("lineHeight"),10),c(),e.bind("input propertychange",(function(e){c(),t.disableTextBoxButton($(e.target))})))),this.textBox=e},clearTextBoxBind:function(){this.textBox&&(this.textBox.unbind("input propertychange"),this.textBox=void 0)}}));if(c)if(this.commentsView)this.commentsView.render($("#id-comments-popover")),this.commentsView.onResetItems();else{this.commentsView=new c({el:$("#id-comments-popover"),itemTemplate:_.template(i(t,{textAddReply:s.textAddReply,textMentionReply:s.canRequestSendNotify?s.mentionShare?s.textMention:s.textMentionNotify:s.textAddReply,textAdd:s.textAdd,textCancel:s.textCancel,textEdit:s.textEdit,textReply:s.textReply,textClose:s.textClose,maxCommLength:Asc.c_oAscMaxCellOrCommentLength,textMentionComment:s.canRequestSendNotify?s.mentionShare?s.textMention:s.textMentionNotify:s.textEnterComment}))});var d=function(t,e,i){e.tipsArray&&e.tipsArray.forEach((function(t){t.remove()}));var n=[],o=$(e.el).find(".btn-resolve:not(.comment-resolved)");o.tooltip({title:s.textResolve,placement:"cursor"}),o.each((function(t,e){n.push($(e).data("bs.tooltip").tip())})),(o=$(e.el).find(".comment-resolved")).tooltip({title:s.textOpenAgain,placement:"cursor"}),o.each((function(t,e){n.push($(e).data("bs.tooltip").tip())})),(o=$(e.el).find(".i-comment-resolved")).tooltip({title:s.textViewResolved,placement:"cursor"}),o.each((function(t,e){n.push($(e).data("bs.tooltip").tip())})),(o=$(e.el).find(".btn-edit")).tooltip({title:s.txtEditTip,placement:"cursor"}),o.each((function(t,e){n.push($(e).data("bs.tooltip").tip())})),(o=$(e.el).find(".btn-delete")).tooltip({title:s.txtDeleteTip,placement:"cursor"}),o.each((function(t,e){n.push($(e).data("bs.tooltip").tip())})),e.tipsArray=n,this.autoHeightTextBox()};this.commentsView.on("item:add",d),this.commentsView.on("item:remove",d),this.commentsView.on("item:change",d),this.commentsView.cmpEl.on("mouseover",(function(){s._isMouseOver=!0})).on("mouseout",(function(){s._isMouseOver=!1})),this.commentsView.setStore(s.commentsStore),this.commentsView.onResetItems(),this.commentsView.on("item:click",(function(t,e,i,n){var o,a,r,l,c,d;function h(){s.update()}if(o=$(n.target)){if(a=i.get("editTextInPopover"),r=i.get("showReplyInPopover"),d=i.get("hideAddReply"),l=i.get("uid"),c=o.attr("data-value"),i.get("hint")&&(s.fireEvent("comment:disableHint",[i]),!i.get("fullInfoInHint")))return;if(o.hasClass("btn-edit"))(p=o.data("bs.tooltip"))&&(p.dontShow=!0),_.isUndefined(c)?a||(s.fireEvent("comment:closeEditing"),i.set("editTextInPopover",!0),s.fireEvent("comment:show",[l]),this.autoHeightTextBox(),s.calculateSizeOfContent(),s.setLeftTop(s.arrowPosX,s.arrowPosY,s.leftX),s.calculateSizeOfContent(),h(),s.hookTextBox(),s.autoScrollToEditButtons(),this.setFocusToTextBox()):(s.fireEvent("comment:closeEditing",[l]),s.fireEvent("comment:editReply",[l,c,!0]),this.replyId=c,this.autoHeightTextBox(),s.calculateSizeOfContent(),s.setLeftTop(s.arrowPosX,s.arrowPosY,s.leftX),s.calculateSizeOfContent(),h(),s.hookTextBox(),s.autoScrollToEditButtons(),this.setFocusToTextBox());else if(o.hasClass("btn-delete")){(p=o.data("bs.tooltip"))&&(p.dontShow=!0),_.isUndefined(c)?s.fireEvent("comment:remove",[l]):(s.fireEvent("comment:removeReply",[l,c]),s.calculateSizeOfContent(),s.setLeftTop(s.arrowPosX,s.arrowPosY,s.leftX),s.calculateSizeOfContent()),s.fireEvent("comment:closeEditing"),h()}else if(o.hasClass("user-reply"))s.fireEvent("comment:closeEditing"),i.set("showReplyInPopover",!0),s.calculateSizeOfContent(),s.setLeftTop(s.arrowPosX,s.arrowPosY,s.leftX),s.calculateSizeOfContent(),h(),this.autoHeightTextBox(),s.hookTextBox(),s.autoScrollToEditButtons(),this.setFocusToTextBox();else if(o.hasClass("btn-reply",!1))r&&(this.clearTextBoxBind(),s.fireEvent("comment:addReply",[l,this.getActiveTextBoxVal()]),s.fireEvent("comment:closeEditing"),s.calculateSizeOfContent(),h());else if(o.hasClass("btn-close",!1))s.fireEvent("comment:closeEditing",[l]),s.calculateSizeOfContent(),s.fireEvent("comment:show",[l]),h();else if(o.hasClass("btn-inner-edit",!1)){if(i.get("dummy")){var m=this.getActiveTextBoxVal();if(s.clearDummyText(),m.length>0)s.fireEvent("comment:addDummyComment",[m]);else{var u=s.$window.find("textarea:not(.user-message)");u&&u.length&&setTimeout((function(){u.focus()}),10)}return}this.clearTextBoxBind(),_.isUndefined(this.replyId)?a&&(s.fireEvent("comment:change",[l,this.getActiveTextBoxVal()]),s.fireEvent("comment:closeEditing"),s.calculateSizeOfContent()):(s.fireEvent("comment:changeReply",[l,this.replyId,this.getActiveTextBoxVal()]),this.replyId=void 0,s.fireEvent("comment:closeEditing")),h()}else if(o.hasClass("btn-inner-close",!1)){if(i.get("dummy"))return s.clearDummyText(),void s.hide();d&&this.getActiveTextBoxVal().length>0?(s.saveText(),i.set("hideAddReply",!1),this.getTextBox().val(s.textVal),this.autoHeightTextBox()):(this.clearTextBoxBind(),s.fireEvent("comment:closeEditing",[l])),this.replyId=void 0,s.calculateSizeOfContent(),s.setLeftTop(s.arrowPosX,s.arrowPosY,s.leftX),s.calculateSizeOfContent(),h()}else if(o.hasClass("btn-resolve")){var p;(p=o.data("bs.tooltip"))&&(p.dontShow=!0),s.fireEvent("comment:resolve",[l]),h()}}})),this.emailMenu=new Common.UI.Menu({maxHeight:200,cyclic:!1,cls:"font-size-medium",items:[]}).on("render:after",(function(t){this.scroller=new Common.UI.Scroller({el:$(this.el).find(".dropdown-menu "),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:40,alwaysVisibleY:!0})})).on("show:after",(function(){this.scroller.update({alwaysVisibleY:!0}),s.$window.css({zIndex:"1001"})})).on("hide:after",(function(){s.$window.css({zIndex:"990"})})),s.on({show:function(){s.commentsView.autoHeightTextBox(),s.$window.find("textarea").keydown((function(t){t.keyCode==Common.UI.Keys.ESC&&s.hide(!0)}))},"animate:before":function(){var t=s.$window.find("textarea");t&&t.length&&(t.focus(),s.commentsView.disableTextBoxButton(t))}})}var h=Common.UI.DataView.extend({options:{handleSelect:!1,scrollable:!0,template:_.template('<div class="dataview-ct inner" style="overflow-y: visible;"></div>')}});if(h)if(this.reviewChangesView)this.reviewChangesView.render($("#id-review-popover")),this.reviewChangesView.onResetItems();else{this.reviewChangesView=new h({el:$("#id-review-popover"),itemTemplate:_.template(e)});d=function(t,e,i){e.tipsArray&&e.tipsArray.forEach((function(t){t.remove()}));var n=[],o=$(e.el).find(".btn-goto");o.tooltip({title:s.textFollowMove,placement:"cursor"}),o.each((function(t,e){n.push($(e).data("bs.tooltip").tip())})),(o=$(e.el).find(".btn-accept")).tooltip({title:s.txtAccept,placement:"cursor"}),o.each((function(t,e){n.push($(e).data("bs.tooltip").tip())})),(o=$(e.el).find(".btn-reject")).tooltip({title:s.txtReject,placement:"cursor"}),o.each((function(t,e){n.push($(e).data("bs.tooltip").tip())})),e.tipsArray=n};this.reviewChangesView.on("item:add",d),this.reviewChangesView.on("item:remove",d),this.reviewChangesView.on("item:change",d),this.reviewChangesView.on("item:click",(function(t,e,i,n){var o=$(n.target);if(o)if(o.hasClass("btn-accept"))(a=o.data("bs.tooltip"))&&(a.dontShow=!0),s.fireEvent("reviewchange:accept",[i.get("changedata")]);else if(o.hasClass("btn-reject")){(a=o.data("bs.tooltip"))&&(a.dontShow=!0),s.fireEvent("reviewchange:reject",[i.get("changedata")])}else if(o.hasClass("btn-delete"))s.fireEvent("reviewchange:delete",[i.get("changedata")]);else if(o.hasClass("btn-goto")){var a;(a=o.data("bs.tooltip"))&&(a.dontShow=!0),s.fireEvent("reviewchange:goto",[i.get("changedata")])}})),this.reviewChangesView.setStore(s.reviewStore),this.reviewChangesView.onResetItems()}_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:a.find("#id-popover"),minScrollbarLength:40,wheelSpeed:10,alwaysVisibleY:!0}))},showComments:function(t,e,i,n){this.options.animate=t;var o=this.commentsView.getTextBox();e&&this.textVal&&o&&o.val(this.textVal),n&&n.length&&o&&o.val(n),this.show(t),this.hookTextBox(),this._state.commentsVisible=!0},showReview:function(t,e,i){this.show(t),this._state.reviewVisible=!0},show:function(t,e,i,n){this.options.animate=t,Common.UI.Window.prototype.show.call(this),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})},hideComments:function(){this.handlerHide&&this.handlerHide(),this.hideTips(),this._state.commentsVisible=!1,this._state.reviewVisible?this.calculateSizeOfContent():this.hide()},hideReview:function(){this.handlerHide&&this.handlerHide(),this.hideTips(),this._state.reviewVisible=!1,this._state.commentsVisible?this.calculateSizeOfContent():this.hide()},hide:function(){this.handlerHide&&this.handlerHide.apply(this,arguments),this.hideTips(),Common.UI.Window.prototype.hide.call(this),_.isUndefined(this.e)||this.e.keyCode!=Common.UI.Keys.ESC||(this.e.preventDefault(),this.e.stopImmediatePropagation(),this.e=void 0)},update:function(t){this.commentsView&&t&&this.commentsView.onResetItems(),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})},isVisible:function(){return this.$window&&this.$window.is(":visible")},setLeftTop:function(t,e,i,n,o){if(this.$window||this.render(),n&&(t=this.arrowPosX,e=this.arrowPosY,i=this.leftX),!_.isUndefined(t)||!_.isUndefined(e)){this.arrowPosX=t,this.arrowPosY=e,this.leftX=i;var s=$("#id-popover"),a=$("#id-comments-arrow"),r=$("#editor_sdk"),l=null,c=0,d="",h=0,m="",u=0,p="",f=0,g="",b=0,v=0,C=0,y=0,w=0,x=0;s&&a&&r&&r.get(0)&&(l=r.get(0).getBoundingClientRect())&&(c=l.height-2*this.sdkBounds.padding,this.$window.css({maxHeight:c+"px"}),this.sdkBounds.width=l.width,this.sdkBounds.height=l.height,_.isUndefined(t)||(((d=$("#id_vertical_scroll")).length||(d=$("#ws-v-scrollbar")).length)&&(h="none"!==d.css("display")?d.width():0),this.sdkBounds.width-=h,(m=$("#id_panel_left")).length&&(u="none"!==m.css("display")?m.width():0),(p=$("#id_panel_thumbnails")).length&&(f="none"!==p.css("display")?p.width():0,this.sdkBounds.width-=f),Common.UI.isRTL()?(v=Math.max(0+u+25,0+this.sdkBounds.width-this.$window.outerWidth()-t+7),v=Math.min(0+this.sdkBounds.width-this.$window.outerWidth()-25,v)):(v=Math.min(0+t+this.arrow.width,0+this.sdkBounds.width-this.$window.outerWidth()-25),v=Math.max(0+u+this.arrow.width,v)),a.removeClass("right top bottom").addClass("left"),a.css({left:""}),_.isUndefined(i)||(C=this.$window.outerWidth())&&(t+C>this.sdkBounds.width-this.arrow.width+5&&this.leftX>C||Common.UI.isRTL()&&0+this.leftX>C+this.arrow.width?(v=0+this.leftX-C-this.arrow.width,a.removeClass("left").addClass("right")):v=0+t+this.arrow.width),this.$window.css("left",v+"px")),_.isUndefined(e)||(x=0,(g=$("#id_panel_top")).length?(b="none"!==g.css("display")?g.height():0,x+=this.sdkBounds.paddingTop):(g=$("#ws-h-scrollbar")).length&&(b="none"!==g.css("display")?g.height():0),this.sdkBounds.height-=b,y=this.$window.outerHeight(),w=Math.min(0+c-y,this.arrowPosY+0-this.arrow.height),w=Math.max(w,x),parseInt(a.css("top"))+this.arrow.height>y&&a.css({top:y-this.arrow.height+"px"}),this.$window.css("top",w+"px"))),o&&!this.isOverCursor()||this.calculateSizeOfContent()}},calculateSizeOfContent:function(t){if(!t||this.$window.is(":visible")){this.$window.css({overflow:"hidden"});var e=$("#id-comments-arrow"),i=$("#id-popover"),n=null,o=null,s=null,a=0,r="",l=0,c=0,d=0,h=0,m=0,u=0,p=0;if(i&&e&&i.get(0)){var f=this.scroller.getScrollTop();if(i.css({height:"100%"}),(n=i.get(0).getBoundingClientRect())&&(o=$("#editor_sdk"))&&o.get(0)&&(s=o.get(0).getBoundingClientRect())){a=s.height-2*this.sdkBounds.padding,p=0,h=this.$window.outerHeight(),(r=$("#id_panel_top")).length?(l="none"!==r.css("display")?r.height():0,p+=this.sdkBounds.paddingTop):(r=$("#ws-h-scrollbar")).length&&(l="none"!==r.css("display")?r.height():0),m=Math.max(i.outerHeight(),this.$window.outerHeight());var g=this.isOverCursor();if(g){var b=parseInt(this.$window.css("left"))-this.arrow.width,v=g[1][1]+l+this.arrow.width,C=g[0][1]+l-this.arrow.width,y=!1;if(v+m>0+a){var w=0+a-v;if(C-m<0){var x=C-0;w<.9*x?(this.$window.css({maxHeight:x+"px",top:"0px"}),i.css({height:x-3+"px"})):(this.$window.css({maxHeight:w+"px",top:v+"px"}),y=!0,i.css({height:w-3+"px"}))}else this.$window.css("top",C-m+"px")}else y=!0,this.$window.css("top",v+"px");b-=this.arrow.height,this.$window.css("left",b+"px"),d=g[y?1:0][0],d=Math.max(0,d-b-this.arrow.height/2),d=Math.min(d,this.$window.outerWidth()-this.arrow.height),e.css({top:"",left:d+"px"}),e.toggleClass("top",y),e.toggleClass("bottom",!y),e.removeClass("left right")}else a<=m?(this.$window.css({maxHeight:a-l+"px",top:0+l+"px"}),i.css({height:a-l-3+"px"}),c=Math.min(c,a-(l+this.arrow.margin+this.arrow.height)),e.css({top:c+"px",left:""}),e.removeClass("top bottom right"),e.addClass("left"),this.scroller.scrollTop(f)):((m=h)>0&&(n.top+m>a+0||0===n.height)&&(u=Math.min(0+a-m,this.arrowPosY+0-this.arrow.height),u=Math.max(u,p),this.$window.css({top:u+"px"})),c=Math.max(this.arrow.margin,this.arrowPosY-(a-m)-this.arrow.height),c=Math.min(c,m-this.arrow.margin-this.arrow.height),e.css({top:c+"px",left:""}),e.removeClass("top bottom right"),e.addClass("left"))}}this.$window.css({overflow:""}),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})}},isOverCursor:function(){if(this.api.asc_GetSelectionBounds){var t=this.api.asc_GetSelectionBounds(),e=Math.abs(t[0][0]-t[1][0])<.1&&Math.abs(t[0][1]-t[1][1])<.1&&Math.abs(t[2][0]-t[3][0])<.1&&Math.abs(t[2][1]-t[3][1])<.1,i=$("#id_panel_left"),n=0;i.length&&(n="none"!==i.css("display")?i.width():0);var o=t[0][0]+n,s=t[0][1],a=t[e?2:1][0]+n,r=t[e?2:1][1],l=parseInt(this.$window.css("left"))-this.arrow.width,c=this.$window.outerWidth()+this.arrow.width,d=parseInt(this.$window.css("top")),h=this.$window.outerHeight();if(o>l&&o<l+c&&s>d&&s<d+h||a>l&&a<l+c&&r>d&&r<d+h)return[s<r?[o,s]:[a,r],s>r?[o,s]:[a,r]]}},saveText:function(t){this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textVal=void 0,t?this.commentsView.clearTextBoxBind():this.textVal=this.commentsView.getActiveTextBoxVal())},loadText:function(){if(this.textVal&&this.commentsView){var t=this.commentsView.getTextBox();t&&t.val(this.textVal)}},getEditText:function(){if(this.commentsView)return this.commentsView.getActiveTextBoxVal()},saveDummyText:function(){this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textDummyVal=this.commentsView.getActiveTextBoxVal())},clearDummyText:function(){if(this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1){this.textDummyVal=void 0;var t=this.commentsView.getTextBox();t&&t.val(""),this.commentsView.clearTextBoxBind()}},getDummyText:function(){return this.textDummyVal||""},hookTextBox:function(){var t=this,e=this.commentsView.getTextBox();e&&e.keydown((function(e){if(!e.ctrlKey&&!e.metaKey||e.altKey||e.keyCode!==Common.UI.Keys.RETURN){if(e.keyCode===Common.UI.Keys.TAB){var i,n,o;o=this.selectionStart,n=this.selectionEnd,(i=$(this)).val(i.val().substring(0,o)+"\t"+i.val().substring(n)),this.selectionStart=this.selectionEnd=o+1,e.preventDefault()}}else{var s=$("#id-comments-change-popover");s&&s.length&&s.click(),e.stopImmediatePropagation()}t.e=e})),this.canRequestUsers&&(e&&e.keydown((function(e){e.keyCode==Common.UI.Keys.SPACE||e.keyCode===Common.UI.Keys.TAB||e.keyCode==Common.UI.Keys.HOME||e.keyCode==Common.UI.Keys.END||e.keyCode==Common.UI.Keys.RIGHT||e.keyCode==Common.UI.Keys.LEFT||e.keyCode==Common.UI.Keys.UP?t.onEmailListMenu():e.keyCode==Common.UI.Keys.DOWN&&t.emailMenu&&t.emailMenu.rendered&&t.emailMenu.isVisible()&&(_.delay((function(){var e=t.emailMenu.cmpEl.find("li:not(.divider):first");(e=e.find("a")).focus()}),10),e.preventDefault()),t.e=e})),e&&e.on("input",(function(e){for(var i=$(this),n=this.selectionStart,o=i.val(),s=0,a=o.length-1,r=n-1;r>=0;r--)if(32==o.charCodeAt(r)||13==o.charCodeAt(r)||10==o.charCodeAt(r)||9==o.charCodeAt(r)){s=r+1;break}for(r=n;r<=a;r++)if(32==o.charCodeAt(r)||13==o.charCodeAt(r)||10==o.charCodeAt(r)||9==o.charCodeAt(r)){a=r-1;break}var l=o.substring(s,a+1),c=l.match(/^(?:[@]|[+](?!1))(\S*)/);c&&c.length>1?(l=c[1],t.onEmailListMenu(l,s,a)):t.onEmailListMenu()})))},hideTips:function(){this.commentsView&&_.each(this.commentsView.dataViewItems,(function(t){t.tipsArray&&t.tipsArray.forEach((function(t){t.hide()}))}),this),this.reviewChangesView&&_.each(this.reviewChangesView.dataViewItems,(function(t){t.tipsArray&&t.tipsArray.forEach((function(t){t.hide()}))}),this),this.emailMenu&&this.emailMenu.rendered&&this.emailMenu.cmpEl.css("display","none")},isCommentsViewMouseOver:function(){return this._isMouseOver},setReviewStore:function(t){this.reviewStore=t,this.reviewChangesView&&this.reviewChangesView.setStore(this.reviewStore)},setCommentsStore:function(t){this.commentsStore=t,this.commentsView&&this.commentsView.setStore(this.commentsStore)},getPopover:function(t){return this.popover||(this.popover=new Common.Views.ReviewPopover(t)),this.popover},autoScrollToEditButtons:function(){var t=$("#id-comments-change-popover"),e=null,i=this.$window[0].getBoundingClientRect(),n=0;t.length&&(e=t.get(0).getBoundingClientRect())&&i&&(n=i.bottom-(e.bottom+7))<0&&this.scroller.scrollTop(this.scroller.getScrollTop()-n)},onEmailListMenu:function(t,e,i){"string"==typeof t?(this._state.emailSearch={str:t,left:e,right:i},Common.UI.ExternalUsers.get("mention")):(this._state.emailSearch=null,this.emailMenu.rendered&&this.emailMenu.cmpEl.css("display","none"))},onEmailListMenuCallback:function(t,e){if(!(!this._state.emailSearch||e.length<1||t&&"mention"!==t)){var i=this,n=i.emailMenu,o=this._state.emailSearch.str,s=this._state.emailSearch.left,a=this._state.emailSearch.right;this._state.emailSearch=null;var r=i.$window.find(Common.Utils.String.format("#menu-container-{0}",n.id)),l=this.commentsView.getTextBox(),c=l?l[0]:null,d=c?[c.offsetLeft,c.offsetTop+c.clientHeight+3]:[0,0];n.rendered||(r.length<1&&(r=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id)),i.$window.append(r)),n.render(r),n.cmpEl.css("min-width",c?c.clientWidth:220),n.cmpEl.attr({tabindex:"-1"}),n.on("hide:after",(function(){setTimeout((function(){var t=i.commentsView.getTextBox();t&&t.focus()}),10)})));for(var h=0;h<n.items.length;h++)n.removeItem(n.items[h]),h--;if(e.length>0){(o=o.toLowerCase()).length>0&&(e=_.filter(e,(function(t){return t.email&&0===t.email.toLowerCase().indexOf(o)||t.name&&0===t.name.toLowerCase().indexOf(o)})));var m=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div style="overflow: hidden; text-overflow: ellipsis; max-width: 195px;"><%= Common.Utils.String.htmlEncode(caption) %></div><div style="overflow: hidden; text-overflow: ellipsis; max-width: 195px; color: #909090;"><%= Common.Utils.String.htmlEncode(options.value) %></div></a>'),u=!1;_.each(e,(function(t,e){if(u&&!t.hasAccess&&(u=!1,n.addItem(new Common.UI.MenuItem({caption:"--"}))),t.email&&t.name){var o=new Common.UI.MenuItem({caption:t.name,value:t.email,template:m}).on("click",(function(t,e){i.insertEmailToTextbox(t.options.value,s,a)}));n.addItem(o),t.hasAccess&&(u=!0)}}))}n.items.length>0?(r.css({left:d[0],top:d[1]}),n.menuAlignEl=l,n.show(),n.cmpEl.css("display",""),n.alignPosition("bl-tl",-5),n.scroller.update({alwaysVisibleY:!0})):n.rendered&&n.cmpEl.css("display","none")}},insertEmailToTextbox:function(t,e,i){var n=this.commentsView.getTextBox();if(n){var o=n.val();n.val(o.substring(0,e)+"+"+t+" "+o.substring(i+1,o.length)),setTimeout((function(){n[0].selectionStart=n[0].selectionEnd=e+t.length+2}),10)}},textAddReply:"Add Reply",textAdd:"Add",textCancel:"Cancel",textEdit:"Edit",textReply:"Reply",textClose:"Close",textResolve:"Resolve",textOpenAgain:"Open Again",textFollowMove:"Follow Move",textMention:"+mention will provide access to the document and send an email",textMentionNotify:"+mention will notify the user via email",textEnterComment:"Enter your comment here",textViewResolved:"You have not permission for reopen comment",txtAccept:"Accept",txtReject:"Reject",txtEditTip:"Edit",txtDeleteTip:"Delete"},Common.Views.ReviewPopover||{}))})),void 0===Common)var Common={};if(Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Comments",["core","common/main/lib/model/Comment","common/main/lib/collection/Comments","common/main/lib/view/Comments","common/main/lib/view/ReviewPopover"],(function(){"use strict";function t(){return void 0!==Asc.asc_CCommentDataWord?new Asc.asc_CCommentDataWord(null):new Asc.asc_CCommentData(null)}Common.Controllers.Comments=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.Comments"],views:["Common.Views.Comments","Common.Views.ReviewPopover"],sdkViewName:"#id_main",subEditStrings:{},filter:void 0,hintmode:!1,fullInfoHintMode:!1,viewmode:!1,isSelectedComment:!1,uids:[],oldUids:[],isDummyComment:!1,initialize:function(){this.addListeners({"Common.Views.Comments":{"comment:add":_.bind(this.onCreateComment,this),"comment:change":_.bind(this.onChangeComment,this),"comment:remove":_.bind(this.onRemoveComment,this),"comment:resolve":_.bind(this.onResolveComment,this),"comment:show":_.bind(this.onShowComment,this),"comment:addReply":_.bind(this.onAddReplyComment,this),"comment:changeReply":_.bind(this.onChangeReplyComment,this),"comment:removeReply":_.bind(this.onRemoveReplyComment,this),"comment:editReply":_.bind(this.onShowEditReplyComment,this),"comment:closeEditing":_.bind(this.closeEditing,this),"comment:sort":_.bind(this.setComparator,this),"comment:filtergroups":_.bind(this.setFilterGroups,this)},"Common.Views.ReviewPopover":{"comment:change":_.bind(this.onChangeComment,this),"comment:remove":_.bind(this.onRemoveComment,this),"comment:resolve":_.bind(this.onResolveComment,this),"comment:show":_.bind(this.onShowComment,this),"comment:addReply":_.bind(this.onAddReplyComment,this),"comment:changeReply":_.bind(this.onChangeReplyComment,this),"comment:removeReply":_.bind(this.onRemoveReplyComment,this),"comment:editReply":_.bind(this.onShowEditReplyComment,this),"comment:closeEditing":_.bind(this.closeEditing,this),"comment:disableHint":_.bind(this.disableHint,this),"comment:addDummyComment":_.bind(this.onAddDummyComment,this)},"Common.Views.ReviewChanges":{"comment:removeComments":_.bind(this.onRemoveComments,this),"comment:resolveComments":_.bind(this.onResolveComments,this)}}),Common.NotificationCenter.on("comments:updatefilter",_.bind(this.onUpdateFilter,this)),Common.NotificationCenter.on("app:comment:add",_.bind(this.onAppAddComment,this)),Common.NotificationCenter.on("layout:changed",function(t){Common.Utils.asyncCall((function(t){"toolbar"!=t&&"status"!=t||!this.view.$el.is(":visible")||this.onAfterShow()}),this,t)}.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},onLaunch:function(){var t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",this._state={disableEditing:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},this.collection=this.getApplication().getCollection("Common.Collections.Comments"),this.setComparator(),this.popoverComments=new Common.Collections.Comments,this.popoverComments&&(this.popoverComments.comparator=function(t){return t.get("time")}),this.groupCollection=[],this.userGroups=[],this.view=this.createView("Common.Views.Comments",{store:this.collection}),this.view.render(),this.userCollection=this.getApplication().getCollection("Common.Collections.Users"),this.userCollection.on("reset",_.bind(this.onUpdateUsers,this)),this.userCollection.on("add",_.bind(this.onUpdateUsers,this)),this.bindViewEvents(this.view,this.events)},setConfig:function(t,e){this.setApi(e),t&&(this.currentUserId=t.config.user.id,this.sdkViewName=t.sdkviewname||this.sdkViewName,this.hintmode=t.hintmode||!1,this.fullInfoHintMode=t.fullInfoHintMode||!1,this.viewmode=t.viewmode||!1)},setApi:function(t){t&&(this.api=t,this.api.asc_registerCallback("asc_onAddComment",_.bind(this.onApiAddComment,this)),this.api.asc_registerCallback("asc_onAddComments",_.bind(this.onApiAddComments,this)),this.api.asc_registerCallback("asc_onRemoveComment",_.bind(this.onApiRemoveComment,this)),this.api.asc_registerCallback("asc_onChangeComments",_.bind(this.onChangeComments,this)),this.api.asc_registerCallback("asc_onRemoveComments",_.bind(this.onApiRemoveComments,this)),this.api.asc_registerCallback("asc_onChangeCommentData",_.bind(this.onApiChangeCommentData,this)),this.api.asc_registerCallback("asc_onLockComment",_.bind(this.onApiLockComment,this)),this.api.asc_registerCallback("asc_onUnLockComment",_.bind(this.onApiUnLockComment,this)),this.api.asc_registerCallback("asc_onShowComment",_.bind(this.onApiShowComment,this)),this.api.asc_registerCallback("asc_onHideComment",_.bind(this.onApiHideComment,this)),this.api.asc_registerCallback("asc_onUpdateCommentPosition",_.bind(this.onApiUpdateCommentPosition,this)),this.api.asc_registerCallback("asc_onDocumentPlaceChanged",_.bind(this.onDocumentPlaceChanged,this)),this.api.asc_registerCallback("asc_onDeleteComment",_.bind(this.onDeleteComment,this)),this.api.asc_registerCallback("asc_onChangeCommentLogicalPosition",_.bind(this.onApiChangeCommentLogicalPosition,this)))},setMode:function(t){return this.mode=t,this.isModeChanged=!0,this.view.viewmode=!this.mode.canComments,this.view.changeLayout(t),this},setComparator:function(t){if(this.collection){var e=void 0!==t;if(void 0===t&&(t=Common.localStorage.getItem(this.appPrefix+"comments-sort")||"date-desc"),Common.localStorage.setItem(this.appPrefix+"comments-sort",t),Common.Utils.InternalSettings.set(this.appPrefix+"comments-sort",t),"position-asc"==t||"position-desc"==t){var i="position-asc"==t?1:-1;this.collection.comparator=function(t){return i*t.get("position")}}else if("author-asc"==t||"author-desc"==t){i="author-asc"==t?1:-1;this.collection.comparator=function(t,e){var n=t.get("parsedName").toLowerCase(),o=e.get("parsedName").toLowerCase();return n==o?0:n<o?-i:i}}else{i="date-asc"==t?1:-1;this.collection.comparator=function(t){return i*t.get("time")}}e&&this.updateComments(!0)}},getComparator:function(){return Common.Utils.InternalSettings.get(this.appPrefix+"comments-sort")||"date"},onCreateComment:function(e,i,n,o,s){if(this.api&&i&&i.length>0){var a=t();a&&(this.showPopover=!0,this.editPopover=!!n,this.hidereply=o,this.isSelectedComment=!1,this.uids=[],a.asc_putText(i),a.asc_putTime(this.utcDateToString(new Date)),a.asc_putOnlyOfficeTime(this.ooDateToString(new Date)),a.asc_putUserId(this.currentUserId),a.asc_putUserName(AscCommon.UserInfoParser.getCurrentName()),a.asc_putSolved(!1),_.isUndefined(a.asc_putDocumentFlag)||a.asc_putDocumentFlag(s),this.api.asc_addComment(a),this.view.showEditContainer(!1))}this.view.txtComment.focus()},onRemoveComment:function(t){this.api&&t&&this.api.asc_removeComment(t)},onRemoveComments:function(t){this.api&&this.api.asc_RemoveAllComments("my"==t||!this.mode.canDeleteComments,"current"==t)},onResolveComments:function(t){this.api&&this.api.asc_ResolveAllComments("my"==t||!this.mode.canEditComments,"current"==t)},onResolveComment:function(e){var i=this,n=null,o=null,s=t(),a=i.findComment(e);return _.isUndefined(e)&&(e=a.get("uid")),!(!s||!a)&&(s.asc_putText(a.get("comment")),s.asc_putQuoteText(a.get("quote")),s.asc_putTime(i.utcDateToString(new Date(a.get("time")))),s.asc_putOnlyOfficeTime(i.ooDateToString(new Date(a.get("time")))),s.asc_putUserId(a.get("userid")),s.asc_putUserName(a.get("username")),s.asc_putSolved(!a.get("resolved")),s.asc_putGuid(a.get("guid")),s.asc_putUserData(a.get("userdata")),_.isUndefined(s.asc_putDocumentFlag)||s.asc_putDocumentFlag(a.get("unattached")),(n=a.get("replys"))&&n.length&&n.forEach((function(e){(o=t())&&(o.asc_putText(e.get("reply")),o.asc_putTime(i.utcDateToString(new Date(e.get("time")))),o.asc_putOnlyOfficeTime(i.ooDateToString(new Date(e.get("time")))),o.asc_putUserId(e.get("userid")),o.asc_putUserName(e.get("username")),o.asc_putUserData(e.get("userdata")),s.asc_addReply(o))})),i.api.asc_changeComment(e,s),!0)},onShowComment:function(t,e,i){var n=this.findComment(t);if(n)if(null!==n.get("quote")){if(this.api){if(this.hintmode){if(this.animate=!0,n.get("unattached")&&this.getPopover())return void this.getPopover().hideComments()}else if(this.popoverComments.findWhere({uid:t})&&!this.getPopover().isVisible())return this.getPopover().showComments(!0),void this.api.asc_selectComment(t);!_.isUndefined(e)&&this.hintmode&&(this.isSelectedComment=e),i&&0===_.difference(this.uids,[t]).length&&0===_.difference([t],this.uids).length||(this.api.asc_selectComment(t),this._dontScrollToComment=!0,this.api.asc_showComment(t,!1))}}else this.hintmode&&this.api.asc_selectComment(t),this.getPopover()&&this.getPopover().hideComments(),this.isSelectedComment=!1,this.uids=[]},onChangeComment:function(e,i){if(i&&i.length>0){var n=this,o=null,s=null,a=null,r=t(),l=n.findComment(e),c="";if(l&&r)return c=l.get("comment"),r.asc_putText(i),r.asc_putQuoteText(l.get("quote")),r.asc_putTime(n.utcDateToString(new Date(l.get("time")))),r.asc_putOnlyOfficeTime(n.ooDateToString(new Date(l.get("time")))),r.asc_putUserId(n.currentUserId),r.asc_putUserName(AscCommon.UserInfoParser.getCurrentName()),r.asc_putSolved(l.get("resolved")),r.asc_putGuid(l.get("guid")),r.asc_putUserData(l.get("userdata")),_.isUndefined(r.asc_putDocumentFlag)||r.asc_putDocumentFlag(l.get("unattached")),l.set("editTextInPopover",!1),(o=n.findPopupComment(e))&&o.set("editTextInPopover",!1),n.subEditStrings[e]&&delete n.subEditStrings[e],n.subEditStrings[e+"-R"]&&delete n.subEditStrings[e+"-R"],(s=l.get("replys"))&&s.length&&s.forEach((function(e){(a=t())&&(a.asc_putText(e.get("reply")),a.asc_putTime(n.utcDateToString(new Date(e.get("time")))),a.asc_putOnlyOfficeTime(n.ooDateToString(new Date(e.get("time")))),a.asc_putUserId(e.get("userid")),a.asc_putUserName(e.get("username")),a.asc_putUserData(e.get("userdata")),r.asc_addReply(a))})),n.api.asc_changeComment(e,r),n.mode&&n.mode.canRequestSendNotify&&n.view.pickEMail(r.asc_getGuid(),i,c),!0}return!1},onChangeReplyComment:function(e,i,n){if(n&&n.length>0){var o=this,s=null,a=null,r=t(),l=o.findComment(e),c="";if(r&&l)return r.asc_putText(l.get("comment")),r.asc_putQuoteText(l.get("quote")),r.asc_putTime(o.utcDateToString(new Date(l.get("time")))),r.asc_putOnlyOfficeTime(o.ooDateToString(new Date(l.get("time")))),r.asc_putUserId(l.get("userid")),r.asc_putUserName(l.get("username")),r.asc_putSolved(l.get("resolved")),r.asc_putGuid(l.get("guid")),r.asc_putUserData(l.get("userdata")),_.isUndefined(r.asc_putDocumentFlag)||r.asc_putDocumentFlag(l.get("unattached")),(s=l.get("replys"))&&s.length&&s.forEach((function(e){(a=t())&&(e.get("id")!==i||_.isUndefined(n)?(a.asc_putText(e.get("reply")),a.asc_putUserId(e.get("userid")),a.asc_putUserName(e.get("username"))):(c=e.get("reply"),a.asc_putText(n),a.asc_putUserId(o.currentUserId),a.asc_putUserName(AscCommon.UserInfoParser.getCurrentName())),a.asc_putTime(o.utcDateToString(new Date(e.get("time")))),a.asc_putOnlyOfficeTime(o.ooDateToString(new Date(e.get("time")))),a.asc_putUserData(e.get("userdata")),r.asc_addReply(a))})),o.api.asc_changeComment(e,r),o.mode&&o.mode.canRequestSendNotify&&o.view.pickEMail(r.asc_getGuid(),n,c),!0}return!1},onAddReplyComment:function(e,i){if(i.length>0){var n=this,o=null,s=null,a=null,r=t(),l=n.findComment(e);if(r&&l&&((o=l.get("uid"))&&(n.subEditStrings[o]&&delete n.subEditStrings[o],n.subEditStrings[o+"-R"]&&delete n.subEditStrings[o+"-R"],l.set("showReplyInPopover",!1)),r.asc_putText(l.get("comment")),r.asc_putQuoteText(l.get("quote")),r.asc_putTime(n.utcDateToString(new Date(l.get("time")))),r.asc_putOnlyOfficeTime(n.ooDateToString(new Date(l.get("time")))),r.asc_putUserId(l.get("userid")),r.asc_putUserName(l.get("username")),r.asc_putSolved(l.get("resolved")),r.asc_putGuid(l.get("guid")),r.asc_putUserData(l.get("userdata")),_.isUndefined(r.asc_putDocumentFlag)||r.asc_putDocumentFlag(l.get("unattached")),(s=l.get("replys"))&&s.length&&s.forEach((function(e){(a=t())&&(a.asc_putText(e.get("reply")),a.asc_putTime(n.utcDateToString(new Date(e.get("time")))),a.asc_putOnlyOfficeTime(n.ooDateToString(new Date(e.get("time")))),a.asc_putUserId(e.get("userid")),a.asc_putUserName(e.get("username")),a.asc_putUserData(e.get("userdata")),r.asc_addReply(a))})),a=t()))return a.asc_putText(i),a.asc_putTime(n.utcDateToString(new Date)),a.asc_putOnlyOfficeTime(n.ooDateToString(new Date)),a.asc_putUserId(n.currentUserId),a.asc_putUserName(AscCommon.UserInfoParser.getCurrentName()),r.asc_addReply(a),n.api.asc_changeComment(e,r),n.mode&&n.mode.canRequestSendNotify&&n.view.pickEMail(r.asc_getGuid(),i),!0}return!1},onRemoveReplyComment:function(e,i){if(!_.isUndefined(e)&&!_.isUndefined(i)){var n=this,o=null,s=null,a=t(),r=n.findComment(e);if(a&&r)return a.asc_putText(r.get("comment")),a.asc_putQuoteText(r.get("quote")),a.asc_putTime(n.utcDateToString(new Date(r.get("time")))),a.asc_putOnlyOfficeTime(n.ooDateToString(new Date(r.get("time")))),a.asc_putUserId(r.get("userid")),a.asc_putUserName(r.get("username")),a.asc_putSolved(r.get("resolved")),a.asc_putGuid(r.get("guid")),a.asc_putUserData(r.get("userdata")),_.isUndefined(a.asc_putDocumentFlag)||a.asc_putDocumentFlag(r.get("unattached")),(o=r.get("replys"))&&o.length&&o.forEach((function(e){e.get("id")!==i&&(s=t())&&(s.asc_putText(e.get("reply")),s.asc_putTime(n.utcDateToString(new Date(e.get("time")))),s.asc_putOnlyOfficeTime(n.ooDateToString(new Date(e.get("time")))),s.asc_putUserId(e.get("userid")),s.asc_putUserName(e.get("username")),s.asc_putUserData(e.get("userdata")),a.asc_addReply(s))})),n.api.asc_changeComment(e,a),!0}return!1},onShowEditReplyComment:function(t,e,i){var n,o,s,a;if(!_.isUndefined(t)&&!_.isUndefined(e))if(i){if((o=this.popoverComments.findWhere({uid:t}))&&(s=o.get("replys"),a=_.clone(o.get("replys"))))for(n=0;n<a.length;++n)if(e===a[n].get("id"))return a[n].set("editTextInPopover",!0),s.length=0,o.set("replys",a),!0}else if((o=this.collection.findWhere({uid:t}))&&(s=o.get("replys"),a=_.clone(o.get("replys"))))for(n=0;n<a.length;++n)if(e===a[n].get("id"))return a[n].set("editText",!0),s.length=0,o.set("replys",a),!0;return!1},onUpdateFilter:function(t,e){if(t){this.view.isVisible()||(this.view.needUpdateFilter=t,e=!0),this.filter=t;var i=this,n=[];if(this.filter.forEach((function(t){i.groupCollection[t]||(i.groupCollection[t]=new Backbone.Collection([],{model:Common.Models.Comment})),n=n.concat(i.groupCollection[t].models)})),this.collection.reset(n),this.collection.groups=this.filter,!e){this.getPopover()&&this.getPopover().hide(),this.view.needUpdateFilter=!1;for(var o=!0,s=this.collection.length-1;s>=0;--s){var a=this.collection.at(s);!o||a.get("hide")||a.get("filtered")?a.get("last")&&a.set("last",!1,{silent:!0}):(a.set("last",!0,{silent:!0}),o=!1)}this.view.render(),this.view.update()}}},onAppAddComment:function(t,e){this.api.can_AddQuotedComment&&!1===this.api.can_AddQuotedComment()||e||this.addDummyComment()},addCommentToGroupCollection:function(t){var e=t.get("groupName");this.groupCollection[e]||(this.groupCollection[e]=new Backbone.Collection([],{model:Common.Models.Comment})),this.groupCollection[e].push(t)},onApiAddComment:function(t,e){var i=this.readSDKComment(t,e);i&&(i.get("groupName")?(this.addCommentToGroupCollection(i),_.indexOf(this.collection.groups,i.get("groupName"))>-1&&this.collection.push(i)):this.collection.push(i),this.updateComments(!0,"position-asc"===this.getComparator()||"position-desc"===this.getComparator()),this.showPopover&&(null!==e.asc_getQuoteText()&&(this.api.asc_selectComment(t),this._dontScrollToComment=!0,this.api.asc_showComment(t,!0)),this.showPopover=void 0,this.editPopover=!1))},onApiAddComments:function(t){for(var e=0;e<t.length;++e){var i=this.readSDKComment(t[e].asc_getId(),t[e]);i.get("groupName")?this.addCommentToGroupCollection(i):this.collection.push(i)}this.updateComments(!0,"position-asc"===this.getComparator()||"position-desc"===this.getComparator())},onApiRemoveComment:function(t,e){for(var i in this.groupCollection){var n=this.groupCollection[i];if(o=n.findWhere({uid:t})){n.remove(o);break}}var o;this.collection.length&&((o=this.collection.findWhere({uid:t}))&&(this.collection.remove(o),e||this.updateComments(!0)),this.popoverComments.length&&(o=this.popoverComments.findWhere({uid:t}))&&(this.popoverComments.remove(o),0===this.popoverComments.length&&this.getPopover()&&this.getPopover().hideComments()))},onChangeComments:function(t){for(var e=0;e<t.length;++e)this.onApiChangeCommentData(t[e].Comment.Id,t[e].Comment,!0);this.updateComments(!0)},onApiRemoveComments:function(t){for(var e=0;e<t.length;++e)this.onApiRemoveComment(t[e],!0);this.updateComments(!0)},onApiChangeCommentData:function(t,e,i){var n=this,o=0,s=null,a=null,r=0,l=null,c=this.findComment(t)||this.findCommentInGroup(t);if(c){n=this,s=e.asc_getOnlyOfficeTime()?new Date(this.stringOOToLocalDate(e.asc_getOnlyOfficeTime())):""==e.asc_getTime()?new Date:new Date(this.stringUtcToLocalDate(e.asc_getTime()));var d=this.userCollection.findOriginalUser(e.asc_getUserId()),h=("author-asc"==this.getComparator()||"author-desc"==this.getComparator())&&e.asc_getUserName()!==c.get("username");if(c.set("comment",e.asc_getText()),c.set("userid",e.asc_getUserId()),c.set("username",e.asc_getUserName()),c.set("parsedName",AscCommon.UserInfoParser.getParsedName(e.asc_getUserName())),c.set("parsedGroups",AscCommon.UserInfoParser.getParsedGroups(e.asc_getUserName())),c.set("usercolor",d?d.get("color"):null),c.set("resolved",e.asc_getSolved()),c.set("quote",e.asc_getQuoteText()),c.set("userdata",e.asc_getUserData()),c.set("time",s.getTime()),c.set("date",n.dateToLocaleTimeString(s)),c.set("editable",(n.mode.canEditComments||e.asc_getUserId()==n.currentUserId)&&AscCommon.UserInfoParser.canEditComment(e.asc_getUserName())),c.set("removable",(n.mode.canDeleteComments||e.asc_getUserId()==n.currentUserId)&&AscCommon.UserInfoParser.canDeleteComment(e.asc_getUserName())),c.set("hide",!AscCommon.UserInfoParser.canViewComment(e.asc_getUserName())),!c.get("hide")){var m=c.get("parsedGroups");n.fillUserGroups(m);var u=Common.Utils.InternalSettings.get(n.appPrefix+"comments-filtergroups"),p=!!u&&-1!==u&&(!m||m.length<1||m.indexOf(u)<0);c.set("filtered",p)}for((a=_.clone(c.get("replys"))).length=0,r=e.asc_getRepliesCount(),o=0;o<r;++o)l=e.asc_getReply(o).asc_getOnlyOfficeTime()?new Date(this.stringOOToLocalDate(e.asc_getReply(o).asc_getOnlyOfficeTime())):""==e.asc_getReply(o).asc_getTime()?new Date:new Date(this.stringUtcToLocalDate(e.asc_getReply(o).asc_getTime())),d=this.userCollection.findOriginalUser(e.asc_getReply(o).asc_getUserId()),a.push(new Common.Models.Reply({id:Common.UI.getId(),userid:e.asc_getReply(o).asc_getUserId(),username:e.asc_getReply(o).asc_getUserName(),parsedName:AscCommon.UserInfoParser.getParsedName(e.asc_getReply(o).asc_getUserName()),usercolor:d?d.get("color"):null,date:n.dateToLocaleTimeString(l),reply:e.asc_getReply(o).asc_getText(),userdata:e.asc_getReply(o).asc_getUserData(),time:l.getTime(),editText:!1,editTextInPopover:!1,showReplyInPopover:!1,scope:n.view,editable:(n.mode.canEditComments||e.asc_getReply(o).asc_getUserId()==n.currentUserId)&&AscCommon.UserInfoParser.canEditComment(e.asc_getReply(o).asc_getUserName()),removable:(n.mode.canDeleteComments||e.asc_getReply(o).asc_getUserId()==n.currentUserId)&&AscCommon.UserInfoParser.canDeleteComment(e.asc_getReply(o).asc_getUserName())}));c.set("replys",a),this.popoverComments.findWhere({hide:!1})||this.getPopover()&&this.getPopover().hideComments(),i||this.updateComments(h,!h)}},onApiLockComment:function(t,e){var i=this.findComment(t)||this.findCommentInGroup(t),n=null;i&&this.userCollection&&(n=this.userCollection.findUser(e))&&(this.getPopover()&&this.getPopover().saveText(),this.view.saveText(),i.set("lock",!0),i.set("lockuserid",this.view.getUserName(n.get("username"))))},onApiUnLockComment:function(t){var e=this.findComment(t)||this.findCommentInGroup(t);e&&(e.set("lock",!1),this.getPopover()&&this.getPopover().loadText(),this.view.loadText())},onApiShowComment:function(t,e,i,n,o,s){var a=s,r=0===_.difference(this.uids,t).length&&0===_.difference(t,this.uids).length;if(!(s&&this.isSelectedComment&&r)||this.isModeChanged){var l=this.getPopover();if(l){if(this.clearDummyComment(),this.isSelectedComment&&r&&!this.isModeChanged)return void(this.api&&(l.commentsView&&l.commentsView.setFocusToTextBox(!0),this.api.asc_enableKeyEvents(!0)));var c=0,d="",h="",m=null,u="",p=!0,f=[];for(c=0;c<t.length;++c)d=t[c],h=t[c]+"-R",(m=this.findComment(d))&&(!this.subEditStrings[d]||!m.get("fullInfoInHint")&&s?!this.subEditStrings[h]||!m.get("fullInfoInHint")&&s||(m.set("showReplyInPopover",!0),u=this.subEditStrings[h]):(m.set("editTextInPopover",!0),u=this.subEditStrings[d]),m.set("hint",!_.isUndefined(s)&&s),!s&&this.hintmode&&(r&&(p=!1),this.oldUids.length&&0===_.difference(this.oldUids,t).length&&0===_.difference(t,this.oldUids).length&&(p=!1,this.oldUids=[]),!r||a||this.isModeChanged||this.api.asc_selectComment(m.get("uid"))),this.animate&&(p=this.animate,this.animate=!1),this.isSelectedComment=!a||!this.hintmode,this.uids=_.clone(t),f.push(m),this._dontScrollToComment||this.view.commentsView.scrollToRecord(m),this._dontScrollToComment=!1);f.sort((function(t,e){return t.get("time")-e.get("time")})),this.popoverComments.reset(f),this.popoverComments.findWhere({hide:!1})?(!l.isVisible()||r&&!this.isModeChanged||l.hide(),l.setLeftTop(e,i,n),l.showComments(p,!1,!0,u)):l.hideComments()}this.isModeChanged=!1}},onApiHideComment:function(t){var e=this;if(this.getPopover()){if(this.isSelectedComment&&t)return;if(t&&this.getPopover().isCommentsViewMouseOver())return;this.popoverComments.each((function(t){t.get("editTextInPopover")&&(e.subEditStrings[t.get("uid")]=e.getPopover().getEditText()),t.get("showReplyInPopover")&&(e.subEditStrings[t.get("uid")+"-R"]=e.getPopover().getEditText())})),this.getPopover().saveText(!0),this.getPopover().hideComments(),this.collection.clearEditing(),this.popoverComments.clearEditing(),this.oldUids=_.clone(this.uids),this.isSelectedComment=!1,this.uids=[],this.popoverComments.reset()}},onApiUpdateCommentPosition:function(t,e,i,n){var o,s=!1,a=null,r=void 0,l="",c="";if(this.getPopover())if(this.getPopover().saveText(),this.getPopover().hideTips(),i<0||this.getPopover().sdkBounds.height<i||!_.isUndefined(n)&&this.getPopover().sdkBounds.width<n)this.getPopover().hide();else{if(this.isModeChanged&&this.onApiShowComment(t,e,i,n),0===this.popoverComments.length){var d=[];for(o=0;o<t.length;++o)l=t[o],c=t[o]+"-R",(a=this.findComment(l))&&(this.subEditStrings[l]?(a.set("editTextInPopover",!0),r=this.subEditStrings[l]):this.subEditStrings[c]&&(a.set("showReplyInPopover",!0),r=this.subEditStrings[c]),d.push(a));d.sort((function(t,e){return t.get("time")-e.get("time")})),this.popoverComments.reset(d),this.popoverComments.findWhere({hide:!1})?(s=!0,this.getPopover().showComments(s,void 0,void 0,r)):this.getPopover().hideComments()}else!this.getPopover().isVisible()&&this.popoverComments.findWhere({hide:!1})&&this.getPopover().showComments(!1,void 0,void 0,r);this.getPopover().setLeftTop(e,i,n,void 0,!0)}},onDocumentPlaceChanged:function(){if(this.isDummyComment&&this.getPopover()&&this.getPopover().isVisible()){var t=this.api.asc_getAnchorPosition();t&&this.getPopover().setLeftTop(t.asc_getX()+t.asc_getWidth(),t.asc_getY(),this.hintmode?t.asc_getX():void 0)}},onDeleteComment:function(t,e){this.api&&this.api.asc_RemoveAllComments(!this.mode.canDeleteComments,!0)},onApiChangeCommentLogicalPosition:function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=this.findComment(e)||this.findCommentInGroup(e);i&&i.set("position",t[e])}("position-asc"===this.getComparator()||"position-desc"===this.getComparator())&&this.updateComments(!0)},updateComments:function(t,e,i){var n=this;n.updateCommentsTime=new Date,n.disableSort=!!e,void 0===n.timerUpdateComments&&(n.timerUpdateComments=setInterval((function(){new Date-n.updateCommentsTime>100&&(clearInterval(n.timerUpdateComments),n.timerUpdateComments=void 0,n.updateCommentsView(t,n.disableSort,i))}),25))},updateCommentsView:function(t,e,i){if(t&&!this.view.isVisible())return this.view.needRender=t,void this.onUpdateFilter(this.filter,!0);var n,o=!0;if(e||this.collection.sort(),t){for(this.onUpdateFilter(this.filter,!0),n=this.collection.length-1;n>=0;--n){var s=this.collection.at(n);!o||s.get("hide")||s.get("filtered")?s.get("last")&&s.set("last",!1,{silent:!0}):(s.set("last",!0,{silent:!0}),o=!1)}this.view.render(),this.view.needRender=!1}this.view.update(),i&&this.view.loadText()},findComment:function(t){return this.collection.findWhere({uid:t})},findPopupComment:function(t){return this.popoverComments.findWhere({id:t})},findCommentInGroup:function(t){for(var e in this.groupCollection){var i=this.groupCollection[e].findWhere({uid:t});if(i)return i}},closeEditing:function(t){if(!_.isUndefined(t)){var e=this.findPopupComment(t);e&&(e.set("editTextInPopover",!1),e.set("showReplyInPopover",!1)),this.subEditStrings[t]&&delete this.subEditStrings[t],this.subEditStrings[t+"-R"]&&delete this.subEditStrings[t+"-R"]}this.collection.clearEditing(),this.collection.each((function(t){var e=_.clone(t.get("replys"));t.get("replys").length=0,e.forEach((function(t){t.get("editText")&&t.set("editText",!1),t.get("editTextInPopover")&&t.set("editTextInPopover",!1)})),t.set("replys",e)})),this.view.showEditContainer(!1),this.view.update()},disableHint:function(t){t&&this.mode.canComments&&(t.set("hint",!1),this.api.asc_showComment(t.get("uid"),!1),this.isSelectedComment=!0)},blockPopover:function(t){this.isSelectedComment=t,t&&this.getPopover().isVisible()&&this.getPopover().hide()},getPopover:function(){return _.isUndefined(this.popover)&&(this.popover=Common.Views.ReviewPopover.prototype.getPopover({commentsStore:this.popoverComments,renderTo:this.sdkViewName,canRequestUsers:this.mode?this.mode.canRequestUsers:void 0,canRequestSendNotify:this.mode?this.mode.canRequestSendNotify:void 0,mentionShare:!this.mode||this.mode.mentionShare,api:this.api}),this.popover.setCommentsStore(this.popoverComments)),this.popover},onUpdateUsers:function(){var t=this.userCollection,e=!1;for(var i in this.groupCollection)e=!0,this.groupCollection[i].each((function(e){var i=t.findOriginalUser(e.get("userid")),n=i?i.get("color"):null,o=!1;n!==e.get("usercolor")&&(o=!0,e.set("usercolor",n,{silent:!0})),e.get("replys").forEach((function(e){i=t.findOriginalUser(e.get("userid")),(n=i?i.get("color"):null)!==e.get("usercolor")&&(o=!0,e.set("usercolor",n,{silent:!0}))})),o&&e.trigger("change")}));!e&&this.collection.each((function(e){var i=t.findOriginalUser(e.get("userid")),n=i?i.get("color"):null,o=!1;n!==e.get("usercolor")&&(o=!0,e.set("usercolor",n,{silent:!0})),e.get("replys").forEach((function(e){i=t.findOriginalUser(e.get("userid")),(n=i?i.get("color"):null)!==e.get("usercolor")&&(o=!0,e.set("usercolor",n,{silent:!0}))})),o&&e.trigger("change")}))},readSDKComment:function(t,e){var i=e.asc_getOnlyOfficeTime()?new Date(this.stringOOToLocalDate(e.asc_getOnlyOfficeTime())):""==e.asc_getTime()?new Date:new Date(this.stringUtcToLocalDate(e.asc_getTime())),n=this.userCollection.findOriginalUser(e.asc_getUserId()),o=t.substr(0,t.lastIndexOf("_")+1).match(/^(doc|sheet[0-9_]+)_/),s=new Common.Models.Comment({uid:t,guid:e.asc_getGuid(),userid:e.asc_getUserId(),username:e.asc_getUserName(),parsedName:AscCommon.UserInfoParser.getParsedName(e.asc_getUserName()),parsedGroups:AscCommon.UserInfoParser.getParsedGroups(e.asc_getUserName()),usercolor:n?n.get("color"):null,date:this.dateToLocaleTimeString(i),quote:e.asc_getQuoteText(),comment:e.asc_getText(),resolved:e.asc_getSolved(),unattached:!_.isUndefined(e.asc_getDocumentFlag)&&e.asc_getDocumentFlag(),userdata:e.asc_getUserData(),id:Common.UI.getId(),time:i.getTime(),showReply:!1,editText:!1,last:void 0,editTextInPopover:!!this.editPopover,showReplyInPopover:!1,hideAddReply:_.isUndefined(this.hidereply)?!!this.showPopover:this.hidereply,scope:this.view,editable:(this.mode.canEditComments||e.asc_getUserId()==this.currentUserId)&&AscCommon.UserInfoParser.canEditComment(e.asc_getUserName()),removable:(this.mode.canDeleteComments||e.asc_getUserId()==this.currentUserId)&&AscCommon.UserInfoParser.canDeleteComment(e.asc_getUserName()),hide:!AscCommon.UserInfoParser.canViewComment(e.asc_getUserName()),hint:!this.mode.canComments,fullInfoInHint:this.fullInfoHintMode,groupName:o&&o.length>1?o[1]:null});if(s){if(!s.get("hide")){var a=s.get("parsedGroups");this.fillUserGroups(a);var r=Common.Utils.InternalSettings.get(this.appPrefix+"comments-filtergroups"),l=!!r&&-1!==r&&(!a||a.length<1||a.indexOf(r)<0);s.set("filtered",l)}var c=this.readSDKReplies(e);c.length&&s.set("replys",c)}return s},readSDKReplies:function(t){var e=0,i=[],n=null,o=t.asc_getRepliesCount();if(o)for(e=0;e<o;++e){n=t.asc_getReply(e).asc_getOnlyOfficeTime()?new Date(this.stringOOToLocalDate(t.asc_getReply(e).asc_getOnlyOfficeTime())):""==t.asc_getReply(e).asc_getTime()?new Date:new Date(this.stringUtcToLocalDate(t.asc_getReply(e).asc_getTime()));var s=this.userCollection.findOriginalUser(t.asc_getReply(e).asc_getUserId());i.push(new Common.Models.Reply({id:Common.UI.getId(),userid:t.asc_getReply(e).asc_getUserId(),username:t.asc_getReply(e).asc_getUserName(),parsedName:AscCommon.UserInfoParser.getParsedName(t.asc_getReply(e).asc_getUserName()),usercolor:s?s.get("color"):null,date:this.dateToLocaleTimeString(n),reply:t.asc_getReply(e).asc_getText(),userdata:t.asc_getReply(e).asc_getUserData(),time:n.getTime(),editText:!1,editTextInPopover:!1,showReplyInPopover:!1,scope:this.view,editable:(this.mode.canEditComments||t.asc_getReply(e).asc_getUserId()==this.currentUserId)&&AscCommon.UserInfoParser.canEditComment(t.asc_getReply(e).asc_getUserName()),removable:(this.mode.canDeleteComments||t.asc_getReply(e).asc_getUserId()==this.currentUserId)&&AscCommon.UserInfoParser.canDeleteComment(t.asc_getReply(e).asc_getUserName())}))}return i},addDummyComment:function(){if(this.api){var t=this,e=null,i=new Date,n=this.getPopover();if(n){if(this.popoverComments.length){if(this.isDummyComment)return void _.delay((function(){n.commentsView.setFocusToTextBox()}),200);this.closeEditing()}var o=this.userCollection.findOriginalUser(this.currentUserId),s=new Common.Models.Comment({id:-1,time:i.getTime(),date:this.dateToLocaleTimeString(i),userid:this.currentUserId,username:AscCommon.UserInfoParser.getCurrentName(),parsedName:AscCommon.UserInfoParser.getParsedName(AscCommon.UserInfoParser.getCurrentName()),usercolor:o?o.get("color"):null,editTextInPopover:!0,showReplyInPopover:!1,hideAddReply:!0,scope:this.view,dummy:!0});this.popoverComments.reset(),this.popoverComments.push(s),this.uids=[],this.isSelectedComment=!0,this.isDummyComment=!0,_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)||t.api.asc_SetDocumentPlaceChangedEnabled(!0),n.handlerHide=function(){},n.isVisible()&&n.hide(),n.handlerHide=function(e){t.clearDummyComment(e)},(e=this.api.asc_getAnchorPosition())&&(n.setLeftTop(e.asc_getX()+e.asc_getWidth(),e.asc_getY(),this.hintmode?e.asc_getX():void 0),Common.NotificationCenter.trigger("comments:showdummy"),n.showComments(!0,!1,!0,n.getDummyText()))}}},onAddDummyComment:function(e){if(this.api&&e&&e.length>0){var i=t();i&&(this.showPopover=!0,this.editPopover=!1,this.hidereply=!1,this.isSelectedComment=!1,this.uids=[],this.popoverComments.reset(),this.getPopover().isVisible()&&this.getPopover().hideComments(),this.isDummyComment=!1,i.asc_putText(e),i.asc_putTime(this.utcDateToString(new Date)),i.asc_putOnlyOfficeTime(this.ooDateToString(new Date)),i.asc_putUserId(this.currentUserId),i.asc_putUserName(AscCommon.UserInfoParser.getCurrentName()),i.asc_putSolved(!1),_.isUndefined(i.asc_putDocumentFlag)||i.asc_putDocumentFlag(!1),this.api.asc_addComment(i),this.view.showEditContainer(!1),this.mode&&this.mode.canRequestSendNotify&&this.view.pickEMail(i.asc_getGuid(),e),_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)||this.api.asc_SetDocumentPlaceChangedEnabled(!1))}},clearDummyComment:function(t){if(this.isDummyComment){this.isDummyComment=!1,this.showPopover=!0,this.editPopover=!1,this.hidereply=!1,this.isSelectedComment=!1,this.uids=[];var e=this.getPopover();e&&(t&&e.clearDummyText(),e.saveDummyText(),e.handlerHide=function(){},e.isVisible()&&e.hideComments()),this.popoverComments.reset(),_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)||this.api.asc_SetDocumentPlaceChangedEnabled(!1),Common.NotificationCenter.trigger("comments:cleardummy")}},onEditComments:function(t){if(this.api){var e=0,i=null,n=this.api.asc_getAnchorPosition();if(n){for(this.isSelectedComment=!0,this.popoverComments.reset(),e=0;e<t.length;++e)(i=this.findComment(t[e].asc_getId()))&&(i.set("editTextInPopover",this.mode.canEditComments&&AscCommon.UserInfoParser.canEditComment(i.username)),i.set("hint",!1),this.popoverComments.push(i));this.getPopover()&&this.popoverComments.length>0&&this.popoverComments.findWhere({hide:!1})&&(this.getPopover().isVisible()&&this.getPopover().hide(),this.getPopover().setLeftTop(n.asc_getX()+n.asc_getWidth(),n.asc_getY(),this.hintmode?n.asc_getX():void 0),this.getPopover().showComments(!0,!1,!0))}}},onAfterShow:function(){if(this.view&&this.api){var t=$(".new-comment-ct",this.view.el);t&&t.length&&"none"!==t.css("display")&&this.view.txtComment.focus(),this.view.needRender?this.updateComments(!0):this.view.needUpdateFilter&&this.onUpdateFilter(this.view.needUpdateFilter),this.view.update()}},onBeforeHide:function(){this.view&&this.view.showEditContainer(!1)},timeZoneOffsetInMs:6e4*(new Date).getTimezoneOffset(),stringOOToLocalDate:function(t){return"string"==typeof t?parseInt(t):0},ooDateToString:function(t){return"[object Date]"===Object.prototype.toString.call(t)?t.getTime().toString():""},stringUtcToLocalDate:function(t){return"string"==typeof t?parseInt(t)+this.timeZoneOffsetInMs:0},utcDateToString:function(t){return"[object Date]"===Object.prototype.toString.call(t)?(t.getTime()-this.timeZoneOffsetInMs).toString():""},dateToLocaleTimeString:function(t){var e=(this.mode&&this.mode.lang||"en").replace("_","-").toLowerCase();try{return t.toLocaleString(e,{dateStyle:"short",timeStyle:"short"})}catch(i){return e="en",t.toLocaleString(e,{dateStyle:"short",timeStyle:"short"})}return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()+" "+function(t){var e=t.getHours(),i=t.getMinutes(),n=e>=12?"pm":"am";return(e=(e%=12)||12)+":"+(i=i<10?"0"+i:i)+" "+n}(t)},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},setPreviewMode:function(t){this._state.disableEditing=t,this.updatePreviewMode()},updatePreviewMode:function(){var t=this._state.docProtection,e=this._state.disableEditing||t.isReadOnly||t.isFormsOnly;this.viewmode!==e&&(this.viewmode=e,e&&(this.prevcanComments=this.mode.canComments),this.mode.canComments=!e&&this.prevcanComments,this.closeEditing(),this.setMode(this.mode),this.updateComments(!0),this.getPopover()&&(e?this.getPopover().hide():this.getPopover().update(!0)))},clearCollections:function(){this.collection.reset(),this.groupCollection=[]},fillUserGroups:function(t){if(this.mode.canUseCommentPermissions){var e=AscCommon.UserInfoParser.getCommentPermissions("view");if(t&&t.length>0&&(e&&(t=_.intersection(t,e)),t=_.uniq(this.userGroups.concat(t))),this.view&&this.view.buttonSort&&_.difference(t,this.userGroups).length>0){this.userGroups=t;var i=this.view.buttonSort.menu;i.items[i.items.length-1].setVisible(this.userGroups.length>0),i.items[i.items.length-2].setVisible(this.userGroups.length>0),(i=i.items[i.items.length-1].menu).removeAll();var n=Common.Utils.InternalSettings.get(this.appPrefix+"comments-filtergroups");i.addItem(new Common.UI.MenuItem({checkable:!0,checked:-1===n||void 0===n,toggleGroup:"filtercomments",caption:this.view.textAll,value:-1})),this.userGroups.forEach((function(t){i.addItem(new Common.UI.MenuItem({checkable:!0,checked:n===t,toggleGroup:"filtercomments",caption:Common.Utils.String.htmlEncode(t),value:t}))}))}}},setFilterGroups:function(t){Common.Utils.InternalSettings.set(this.appPrefix+"comments-filtergroups",t);var e,i=!0;for(e=this.collection.length-1;e>=0;--e){var n=this.collection.at(e);if(!n.get("hide")){var o=n.get("parsedGroups");n.set("filtered",!!t&&-1!==t&&(!o||o.length<1||o.indexOf(t)<0),{silent:!0})}!i||n.get("hide")||n.get("filtered")?n.get("last")&&n.set("last",!1,{silent:!0}):(n.set("last",!0,{silent:!0}),i=!1)}this.updateComments(!0)},onAppReady:function(t){var e=this;new Promise((function(t,e){t()})).then((function(){e.onChangeProtectDocument(),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))}))},onChangeProtectDocument:function(t){if(!t){var e=this.getApplication().getController("DocProtection");t=e?e.getDocProps():null}t&&(this._state.docProtection=t,this.updatePreviewMode())}},Common.Controllers.Comments||{}))})),void 0===Common)var Common={};if(Common.Models=Common.Models||{},define("common/main/lib/model/User",["underscore","backbone","common/main/lib/component/BaseView"],(function(t,e){"use strict";Common.Models.User=e.Model.extend({defaults:function(){return{iid:Common.UI.getId(),id:void 0,idOriginal:void 0,username:"Guest",color:"#fff",colorval:null,online:!1,view:!1,hidden:!1}}})})),define("common/main/lib/collection/Users",["backbone","common/main/lib/model/User"],(function(t){"use strict";Common.Collections=Common.Collections||{},Common.Collections.Users=t.Collection.extend({model:Common.Models.User,getOnlineCount:function(){var t=0;return this.each((function(e){e.get("online")&&++t})),t},getEditingCount:function(){return this.filter((function(t){return t.get("online")&&!t.get("view")})).length},getVisibleEditingCount:function(){return this.filter((function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")})).length},getEditingOriginalCount:function(){return this.chain().filter((function(t){return t.get("online")&&!t.get("view")})).groupBy((function(t){return t.get("idOriginal")})).size().value()},getVisibleEditingOriginalCount:function(){return this.chain().filter((function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")})).groupBy((function(t){return t.get("idOriginal")})).size().value()},findUser:function(t){return this.find((function(e){return e.get("id")==t}))},findOriginalUser:function(t){return this.find((function(e){return e.get("idOriginal")==t}))}}),Common.Collections.HistoryUsers=t.Collection.extend({model:Common.Models.User,findUser:function(t){return this.find((function(e){return e.get("id")==t}))}})})),define("common/main/lib/model/ChatMessage",["backbone"],(function(t){"use strict";Common.Models=Common.Models||{},Common.Models.ChatMessage=t.Model.extend({defaults:{type:0,userid:null,username:"",message:""}})})),define("common/main/lib/collection/ChatMessages",["backbone","common/main/lib/model/ChatMessage"],(function(t){"use strict";!Common.Collections&&(Common.Collections={}),Common.Collections.ChatMessages=t.Collection.extend({model:Common.Models.ChatMessage})})),define("common/main/lib/controller/Chat",["core","common/main/lib/collection/Users","common/main/lib/collection/ChatMessages","common/main/lib/view/Chat"],(function(){"use strict";Common.Controllers.Chat=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.Users","Common.Collections.ChatMessages"],views:["Common.Views.Chat"],initialize:function(){this.addListeners({"Common.Views.Chat":{"message:add":_.bind(this.onSendMessage,this)}});var t=this;Common.NotificationCenter.on("layout:changed",(function(e){Common.Utils.asyncCall((function(e){"toolbar"!=e&&"status"!=e||!t.panelChat.$el.is(":visible")||(t.panelChat.updateLayout(!0),t.panelChat.setupAutoSizingTextBox())}),this,e)}))},events:{},onLaunch:function(){this.panelChat=this.createView("Common.Views.Chat",{storeUsers:this.getApplication().getCollection("Common.Collections.Users"),storeMessages:this.getApplication().getCollection("Common.Collections.ChatMessages")}),this.panelChat.on("render:after",_.bind(this.onAfterRender,this))},onAfterRender:function(t){this.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind((function(){t&&t.updateScrolls()}),this))},setMode:function(t){return this.mode=t,this.currentUserId=t.user.id,this.api&&(this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage",_.bind(this.onReceiveMessage,this)),this.mode.isEditDiagram||this.mode.isEditMailMerge||this.mode.isEditOle||(this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onUsersChanged,this)),this.api.asc_registerCallback("asc_onConnectionStateChanged",_.bind(this.onUserConnection,this)),this.api.asc_coAuthoringGetUsers()),this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_coAuthoringChatGetMessages()),this},setApi:function(t){return this.api=t,this},onUsersChanged:function(t,e){if(!this.mode.canLicense||!this.mode.canCoAuthoring){var i=0;for(o in t)void 0!==o&&i++;if(i>1&&null==this._isCoAuthoringStopped)return this._isCoAuthoringStopped=!0,this.api.asc_coAuthoringDisconnect(),void Common.NotificationCenter.trigger("api:disconnect")}var n=this.getApplication().getCollection("Common.Collections.Users");if(n){var o,s,a=[];for(o in t)if(void 0!==o&&(s=t[o])){var r=new Common.Models.User({id:s.asc_getId(),idOriginal:s.asc_getIdOriginal(),username:s.asc_getUserName(),online:!0,color:s.asc_getColor(),view:s.asc_getView(),hidden:!(s.asc_getIdOriginal()===this.currentUserId||AscCommon.UserInfoParser.isUserVisible(s.asc_getUserName()))});a[s.asc_getId()==e?"unshift":"push"](r)}n[n.size()>0?"add":"reset"](a)}},onUserConnection:function(t){var e=this.getApplication().getCollection("Common.Collections.Users");if(e){var i=e.findUser(t.asc_getId());i?(i.set({online:t.asc_getState()}),i.set({username:t.asc_getUserName()})):e.add(new Common.Models.User({id:t.asc_getId(),idOriginal:t.asc_getIdOriginal(),username:t.asc_getUserName(),online:t.asc_getState(),color:t.asc_getColor(),view:t.asc_getView(),hidden:!(t.asc_getIdOriginal()===this.currentUserId||AscCommon.UserInfoParser.isUserVisible(t.asc_getUserName()))}))}},onReceiveMessage:function(t,e){var i=this.getApplication().getCollection("Common.Collections.ChatMessages");if(i){var n=[];t.forEach((function(t){n.push(new Common.Models.ChatMessage({userid:t.useridoriginal,message:t.message,username:t.username}))})),i[i.size()<1||e?"reset":"add"](n)}},onSendMessage:function(t,e){if(e.length>0){var i=this;(function(t,e){for(var i=[];t;){if(t.length<e){i.push(t);break}i.push(t.substr(0,e)),t=t.substr(e)}return i})(e,2048).forEach((function(t){i.api.asc_coAuthoringChatSendMessage(t)}))}},notcriticalErrorTitle:"Warning"},Common.Controllers.Chat||{}))})),void 0===Common)var Common={};if(Common.Models=Common.Models||{},define("common/main/lib/model/Plugin",["underscore","backbone","common/main/lib/component/BaseView"],(function(t,e){"use strict";Common.Models.PluginVariation=e.Model.extend({defaults:function(){return{description:"",url:"",index:0,icons:void 0,isSystem:!1,isViewer:!1,isDisplayedInViewer:!0,EditorsSupport:["word","cell","slide"],isVisual:!1,isCustomWindow:!1,isModal:!0,isInsideMode:!1,initDataType:0,initData:"",isUpdateOleOnResize:!1,buttons:[],size:[800,600],initOnSelectionChanged:!1,visible:!0}}}),Common.Models.Plugin=e.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:"",baseUrl:"",guid:Common.UI.getId(),variations:[],currentVariation:0,pluginObj:void 0,allowSelected:!1,selected:!1,visible:!0,groupName:"",groupRank:0}}})})),void 0===Common)var Common={};if(Common.Collections=Common.Collections||{},define("common/main/lib/collection/Plugins",["underscore","backbone","common/main/lib/model/Plugin"],(function(t,e){"use strict";Common.Collections.Plugins=e.Collection.extend({model:Common.Models.Plugin,hasVisible:function(){return!!this.findWhere({visible:!0})}})})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],(function(t){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!0,enableKeyEvents:!1,automove:!1},t);var i=e.buttons&&_.size(e.buttons)>0?85:34;e.header||(i-=34),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.height+=i,e.height=Common.Utils.innerHeight()-2*this.bordersOffset-e.height<0?Common.Utils.innerHeight()-2*this.bordersOffset:e.height,e.cls+=" advanced-settings-dlg invisible-borders",this.template=['<div id="id-plugin-container" class="box" style="height:'+(e.height-i)+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.buttons&&_.size(this.options.buttons)>0?85:34,this.options.header||(this._headerFooterHeight-=34),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));var t=document.createElement("iframe");t.id=this.frameId,t.name="pluginFrameEditor",t.width="100%",t.height="100%",t.align="top",t.frameBorder=0,t.scrolling="no",t.allow="camera; microphone; display-capture",t.onload=_.bind(this._onLoad,this);var e=this,i=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout((function(){e.isLoaded||(e.loadMask=new Common.UI.LoadMask({owner:i}),e.loadMask.setTitle(e.textLoading),e.loadMask.show(),e.isLoaded&&e.loadMask.hide())}),500),t.src=this.url,i.append(t),this.on("resizing",(function(t){e.boxEl.css("height",parseInt(e.$window.css("height"))-e._headerFooterHeight)}));var n=function(){e.onWindowResize()};$(window).on("resize",n),this.on("close",(function(){$(window).off("resize",n)}))},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),o=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),s=2*this.bordersOffset;i-s<e+this._headerFooterHeight&&(e=i-s-this._headerFooterHeight),n-s<t+o&&(t=n-s-o),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+o),this.$window.css("left",(n-t-o)/2),this.$window.css("top",(i-e-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight(),i=this.getWidth(),n=this.getHeight(),o=this.resizable?0:this.bordersOffset;if(n<e-2*o+.1){if(!this.resizable&&this._restoreHeight>0&&n<this._restoreHeight){var s=Math.max(Math.min(this._restoreHeight,e-2*o),this.initConfig.minheight);this.setHeight(s),this.boxEl.css("height",s-this._headerFooterHeight)}var a=this.getTop();a<o?this.$window.css("top",o):a+n>e-o&&this.$window.css("top",e-o-n)}else void 0===this._restoreHeight&&(this._restoreHeight=n),this.setHeight(Math.max(e-2*o,this.initConfig.minheight)),this.boxEl.css("height",Math.max(e-2*o,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",o);if(i<t-2*o+.1){!this.resizable&&this._restoreWidth>0&&i<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,t-2*o),this.initConfig.minwidth));var r=this.getLeft();r<o?this.$window.css("left",o):r+i>t-o&&this.$window.css("left",t-o-i)}else void 0===this._restoreWidth&&(this._restoreWidth=i),this.setWidth(Math.max(t-2*o,this.initConfig.minwidth)),this.$window.css("left",o)},showButton:function(t,e){var i=this.$window.find(e?".header .tools:not(.left)":".header .tools.left"),n=i.find("#id-plugindlg-"+t);if(n.length<1){var o="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t);(n=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+o+'"></div>')).on("click",_.bind((function(){this.fireEvent("header:click",t)}),this)),i.append(n)}n.show(),i.removeClass("hidden")},hideButton:function(t){var e=this.$window.find(".header #id-plugindlg-"+t);e.length>0&&e.hide()},textLoading:"Loading"},Common.Views.PluginDlg||{}))})),define("common/main/lib/controller/Plugins",["core","common/main/lib/collection/Plugins","common/main/lib/view/Plugins","common/main/lib/view/PluginDlg"],(function(){"use strict";Common.Controllers.Plugins=Backbone.Controller.extend(_.extend({models:[],appOptions:{},configPlugins:{autostart:[]},serverPlugins:{autostart:[]},collections:["Common.Collections.Plugins"],views:["Common.Views.Plugins"],initialize:function(){var t=this;this.addListeners({Toolbar:{"render:before":function(e){var i=t.getApplication().getController("Main").appOptions;if(!i.isEditMailMerge&&!i.isEditDiagram&&!i.isEditOle){var n={action:"plugins",caption:t.panelPlugins.groupCaption,dataHintTitle:"E",layoutname:"toolbar-plugins"};t.$toolbarPanelPlugins=t.panelPlugins.getPanel(),t.toolbar=e,e.addTab(n,t.$toolbarPanelPlugins,10)}}},"Common.Views.Plugins":{"plugin:select":function(e,i){t.api.asc_pluginRun(e,i,"")}}})},events:function(){return{"click #id-plugin-close":_.bind(this.onToolClose,this)}},onLaunch:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins");this.panelPlugins=this.createView("Common.Views.Plugins",{storePlugins:t}),this.panelPlugins.on("render:after",_.bind(this.onAfterRender,this)),t.on({add:this.onAddPlugin.bind(this),reset:this.onResetPlugins.bind(this)}),this._moveOffset={x:0,y:0},this.autostart=[],this.customPluginsDlg=[],Common.Gateway.on("init",this.loadConfig.bind(this)),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this)),Common.NotificationCenter.on("uitheme:changed",this.updatePluginsButtons.bind(this)),Common.NotificationCenter.on("window:resize",this.updatePluginsButtons.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},loadConfig:function(t){var e=this;e.configPlugins.config=t.config.plugins,e.editor=window.DE||window.PDFE?"word":window.PE?"slide":"cell",e.isPDFEditor=!!window.PDFE},loadPlugins:function(){if(this.configPlugins.plugins=this.serverPlugins.plugins=!1,this.configPlugins.config&&this.getPlugins(this.configPlugins.config.pluginsData).then((function(e){t.configPlugins.plugins=e,t.mergePlugins()})).catch((function(e){t.configPlugins.plugins=!1})),!Common.Controllers.Desktop.isActive()||!Common.Controllers.Desktop.isOffline()){var t=this;Common.Utils.loadConfig("../../../../plugins.json",(function(e){"error"!=e&&(t.serverPlugins.config=e,t.getPlugins(t.serverPlugins.config.pluginsData).then((function(e){t.serverPlugins.plugins=e,t.mergePlugins()})).catch((function(e){t.serverPlugins.plugins=!1})))}))}},onAppShowed:function(t){},onAppReady:function(t){var e=this;new Promise((function(t,e){t()})).then((function(){e.onChangeProtectDocument(),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))}))},setApi:function(t){return this.api=t,this.appOptions.customization&&!1===this.appOptions.customization.plugins||(this.api.asc_registerCallback("asc_onPluginShow",_.bind(this.onPluginShow,this)),this.api.asc_registerCallback("asc_onPluginClose",_.bind(this.onPluginClose,this)),this.api.asc_registerCallback("asc_onPluginResize",_.bind(this.onPluginResize,this)),this.api.asc_registerCallback("asc_onPluginMouseUp",_.bind(this.onPluginMouseUp,this)),this.api.asc_registerCallback("asc_onPluginMouseMove",_.bind(this.onPluginMouseMove,this)),this.api.asc_registerCallback("asc_onPluginsReset",_.bind(this.resetPluginsList,this)),this.api.asc_registerCallback("asc_onPluginsInit",_.bind(this.onPluginsInit,this)),this.api.asc_registerCallback("asc_onPluginShowButton",_.bind(this.onPluginShowButton,this)),this.api.asc_registerCallback("asc_onPluginHideButton",_.bind(this.onPluginHideButton,this)),this.api.asc_registerCallback("asc_onPluginWindowShow",_.bind(this.onPluginWindowShow,this)),this.api.asc_registerCallback("asc_onPluginWindowClose",_.bind(this.onPluginWindowClose,this)),this.api.asc_registerCallback("asc_onPluginWindowResize",_.bind(this.onPluginWindowResize,this)),this.api.asc_registerCallback("asc_onPluginWindowMouseUp",_.bind(this.onPluginWindowMouseUp,this)),this.api.asc_registerCallback("asc_onPluginWindowMouseMove",_.bind(this.onPluginWindowMouseMove,this)),this.loadPlugins()),this},setMode:function(t,e){return this.appOptions=t,this.api=e,this.customPluginsComplete=!this.appOptions.canBrandingExt,this.appOptions.canBrandingExt&&this.getAppCustomPlugins(this.configPlugins),this},onAfterRender:function(t){t.viewPluginsList&&t.viewPluginsList.on("item:click",_.bind(this.onSelectPlugin,this)),this.bindViewEvents(this.panelPlugins,this.events);var e=this;Common.NotificationCenter.on({"layout:resizestart":function(t){if(e.panelPlugins.isVisible()){var i=e.panelPlugins.currentPluginFrame.offset();e._moveOffset={x:i.left+parseInt(e.panelPlugins.currentPluginFrame.css("padding-left")),y:i.top+parseInt(e.panelPlugins.currentPluginFrame.css("padding-top"))},e.api.asc_pluginEnableMouseEvents(!0)}},"layout:resizestop":function(t){e.panelPlugins.isVisible()&&e.api.asc_pluginEnableMouseEvents(!1)}})},refreshPluginsList:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),e=[];t.each((function(t){var i=new Asc.CPlugin;i.deserialize(t.get("original")),t.set("pluginObj",i),e.push(i)})),this.api.asc_pluginsRegister("",e),t.hasVisible()&&Common.NotificationCenter.trigger("tab:visible","plugins",Common.UI.LayoutManager.isElementVisible("toolbar-plugins")),Common.Gateway.pluginsReady()},onAddPlugin:function(t){var e=this;if(e.$toolbarPanelPlugins){var i=e.panelPlugins.createPluginButton(t);if(!i)return;var n=$("> .group",e.$toolbarPanelPlugins),o=$('<span class="btn-slot text x-huge"></span>').appendTo(n);i.render(o);var s=e.panelPlugins._state.docProtection;Common.Utils.lockControls(Common.enumLock.docLockView,s.isReadOnly,{array:i}),Common.Utils.lockControls(Common.enumLock.docLockForms,s.isFormsOnly,{array:i}),Common.Utils.lockControls(Common.enumLock.docLockComments,s.isCommentsOnly,{array:i})}},onResetPlugins:function(t){var e=this;if(e.appOptions.canPlugins=!t.isEmpty(),e.$toolbarPanelPlugins){e.$toolbarPanelPlugins.empty(),e.toolbar&&e.toolbar.clearMoreButton("plugins");var i=$('<div class="group"></div>'),n=-1,o=0;t.each((function(t){var s=t.get("groupRank");s!==n&&n>-1&&o>0?(i.appendTo(e.$toolbarPanelPlugins),$('<div class="separator long"></div>').appendTo(e.$toolbarPanelPlugins),i=$('<div class="group"></div>'),o=0):(i.appendTo(e.$toolbarPanelPlugins),$('<div class="separator long invisible"></div>').appendTo(e.$toolbarPanelPlugins),i=$('<div class="group" style="'+(Common.UI.isRTL()?"padding-right: 0;":"padding-left: 0;")+'"></div>'));var a=e.panelPlugins.createPluginButton(t);if(a){var r=$('<span class="btn-slot text x-huge"></span>').appendTo(i);a.render(r),o++}n=s})),i.appendTo(e.$toolbarPanelPlugins),e.toolbar&&e.toolbar.isTabActive("plugins")&&e.toolbar.processPanelVisible(null,!0,!0);var s=e.panelPlugins._state.docProtection;Common.Utils.lockControls(Common.enumLock.docLockView,s.isReadOnly,{array:e.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,s.isFormsOnly,{array:e.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,s.isCommentsOnly,{array:e.panelPlugins.lockedControls})}else console.error("toolbar panel isnot created")},updatePluginsButtons:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),e=this;t.each((function(t){e.panelPlugins.updatePluginIcons(t)}))},onSelectPlugin:function(t,e,i,n){var o=$(n.target);if(o&&o.hasClass("plugin-caret")){var s=this.panelPlugins.pluginMenu;if(s.isVisible())return void s.hide();var a,r=this,l=$(n.currentTarget),c=$(this.panelPlugins.el),d=l.offset(),h=c.offset();if(a=[d.left-h.left+l.width(),d.top-h.top+l.height()/2],null!=i){for(var m=0;m<s.items.length;m++)s.removeItem(s.items[m]),m--;s.removeAll();var u=i.get("variations");for(m=0;m<u.length;m++){var p=u[m],f=new Common.UI.MenuItem({caption:m>0?p.get("description"):r.panelPlugins.textStart,value:parseInt(p.get("index"))}).on("click",(function(t,e){r.api&&r.api.asc_pluginRun(i.get("guid"),t.value,"")}));s.addItem(f)}}var g=c.find("#menu-plugin-container");s.rendered||(g.length<1&&(g=$('<div id="menu-plugin-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',s.id),c.append(g)),s.render(g),s.cmpEl.attr({tabindex:"-1"}),s.on({"show:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!0)},"hide:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!1)}})),g.css({left:a[0],top:a[1]}),s.menuAlignEl=l,s.setOffset(-20,-l.height()/2-3),s.show(),_.delay((function(){s.cmpEl.focus()}),10),n.stopPropagation(),n.preventDefault()}else this.api.asc_pluginRun(i.get("guid"),0,"")},onPluginShow:function(t,e,i,n){var o=t.get_Variations()[e];if(o.get_Visual()){var s=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",a=o.get_Url();if(a=(0==t.get_BaseUrl().length?a:t.get_BaseUrl())+a,n&&(a+=n),o.get_InsideMode())this.panelPlugins.openInsideMode(t.get_Name(s),a,i,t.get_Guid())||this.api.asc_pluginButtonClick(-1,t.get_Guid());else{var r=this,l=o.get_CustomWindow(),c=o.get_Buttons(),d=[],h=o.get_Size(),m=o.get_Modal();(!h||h.length<2)&&(h=[800,600]),_.isArray(c)&&_.each(c,(function(t,e){t.visible&&(d[e]={caption:t.text,value:e,primary:t.primary})}));var u=o.get_Help();r.pluginDlg=new Common.Views.PluginDlg({cls:l?"plain":"",header:!l,title:t.get_Name(s),width:h[0],height:h[1],url:a,frameId:i,buttons:l?void 0:d,toolcallback:function(e){r.api.asc_pluginButtonClick(-1,t.get_Guid())},help:!!u,loader:t.get_Loader(),modal:void 0===m||m}),r.pluginDlg.on({"render:after":function(e){e.getChild(".footer .dlg-btn").on("click",(function(e){r.api.asc_pluginButtonClick(parseInt(e.currentTarget.attributes.result.value),t.get_Guid())})),r.pluginContainer=r.pluginDlg.$window.find("#id-plugin-container")},close:function(t){r.pluginDlg=void 0},drag:function(t){r.api.asc_pluginEnableMouseEvents("start"==t[1])},resize:function(t){r.api.asc_pluginEnableMouseEvents("start"==t[1])},help:function(){u&&window.open(u,"_blank")},"header:click":function(e){r.api.asc_pluginButtonClick(e,t.get_Guid())}}),r.pluginDlg.show()}}this.panelPlugins.openedPluginMode(t.get_Guid())},onPluginClose:function(t){this.pluginDlg?this.pluginDlg.close():this.panelPlugins.iframePlugin&&this.panelPlugins.closeInsideMode(),this.panelPlugins.closedPluginMode(t.get_Guid()),this.runAutoStartPlugins()},onPluginResize:function(t,e,i,n){if(this.pluginDlg){var o=e&&e.length>1&&i&&i.length>1&&(i[0]>e[0]||i[1]>e[1]||0==i[0]||0==i[1]);this.pluginDlg.setResizable(o,e,i),this.pluginDlg.setInnerSize(t[0],t[1]),n&&n.call()}},onToolClose:function(){this.api.asc_pluginButtonClick(-1,this.panelPlugins?this.panelPlugins._state.insidePlugin:void 0)},onPluginMouseUp:function(t,e){this.pluginDlg?(this.pluginDlg.binding.dragStop&&this.pluginDlg.binding.dragStop(),this.pluginDlg.binding.resizeStop&&this.pluginDlg.binding.resizeStop()):Common.NotificationCenter.trigger("frame:mouseup",{pageX:t*Common.Utils.zoom()+this._moveOffset.x,pageY:e*Common.Utils.zoom()+this._moveOffset.y})},onPluginMouseMove:function(t,e){if(this.pluginDlg){var i=this.pluginContainer.offset();this.pluginDlg.binding.drag&&this.pluginDlg.binding.drag({pageX:t*Common.Utils.zoom()+i.left,pageY:e*Common.Utils.zoom()+i.top}),this.pluginDlg.binding.resize&&this.pluginDlg.binding.resize({pageX:t*Common.Utils.zoom()+i.left,pageY:e*Common.Utils.zoom()+i.top})}else Common.NotificationCenter.trigger("frame:mousemove",{pageX:t*Common.Utils.zoom()+this._moveOffset.x,pageY:e*Common.Utils.zoom()+this._moveOffset.y})},onPluginsInit:function(t){!(t instanceof Array)&&(t=t.pluginsData),this.parsePlugins(t,!1,!0)},onPluginShowButton:function(t,e){this.pluginDlg&&this.pluginDlg.showButton(t,e)},onPluginHideButton:function(t){this.pluginDlg&&this.pluginDlg.hideButton(t)},runAutoStartPlugins:function(){this.autostart&&this.autostart.length>0&&this.api.asc_pluginRun(this.autostart.shift(),0,"")},resetPluginsList:function(){this.getApplication().getCollection("Common.Collections.Plugins").reset()},applyUICustomization:function(){var me=this;return new Promise((function(resolve,reject){var timer_sl=setInterval((function(){if(me.customPluginsComplete){clearInterval(timer_sl);try{me.configPlugins.UIplugins&&me.configPlugins.UIplugins.forEach((function(c){c.code&&eval(c.code)}))}catch(t){}resolve()}}),10)}))},parsePlugins:function(t,e,i){var n=this,o=this.getApplication().getCollection("Common.Collections.Plugins"),s=n.appOptions.isEdit&&!n.isPDFEditor,a=n.editor,r=n.api?n.api.GetVersion():void 0;if(t instanceof Array){var l=[],c=[],d=n.appOptions.lang.split(/[\-_]/)[0];t.forEach((function(t){var e;if(i)!(e=l.find((function(e){return e.get("baseUrl")==t.baseUrl||e.get("guid")==t.guid})))&&(e=o.findWhere({baseUrl:t.baseUrl})),!e&&(e=o.findWhere({guid:t.guid}));else if(l.some((function(e){return e.get("baseUrl")==t.baseUrl||e.get("guid")==t.guid}))||o.findWhere({baseUrl:t.baseUrl})||o.findWhere({guid:t.guid}))return;var h=[],m=!1,u=!1;if(t.variations.forEach((function(e){var i=!0===e.isSystem||"system"===e.type,n=(s||e.isViewer&&!1!==e.isDisplayedInViewer)&&_.contains(e.EditorsSupport,a)&&!i;if(n&&(m=!0),e.isViewer&&!1!==e.isDisplayedInViewer&&(u=!0),t.isUICustomizer)n&&c.push({url:t.baseUrl+e.url});else{var o=new Common.Models.PluginVariation(e),r=e.description;"object"==typeof e.descriptionLocale&&(r=e.descriptionLocale[d]||e.descriptionLocale.en||r||""),_.each(e.buttons,(function(t,e){"object"==typeof t.textLocale&&(t.text=t.textLocale[d]||t.textLocale.en||t.text||""),t.visible=s||!1!==t.isViewer})),o.set({description:r,index:h.length,url:e.url,icons:e.icons2||e.icons,buttons:e.buttons,visible:n,help:e.help}),h.push(o)}})),h.length>0&&!t.isUICustomizer){var p=t.name;"object"==typeof t.nameLocale&&(p=t.nameLocale[d]||t.nameLocale.en||p||""),m&&(m=n.checkPluginVersion(r,t.minVersion));var f={name:p,guid:t.guid,baseUrl:t.baseUrl,variations:h,currentVariation:0,visible:m,groupName:t.group?t.group.name:"",groupRank:t.group?t.group.rank:0,minVersion:t.minVersion,original:t,isDisplayedInViewer:u};e?e.set(f):l.push(new Common.Models.Plugin(f))}})),!1!==e&&(n.configPlugins.UIplugins=c),!e&&o&&((l=o.models.concat(l)).sort((function(t,e){var i=t.get("groupRank"),n=e.get("groupRank");return i<n?0==i?1:-1:i>n?0==n?-1:1:0})),o.reset(l),this.appOptions.canPlugins=!o.isEmpty())}else e||(this.appOptions.canPlugins=!1);e||this.getApplication().getController("LeftMenu").enablePlugins(),this.appOptions.canPlugins&&(this.refreshPluginsList(),this.runAutoStartPlugins())},checkPluginVersion:function(t,e){if(t&&"develop"!==t&&e&&"string"==typeof e){var i=e.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/),n=t.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/);if(i&&i.length>1&&n&&n.length>1)for(var o=0;o<3;o++){var s=i[o+1]?parseInt(i[o+1]):0,a=n[o+1]?parseInt(n[o+1]):0;if(s>a)return!1;if(s<a)return!0}}return!0},getPlugins:function(t,e){if(!t||t.length<1)return Promise.resolve([]);e=e||function(t){return fetch(t).then((function(e){return e.ok?e.json():Promise.reject(t)})).then((function(e){return e.baseUrl=t.substring(0,t.lastIndexOf("config.json")),e}))};var i=[];return t.map(e).reduce((function(t,e){return t.then((function(){return e})).then((function(t){return i.push(t),Promise.resolve(t)})).catch((function(t){return Promise.resolve(t)}))}),Promise.resolve()).then((function(){return Promise.resolve(i)}))},mergePlugins:function(){if(void 0!==this.serverPlugins.plugins&&void 0!==this.configPlugins.plugins){var t=[],e=[],i=this.configPlugins,n=!1;if(i.plugins&&i.plugins.length>0&&(e=i.plugins),i&&i.config){var o=i.config.autostart||i.config.autoStartGuid;"string"==typeof o&&(o=[o]),n=!!i.config.autoStartGuid,t=o||[]}(i=this.serverPlugins).plugins&&i.plugins.length>0&&(e=e.concat(i.plugins)),i&&i.config&&("string"==typeof(o=i.config.autostart||i.config.autoStartGuid)&&(o=[o]),(n||i.config.autoStartGuid)&&console.warn("Obsolete: The autoStartGuid parameter is deprecated. Please check the documentation for new plugin connection configuration."),t=t.concat(o||[])),this.autostart=t,this.parsePlugins(e,!1)}},getAppCustomPlugins:function(t){var e=this,i=function(){e.customPluginsComplete=!0};t.config?this.getPlugins(t.config.UIpluginsData).then((function(n){e.parsePlugins(n,!0),e.getPlugins(t.UIplugins,(function(t){return fetch(t.url).then((function(t){return t.ok?t.text():Promise.reject()})).then((function(e){return t.code=e,e}))})).then(i,i)}),i):i()},onChangeProtectDocument:function(t){if(!t){var e=this.getApplication().getController("DocProtection");t=e?e.getDocProps():null}t&&this.panelPlugins&&(this.panelPlugins._state.docProtection=t,Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:this.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:this.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:this.panelPlugins.lockedControls}))},onPluginWindowShow:function(t,e){if(e.isVisual){if(this.customPluginsDlg[t])return;var i=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",n=e.url,o=!0===e.isSystem||"system"===e.type;if((this.appOptions.isEdit||e.isViewer&&!1!==e.isDisplayedInViewer)&&_.contains(e.EditorsSupport,this.editor)&&!o&&!e.isInsideMode){var s=this,a=e.isCustomWindow,r=e.buttons,l=[],c=e.size,d=e.isModal;(!c||c.length<2)&&(c=[800,600]);var h=e.description;"object"==typeof e.descriptionLocale&&(h=e.descriptionLocale[i]||e.descriptionLocale.en||h||""),_.isArray(r)&&_.each(r,(function(e,n){"object"==typeof e.textLocale&&(e.text=e.textLocale[i]||e.textLocale.en||e.text||""),(s.appOptions.isEdit&&!s.isPDFEditor||!1!==e.isViewer)&&(l[n]={caption:e.text,value:n,primary:e.primary,frameId:t})}));var m=e.help;s.customPluginsDlg[t]=new Common.Views.PluginDlg({cls:a?"plain":"",header:!a,title:h,width:c[0],height:c[1],url:n,frameId:t,buttons:a?void 0:l,toolcallback:function(i){s.api.asc_pluginButtonClick(-1,e.guid,t)},help:!!m,modal:void 0===d||d}),s.customPluginsDlg[t].on({"render:after":function(i){i.getChild(".footer .dlg-btn").on("click",(function(i){s.api.asc_pluginButtonClick(parseInt(i.currentTarget.attributes.result.value),e.guid,t)})),s.customPluginsDlg[t].options.pluginContainer=s.customPluginsDlg[t].$window.find("#id-plugin-container")},close:function(e){s.customPluginsDlg[t]=void 0},drag:function(e){s.api.asc_pluginEnableMouseEvents("start"==e[1],t)},resize:function(e){s.api.asc_pluginEnableMouseEvents("start"==e[1],t)},help:function(){m&&window.open(m,"_blank")},"header:click":function(i){s.api.asc_pluginButtonClick(i,e.guid,t)}}),s.customPluginsDlg[t].show()}}},onPluginWindowClose:function(t){this.customPluginsDlg[t]&&this.customPluginsDlg[t].close()},onPluginWindowResize:function(t,e,i,n,o){if(this.customPluginsDlg[t]){var s=i&&i.length>1&&n&&n.length>1&&(n[0]>i[0]||n[1]>i[1]||0==n[0]||0==n[1]);this.customPluginsDlg[t].setResizable(s,i,n),this.customPluginsDlg[t].setInnerSize(e[0],e[1]),o&&o.call()}},onPluginWindowMouseUp:function(t,e,i){this.customPluginsDlg[t]?(this.customPluginsDlg[t].binding.dragStop&&this.customPluginsDlg[t].binding.dragStop(),this.customPluginsDlg[t].binding.resizeStop&&this.customPluginsDlg[t].binding.resizeStop()):Common.NotificationCenter.trigger("frame:mouseup",{pageX:e*Common.Utils.zoom()+this._moveOffset.x,pageY:i*Common.Utils.zoom()+this._moveOffset.y})},onPluginWindowMouseMove:function(t,e,i){if(this.customPluginsDlg[t]){var n=this.customPluginsDlg[t].options.pluginContainer.offset();this.customPluginsDlg[t].binding.drag&&this.customPluginsDlg[t].binding.drag({pageX:e*Common.Utils.zoom()+n.left,pageY:i*Common.Utils.zoom()+n.top}),this.customPluginsDlg[t].binding.resize&&this.customPluginsDlg[t].binding.resize({pageX:e*Common.Utils.zoom()+n.left,pageY:i*Common.Utils.zoom()+n.top})}else Common.NotificationCenter.trigger("frame:mousemove",{pageX:e*Common.Utils.zoom()+this._moveOffset.x,pageY:i*Common.Utils.zoom()+this._moveOffset.y})}},Common.Controllers.Plugins||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/UpDownPicker",["common/main/lib/component/BaseView"],(function(){"use strict";Common.UI.UpDownPicker=Common.UI.BaseView.extend({options:{caption:"",iconUpCls:"btn-zoomup",iconDownCls:"btn-zoomdown",minWidth:40},disabled:!1,template:_.template(['<label class="title float-left"><%= options.caption %></label>','<button type="button" class="btn small btn-toolbar updown-picker-button-up float-right"><i class="icon menu__icon <%= options.iconUpCls %>">&nbsp;</i></button>','<label class="updown-picker-value float-right" style="min-width: <%= options.minWidth %>px;"></label>','<button type="button" class="btn small btn-toolbar updown-picker-button-down float-right"><i class="icon menu__icon <%= options.iconDownCls %>">&nbsp;</i></button>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.render(),this.cmpEl=this.$el||$(this.el),this.btnUp=new Common.UI.Button({el:this.cmpEl.find(".updown-picker-button-up")}).on("click",_.bind((function(){this.trigger("click","up")}),this)),this.btnDown=new Common.UI.Button({el:this.cmpEl.find(".updown-picker-button-down")}).on("click",_.bind((function(){this.trigger("click","down")}),this)),this.displayValue=this.cmpEl.find(".updown-picker-value"),this.options.disabled&&this.setDisabled(this.options.disabled)},render:function(){return(this.$el||$(this.el)).html($(this.template({options:this.options}))),this.rendered=!0,this},setValue:function(t){this.displayValue.html(t||"")},setDisabled:function(t){this.rendered&&((t=!0===t)!==this.disabled&&(this.btnUp.setDisabled(t),this.btnDown.setDisabled(t)),this.disabled=t)}})})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/Draw",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window","common/main/lib/component/UpDownPicker"],(function(t){"use strict";Common.Views.Draw=Common.UI.BaseView.extend(_.extend(function(){var t='<div class="group"><span id="slot-btn-draw-select" class="btn-slot text x-huge"></span><span id="slot-btn-draw-pen-0" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-1" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-2" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-eraser" class="btn-slot text x-huge"></span></div>',e='<section id="draw-ink-panel" class="panel" data-tab="draw">'+t+"</section>";function i(){var t=this;t.btnEraser.on("click",(function(e){t.fireEvent("draw:eraser",[e])})),t.btnsPen.forEach((function(e){e.on("click",(function(e,i){t.fireEvent("draw:pen",[e])})),e.on("color:select",(function(e,i){t.fireEvent("draw:color",[e,i])}))})),t.btnSelect.on("click",(function(e){t.fireEvent("draw:select",[e])})),t._isSetEvents=!0}return{options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode,this._state={disabled:!1},this.lockedControls=[],this.btnsPen=[],this.isPDFEditor=!!window.PDFE;var e=Common.localStorage.getKeysFilter();this.appPrefix=e&&e.length?e.split(",")[0]:"";var i=Common.enumLock,n=[{hint:this.txtPen,color:"3D8A44",opacity:100,size:{arr:[.25,.5,1,2,3.5],idx:2},iconCls:"btn-pen-tool",idx:0},{hint:this.txtPen,color:"D43230",opacity:100,size:{arr:[.25,.5,1,2,3.5],idx:2},iconCls:"btn-pen-tool",idx:1},{hint:this.txtHighlighter,color:"FFFC54",opacity:50,size:{arr:[2,4,6,8,10],idx:2},iconCls:"btn-highlighter-tool",idx:2,colors:["FFFC54","72F54A","74F9FD","EB51F7","A900F9","EF8B3A","7272FF","FF63A4","1DFF92","03DA18","249B01","C504D2","0633D1","FFF7A0","FF0303","FFFFFF","D3D3D4","969696","606060","000000"]}],o="de-"===this.appPrefix?[i.headerLock,i.previewReviewMode,i.viewFormMode,i.lostConnect,i.docLockView,i.docLockForms,i.docLockComments]:"pe-"===this.appPrefix?[i.slideDeleted,i.lostConnect,i.noSlides]:[i.editCell,i.lostConnect,i.coAuth,i.Objects],s=this;n.forEach((function(t){var e=new Common.UI.ButtonColored({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon "+t.iconCls,caption:" ",menu:!0,split:!0,enableToggle:!0,allowDepress:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",penOptions:t,lock:o});s.btnsPen.push(e),s.lockedControls.push(e)})),this.btnEraser=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-eraser",caption:this.txtEraser,enableToggle:!0,allowDepress:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",lock:o}),this.lockedControls.push(this.btnEraser),this.btnSelect=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-select",caption:this.txtSelect,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",lock:o,visible:!this.isPDFEditor}),this.lockedControls.push(this.btnSelect),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this.boxSdk=$("#editor_sdk"),t&&t.html(this.getPanel()),this},updateButtonHint:function(t){var e=t.options.penOptions;t.updateHint(e.hint+": "+Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(e.color).asc_getName())+", "+e.size.arr[e.size.idx]+" "+this.txtMM),t.sizePicker&&t.sizePicker.setValue(e.size.arr[e.size.idx]+" "+this.txtMM)},createPen:function(t){var e=t.options.penOptions,i=Common.UI.getId(),n=this;this.updateButtonHint(t),t.setMenu(new Common.UI.Menu({cls:"shifted-left",style:"min-width: 100px;",items:[{template:_.template('<div id="id-toolbar-menu-draw-pen-'+i+'" style="width: 174px; display: inline-block;" class="palette-large"></div>'),stopPropagation:!0},{id:i+"-color-new",template:_.template('<a tabindex="-1" type="menuitem" style="">'+t.textNewColor+"</a>")},{caption:"--"},{template:_.template('<div id="id-toolbar-draw-updownpicker-'+i+'" class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0}]}),!0),t.currentColor=e.color,t.setColor(t.currentColor);var o=new Common.UI.ThemeColorPalette({el:$("#id-toolbar-menu-draw-pen-"+i),colors:e.colors||["1755A0","D43230","F5C346","EA3368","12A489","552F8B","9D1F87","BB2765","479ED2","67C9FA","3D8A44","80CA3D","1C19B4","7F4B0F","FF7E07","FFFFFF","D3D3D4","879397","575757","000000"],value:t.currentColor,dynamiccolors:5,themecolors:0,effects:0,columns:5,outerMenu:{menu:t.menu,index:0,focusOnShow:!0},storageSuffix:"-draw"});t.setPicker(o),o.on("select",_.bind(t.onColorSelect,t)),t.menu.setInnerMenu([{menu:o,index:0}]),t.menu.cmpEl.find("#"+i+"-color-new").on("click",(function(){o.addNewColor(t.currentColor)}));var s=function(e){var o=new Common.UI.UpDownPicker({el:$("#id-toolbar-draw-updownpicker-"+i),caption:n.txtSize,minWidth:50});o.on("click",(function(e){n.fireEvent("draw:size",[t,e])})),o.setValue(t.options.penOptions.size.arr[t.options.penOptions.size.idx]+" "+n.txtMM),t.sizePicker=o,e.off("show:after",s)};t.menu.on("show:after",s)},onAppReady:function(t){var e=this;new Promise((function(t,e){t()})).then((function(){e.btnsPen.forEach((function(t){e.createPen(t)})),e.btnEraser.updateHint(e.hintEraser),e.btnSelect.updateHint(e.hintSelect),Common.NotificationCenter.trigger("tab:visible","draw",Common.UI.LayoutManager.isElementVisible("toolbar-draw")),i.call(e)}))},getPanel:function(i){this.$el=$(_.template(i?t:e)({}));var n=this;return this.btnsPen.forEach((function(t,e){t.render(n.$el.find("#slot-btn-draw-pen-"+e))})),this.btnEraser&&this.btnEraser.render(this.$el.find("#slot-btn-draw-eraser")),this.btnSelect&&this.btnSelect.render(this.$el.find("#slot-btn-draw-select")),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(){return this.lockedControls},depressButtons:function(t){this.btnsPen.forEach((function(e){e!==t&&e.toggle(!1,!0)})),this.btnEraser!==t&&this.btnEraser.toggle(!1,!0)},SetDisabled:function(t){this._state.disabled=t},txtPen:"Pen",txtHighlighter:"Highlighter",txtEraser:"Eraser",hintEraser:"Eraser",txtSize:"Size",txtSelect:"Select",hintSelect:"Select",txtMM:"mm"}}(),Common.Views.Draw||{}))})),define("common/main/lib/view/PasswordDialog",["common/main/lib/component/Window"],(function(){"use strict";Common.Views.PasswordDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e=this,i={};_.extend(i,{width:395,height:270,header:!0,cls:"modal-dlg",contentTemplate:"",title:e.txtTitle,buttons:["ok","cancel"]},t),this.handler=t.handler,this.template=t.template||['<div class="box">','<div class="input-row" style="margin-bottom: 10px;">',"<label>"+e.txtDescription+"</label>","</div>",'<div class="input-row">',"<label>"+e.txtPassword+(e.passwordOptional?" ("+e.txtOptional+")":"")+"</label>","</div>",'<div id="id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRepeat+"</label>","</div>",'<div id="id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>',"<label>"+e.txtWarning+"</label>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.$window){var t=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#id-repeat-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(e){return t.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd})}},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd]},getDefaultFocusableComponent:function(){return this.inputPwd},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue())}this.close()},txtTitle:"Set Password",txtPassword:"Password",txtDescription:"A Password is required to open this document",txtRepeat:"Repeat password",txtIncorrectPwd:"Confirmation password is not identical",txtWarning:"Warning: If you lose or forget the password, it cannot be recovered. Please keep it in a safe place."},Common.Views.PasswordDialog||{}))})),void 0===Common)var Common={};if(define("common/main/lib/view/SignDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/Window","common/main/lib/component/ComboBoxFonts"],(function(){"use strict";Common.Views.SignDialog=Common.UI.Window.extend(_.extend({options:{width:370,style:"min-width: 350px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.api=this.options.api,this.signType=this.options.signType||"invisible",this.signSize=this.options.signSize||{width:0,height:0},this.certificateId=null,this.signObject=null,this.fontStore=this.options.fontStore,this.font={size:11,name:"Arial",bold:!1,italic:!1};var e=Common.localStorage.getKeysFilter();this.appPrefix=e&&e.length?e.split(",")[0]:"",this.template=['<div class="box" style="height: '+("invisible"==this.signType?"132px;":"300px;")+'">','<div id="id-dlg-sign-invisible">','<div class="input-row">',"<label>"+this.textPurpose+"</label>","</div>",'<div id="id-dlg-sign-purpose" class="input-row"></div>',"</div>",'<div id="id-dlg-sign-visible">','<div class="input-row">',"<label>"+this.textInputName+"</label>","</div>",'<div id="id-dlg-sign-name" class="input-row" style="margin-bottom: 5px;"></div>','<div id="id-dlg-sign-fonts" class="input-row" style="display: inline-block;"></div>','<div id="id-dlg-sign-font-size" class="input-row margin-left-3" style="display: inline-block;"></div>','<div id="id-dlg-sign-bold" class="margin-left-3" style="display: inline-block;"></div>','<div id="id-dlg-sign-italic" class="margin-left-3" style="display: inline-block;"></div>','<div style="margin: 10px 0 5px 0;">',"<label>"+this.textUseImage+"</label>","</div>",'<button id="id-dlg-sign-image" class="btn btn-text-default auto">'+this.textSelectImage+"</button>",'<div class="input-row" style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textSignature+"</label>","</div>",'<div style="border: 1px solid #cbcbcb;"><div id="signature-preview-img" style="width: 100%; height: 50px;position: relative;"></div></div>',"</div>",'<table style="margin-top: 30px;">',"<tr>",'<td><label class="font-weight-bold" style="margin-bottom: 3px;">'+this.textCertificate+'</label></td><td rowspan="2" class="padding-left-20" style="vertical-align: top;"><button id="id-dlg-sign-change" class="btn btn-text-default float-right">'+this.textSelect+"</button></td>","</tr>",'<tr><td><div id="id-dlg-sign-certificate" class="hidden" style="max-width: 240px;overflow: hidden;white-space: nowrap;"></td></tr>',"</table>","</div>"].join(""),this.templateCertificate=_.template(['<label style="display: block;margin-bottom: 3px;overflow: hidden;text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(name) %></label>','<label style="display: block;"><%= Common.Utils.String.htmlEncode(valid) %></label>'].join("")),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.inputPurpose=new Common.UI.InputField({el:$("#id-dlg-sign-purpose"),style:"width: 100%;"}),t.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-name"),style:"width: 100%;",validateOnChange:!0}).on("changing",_.bind(t.onChangeName,t)),t.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#id-dlg-sign-fonts"),cls:"input-group-nr",style:"width: 234px;",menuCls:"scrollable-menu",menuStyle:"min-width: 234px;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,takeFocusOnClose:!0,hint:t.tipFontName}).on("selected",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),i.name,t.font.size,t.font.italic,t.font.bold),t.font.name=i.name})),this.cmbFontSize=new Common.UI.ComboBox({el:$("#id-dlg-sign-font-size"),cls:"input-group-nr",style:"width: 55px;",menuCls:"scrollable-menu",menuStyle:"min-width: 55px;max-height: 270px;",hint:this.tipFontSize,takeFocusOnClose:!0,data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}]}).on("selected",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,i.value,t.font.italic,t.font.bold),t.font.size=i.value})),this.cmbFontSize.setValue(this.font.size),this.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),t.btnBold=new Common.UI.Button({parentEl:$("#id-dlg-sign-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:t.textBold}),t.btnBold.on("click",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,t.font.size,t.font.italic,e.pressed),t.font.bold=e.pressed})),t.btnItalic=new Common.UI.Button({parentEl:$("#id-dlg-sign-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:t.textItalic}),t.btnItalic.on("click",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,t.font.size,e.pressed,t.font.bold),t.font.italic=e.pressed})),t.btnSelectImage=new Common.UI.Button({el:"#id-dlg-sign-image"}),t.btnSelectImage.on("click",_.bind(t.onSelectImage,t)),t.btnChangeCertificate=new Common.UI.Button({el:"#id-dlg-sign-change"}),t.btnChangeCertificate.on("click",_.bind(t.onChangeCertificate,t)),t.btnOk=new Common.UI.Button({el:e.find(".primary"),disabled:!0}),t.cntCertificate=$("#id-dlg-sign-certificate"),t.cntVisibleSign=$("#id-dlg-sign-visible"),t.cntInvisibleSign=$("#id-dlg-sign-invisible"),"visible"==t.signType?t.cntInvisibleSign.addClass("hidden"):t.cntVisibleSign.addClass("hidden"),e.find(".dlg-btn").on("click",_.bind(t.onBtnClick,t)),t.afterRender()},getFocusedComponents:function(){return[this.inputPurpose,this.inputName,this.cmbFonts,this.cmbFontSize,this.btnBold,this.btnItalic,this.btnSelectImage,this.btnChangeCertificate]},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){("visible"==t.signType?t.inputName:t.inputPurpose).cmpEl.find("input").focus()}),500)},close:function(){this.api.asc_unregisterCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_unregisterCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),Common.UI.Window.prototype.close.apply(this,arguments),this.signObject&&this.signObject.destroy()},afterRender:function(){this.api&&(this.binding||(this.binding={}),this.binding.certificateChanged=_.bind(this.onCertificateChanged,this),this.api.asc_registerCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_registerCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),this.api.asc_GetDefaultCertificate()),"visible"==this.signType&&(this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.font.name})||this.fontStore.at(0)),this.signObject=new AscCommon.CSignatureDrawer("signature-preview-img",this.api,this.signSize.width,this.signSize.height))},getSettings:function(){var t={};return t.certificateId=this.certificateId,"invisible"==this.signType?t.purpose=this.inputPurpose.getValue():t.images=this.signObject?this.signObject.getImages():[null,null],t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&(this.btnOk.isDisabled()||this.signObject&&!this.signObject.isValid()))return void(this.btnOk.isDisabled()||(this.inputName.showError([this.textNameError]),this.inputName.focus()));this.options.handler.call(this,this,t)}this.close()},onChangeCertificate:function(){this.api.asc_SelectCertificate()},onCertificateChanged:function(t){this.certificateId=t.id;var e=t.date,i="string"==typeof e?e.split(" - "):["",""];this.cntCertificate.html(this.templateCertificate({name:t.name,valid:this.textValid.replace("%1",i[0]).replace("%2",i[1])})),this.cntCertificate.toggleClass("hidden",_.isEmpty(this.certificateId)||this.certificateId<0),this.btnChangeCertificate.setCaption(_.isEmpty(this.certificateId)||this.certificateId<0?this.textSelect:this.textChange),this.btnOk.setDisabled(_.isEmpty(this.certificateId)||this.certificateId<0)},onSelectImage:function(){this.signObject&&(this.signObject.selectImage(),this.inputName.setValue(""))},onChangeName:function(t,e){this.signObject&&this.signObject.setText(e,this.font.name,this.font.size,this.font.italic,this.font.bold)},onFontSizeChanged:function(t,e,i,n){var o;if(t){if(!e.store.findWhere({displayValue:i.value})&&!(o=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return o=e.getValue(),e.setRawValue(o),n.preventDefault(),!1}else{var s="sse-"==this.appPrefix?409:300;o=(o=Common.Utils.String.parseFloat(i.value))>s?s:o<1?1:Math.floor(2*(o+.4))/2,e.setRawValue(o),this.signObject&&this.signObject.setText(this.inputName.getValue(),this.font.name,o,this.font.italic,this.font.bold),this.font.size=o}},textTitle:"Sign Document",textPurpose:"Purpose for signing this document",textCertificate:"Certificate",textValid:"Valid from %1 to %2",textChange:"Change",textInputName:"Input signer name",textUseImage:"or click 'Select Image' to use a picture as signature",textSelectImage:"Select Image",textSignature:"Signature looks as",tipFontName:"Font Name",tipFontSize:"Font Size",textBold:"Bold",textItalic:"Italic",textSelect:"Select",textNameError:"Signer name must not be empty."},Common.Views.SignDialog||{}))})),void 0===Common)var Common={};if(define("common/main/lib/view/SignSettingsDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/CheckBox","common/main/lib/component/Window"],(function(){"use strict";Common.Views.SignSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 350px;",cls:"modal-dlg",type:"edit"},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 250px;">','<div class="input-row">',"<label>"+this.textInfoName+"</label>","</div>",'<div id="id-dlg-sign-settings-name" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoTitle+"</label>","</div>",'<div id="id-dlg-sign-settings-title" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoEmail+"</label>","</div>",'<div id="id-dlg-sign-settings-email" class="input-row" style="margin-bottom: 10px;"></div>','<div class="input-row">',"<label>"+this.textInstructions+"</label>","</div>",'<div id="id-dlg-sign-settings-instructions"></div>','<div id="id-dlg-sign-settings-date"></div>',"</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">'+this.okButtonText+"</button>",'<% if (type == "edit") { %>','<button class="btn normal dlg-btn" result="cancel">'+this.cancelButtonText+"</button>","<% } %>","</div>"].join(""),this.api=this.options.api,this.type=this.options.type||"edit",this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-settings-name"),style:"width: 100%;",disabled:"view"==this.type}),t.inputTitle=new Common.UI.InputField({el:$("#id-dlg-sign-settings-title"),style:"width: 100%;",disabled:"view"==this.type}),t.inputEmail=new Common.UI.InputField({el:$("#id-dlg-sign-settings-email"),style:"width: 100%;",disabled:"view"==this.type}),t.textareaInstructions=new Common.UI.TextareaField({el:e.find("#id-dlg-sign-settings-instructions"),style:"width: 100%; height: 35px;margin-bottom: 10px;",value:this.textDefInstruction,disabled:"view"==this.type}),this.chDate=new Common.UI.CheckBox({el:$("#id-dlg-sign-settings-date"),labelText:this.textShowDate,disabled:"view"==this.type,value:"checked"}),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputName,this.inputTitle,this.inputEmail,this.textareaInstructions,this.chDate]},getDefaultFocusableComponent:function(){return this.inputName},setSettings:function(t){if(t){var e=this,i=t.asc_getSigner1();e.inputName.setValue(i||""),i=t.asc_getSigner2(),e.inputTitle.setValue(i||""),i=t.asc_getEmail(),e.inputEmail.setValue(i||""),i=t.asc_getInstructions(),e.textareaInstructions.setValue(i||""),e.chDate.setValue(t.asc_getShowDate()),e._currentGuid=t.asc_getGuid()}},getSettings:function(){var t=this,e=new AscCommon.asc_CSignatureLine;return e.asc_setSigner1(t.inputName.getValue()),e.asc_setSigner2(t.inputTitle.getValue()),e.asc_setEmail(t.inputEmail.getValue()),e.asc_setInstructions(t.textareaInstructions.getValue()),e.asc_setShowDate("checked"==t.chDate.getValue()),void 0!==t._currentGuid&&e.asc_setGuid(t._currentGuid),e},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},textInfo:"Signer Info",textInfoName:"Suggested signer",textInfoTitle:"Suggested signer's title",textInfoEmail:"Suggested signer's e-mail",textInstructions:"Instructions for signer",txtEmpty:"This field is required",textAllowComment:"Allow signer to add comment in the signature dialog",textShowDate:"Show sign date in signature line",textTitle:"Signature Setup",textDefInstruction:"Before signing this document, verify that the content you are signing is correct."},Common.Views.SignSettingsDialog||{}))})),void 0===Common)var Common={};Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Draw",["core","common/main/lib/view/Draw","common/main/lib/view/PasswordDialog","common/main/lib/view/SignDialog","common/main/lib/view/SignSettingsDialog"],(function(){"use strict";Common.Controllers.Draw=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Common.Views.Draw"],sdkViewName:"#id_main",initialize:function(){this.addListeners({"Common.Views.Draw":{"draw:select":_.bind(this.onSelect,this),"draw:eraser":_.bind(this.onEraser,this),"draw:pen":_.bind(this.onDrawPen,this),"draw:size":_.bind(this.onDrawSizeClick,this),"draw:color":_.bind(this.onDrawColorClick,this)}})},onLaunch:function(){this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))},setConfig:function(t,e){this.setApi(e),t&&(this.sdkViewName=t.sdkviewname||this.sdkViewName)},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onInkDrawerStop",_.bind(this.onInkDrawerStop,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this))),this},setMode:function(t){return this.appConfig=t,this.view=this.createView("Common.Views.Draw",{mode:t}),this},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},onInkDrawerStop:function(){this.view&&this.view.depressButtons()},onSelect:function(t){this.api&&this.api.asc_StopInkDrawer(),Common.NotificationCenter.trigger("edit:complete",this.view)},onEraser:function(t){this.api&&(t.pressed?(this.view.depressButtons(t),this.api.asc_StartInkEraser(),Common.NotificationCenter.trigger("draw:start",this.view)):this.api.asc_StopInkDrawer())},onDrawPen:function(t){if(this.api)if(t.pressed){this.view.depressButtons(t);var e=t.options.penOptions,i=new Asc.asc_CStroke;i.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),i.put_color(Common.Utils.ThemeColor.getRgbColor(e.color)),i.asc_putPrstDash(Asc.c_oDashType.solid),i.put_width(e.size.arr[e.size.idx]),i.put_transparent(2.55*e.opacity),this.api.asc_StartDrawInk(i,e.idx),Common.NotificationCenter.trigger("draw:start",this.view)}else this.api.asc_StopInkDrawer()},onDrawSizeClick:function(t,e){t.pressed||(t.toggle(!0,!0),this.view&&this.view.depressButtons(t));var i=t.options.penOptions;i.size.idx="up"===e?Math.min(i.size.idx+1,i.size.arr.length-1):Math.max(i.size.idx-1,0),this.view&&this.view.updateButtonHint(t),this.onDrawPen(t)},onDrawColorClick:function(t,e){t.pressed||(t.toggle(!0,!0),this.view&&this.view.depressButtons(t)),t.options.penOptions.color=e,this.view&&this.view.updateButtonHint(t),this.onDrawPen(t)},createToolbarPanel:function(t){return this.view.getPanel(t)},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAppReady:function(t){new Promise((function(t,e){t()})).then((function(){}))},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)}},Common.Controllers.Draw||{}))})),require.config({baseUrl:"../../",paths:{jquery:"../vendor/jquery/jquery",underscore:"../vendor/underscore/underscore",backbone:"../vendor/backbone/backbone",bootstrap:"../vendor/bootstrap/dist/js/bootstrap",text:"../vendor/requirejs-text/text",perfectscrollbar:"common/main/lib/mods/perfect-scrollbar",jmousewheel:"../vendor/perfect-scrollbar/src/jquery.mousewheel",xregexp:"../vendor/xregexp/xregexp-all-min",socketio:"../vendor/socketio/socket.io.min",allfonts:"../../sdkjs/common/AllFonts",sdk:"../../sdkjs/word/sdk-all-min",api:"api/documents/api",core:"common/main/lib/core/application",notification:"common/main/lib/core/NotificationCenter",keymaster:"common/main/lib/core/keymaster",tip:"common/main/lib/util/Tip",localstorage:"common/main/lib/util/LocalStorage",analytics:"common/Analytics",gateway:"common/Gateway",locale:"common/locale",irregularstack:"common/IrregularStack"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},bootstrap:{deps:["jquery"]},perfectscrollbar:{deps:["jmousewheel"]},notification:{deps:["backbone"]},core:{deps:["backbone","notification","irregularstack"]},sdk:{deps:["jquery","allfonts","xregexp","socketio"]},gateway:{deps:["jquery"]},analytics:{deps:["jquery"]}}}),require(["sdk","backbone","bootstrap","core","analytics","gateway","locale"],(function(t,e,i,n){if(!e.History||!e.History.started){e.history.start();var o=new e.Application({nameSpace:"PDFE",autoCreate:!1,controllers:["Viewport","DocumentHolder","Toolbar","Statusbar","Navigation","PageThumbnails","LeftMenu","Main","ViewTab","Search","Print","Common.Controllers.Fonts","Common.Controllers.Chat","Common.Controllers.Comments","Common.Controllers.Draw","Common.Controllers.Plugins"]});Common.Locale.apply((function(){require(["common/main/lib/util/LocalStorage","common/main/lib/controller/Scaling","common/main/lib/controller/Themes","common/main/lib/controller/Desktop","pdfeditor/main/app/controller/Viewport","pdfeditor/main/app/controller/DocumentHolder","pdfeditor/main/app/controller/Toolbar","pdfeditor/main/app/controller/Statusbar","pdfeditor/main/app/controller/Navigation","pdfeditor/main/app/controller/PageThumbnails","pdfeditor/main/app/controller/LeftMenu","pdfeditor/main/app/controller/Main","pdfeditor/main/app/controller/ViewTab","pdfeditor/main/app/controller/Search","pdfeditor/main/app/controller/Print","pdfeditor/main/app/view/FileMenuPanels","common/main/lib/util/utils","common/main/lib/controller/Fonts","common/main/lib/controller/Comments","common/main/lib/controller/Chat","common/main/lib/controller/Plugins","common/main/lib/controller/Draw"],(function(){o.start()}))}))}}),(function(t){"timeout"==t.requireType&&!reqerr&&window.requireTimeourError&&(reqerr=window.requireTimeourError(),window.alert(reqerr),window.location.reload())})),define("../apps/pdfeditor/main/app.js",(function(){}));